define('core/modal_backdrop', ["jquery","core/templates","core/notification"],function(a,b,c){var d={ROOT:'[data-region="modal-backdrop"]'},e=function(b){this.root=a(b),this.isAttached=!1,this.root.is(d.ROOT)||c.exception({message:"Element is not a modal backdrop"})};return e.prototype.getRoot=function(){return this.root},e.prototype.attachToDOM=function(){this.isAttached||(a("body").append(this.root),this.isAttached=!0)},e.prototype.setZIndex=function(a){this.root.css("z-index",a)},e.prototype.isVisible=function(){return this.root.hasClass("show")},e.prototype.hasTransitions=function(){return this.getRoot().hasClass("fade")},e.prototype.show=function(){this.isVisible()||(this.isAttached||this.attachToDOM(),this.root.removeClass("hide").addClass("show"))},e.prototype.hide=function(){this.isVisible()&&(this.hasTransitions()?this.getRoot().one("transitionend webkitTransitionEnd oTransitionEnd",function(){this.getRoot().removeClass("show").addClass("hide")}.bind(this)):this.getRoot().removeClass("show").addClass("hide"))},e.prototype.destroy=function(){this.root.remove()},e});
define('core/modal_events', [],function(){return{shown:"modal:shown",hidden:"modal:hidden",destroyed:"modal:destroyed",save:"modal-save-cancel:save",cancel:"modal-save-cancel:cancel",yes:"modal-confirm:yes",no:"modal-confirm:no"}});
define('core/chart_output_base', ["jquery"],function(a){function b(b,c){this._node=a(b),this._chart=c}return b.prototype.update=function(){throw new Error("Not supported.")},b});
define('core/flex_icon', ["jquery","core/config","core/localstorage","core/ajax"],function(a,b,c,d){var e=!1,f=!1,g=null,h=function(){var h="core_flex_icon/"+b.theme+"/cache",i=a.Deferred();e=!0,g=i.promise();var j=c.get(h);j?(f=JSON.parse(j),i.resolve()):a.when.apply(this,d.call([{methodname:"core_output_get_flex_icons",args:{themename:b.theme}}],!0,!1)).done(function(a){c.set(h,JSON.stringify(a)),f=a,i.resolve()})},i={getFlexTemplateData:function(b){var c=a.Deferred(),d=c.promise(),e=function(){if(!f.icons.hasOwnProperty(b))return void c.reject();var d=f.icons[b],e={data:a.extend({},f.datas[d[1]]),template:f.templates[d[0]]};e.data.identifier=b,c.resolve(e)};return g.done(e),d},getIconData:function(c,d,e){var f,g=a.Deferred(),h=g.promise(),i=this;"undefined"==typeof e&&(e={}),d&&""!==d&&"moodle"!==d&&"core"!==d?f=d+"|"+c:(f=c,d="core"),"undefined"==typeof e.title&&"undefined"!=typeof e.alt&&(e.title=e.alt);var j=function(a){a.data.customdata=e,g.resolve({context:a.data,template:a.template})},k=function(){var a=[],f="";for(var h in e)"class"===h&&e.hasOwnProperty(h)?f=e[h]:e.hasOwnProperty(h)&&a.push({name:h,value:e[h]});var i=b.wwwroot+"/theme/image.php";i+=b.themerev>0&&1==b.slasharguments?"/"+b.theme+"/"+d+"/"+b.themerev+"/"+c:"?theme="+b.theme+"&component="+d+"&rev="+b.themerev+"&image="+c,a.push({name:"src",value:i}),g.resolve({template:"core/pix_icon",context:{attributes:a,extraclasses:f}})};return this.getFlexTemplateData(f).then(j).fail(function(){f===d+"|"+c?k():(f=d+"|"+c,i.getFlexTemplateData(f).then(j).fail(k))}),h}};return e||h(),i});
define('core/chart_bar', ["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}return b.prototype=Object.create(a.prototype),b.prototype._horizontal=!1,b.prototype._stacked=!1,b.prototype.TYPE="bar",b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);return d.setHorizontal(c.horizontal),d.setStacked(c.stacked),d},b.prototype._setDefaults=function(){a.prototype._setDefaults.apply(this,arguments);var b=this.getYAxis(0,!0);b.setMin(0)},b.prototype.getHorizontal=function(){return this._horizontal},b.prototype.getStacked=function(){return this._stacked},b.prototype.setHorizontal=function(a){var b=this.getXAxis(0,!0);null===b.getMin()&&b.setMin(0),this._horizontal=Boolean(a)},b.prototype.setStacked=function(a){this._stacked=Boolean(a)},b});
define('core/config', function(){return M.cfg});
define('core/modal_factory', ["jquery","core/modal_events","core/modal_registry","core/modal","core/modal_save_cancel","core/modal_confirm","core/modal_cancel","core/templates","core/notification","core/custom_interaction_events"],function(a,b,c,d,e,f,g,h,i,j){var k={DEFAULT:"core/modal",SAVE_CANCEL:"core/modal_save_cancel",CONFIRM:"core/modal_confirm",CANCEL:"core/modal_cancel"},l={DEFAULT:"DEFAULT",SAVE_CANCEL:"SAVE_CANCEL",CONFIRM:"CONFIRM",CANCEL:"CANCEL"};c.register(l.DEFAULT,d,k.DEFAULT),c.register(l.SAVE_CANCEL,e,k.SAVE_CANCEL),c.register(l.CONFIRM,f,k.CONFIRM),c.register(l.CANCEL,g,k.CANCEL);var m=function(a,c){if("undefined"!=typeof c){var d=null;j.define(c,[j.events.activate]),c.on(j.events.activate,function(b,c){d=b.currentTarget,a.then(function(a){return a.show(),a}),c.originalEvent.preventDefault()}),a.then(function(a){return a.getRoot().on(b.hidden,function(){null!==d&&d.focus()}),a})}},n=function(b,c){c=a(c);var d=b.module,e=new d(c);return e},o=function(b,c,d){var e=b.template,f=h.render(e,d).then(function(c){var d=a(c);return n(b,d)}).fail(i.exception);return m(f,c),f},p=function(a,b,d){var e=a.type||l.DEFAULT,f=!!a.large,g=null;return g=c.get(e),g||i.exception({message:"Unable to find modal of type: "+e}),o(g,b,d).then(function(b){return"undefined"!=typeof a.title&&b.setTitle(a.title),"undefined"!=typeof a.body&&b.setBody(a.body),"undefined"!=typeof a.footer&&b.setFooter(a.footer),f&&b.setLarge(),b})};return{create:p,types:l}});
define('core/log', ["core/loglevel"],function(a){var b=a.methodFactory;return a.methodFactory=function(a,c){var d=b(a,c);return function(a,b){d(b?b+": "+a:a)}},a.setConfig=function(b){"undefined"!=typeof b.level&&a.setLevel(b.level)},a});
define('core/search-input', ["jquery"],function(a){var b=null,c=function(a){b.hasClass("expanded")?e():d(a)},d=function(c){var d=a(document).width();if("keydown"!==c.type||13===c.keyCode||32===c.keyCode)return d<=767&&("click"===c.type||"keydown"===c.type)?void f():void(d<=767||("keydown"===c.type&&c.preventDefault(),b.addClass("expanded"),b.find("form").addClass("expanded"),b.find("input").focus()))},e=function(){b.removeClass("expanded"),b.find("form").removeClass("expanded")},f=function(){b.find("form").submit()};return{init:function(d){b=a("#"+d),b.on("click mouseover keydown","div",c)}}});
define('core/sessionstorage', ["core/config","core/storagewrapper"],function(a,b){var c=new b(window.sessionStorage);return{get:function(a){return c.get(a)},set:function(a,b){return c.set(a,b)}}});
define('core/key_codes', function(){return{tab:9,enter:13,escape:27,space:32,end:35,home:36,arrowLeft:37,arrowUp:38,arrowRight:39,arrowDown:40,8:56,asterix:106,pageUp:33,pageDown:34}});
define('core/blocks', ["jquery","core/templates"],function(a,b){var c={init:function(c){function d(a){a.preventDefault();var b=!f.hasClass("hidden");M.util.set_user_preference(c.preference,b),b?(f.addClass("hidden"),f.find(".block-hider-show").focus()):(f.removeClass("hidden"),f.find(".block-hider-hide").focus())}function e(a){a.preventDefault(),13==a.keyCode&&d(this)}var f=a("#"+c.id),g=f.find(".title"),h=f.find(".block_action"),i=h.data("collapsible");g&&h&&i&&(b.renderIcon("block-hide",c.tooltipVisible).done(function(b){var f=a('<a href="#" title="'+c.tooltipVisible+'" class="block-hider-hide">'+b+"</a>");f.click(d),f.keypress(e),h.append(f)}),b.renderIcon("block-show",c.tooltipHidden).done(function(b){var f=a('<a href="#" title="'+c.tooltipHidden+'" class="block-hider-show">'+b+"</a>");f.click(d),f.keypress(e),h.append(f)}))}};return c});
define('core/permissionmanager', ["jquery","core/config","core/notification","core/templates","core/flex_icon","core/yui"],function(a,b,c,d,e,f){var g,h,i,j,k={ADDROLE:"a.allowlink, a.prohibitlink",REMOVEROLE:"a.preventlink, a.unprohibitlink",UNPROHIBIT:"a.unprohibitlink"},l=a.Event("rolesloaded"),m=null,n=function(){var d={contextid:g,getroles:1,sesskey:b.sesskey};a.post(i+"roles/ajax.php",d,null,"json").done(function(b){try{j=b,n=function(){a("body").trigger(l)},n()}catch(d){c.exception(d)}}).fail(function(a,b,d){c.exception(d)})},o=function(b,f,h){var k={contextid:g,roleid:f,sesskey:M.cfg.sesskey,action:h,capability:b.data("name")};a.post(i+"roles/ajax.php",k,null,"json").done(function(g){var h=g;try{var k={rolename:j[f],roleid:f,adminurl:i,imageurl:"delete-ns"};switch(h){case"allow":k.spanclass="label label-success allowed",k.linkclass="preventlink",k.action="prevent";break;case"prohibit":k.spanclass="label label-danger forbidden",k.linkclass="unprohibitlink",k.action="unprohibit";break;case"prevent":return void b.find('a[data-role-id="'+f+'"]').first().closest(".allowed").remove();case"unprohibit":return void b.find('a[data-role-id="'+f+'"]').first().closest(".forbidden").remove();default:return}e.getIconData("delete-ns","",{alt:k.action}).then(function(a){return k.deleteicon=a,d.render("core/permissionmanager_role",k)}).then(function(c){if("allow"==h)a(c).insertBefore(b.find(".allowmore:first"));else if("prohibit"==h){a(c).insertBefore(b.find(".prohibitmore:first"));var d=b.find(".allowedroles").first().find('a[data-role-id="'+f+'"]');d&&d.first().closest(".allowed").remove()}m.hide()}).fail(c.exception)}catch(l){c.exception(l)}}).fail(function(a,b,d){c.exception(d)})},p=function(b){b.preventDefault(),f.use("moodle-core-notification-dialogue",function(){a("body").one("rolesloaded",function(){var e=a(b.currentTarget),f=e.data("action"),g=e.closest("tr.rolecap"),i={cap:g.data("humanname"),context:h},l=M.util.get_string("role"+f+"info","core_role",i);null===m&&(m=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,width:"450px"})),m.set("headerContent",M.util.get_string("role"+f+"header","core_role"));var n,p,q=[];switch(f){case"allow":p=g.find(k.REMOVEROLE);break;case"prohibit":p=g.find(k.UNPROHIBIT)}for(n in j){var r="",s=p.filter("[data-role-id='"+n+"']").length;s&&(r="disabled");var t={roleid:n,rolename:j[n],disabled:r};q.push(t)}d.render("core/permissionmanager_panelcontent",{message:l,roles:q}).done(function(b){m.set("bodyContent",b),m.show(),a("div.role_buttons").delegate("input","click",function(b){var c=a(b.currentTarget).data("role-id");o(g,c,f)})}).fail(c.exception)})}),n()},q=function(b){b.preventDefault(),a("body").one("rolesloaded",function(){var d=a(b.currentTarget),e=d.data("action"),f=d.data("role-id"),g=d.closest("tr.rolecap"),i={role:j[f],cap:g.data("humanname"),context:h};c.confirm(M.util.get_string("confirmunassigntitle","core_role"),M.util.get_string("confirmrole"+e,"core_role",i),M.util.get_string("confirmunassignyes","core_role"),M.util.get_string("confirmunassignno","core_role"),function(){o(g,f,e)})}),n()};return{initialize:function(b){g=b.contextid,h=b.contextname,i=b.adminurl;var c=a("body");c.delegate(k.ADDROLE,"click",p),c.delegate(k.REMOVEROLE,"click",q)}}});
define('core/popover', ["jquery","theme_roots/bootstrap"],function(a){function b(){function b(b){for(var d=0;d<c.length;d++){var e=c[d],f=a(e.parentNode),g=a(".popover");f.is(b.target)||0!==f.has(b.target).length||0!==g.has(b.target).length||f.popover("hide").data("bs.popover")}}a('[data-component="/core/output/popover"][data-enhanced="false"]').each(function(){var b=this,c=a(this),d=c.parent(),e=this.getAttribute("data-arrow_placement")?this.getAttribute("data-arrow_placement"):"bottom",f=this.getAttribute("data-trigger")?this.getAttribute("data-trigger"):"focus";if("smartPosition"===e){var g=!1;e=function(a,c){var d=c.getBoundingClientRect(),e=b.getAttribute("data-placement_max_height")?b.getAttribute("data-placement_max_height"):300,f=b.getAttribute("data-placement_max_width")?b.getAttribute("data-placement_max_width"):300;return e+=10,f+=10,window.innerHeight-d.bottom>e?(g=!0,"bottom"):d.top>e?(g=!1,"top"):d.left>f?"left":window.innerWidth-d.right>f?"right":(g=!1,"top")},window.innerWidth<992&&d.on("shown.bs.popover",function(){b.parentNode.scrollIntoView(g)})}d.popover({title:c.data("title")?c.data("title"):"",content:a(".popover__content",this).html(),placement:e,trigger:f,html:!0}),"manual"===f?(b.parentNode.addEventListener("core/popover:show",function(){d.popover("show")}),b.parentNode.addEventListener("core/popover:hide",function(){d.popover("hide")})):d.attr("tabindex",0).css("cursor","pointer"),c.attr("data-enhanced","true")});var c=document.querySelectorAll('[data-component="/core/output/popover"][data-close_on_focus_out]');c&&(document.removeEventListener("click",b,!1),document.removeEventListener("touchstart",b,!1),document.addEventListener("click",b,!1),document.addEventListener("touchstart",b,!1))}return{scan:b}});
define('core/user_date', ["jquery","core/ajax","core/sessionstorage","core/config"],function(a,b,c,d){var e={},f=function(b){var c=a("html").attr("lang").replace("-","_");return"core_user_date/"+c+"/"+d.usertimezone+"/"+b.timestamp+"/"+b.format},g=function(a){return c.get(a)},h=function(a,b){c.set(a,b)},i=function(a){return"undefined"!=typeof e[a]},j=function(a){return e[a]},k=function(a,b){e[a]=b},l=function(a){var c=a.map(function(a){return{timestamp:a.timestamp,format:a.format}}),e={methodname:"core_get_user_dates",args:{contextid:d.contextid,timestamps:c}};return b.call([e],!0,!0)[0].then(function(b){b.dates.forEach(function(b,c){var d=a[c],e=f(d);h(e,b),d.deferred.resolve(b)})}).fail(function(b){a.forEach(function(a){a.deferred.reject(b)})})},m=function(b){var c=[],d=[];return b.forEach(function(b){var e=f(b);if(i(e))d.push(j(e));else{var h=a.Deferred(),l=g(e);l?h.resolve(l):(b.deferred=h,c.push(b)),k(e,h.promise()),d.push(h.promise())}}),c.length&&l(c),a.when.apply(a,d).then(function(){return 1===arguments.length?[arguments[0]]:Array.apply(null,arguments)})};return{get:m}});
define('core/truncate', ["jquery"],function(a){var b=/(\s*\S+|\s)$/,c=/^(\S*)/,d=/\s/,e=function(a,b){if(null==this)throw TypeError();var c=String(a),d=c.length,e=b?Number(b):0;if(e!=e&&(e=0),e<=-1||e>=d)return"";e=0|e;var f,g=c.charCodeAt(e),h=e+1,i=1;return g>=55296&&g<=56319&&d>h&&(f=c.charCodeAt(h),f>=56320&&f<=57343&&(i=2)),i},f=function(a){for(var b=0,c=0;c<a.length;c+=e(a,c))b++;return b},g=function(a,b){if(!a.length)return 0;var c=0,d=0;do c+=e(a,c),d++;while(c<a.length&&d<b);return c};return a.truncate=function(b,c){return a("<div></div>").append(b).truncate(c).html()},a.fn.truncate=function(e){a.isNumeric(e)&&(e={length:e});var h=a.extend({},a.truncate.defaults,e);return this.each(function(){var e=a(this);h.noBreaks&&e.find("br").replaceWith(" ");var i=h.ellipsis.length,j=e.text(),k=f(j),l=k-h.length+i;if(!(k<h.length)){if(h.stripTags&&e.text(j),h.words&&l>0){var m=j.slice(0,g(j,h.length-i)+1),n=m.replace(b,""),o=f(n),p=!m.match(d);l=h.keepFirstWord&&0===o?k-f(c.exec(j)[0])-i:p&&0===o?k-h.length+i:k-o-1}l>k&&(l=k-h.length),l<0||!l&&!h.truncated||a.each(e.contents().get().reverse(),function(b,c){var d=a(c),e=d.text(),j=f(e);if(j<=l)return h.truncated=!0,l-=j,void d.remove();if(3===c.nodeType){var k=j-l;return k=k>=0?g(e,k):0,a(c.splitText(k)).replaceWith(h.ellipsis),!1}return d.truncate(a.extend(h,{length:j-l+i})),!1})}})},a.truncate.defaults={stripTags:!1,words:!1,keepFirstWord:!1,noBreaks:!1,length:1/0,ellipsis:"…"},{truncate:a.truncate}});
define('core/maintenance', ["jquery","core/str","core/templates"],function(a,b,c){var d=0,e=a(".maintenancewarning"),f=function(){d-=1;var f="",g={};d<=0?f="sitemaintenance":(g.sec=d%60,g.min=Math.floor(d/60)%60,g.hour=Math.floor(d/3600),f=g.hour>0?"maintenancemodeisscheduledlong":"maintenancemodeisscheduled"),b.get_string(f,"admin",g).then(function(a){var b="notification_warning";return d<30&&(b="notification_error"),c.render("core/"+b,{message:a,extraclasses:"maintenancewarning"})}).then(function(b){e=a(".maintenancewarning"),e.length>0&&(e.replaceWith(b),a(".maintenancewarning").attr("aria-live","polite"))})};return{init:function(a){e&&(d=a,e.attr("aria-live","polite"),setInterval(f,1e3))}}});
define('core/chartjs', ["core/chartjs-lazy"],function(a){return a});
define('core/chart_output_htmltable', ["jquery","core/chart_output_base"],function(a,b){function c(){b.prototype.constructor.apply(this,arguments),this._build()}return c.prototype=Object.create(b.prototype),c.prototype._build=function(){this._node.empty(),this._node.append(this._makeTable())},c.prototype._makeTable=function(){var b,c,d,e=a("<table>"),f=this._chart,g=f.getLabels(),h=g.length>0,i=f.getSeries(),j=i[0].getCount();e.addClass("chart-output-htmltable generaltable"),null!==f.getTitle()&&e.append(a("<caption>").text(f.getTitle())),b=a("<tr>"),h&&b.append(a("<td>")),i.forEach(function(c){b.append(a("<th>").text(c.getLabel()).attr("scope","col"))}),e.append(b);for(var k=0;k<j;k++){b=a("<tr>"),g.length>0&&b.append(a("<th>").text(g[k]).attr("scope","row"));for(var l=0;l<i.length;l++)c=i[l].getValues()[k],d=i[l].getLabels(),null!==d&&(c=i[l].getLabels()[k]),b.append(a("<td>").text(c));e.append(b)}return e},c.prototype.update=function(){this._build()},c});
define('core/modal_save_cancel', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_events"],function(a,b,c,d,e){var f={SAVE_BUTTON:'[data-action="save"]',CANCEL_BUTTON:'[data-action="cancel"]'},g=function(a){d.call(this,a),this.getFooter().find(f.SAVE_BUTTON).length||b.exception({message:"No save button found"}),this.getFooter().find(f.CANCEL_BUTTON).length||b.exception({message:"No cancel button found"})};return g.prototype=Object.create(d.prototype),g.prototype.constructor=g,g.prototype.setFooter=function(){b.exception({message:"Can not change the footer of a save cancel modal"})},g.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,f.SAVE_BUTTON,function(b,c){var d=a.Event(e.save);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this)),this.getModal().on(c.events.activate,f.CANCEL_BUTTON,function(b,c){var d=a.Event(e.cancel);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this))},g});
define('core/chart_output_chartjs', ["jquery","core/chartjs","core/chart_axis","core/chart_bar","core/chart_output_base","core/chart_line","core/chart_pie","core/chart_series"],function(a,b,c,d,e,f,g,h){function i(){e.prototype.constructor.apply(this,arguments),this._canvas=this._node,"CANVAS"!=this._canvas.prop("tagName")&&(this._canvas=a("<canvas>"),this._node.append(this._canvas)),this._build()}var j=function(a,b){return"axis-"+a+"-"+b};return i.prototype=Object.create(e.prototype),i.prototype._config=null,i.prototype._chartjs=null,i.prototype._canvas=null,i.prototype._build=function(){this._config=this._makeConfig(),this._chartjs=new b(this._canvas[0],this._config)},i.prototype._cleanData=function(b){return b instanceof Array?b.map(function(b){return a("<span>").html(b).text()}):a("<span>").html(b).text()},i.prototype._getChartType=function(){var a=this._chart.getType();return this._chart.getType()===d.prototype.TYPE&&this._chart.getHorizontal()===!0?a="horizontalBar":this._chart.getType()===g.prototype.TYPE&&this._chart.getDoughnut()===!0&&(a="doughnut"),a},i.prototype._makeAxisConfig=function(a,b,d){var e={id:j(b,d)};return a.getPosition()!==c.prototype.POS_DEFAULT&&(e.position=a.getPosition()),null!==a.getLabel()&&(e.scaleLabel={display:!0,labelString:this._cleanData(a.getLabel())}),null!==a.getStepSize()&&(e.ticks=e.ticks||{},e.ticks.stepSize=a.getStepSize()),null!==a.getMax()&&(e.ticks=e.ticks||{},e.ticks.max=a.getMax()),null!==a.getMin()&&(e.ticks=e.ticks||{},e.ticks.min=a.getMin()),e},i.prototype._makeConfig=function(){var a={type:this._getChartType(),data:{labels:this._cleanData(this._chart.getLabels()),datasets:this._makeDatasetsConfig()},options:{title:{display:null!==this._chart.getTitle(),text:this._cleanData(this._chart.getTitle())}}};return this._chart.getXAxes().forEach(function(b,c){var d=b.getLabels();a.options.scales=a.options.scales||{},a.options.scales.xAxes=a.options.scales.xAxes||[],a.options.scales.xAxes[c]=this._makeAxisConfig(b,"x",c),null!==d&&(a.options.scales.xAxes[c].ticks.callback=function(a,b){return d[b]||""}),a.options.scales.xAxes[c].stacked=this._isStacked()}.bind(this)),this._chart.getYAxes().forEach(function(b,c){var d=b.getLabels();a.options.scales=a.options.scales||{},a.options.scales.yAxes=a.options.scales.yAxes||[],a.options.scales.yAxes[c]=this._makeAxisConfig(b,"y",c),null!==d&&(a.options.scales.yAxes[c].ticks.callback=function(a){return d[parseInt(a,10)]||""}),a.options.scales.yAxes[c].stacked=this._isStacked()}.bind(this)),a.options.tooltips={callbacks:{label:this._makeTooltip.bind(this)}},a},i.prototype._makeDatasetsConfig=function(){var a=this._chart.getSeries().map(function(a){var b=a.hasColoredValues()?a.getColors():a.getColor(),c={label:this._cleanData(a.getLabel()),data:a.getValues(),type:a.getType(),fill:!1,backgroundColor:b,borderColor:this._chart.getType()==g.prototype.TYPE?null:b,lineTension:this._isSmooth(a)?.3:0};return null!==a.getXAxis()&&(c.xAxisID=j("x",a.getXAxis())),null!==a.getYAxis()&&(c.yAxisID=j("y",a.getYAxis())),c}.bind(this));return a},i.prototype._makeTooltip=function(a,b){var c=this._chart.getSeries()[a.datasetIndex],d=c.getLabel(),e=c.getLabels(),f=b.datasets[a.datasetIndex].data,g=f[a.index],h=[];if(""==a.xLabel&&""==a.yLabel){var i=this._cleanData(this._chart.getLabels());h.push(i[a.index])}return null!==e?h.push(this._cleanData(e[a.index])):h.push(this._cleanData(d)+": "+g),h},i.prototype._isSmooth=function(a){var b=!1;return this._chart.getType()===f.prototype.TYPE?(b=a.getSmooth(),null===b&&(b=this._chart.getSmooth())):a.getType()===h.prototype.TYPE_LINE&&(b=a.getSmooth()),b},i.prototype._isStacked=function(){var a=!1;return this._chart.getType()===d.prototype.TYPE&&(a=this._chart.getStacked()),a},i.prototype.update=function(){a.extend(!0,this._config,this._makeConfig()),this._chartjs.update()},i});
define('core/addblockmodal', ["jquery","core/modal_factory","core/templates","core/str","core/notification"],function(a,b,c,d,e){return{init:function(f){var g=a("[data-key=addblock]"),h=[];a.each(f.blocks,function(a,b){h[h.length]={key:"pluginname",component:"block_"+b}});var i=d.get_strings(h).then(function(a){return a.map(function(a,b){return{name:f.blocks[b],title:a}})}).then(function(a){return f.blocks=a,c.render("core/add_block_body",f)}).fail(e.exception),j=d.get_string("addblock").fail(e.exception);b.create({title:j,body:i,type:"CANCEL"},g)}}});
define('core/str', ["jquery","core/ajax","core/localstorage"],function(a,b,c){var d=[];return{get_string:function(a,b,c,d){var e=this.get_strings([{key:a,component:b,param:c,lang:d}]);return e.then(function(a){return a[0]})},get_strings:function(e){var f,g=a.Deferred(),h=[],i=0,j=!1;for(i=0;i<e.length;i++)if(f=e[i],"undefined"==typeof f.lang&&(f.lang=a("html").prop("lang").replace(/-/g,"_")),f.cacheKey="core_str/"+f.key+"/"+f.component+"/"+f.lang,"undefined"==typeof M.str[f.component]||"undefined"==typeof M.str[f.component][f.key]){var k=c.get(f.cacheKey);k?("undefined"==typeof M.str[f.component]&&(M.str[f.component]=[]),M.str[f.component][f.key]=k):j=!0}if(j){var l=[],m=[],n=function(a){this.resolve(a)},o=function(a){this.reject(a)};for(i=0;i<e.length;i++)if(f=e[i],"undefined"!=typeof d[f.cacheKey])m.push(d[f.cacheKey]);else{var p=a.Deferred();l.push({methodname:"core_get_string",args:{stringid:f.key,component:f.component,lang:f.lang,stringparams:[]},done:n.bind(p),fail:o.bind(p)}),d[f.cacheKey]=p.promise(),m.push(d[f.cacheKey])}l.length>0&&b.call(l,!0,!1),a.when.apply(null,m).done(function(){var a=0;for(a=0;a<arguments.length;a++)f=e[a],"undefined"==typeof M.str[f.component]&&(M.str[f.component]=[]),M.str[f.component][f.key]=arguments[a],c.set("core_str/"+f.key+"/"+f.component+"/"+f.lang,arguments[a]),h[a]=M.util.get_string(f.key,f.component,f.param).trim();g.resolve(h)}).fail(function(a){g.reject(a)})}else{for(i=0;i<e.length;i++)f=e[i],h[i]=M.util.get_string(f.key,f.component,f.param);g.resolve(h)}return g.promise()}}});
define('core/storagewrapper', ["core/config"],function(a){var b=function(b){this.storage=b,this.supported=this.detectSupport(),this.hashSource=a.wwwroot+"/"+a.jsrev,this.hash=this.hashString(this.hashSource),this.prefix=this.hash+"/",this.jsrevPrefix=this.hashString(a.wwwroot)+"/jsrev",this.validateCache()};return b.prototype.detectSupport=function(){if(a.jsrev==-1)return!1;if("undefined"==typeof this.storage)return!1;var b="test";try{return null!==this.storage&&(this.storage.setItem(b,"1"),this.storage.removeItem(b),!0)}catch(c){return!1}},b.prototype.prefixKey=function(a){return this.prefix+a},b.prototype.validateCache=function(){var b=this.storage.getItem(this.jsrevPrefix);if(null===b)return void this.storage.setItem(this.jsrevPrefix,a.jsrev);var c=a.jsrev;c!=b&&(this.storage.clear(),this.storage.setItem(this.jsrevPrefix,a.jsrev))},b.prototype.hashString=function(a){var b,c,d,e=0;if(0===a.length)return e;for(b=0,d=a.length;b<d;b++)c=a.charCodeAt(b),e=(e<<5)-e+c,e|=0;return e},b.prototype.get=function(a){return!!this.supported&&(a=this.prefixKey(a),this.storage.getItem(a))},b.prototype.set=function(a,b){if(!this.supported)return!1;a=this.prefixKey(a);try{this.storage.setItem(a,b)}catch(c){return!1}return!0},b});
define('core/tooltip', ["jquery"],function(a){var b=function(b){this._regionSelector=b,a(this._regionSelector).each(function(b,c){var d=a(c).attr("aria-describedby");if(d){var e=document.getElementById(d);if(e){var f="tooltip"==a(e).attr("role");f&&(a(e).hide(),a(c).attr("tabindex","0")),a(c).on("focus",this._handleFocus.bind(this)),a(c).on("mouseover",this._handleMouseOver.bind(this)),a(c).on("mouseout",this._handleMouseOut.bind(this)),a(c).on("blur",this._handleBlur.bind(this)),a(c).on("keydown",this._handleKeyDown.bind(this))}}}.bind(this))};return b.prototype._regionSelector=null,b.prototype._showTooltip=function(b){var c=a(b.target),d=c.attr("aria-describedby");if(d){var e=a(document.getElementById(d));if(e.show(),e.attr("aria-hidden","false"),!e.is(".tooltip")){var f=a('<div class="tooltip-inner"></div>');f.append(e.contents()),e.append(f),e.addClass("tooltip"),e.addClass("bottom"),e.append('<div class="tooltip-arrow"></div>')}var g=c.offset();g.top+=c.height()+10,a(e).offset(g)}},b.prototype._hideTooltip=function(b){var c=a(b.target),d=c.attr("aria-describedby");if(d){var e=document.getElementById(d);a(e).hide(),a(e).attr("aria-hidden","true")}},b.prototype._handleFocus=function(a){this._showTooltip(a)},b.prototype._handleKeyDown=function(a){27==a.which&&this._hideTooltip(a)},b.prototype._handleMouseOver=function(a){this._showTooltip(a)},b.prototype._handleMouseOut=function(b){var c=a(b.target);c.is(":focus")||this._hideTooltip(b)},b.prototype._handleBlur=function(a){this._hideTooltip(a)},b});
define('core/tag', ["jquery","core/ajax","core/templates","core/notification","core/str","core/yui"],function(a,b,c,d,e,f){return{initTagindexPage:function(){a("body").delegate(".tagarea[data-ta] a[data-quickload=1]","click",function(d){d.preventDefault();var e=a(this),f=e[0].search.replace(/^\?/,""),g=e.closest(".tagarea[data-ta]"),h=f.split("&").reduce(function(a,b){var c=b.split("=");return a[c[0]]=decodeURIComponent(c[1]),a},{}),i=b.call([{methodname:"core_tag_get_tagindex",args:{tagindex:h}}],!0);a.when.apply(a,i).done(function(a){c.render("core_tag/index",a).done(function(a){g.replaceWith(a)})})})},initManagePage:function(){a("body").on("updated","[data-inplaceeditable]",function(b){if(e.get_strings([{key:"now"},{key:"selecttag",component:"tag"}]).then(function(c){a(b.target).closest("tr").find("td.col-timemodified").html(c[0]),a('label[for="tagselect'+b.ajaxreturn.itemid+'"]').html(c[1])}).fail(d.exception),"tagflag"===b.ajaxreturn.itemtype){var c=a(b.target).closest("tr");"0"===b.ajaxreturn.value?c.removeClass("flagged-tag"):c.addClass("flagged-tag")}}),a(".tag-management-table").delegate("a.tagdelete","click",function(b){b.preventDefault();var c=a(this).attr("href");e.get_strings([{key:"delete"},{key:"confirmdeletetag",component:"tag"},{key:"yes"},{key:"no"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=c})})}),a("#tag-management-delete").click(function(b){var c=a(this).closest("form").get(0),f=a(c).find("input[type=checkbox]:checked").length;if(f){var g=a("<input type='hidden'/>").attr("name",this.name);b.preventDefault(),e.get_strings([{key:"delete"},{key:"confirmdeletetags",component:"tag"},{key:"yes"},{key:"no"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){g.appendTo(c),c.submit()})})}}),a("#tag-management-combine").click(function(b){b.preventDefault();var c=a(this).closest("form").get(0),g=a(c).find("input[type=checkbox]:checked");if(g.length<=1)return void e.get_strings([{key:"combineselected",component:"tag"},{key:"selectmultipletags",component:"tag"},{key:"ok"}]).done(function(a){d.alert(a[0],a[1],a[2])});var h=a("<input type='hidden'/>").attr("name",this.name);e.get_strings([{key:"combineselected",component:"tag"},{key:"selectmaintag",component:"tag"},{key:"continue"},{key:"cancel"}]).done(function(b){var d=a('<div><form id="combinetags_form" class="form-inline"><p class="description"></p><p class="options"></p><p class="mdl-align"><input type="submit" id="combinetags_submit"/><input type="button" id="combinetags_cancel"/></p></form></div>');d.find(".description").html(b[1]),d.find("#combinetags_submit").attr("value",b[2]),d.find("#combinetags_cancel").attr("value",b[3]);var e=d.find(".options");g.each(function(){var b=a(this).val(),c=a(".inplaceeditable[data-itemtype=tagname][data-itemid="+b+"]").attr("data-value");e.append(a('<input type="radio" name="maintag" id="combinetags_maintag_'+b+'" value="'+b+'"/><label for="combinetags_maintag_'+b+'">'+c+"</label><br>"))}),f.use("moodle-core-notification-dialogue",function(){var e=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,headerContent:b[0],bodyContent:d.html()});e.show(),a("#combinetags_form input[type=radio]").first().focus().prop("checked",!0),a("#combinetags_form #combinetags_cancel").on("click",function(){e.destroy()}),a("#combinetags_form").on("submit",function(){h.appendTo(c);var b=a("input[name=maintag]:checked","#combinetags_form").val();return a("<input type='hidden'/>").attr("name","maintag").attr("value",b).appendTo(c),c.submit(),!1})})})}),a("body").on("updatefailed","[data-inplaceeditable][data-itemtype=tagname]",function(b){var c=b.exception,f=b.newvalue,g=a(b.target).attr("data-itemid");"namesalreadybeeingused"===c.errorcode&&(b.preventDefault(),e.get_strings([{key:"nameuseddocombine",component:"tag"},{key:"yes"},{key:"cancel"}]).done(function(a){d.confirm(b.message,a[0],a[1],a[2],function(){window.location.href=window.location.href+"&newname="+encodeURIComponent(f)+"&tagid="+encodeURIComponent(g)+"&action=renamecombine&sesskey="+M.cfg.sesskey})}))}),a("body").on("click","a[data-action=addstandardtag]",function(b){b.preventDefault(),e.get_strings([{key:"addotags",component:"tag"},{key:"inputstandardtags",component:"tag"},{key:"continue"},{key:"cancel"}]).done(function(b){var c=a('<div><form id="addtags_form" class="form-inline" method="POST"><input type="hidden" name="action" value="addstandardtag"/><input type="hidden" name="sesskey" value="'+M.cfg.sesskey+'"/><p><label for="id_tagslist">'+b[1]+'</label><input type="text" id="id_tagslist" name="tagslist"/></p><p class="mdl-align"><input type="submit" id="addtags_submit"/><input type="button" id="addtags_cancel"/></p></form></div>');c.find("#addtags_form").attr("action",window.location.href),c.find("#addtags_submit").attr("value",b[2]),c.find("#addtags_cancel").attr("value",b[3]),f.use("moodle-core-notification-dialogue",function(){var d=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,headerContent:b[0],bodyContent:c.html()});d.show(),a("#addtags_form input[type=text]").focus(),a("#addtags_form #addtags_cancel").on("click",function(){d.destroy()})})})})},initManageCollectionsPage:function(){a("body").on("updated","[data-inplaceeditable]",function(b){var c,d,e,f=b.ajaxreturn;"core_tag"===f.component&&"tagareaenable"===f.itemtype&&(c=a(this).attr("data-itemid"),a(".tag-collections-table ul[data-collectionid] li[data-areaid="+c+"]").hide(),e=f.value,"1"===e?(a(this).closest("tr").removeClass("dimmed_text"),d=a(this).closest("tr").find('[data-itemtype="tagareacollection"]').attr("data-value"),a(".tag-collections-table ul[data-collectionid="+d+"] li[data-areaid="+c+"]").show()):a(this).closest("tr").addClass("dimmed_text")),"core_tag"===f.component&&"tagareacollection"===f.itemtype&&(c=a(this).attr("data-itemid"),a(".tag-collections-table ul[data-collectionid] li[data-areaid="+c+"]").hide(),d=a(this).attr("data-value"),e=a(this).closest("tr").find('[data-itemtype="tagareaenable"]').attr("data-value"),"1"===e&&a(".tag-collections-table ul[data-collectionid="+d+"] li[data-areaid="+c+"]").show())}),a("body").on("click",".addtagcoll > a",function(b){b.preventDefault();var c=a(this).attr("data-url")+"&sesskey="+M.cfg.sesskey;e.get_strings([{key:"addtagcoll",component:"tag"},{key:"name"},{key:"searchable",component:"tag"},{key:"create"},{key:"cancel"}]).done(function(b){var d=a('<div><form id="addtagcoll_form" class="form-inline"><p><label for="addtagcoll_name"></label>: <input id="addtagcoll_name" type="text"/></p><p><label for="addtagcoll_searchable"></label>: <input id="addtagcoll_searchable" type="checkbox" value="1" checked/></p><p class="mdl-align"><input type="submit" id="addtagcoll_submit"/><input type="button" id="addtagcoll_cancel"/></p></form></div>');d.find('label[for="addtagcoll_name"]').html(b[1]),d.find('label[for="addtagcoll_searchable"]').html(b[2]),d.find("#addtagcoll_submit").attr("value",b[3]),d.find("#addtagcoll_cancel").attr("value",b[4]),f.use("moodle-core-notification-dialogue",function(){var e=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,headerContent:b[0],bodyContent:d.html()});e.show(),a("#addtagcoll_form #addtagcoll_name").focus(),a("#addtagcoll_form #addtagcoll_cancel").on("click",function(){e.destroy()}),a("#addtagcoll_form").on("submit",function(){var b=a("#addtagcoll_form #addtagcoll_name").val(),d=a("#addtagcoll_form #addtagcoll_searchable").prop("checked")?1:0;return String(b).length>0&&(window.location.href=c+"&name="+encodeURIComponent(b)+"&searchable="+d),!1})})})}),a("body").on("click",".tag-collections-table .action_delete",function(b){b.preventDefault();var c=a(this).attr("data-url")+"&sesskey="+M.cfg.sesskey;e.get_strings([{key:"delete"},{key:"suredeletecoll",component:"tag",param:a(this).attr("data-collname")},{key:"yes"},{key:"no"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=c})})})}}});
define('core/chart_series', [],function(){function a(a,b){if("string"!=typeof a)throw new Error("Invalid label for series.");if("object"!=typeof b)throw new Error("Values for a series must be an array.");if(b.length<1)throw new Error("Invalid values received for series.");this._colors=[],this._label=a,this._values=b}return a.prototype.TYPE_DEFAULT=null,a.prototype.TYPE_LINE="line",a.prototype._colors=null,a.prototype._label=null,a.prototype._labels=null,a.prototype._smooth=!1,a.prototype._type=a.prototype.TYPE_DEFAULT,a.prototype._values=null,a.prototype._xaxis=null,a.prototype._yaxis=null,a.prototype.create=function(b){var c=new a(b.label,b.values);return c.setType(b.type),c.setXAxis(b.axes.x),c.setYAxis(b.axes.y),c.setLabels(b.labels),b.colors&&b.colors.length>1?c.setColors(b.colors):c.setColor(b.colors[0]),c.setSmooth(b.smooth),c},a.prototype.getColor=function(){return this._colors[0]||null},a.prototype.getColors=function(){return this._colors},a.prototype.getCount=function(){return this._values.length},a.prototype.getLabel=function(){return this._label},a.prototype.getLabels=function(){return this._labels},a.prototype.getSmooth=function(){return this._smooth},a.prototype.getType=function(){return this._type},a.prototype.getValues=function(){return this._values},a.prototype.getXAxis=function(){return this._xaxis},a.prototype.getYAxis=function(){return this._yaxis},a.prototype.hasColoredValues=function(){return this._colors.length==this.getCount()},a.prototype.setColor=function(a){this._colors=[a]},a.prototype.setColors=function(a){if(a&&a.length!=this.getCount())throw new Error("When setting multiple colors there must be one per value.");this._colors=a||[]},a.prototype.setLabels=function(a){this._validateLabels(a),a="undefined"==typeof a?null:a,this._labels=a},a.prototype.setSmooth=function(a){a="undefined"==typeof a?null:a,this._smooth=a},a.prototype.setType=function(a){if(a!=this.TYPE_DEFAULT&&a!=this.TYPE_LINE)throw new Error("Invalid serie type.");this._type=a||null},a.prototype.setXAxis=function(a){this._xaxis=a||null},a.prototype.setYAxis=function(a){this._yaxis=a||null},a.prototype._validateLabels=function(a){if(a&&a.length>0&&a.length!=this.getCount())throw new Error("Series labels must match series values.")},a});
define('core/chart_builder', ["jquery"],function(a){var b={make:function(b){var c=a.Deferred();return require(["core/chart_"+b.type],function(a){var d=a.prototype.create(a,b);c.resolve(d)}),c.promise()}};return b});
define('core/modal_registry', ["core/notification"],function(a){var b={},c=function(a){return b[a]},d=function(d,e,f){c(d)&&a.exception({message:"Modal of  type '"+d+"' is already registered"}),e&&"function"==typeof e||a.exception({message:"You must provide a modal module"}),f||a.exception({message:"You must provide a modal template"}),b[d]={module:e,template:f}};return{register:d,get:c}});
define('core/jqueryajaxhandler', ["core/str"],function(a){var b={success:function(a){a.responseJSON&&a.responseJSON.error&&YUI().use("moodle-core-notification-ajaxexception",function(){return new M.core.ajaxException(a.responseJSON).show()})},error:function(b,c){if("abort"!==b.statusText&&(0!==b.status||0!==b.readyState||"error"!==b.statusText)){var d=[];d.push({key:"accessdenied",component:"admin"}),d.push({key:"resourcenotfound",component:"admin"}),d.push({key:"unknownerror",component:"core"}),a.get_strings(d).done(function(a){for(var e=[],f=0;f<d.length;f++)e[d[f].key]=a[f];var g={debugginginfo:"",error:"",reproductionlink:"",stacktrace:""};b.hasOwnProperty("status")&&403===b.status?g.error=e.accessdenied:b.hasOwnProperty("status")&&404===b.status?g.error=e.resourcenotfound:g.error=e.unknownerror,c.hasOwnProperty("url")&&"string"==typeof c.url&&(g.reproductionlink=c.url),b.hasOwnProperty("stacktrace")&&"string"==typeof b.stacktrace&&(g.stacktrace=c.stacktrace),YUI().use("moodle-core-notification-ajaxexception",function(){return new M.core.ajaxException(g).show()})})}}};return b});
define('core/modal_confirm', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_events"],function(a,b,c,d,e){var f={YES_BUTTON:'[data-action="yes"]',NO_BUTTON:'[data-action="no"]'},g=function(a){d.call(this,a),this.getFooter().find(f.YES_BUTTON).length||b.exception({message:'No "yes" button found'}),this.getFooter().find(f.NO_BUTTON).length||b.exception({message:'No "no" button found'})};return g.prototype=Object.create(d.prototype),g.prototype.constructor=g,g.prototype.setFooter=function(){b.exception({message:"Can not change the footer of a confirm modal"})},g.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,f.YES_BUTTON,function(b,c){var d=a.Event(e.yes);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this)),this.getModal().on(c.events.activate,f.NO_BUTTON,function(b,c){var d=a.Event(e.no);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this))},g});
define('core/modal_cancel', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_events"],function(a,b,c,d,e){var f={CANCEL_BUTTON:'[data-action="cancel"]'},g=function(a){d.call(this,a),this.getFooter().find(f.CANCEL_BUTTON).length||b.exception({message:"No cancel button found"})};return g.prototype=Object.create(d.prototype),g.prototype.constructor=g,g.prototype.setFooter=function(){b.exception({message:"Can not change the footer of a cancel modal"})},g.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,f.CANCEL_BUTTON,function(b,c){var d=a.Event(e.cancel);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this))},g});
define('core/tree', ["jquery"],function(a){var b={ITEM:"[role=treeitem]",GROUP:"[role=treeitem]:has([role=group]), [role=treeitem][aria-owns], [role=treeitem][data-requires-ajax=true]",CLOSED_GROUP:"[role=treeitem]:has([role=group])[aria-expanded=false], [role=treeitem][aria-owns][aria-expanded=false], [role=treeitem][data-requires-ajax=true][aria-expanded=false]",FIRST_ITEM:"[role=treeitem]:first",VISIBLE_ITEM:"[role=treeitem]:visible",UNLOADED_AJAX_ITEM:"[role=treeitem][data-requires-ajax=true][data-loaded=false][aria-expanded=true]"},c=function(c,d){this.treeRoot=a(c),this.treeRoot.data("activeItem",null),this.selectCallback=d,this.keys={tab:9,enter:13,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,asterisk:106},this.initialiseNodes(this.treeRoot),this.setActiveItem(this.treeRoot.find(b.FIRST_ITEM)),this.refreshVisibleItemsCache(),this.bindEventHandlers()};return c.prototype.refreshVisibleItemsCache=function(){this.treeRoot.data("visibleItems",this.treeRoot.find(b.VISIBLE_ITEM))},c.prototype.getVisibleItems=function(){return this.treeRoot.data("visibleItems")},c.prototype.setActiveItem=function(a){var b=this.treeRoot.data("activeItem");a!==b&&(b&&(b.attr("tabindex","-1"),b.attr("aria-selected","false")),a.attr("tabindex","0"),a.attr("aria-selected","true"),this.treeRoot.data("activeItem",a),"function"==typeof this.selectCallback&&this.selectCallback(a))},c.prototype.isGroupItem=function(a){return a.is(b.GROUP)},c.prototype.getGroupFromItem=function(a){return this.treeRoot.find("#"+a.attr("aria-owns"))||a.children("[role=group]")},c.prototype.isGroupCollapsed=function(a){return"false"===a.attr("aria-expanded")},c.prototype.isGroupCollapsible=function(a){return"false"!==a.attr("data-collapsible")},c.prototype.initialiseNodes=function(c){this.removeAllFromTabOrder(c),this.setAriaSelectedFalseOnItems(c);var d=this;c.find(b.UNLOADED_AJAX_ITEM).each(function(){var b=a(this);d.collapseGroup(b),d.expandGroup(b)})},c.prototype.removeAllFromTabOrder=function(b){b.find("*").attr("tabindex","-1"),this.getGroupFromItem(a(b)).find("*").attr("tabindex","-1")},c.prototype.setAriaSelectedFalseOnItems=function(a){a.find(b.ITEM).attr("aria-selected","false")},c.prototype.expandAllGroups=function(){var c=this;this.treeRoot.find(b.CLOSED_GROUP).each(function(){var b=a(this);c.expandGroup(a(this)).done(function(){c.expandAllChildGroups(b)})})},c.prototype.expandAllChildGroups=function(c){var d=this;this.getGroupFromItem(c).find(b.CLOSED_GROUP).each(function(){var b=a(this);d.expandGroup(a(this)).done(function(){d.expandAllChildGroups(b)})})},c.prototype.expandGroup=function(b){var c=a.Deferred();if(require(["core/templates"],function(a){a.renderIcon("loading").done(function(a){"pending"===c.state()&&(b.find(".flex-icon").remove(),b.prepend(a))})}),"false"!==b.attr("data-expandable")&&this.isGroupCollapsed(b))if("true"===b.attr("data-requires-ajax")&&"true"!==b.attr("data-loaded")){b.attr("data-loaded",!1);var d=b.closest("[data-ajax-loader]").attr("data-ajax-loader"),e=this;require([d],function(a){a.load(b).done(function(){b.attr("data-loaded",!0),e.initialiseNodes(b),e.finishExpandingGroup(b),c.resolve()})})}else this.finishExpandingGroup(b),c.resolve();else c.resolve();return c},c.prototype.finishExpandingGroup=function(a){var b=this.getGroupFromItem(a);b.attr("aria-hidden","false"),a.parent("li").hasClass("collapsed")&&a.parent("li").removeClass("collapsed").addClass("branch_expanded"),a.attr("aria-expanded","true"),require(["core/templates"],function(b){b.renderIcon("expanded").done(function(b){"true"===a.attr("aria-expanded")&&(a.find(".flex-icon").remove(),a.prepend(b))})}),this.refreshVisibleItemsCache()},c.prototype.collapseGroup=function(a){if(this.isGroupCollapsible(a)&&!this.isGroupCollapsed(a)){var b=this.getGroupFromItem(a);b.attr("aria-hidden","true"),a.attr("aria-expanded","false"),a.parent("li").hasClass("branch_expanded")&&a.parent("li").removeClass("branch_expanded").addClass("collapsed"),require(["core/templates"],function(b){b.renderIcon("collapsed").done(function(b){"false"===a.attr("aria-expanded")&&(a.find(".flex-icon").remove(),a.prepend(b))})}),this.refreshVisibleItemsCache()}},c.prototype.toggleGroup=function(a){"true"===a.attr("aria-expanded")?this.collapseGroup(a):this.expandGroup(a)},c.prototype.handleKeyDown=function(c,d){var e=this.getVisibleItems().index(c);if(d.altKey||d.ctrlKey||d.metaKey||d.shiftKey&&d.keyCode!=this.keys.tab)return!0;switch(d.keyCode){case this.keys.home:return this.getVisibleItems().first().focus(),d.stopPropagation(),!1;case this.keys.end:return this.getVisibleItems().last().focus(),d.stopPropagation(),!1;case this.keys.enter:var f=c.children("a").length?c.children("a"):c.children().not(b.GROUP).find("a");return f.length?window.location.href=f.first().attr("href"):this.isGroupItem(c)&&this.toggleGroup(c,!0),d.stopPropagation(),!1;case this.keys.space:return this.isGroupItem(c)&&this.toggleGroup(c,!0),d.stopPropagation(),!1;case this.keys.left:var g=function(b){b.getVisibleItems().filter(function(){return b.getGroupFromItem(a(this)).has(c).length}).focus()};return this.isGroupItem(c)?this.isGroupCollapsed(c)?g(this):this.collapseGroup(c):g(this),d.stopPropagation(),!1;case this.keys.right:return this.isGroupItem(c)&&(this.isGroupCollapsed(c)?this.expandGroup(c):this.getGroupFromItem(c).find(b.ITEM).first().focus()),d.stopPropagation(),!1;case this.keys.up:if(e>0){var h=this.getVisibleItems().eq(e-1);h.focus()}return d.stopPropagation(),!1;case this.keys.down:if(e<this.getVisibleItems().length-1){var i=this.getVisibleItems().eq(e+1);i.focus()}return d.stopPropagation(),!1;case this.keys.asterisk:return this.expandAllGroups(),d.stopPropagation(),!1}return!0},c.prototype.handleClick=function(a,b){return!!(b.altKey||b.ctrlKey||b.shiftKey||b.metaKey)||(a.focus(),this.isGroupItem(a)&&this.toggleGroup(a),b.stopPropagation(),!0)},c.prototype.handleFocus=function(a,b){return this.setActiveItem(a),b.stopPropagation(),!0},c.prototype.bindEventHandlers=function(){var c=this;this.treeRoot.on({click:function(b){return c.handleClick(a(this),b)},keydown:function(b){return c.handleKeyDown(a(this),b)},focus:function(b){return c.handleFocus(a(this),b)}},b.ITEM)},c});
define('core/ajax', ["jquery","core/config","core/log"],function(a,b,c){var d=!1,e=function(a){var b,c,d=this,e=null,f=0;if(a.error)for(;f<d.length;f++)b=d[f],b.deferred.reject(a);else{for(f=0;f<d.length;f++){if(b=d[f],c=a[f],"undefined"==typeof c){e=new Error("missing response");break}if(c.error!==!1){e=c.exception;break}b.deferred.resolve(c.data)}if(null!==e)for(;f<d.length;f++)b=d[f],b.deferred.reject(e)}},f=function(a,b,e){var f=this,g=0;for(g=0;g<f.length;g++){var h=f[g];d?(c.error("Page unloaded."),c.error(e)):h.deferred.reject(e)}};return{call:function(c,g,h){a(window).bind("beforeunload",function(){d=!0});var i,j=[],k=[],l=[],m="";for("undefined"==typeof h&&(h=!0),"undefined"==typeof g&&(g=!0),i=0;i<c.length;i++){var n=c[i];j.push({index:i,methodname:n.methodname,args:n.args}),n.deferred=a.Deferred(),k.push(n.deferred.promise()),"undefined"!=typeof n.done&&n.deferred.done(n.done),"undefined"!=typeof n.fail&&n.deferred.fail(n.fail),n.index=i,l.push(n.methodname)}m=l.length<=5?l.sort().join():l.length+"-method-calls",j=JSON.stringify(j);var o={type:"POST",data:j,context:c,dataType:"json",processData:!1,async:g,contentType:"application/json"},p="service.php";h||(p="service-nologin.php");var q=b.wwwroot+"/lib/ajax/"+p+"?sesskey="+b.sesskey+"&info="+m;return g?a.ajax(q,o).done(e).fail(f):(o.success=e,o.error=f,a.ajax(q,o)),k}}});
define('core/yui', function(){return Y});
define('core/chart_pie', ["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}return b.prototype=Object.create(a.prototype),b.prototype.TYPE="pie",b.prototype._doughnut=null,b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);return d.setDoughnut(c.doughnut),d},b.prototype.addSeries=function(b){if(null===b.getColor()){for(var c=[],d=this.getConfigColorSet()||a.prototype.COLORSET,e=0;e<b.getCount();e++)c.push(d[e%d.length]);b.setColors(c)}return a.prototype.addSeries.apply(this,arguments)},b.prototype.getDoughnut=function(){return this._doughnut},b.prototype.setDoughnut=function(a){this._doughnut=Boolean(a)},b.prototype._validateSeries=function(){if(this._series.length>=1)throw new Error("Pie charts only support one serie.");return a.prototype._validateSeries.apply(this,arguments)},b});
define('core/auto_rows', ["jquery"],function(a){var b={ELEMENT:"[data-auto-rows]"},c={ROW_CHANGE:"autorows:rowchange"},d=function(a){var b=a.attr("rows"),c=a.attr("data-max-rows"),d=a.height(),e=a.innerHeight(),f=e-d;a.height("1px");var g=a[0].scrollHeight,h=Math.ceil((g-f)/(d/b));return a.css("height",""),c&&h>=c?c:h},e=function(e){a(e).on("input propertychange",b.ELEMENT,function(b){var f=a(b.target),g=f.attr("rows"),h=d(f);h!=g&&(f.attr("rows",h),a(e).trigger(c.ROW_CHANGE))})};return{init:e,events:c}});
define('core/custom_interaction_events', ["jquery","core/key_codes"],function(a,b){var c={activate:"cie:activate",keyboardActivate:"cie:keyboardactivate",escape:"cie:escape",down:"cie:down",up:"cie:up",home:"cie:home",end:"cie:end",next:"cie:next",previous:"cie:previous",asterix:"cie:asterix",scrollLock:"cie:scrollLock",scrollTop:"cie:scrollTop",scrollBottom:"cie:scrollBottom",ctrlPageUp:"cie:ctrlPageUp",ctrlPageDown:"cie:ctrlPageDown",enter:"cie:enter"},d=function(a,b){return b=b||[],!(!b.length||b.indexOf(a)===-1)},e=function(a){return a.shiftKey||a.metaKey||a.altKey||a.ctrlKey},f=function(b,c,d){b.off("keydown."+c).on("keydown."+c,function(b){e(b)||b.keyCode==d&&(a(b.target).trigger(c,[{originalEvent:b}]),"input"!=b.target.tagName.toLowerCase()&&"select"!=b.target.tagName.toLowerCase()&&"textarea"!=b.target.tagName.toLowerCase()&&b.preventDefault())})},g=function(d){d.off("click.cie.activate").on("click.cie.activate",function(b){a(b.target).trigger(c.activate,[{originalEvent:b}])}),d.off("keydown.cie.activate").on("keydown.cie.activate",function(d){e(d)||d.keyCode!=b.enter&&d.keyCode!=b.space||(a(d.target).trigger(c.activate,[{originalEvent:d}]),"input"!=d.target.tagName.toLowerCase()&&"select"!=d.target.tagName.toLowerCase()&&"textarea"!=d.target.tagName.toLowerCase()&&d.preventDefault())})},h=function(d){d.off("keydown.cie.keyboardactivate").on("keydown.cie.keyboardactivate",function(d){e(d)||d.keyCode!=b.enter&&d.keyCode!=b.space||(a(d.target).trigger(c.keyboardActivate,[{originalEvent:d}]),"input"!=d.target.tagName.toLowerCase()&&"select"!=d.target.tagName.toLowerCase()&&"textarea"!=d.target.tagName.toLowerCase()&&d.preventDefault())})},i=function(a){f(a,c.escape,b.escape)},j=function(a){f(a,c.down,b.arrowDown)},k=function(a){f(a,c.up,b.arrowUp)},l=function(a){f(a,c.home,b.home)},m=function(a){f(a,c.end,b.end)},n=function(d){var e="rtl"==a("html").attr("dir")?b.arrowLeft:b.arrowRight;f(d,c.next,e)},o=function(d){var e="rtl"==a("html").attr("dir")?b.arrowRight:b.arrowLeft;f(d,c.previous,e)},p=function(a){f(a,c.asterix,b.asterix)},q=function(a){a.off("scroll.cie.scrollTop").on("scroll.cie.scrollTop",function(b){var d=a.scrollTop();0===d&&a.trigger(c.scrollTop,[{originalEvent:b}])})},r=function(a){a.off("scroll.cie.scrollBottom").on("scroll.cie.scrollBottom",function(b){var d=a.scrollTop(),e=a.innerHeight(),f=a[0].scrollHeight;d+e>=f&&a.trigger(c.scrollBottom,[{originalEvent:b}])})},s=function(a){a.off("DOMMouseScroll.cie.DOMMouseScrollLock mousewheel.cie.mousewheelLock").on("DOMMouseScroll.cie.DOMMouseScrollLock mousewheel.cie.mousewheelLock",function(b){var d=a.scrollTop(),e=a[0].scrollHeight,f=a.height(),g="DOMMouseScroll"==b.type?b.originalEvent.detail*-40:b.originalEvent.wheelDelta,h=g>0;return!h&&-g>e-f-d?(a.scrollTop(e),b.stopPropagation(),b.preventDefault(),b.returnValue=!1,a.trigger(c.scrollLock,[{originalEvent:b}]),!1):!(h&&g>d)||(a.scrollTop(0),b.stopPropagation(),b.preventDefault(),b.returnValue=!1,a.trigger(c.scrollLock,[{originalEvent:b}]),!1)})},t=function(d){d.off("keydown.cie.ctrlpageup").on("keydown.cie.ctrlpageup",function(d){d.ctrlKey&&d.keyCode==b.pageUp&&a(d.target).trigger(c.ctrlPageUp,[{originalEvent:d}])})},u=function(d){d.off("keydown.cie.ctrlpagedown").on("keydown.cie.ctrlpagedown",function(d){d.ctrlKey&&d.keyCode==b.pageDown&&a(d.target).trigger(c.ctrlPageDown,[{originalEvent:d}])})},v=function(a){f(a,c.enter,b.enter)},w=function(){var a={};return a[c.activate]=g,a[c.keyboardActivate]=h,a[c.escape]=i,a[c.down]=j,a[c.up]=k,a[c.home]=l,a[c.end]=m,a[c.next]=n,a[c.previous]=o,a[c.asterix]=p,a[c.scrollLock]=s,a[c.scrollTop]=q,a[c.scrollBottom]=r,a[c.ctrlPageUp]=t,a[c.ctrlPageDown]=u,a[c.enter]=v,a},x=function(b,c){b=a(b),c=c||[],b.length&&c.length&&a.each(w(),function(a,e){d(a,c)&&e(b)})};return{define:x,events:c}});
define('core/inplace_editable', ["jquery","core/ajax","core/templates","core/notification","core/str","core/config","core/flex_icon"],function(a,b,c,d,e,f,g){return a("body").on("click keypress","[data-inplaceeditable] [data-inplaceeditablelink]",function(h){if("keypress"!==h.type||13===h.keyCode){h.stopImmediatePropagation(),h.preventDefault();var i=a(this),j=i.closest("[data-inplaceeditable]"),k=function(b){b.addClass("updating");var d=b.find(".icon-spinner");d.length?d.show():(d=a('<span class="icon-spinner"/>'),e.get_string("loading","admin").then(function(a){return c.renderIcon("loading",{alt:a})}).then(function(a){d&&d.prepend(a)}),b.append(d))},l=function(a){a.removeClass("updating"),a.find(".icon-spinner").hide()},m=function(e,f){var h=[e.attr("data-itemid"),e.attr("data-component"),e.attr("data-itemtype")].join("-");M.util.js_pending(h),k(e),b.call([{methodname:"core_update_inplace_editable",args:{itemid:e.attr("data-itemid"),component:e.attr("data-component"),itemtype:e.attr("data-itemtype"),value:f},done:function(b){var d=e.attr("data-value");g.getIconData("t/editstring","core",{alt:b.edithint}).then(function(a){return b.icon=a,c.render("core/inplace_editable",b)}).then(function(f,g){var i=a(f);c.replaceNode(e,i,g),i.find("[data-inplaceeditablelink]").focus(),i.trigger({type:"updated",ajaxreturn:b,oldvalue:d}),M.util.js_complete(h)})},fail:function(b){var c=a.Event("updatefailed",{exception:b,newvalue:f});l(e),M.util.js_complete(h),e.trigger(c),c.isDefaultPrevented()||d.exception(b)}}],!0)},n=function(a){a.find("input").off(),a.find("select").off(),a.html(a.attr("data-oldcontent")),a.removeAttr("data-oldcontent"),a.removeClass("inplaceeditingon"),a.find("[data-inplaceeditablelink]").focus()},o=function(){a("span.inplaceeditable.inplaceeditingon").each(function(){n(a(this))})},p=function(b,c){var d,e=b;for(d=0;d<c;d++)e+=String(Math.floor(10*Math.random()));return 0===a("#"+e).length?e:p(b,c)},q=function(b){e.get_string("edittitleinstructions").done(function(c){var d=a('<span class="editinstructions">'+c+"</span>").attr("id",p("id_editinstructions_",20)),e=a('<input type="text"/>').attr("id",p("id_inplacevalue_",20)).attr("value",b.attr("data-value")).attr("aria-describedby",d.attr("id")).addClass("ignoredirty").addClass("form-control"),g=a('<label class="accesshide">'+j.attr("data-editlabel")+"</label>").attr("for",e.attr("id"));b.html("").append(d).append(g).append(e),e.focus(),e.select(),e.on("keyup keypress focusout",function(a){if(!f.behatsiterunning||"focusout"!==a.type){if("keypress"===a.type&&13===a.keyCode){var c=e.val();n(b),m(b,c)}("keyup"===a.type&&27===a.keyCode||"focusout"===a.type)&&n(b)}})})},r=function(a,b){n(a),m(a,b)},s=function(b,c){var d,e=a("<select></select>").attr("id",p("id_inplacevalue_",20)).addClass("custom-select"),g=a('<label class="accesshide">'+j.attr("data-editlabel")+"</label>").attr("for",e.attr("id"));for(d in c)e.append(a("<option>").attr("value",c[d].key).html(c[d].value));e.val(b.attr("data-value")),b.html("").append(g).append(e),e.focus(),e.select(),e.on("keyup change focusout",function(a){if(!f.behatsiterunning||"focusout"!==a.type){if("change"===a.type){var c=e.val();n(b),m(b,c)}("keyup"===a.type&&27===a.keyCode||"focusout"===a.type)&&n(b)}})},t=function(b){b.addClass("inplaceeditingon"),b.attr("data-oldcontent",b.html());var c=b.attr("data-type"),d=b.attr("data-options");"toggle"===c?r(b,d):"select"===c?s(b,a.parseJSON(d)):q(b)};o(),t(j)}}),{}});
define('core/templates', ["core/mustache","jquery","core/ajax","core/str","core/notification","core/url","core/config","core/localstorage","core/event","core/flex_icon","core/log","core/user_date","core/truncate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.substr(b,a.length)===a});var n={},o={},p=function(c,f,h){var i=b.Deferred(),j=[],n=[],o=[],p="",r=[],s=[],u=!0,v=!0,w=function(a){var b="",c=q(a);return c.done(function(a){b=a}).fail(e.exception),""===b&&(o.push(c),u=!1),b},x=function(a,b){if(a.indexOf("{{")===-1||a.indexOf("}}")===-1)return a;if(a.match(/^\{{2,3}\s*([a-zA-Z0-9_]+)\s*\}{2,3}$/)){var c=a.replace(/^\{{2,3}\s*([a-zA-Z0-9_]+)\s*\}{2,3}$/,"$1");if(this.hasOwnProperty(c))return this[c]}return k.debug("Escaped content contains unexpected mustache processing queues. It will be lost."),""},y=function(a,b){var c=a.split(","),d=function(a,b,c,d){var e="",f=0,g=0;return void 0!==c&&""!==c&&(f=r.length,r.push({key:c,component:d}),e="[[_s"+f+"]]"),g=r.length,r.push({key:a,component:b,param:e}),"[[_s"+g+"]]"},e=function(a){var b=a.shift();return void 0===b&&(b=""),b.trim()},f=function(a){return 0===a.indexOf("{{")&&(a=b("{{#esc}}"+a+"{{/esc}}",this)),a},g=function(a){var b=e(a);return b=f(b)},h=function(a){var b=a[0].trim(),c=a[a.length-1].trim();return 0===b.search("{")||"}"===c.substr(c.length-1)},i=function(a,b,c){var d=c.join(",").trim(),e={};0===d.indexOf("{")&&0!==d.indexOf("{{")?(d=f(d),e=JSON.parse(d)):(e=f(d),0===e.indexOf("{")&&0!==e.indexOf("{{")&&(e=JSON.parse(e)));var g=r.length;return r.push({key:a,component:b,param:e}),"[[_s"+g+"]]"},j=g(c),l=g(c),m="",n="";return j.match(/^[a-zA-Z][a-zA-Z0-9\.:\/_\-]*$/)?(""===l?l="core":(!l.match(/^[a-z]+(_[a-z][a-z0-9_]*)?[a-z0-9]+$/)||l.search("__")>0)&&(k.debug("invalid component:"+l),l="core"),0===c.length?d(j,l):h(c)?(k.debug('Legacy string helper API in use for "'+a+'"'),i(j,l,c)):(m=g(c),n=g(c),m.match(/^[a-zA-Z][a-zA-Z0-9\.:\/_\-]*$/)||(k.debug('Invalid string identifier in "'+a+'"'),m=""),""===n?n="":(!n.match(/^[a-z]+(_[a-z][a-z0-9_]*)?[a-z0-9]+$/)||n.search("__")>0)&&(k.debug("Invalid component:"+n),n=""),d(j,l,m,n))):(k.debug('Invalid string identifier in "'+a+'"'),"")},z=function(a,b){var c=a.split(","),d=function(a,b,c){var d=n.length;return a=f(a),n.push(t(a,b,c)),"<_p"+d+">"},e=function(a){var b=a.shift();return void 0===b&&(b=""),b.trim()},f=function(a){return 0===a.indexOf("{{")&&(a=b("{{#esc}}"+a+"{{/esc}}",this)),a},g=function(a){var b=e(a);return b=f(b)},h=f(c.shift().trim()),i=function(a){if(0===a.length)return!1;var b=a[0].trim(),c=a[a.length-1].trim();return(0===b.search("{")||"}"===c.substr(c.length-1))&&((0!==b.search("{{")||"}}"!==c.substr(c.length-2))&&("{"===b[0]&&"}"===c[c.length-1]))},j=function(a,b){var c=b.join(",").trim(),e="",g="";if(""!==c){c.match(/^\{{2}.*?\}{2}$/)&&(c=f(c));try{c=JSON.parse(c)}catch(h){k.error("Unable to parse customdata for flex icon helper. Not valid JSON."),c={}}"undefined"!=typeof c.alt&&(e=f(c.alt)),c.classes&&(g=f(c.classes))}return d(a,e,g)},l="",m="",o="",p="";if(i(c))return k.debug('Legacy flex icon helper API in use for "'+a+'"'),j(h,c);if(l=g(c),""===l||l.match(/^[a-zA-Z][a-zA-Z0-9\.:\/_\-]*$/)||k.debug('Invalid alt identifier for flex icon "'+l+'", it must be a string identifier.'),m=g(c),""!==m&&(!m.match(/^[a-z]+(_[a-z][a-z0-9_]*)?[a-z0-9]+$/)||m.search("__")>0)&&k.debug('Invalid alt identifier for flex icon "'+m+'", it must be a component identifier.'),""!==l){var q=r.length;r.push({key:l,component:m}),o="[[_s"+q+"]]"}else o="";return p=e(c),d(h,o,p)},A=function(a,b){var c=a.split(","),d=function(a,b,c,d){var e=n.length;return""===b&&(b="core"),a=f(a),n.push(t(b+"|"+a,c,d)),"<_p"+e+">"},e=function(a){var b=a.shift();return void 0===b&&(b=""),b.trim()},f=function(a){return 0===a.indexOf("{{")&&(a=b("{{#esc}}"+a+"{{/esc}}",this)),a},g=function(a,b){var c=e(a);return c=f(c,b)},h=function(a){if(0===a.length)return!1;var b=a[0].trim(),c=a[a.length-1].trim();return(0===b.search("{")||"}"===c.substr(c.length-1))&&(0!==b.search("{{")||c.search("}}")===c.length-1)},i=function(a,b,c){var d,e;try{e=JSON.parse(c)}catch(g){e={alt:c}}for(d in e)e.hasOwnProperty(d)&&(e[d]=f(e[d]));return e},j="",l="",m="",o="",p="",q="",s="",u={};if(j=g(c),l=g(c),!c.length)return d(j,l);if(q=e(c),q.match(/^[a-zA-Z][a-zA-Z0-9\.:\/_\-]*$/)){m=q.trim(),o=e(c),""!==o&&(!o.match(/^[a-z]+(_[a-z][a-z0-9_]*)?[a-z0-9]+$/)||o.search("__")>0)&&k.debug("invalid component:"+o);var v=r.length;r.push({key:m,component:o}),p="[[_s"+v+"]]",s=e(c)}else k.debug('Legacy pix API in use for string:"'+a+'" - Please use the pix icon template or new API'),c.unshift(q),h(c)?(u=i(j,l,c.join(",")),u.hasOwnProperty("alt")&&(p=u.alt),u.hasOwnProperty("classes")&&(s=u.classes)):p=f(c.join(","));return"flexicon"===l?z.apply(this,[j+","+p,b]):d(j,l,p,s)},B=function(a,b){return j.push(b(a,this)),""},C=function(a,b){var c=b(a.trim(),this);return c=c.replace('"','\\"').replace(/([\{\}]{2,3})/g,"{{=<% %>=}}$1<%={{ }}=%>"),'"'+c+'"'},D=function(a,b){var c=/(.*?),(.*)/,d=a.match(c),e=b("{{#esc}}"+d[1].trim()+"{{/esc}}",this),f=b(d[2].trim(),this),g=s.length;return s.push({timestamp:parseInt(e,10),format:f}),"[[_t_"+g+"]]"},E=function(a,b){var c=/(.*?),(.*)/,d=a.match(c),e=parseInt(d[1].trim(),10),f=d[2].trim(),g=b("{{#esc}}"+f+"{{/esc}}",this);return m.truncate(g,{length:e,words:!0,ellipsis:"..."})};f.str=function(){return y},f.pix=function(){return A},f.flex_icon=function(){return z},f.js=function(){return B},f.quote=function(){return C},f.userdate=function(){return D},f.esc=function(){return x},f.shortentext=function(){return E},f.globals={config:g};var F=b.Deferred(),G=function(){b.when.apply(b,o).done(function(){if(u&&!v)F.resolve();else{v=!1,j=[],n=[],o=[],p="",r=[],s=[],u=!0;try{p=a.render(c,f,w),G()}catch(b){i.reject(b)}}})};return G(),F.done(function(){for(var a=0;a<n.length;a++)n[a].done(function(a){return function(b,c){j.push(c),p=p.replace("<_p"+a+">",b)}}(a));b.when.apply(b,n).then(function(){var a=b.Deferred();return j=j.join(";\n"),r.length>0?d.get_strings(r).done(function(b){for(var c,d=0;(p.indexOf("[[_s")!==-1||j.indexOf("[[_s")!==-1)&&d<2;){for(c=0;c<b.length;c++){for(;p.indexOf("[[_s"+c+"]]")!==-1;)p=p.replace("[[_s"+c+"]]",b[c]);for(;j.indexOf("[[_s"+c+"]]")!==-1;)j=j.replace("[[_s"+c+"]]",b[c])}d++}s.length>0&&s.forEach(function(a){return a.format=a.format.replace(/\[\[_s\d+\]\]/,function(a){var c=parseInt(a.match(/\d+/),10);return b[c]}),a}),a.resolve()}):a.resolve(),a}).then(function(){return s.length>0?(k.debug("userdate mustache helper in use - This has a potential XSS security issue"),l.get(s).then(function(a){a.forEach(function(a,b){var c="\\[\\[_t_"+b+"\\]\\]",d=new RegExp(c,"g");p=p.replace(d,a),j=j.replace(d,a)})})):b.Deferred().resolve().promise()}).then(function(){i.resolve(p.trim(),j)},function(a){i.reject(a)})}),i.promise()},q=function(a,d){var e=b.Deferred(),f=a.split("/"),i=f.shift(),j=f.shift(),k=g.theme+"/"+a;if(k in n)return e.resolve(n[k]),e.promise();var l=h.get("core_template/"+k);if(l)return e.resolve(l),n[k]=l,e.promise();if(k in o)return o[k].promise();o[k]=e;var m=c.call([{methodname:"core_output_load_template",args:{component:i,template:j,themename:g.theme}}],d,!1);return m[0].done(function(a){h.set("core_template/"+k,a),n[k]=a,e.resolve(a)}).fail(function(a){e.reject(a)}),e.promise()},r=function(a){if(void 0!==a&&""!==a.trim()){var c=b("<script>").attr("type","text/javascript").html(a);b("head").append(c)}M.util.js_pending("core-autoinitialise"),require(["core/autoinitialise"],function(a){a.scan().then(function(){M.util.js_complete("core-autoinitialise")})})},s=function(a,c,d,e){var f=b(a);if(f.length){var g=b(c);e?(f.empty(),f.append(g)):f.replaceWith(g),r(d),i.notifyFilterContentUpdated(g)}},t=function(a,c,d,e){var g={};g.classes=d||"",g=b.extend(g,e),Boolean(c)&&("[object Object]"===c.toString()?g=b.extend(g,c):g.alt=c);var h=b.Deferred();return j.getFlexTemplateData(a).done(function(a){"undefined"==typeof a.data&&(a.data={}),a.data.customdata=g,"undefined"==typeof a.data.customdata.title&&"undefined"!=typeof a.data.customdata.alt&&(a.data.customdata.title=a.data.customdata.alt),w.render(a.template,a.data).done(function(a){h.resolve(a)})}).fail(function(){var b=a.split("|");1===b.length&&b.unshift("core");var c=f.imageUrl(b[1],b[0]),d=[{name:"src",value:c},{name:"alt",value:g.alt},{name:"title",value:g.alt}],e=g.classes;delete g.alt,delete g.classes;for(var i in g)d.push({name:i,value:g[i]});w.render("core/pix_icon",{attributes:d,extraclasses:e}).done(h.resolve)}),h.promise()},u=function(a,c,d){var e=b(a);e.length&&(e.prepend(c),r(d),i.notifyFilterContentUpdated(e))},v=function(a,c,d){var e=b(a);e.length&&(e.append(c),r(d),i.notifyFilterContentUpdated(e))},w={render:function(a,c,d){var e=b.Deferred(),f=b.extend({},c),g=q(a,!0);return g.done(function(a){var b=p(a,f);b.done(function(a,b){e.resolve(a,b)}).fail(function(a){e.reject(a)})}).fail(function(a){e.reject(a)}),e},runTemplateJS:r,replaceNodeContents:function(a,b,c){return s(a,b,c,!0)},replaceNode:function(a,b,c){return s(a,b,c,!1)},prependNodeContents:function(a,b,c){u(a,b,c)},appendNodeContents:function(a,b,c){v(a,b,c)},renderIcon:t,renderPix:function(a,b,c){return t(b+"|"+a,c)}};return w});
define('core/autoinitialise', ["core/log"],function(a){var b="data-core-autoinitialise",c="data-core-autoinitialise-amd",d="true",e="initialising",f="done",g="error",h=function(){for(var h=[],i=document.querySelectorAll("["+b+"="+d+"]"),j=function(c,d){a.error(d),c.setAttribute(b,g)},k=function(a,c){var d=function(d){require([c],function(e){if("undefined"==typeof e.init)return j(a,'AMD module "'+c+'" cannot be autoinitialised because init method is missing'),void d();try{var g=e.init(a);g&&"function"==typeof g.then?g.then(function(){a.setAttribute(b,f),d()})["catch"](function(b){j(a,b),d()}):(a.setAttribute(b,f),d())}catch(h){j(a,'AMD module "'+c+'" failed to autoinitialise'),d()}},function(){j(a,'Failed to load AMD module "'+c+'"'),d()})};return d},l=0;l<i.length;l++){var m=i[l],n=m.getAttribute(c);if(null!==n)if(n.match(/^[a-zA-Z0-9\/_-]+$/g)){m.setAttribute(b,e);var o=k(m,n),p=new Promise(o);h.push(p)}else j(m,'AMD module cannot be autoinitialised because "'+c+'" attribute is invalid');else j(m,'AMD module cannot be autoinitialised because "'+c+'" attribute is missing')}return Promise.all(h)};return{scan:h}});
define('core/chart_base', ["core/chart_series","core/chart_axis"],function(a,b){function c(){this._series=[],this._labels=[],this._xaxes=[],this._yaxes=[],this._setDefaults()}return c.prototype._series=null,c.prototype._labels=null,c.prototype._title=null,c.prototype._xaxes=null,c.prototype._yaxes=null,c.prototype.COLORSET=["#f3c300","#875692","#f38400","#a1caf1","#be0032","#c2b280","#7f180d","#008856","#e68fac","#0067a5"],c.prototype._configColorSet=null,c.prototype.TYPE=null,c.prototype.addSeries=function(a){if(this._validateSeries(a),this._series.push(a),null===a.getColor()){var b=this.getConfigColorSet()||c.prototype.COLORSET;a.setColor(b[this._series.length%b.length])}},c.prototype.create=function(c,d){var e=new c;return e.setConfigColorSet(d.config_colorset),e.setLabels(d.labels),e.setTitle(d.title),d.series.forEach(function(b){e.addSeries(a.prototype.create(b))}),d.axes.x.forEach(function(a,c){e.setXAxis(b.prototype.create(a),c)}),d.axes.y.forEach(function(a,c){e.setYAxis(b.prototype.create(a),c)}),e},c.prototype.__getAxis=function(a,c,d){var e,f="x"===a?this._xaxes:this._yaxes,g=("x"===a?this.setXAxis:this.setYAxis).bind(this);if(c="undefined"==typeof c?0:c,d="undefined"!=typeof d&&d,e=f[c],"undefined"==typeof e){if(!d)throw new Error("Unknown axis.");e=new b,g(e,c)}return e},c.prototype.getConfigColorSet=function(){return this._configColorSet},c.prototype.getLabels=function(){return this._labels},c.prototype.getSeries=function(){return this._series},c.prototype.getTitle=function(){return this._title},c.prototype.getType=function(){if(!this.TYPE)throw new Error("The TYPE property has not been set.");return this.TYPE},c.prototype.getXAxes=function(){return this._xaxes},c.prototype.getXAxis=function(a,b){return this.__getAxis("x",a,b)},c.prototype.getYAxes=function(){return this._yaxes},c.prototype.getYAxis=function(a,b){return this.__getAxis("y",a,b)},c.prototype.setConfigColorSet=function(a){this._configColorSet=a},c.prototype._setDefaults=function(){},c.prototype.setLabels=function(a){if(a.length&&this._series.length&&this._series[0].length!=a.length)throw new Error("Series must match label values.");this._labels=a},c.prototype.setTitle=function(a){this._title=a},c.prototype.setXAxis=function(a,b){b="undefined"==typeof b?0:b,this._validateAxis("x",a,b),this._xaxes[b]=a},c.prototype.setYAxis=function(a,b){b="undefined"==typeof b?0:b,this._validateAxis("y",a,b),this._yaxes[b]=a},c.prototype._validateAxis=function(a,b,c){if(c="undefined"==typeof c?0:c,c>0){var d="x"==a?this._xaxes:this._yaxes;if("undefined"==typeof d[c-1])throw new Error("Missing "+a+" axis at index lower than "+c)}},c.prototype._validateSeries=function(a){if(this._series.length&&this._series[0].getCount()!=a.getCount())throw new Error("Series do not have an equal number of values.");if(this._labels.length&&this._labels.length!=a.getCount())throw new Error("Series must match label values.")},c});
define('core/popover_region_controller', ["jquery","core/str","core/custom_interaction_events"],function(a,b,c){var d={CONTENT:".popover-region-content",CONTENT_CONTAINER:".popover-region-content-container",MENU_CONTAINER:".popover-region-container",MENU_TOGGLE:".popover-region-toggle",CAN_RECEIVE_FOCUS:'input:not([type="hidden"]), a[href], button, textarea, select, [tabindex]'},e=function(b){this.root=a(b),this.content=this.root.find(d.CONTENT),this.contentContainer=this.root.find(d.CONTENT_CONTAINER),this.menuContainer=this.root.find(d.MENU_CONTAINER),this.menuToggle=this.root.find(d.MENU_TOGGLE),this.isLoading=!1,this.promises={closeHandlers:a.Deferred(),navigationHandlers:a.Deferred()},this.registerBaseEventListeners()};return e.prototype.events=function(){return{menuOpened:"popoverregion:menuopened",menuClosed:"popoverregion:menuclosed",startLoading:"popoverregion:startLoading",stopLoading:"popoverregion:stopLoading"}},e.prototype.getContentContainer=function(){return this.contentContainer},e.prototype.getContent=function(){return this.content},e.prototype.isMenuOpen=function(){return!this.root.hasClass("collapsed")},e.prototype.toggleMenu=function(){this.isMenuOpen()?this.closeMenu():this.openMenu()},e.prototype.closeMenu=function(){this.isMenuOpen()&&(this.root.addClass("collapsed"),this.menuContainer.attr("aria-expanded","false"),this.menuContainer.attr("aria-hidden","true"),this.updateButtonAriaLabel(),this.root.trigger(this.events().menuClosed))},e.prototype.openMenu=function(){this.isMenuOpen()||(this.root.removeClass("collapsed"),this.menuContainer.attr("aria-expanded","true"),this.menuContainer.attr("aria-hidden","false"),this.updateButtonAriaLabel(),this.promises.closeHandlers.resolve(),this.promises.navigationHandlers.resolve(),this.root.trigger(this.events().menuOpened))},e.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?b.get_string("hidepopoverwindow").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):b.get_string("showpopoverwindow").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))},e.prototype.startLoading=function(){this.isLoading=!0,this.getContentContainer().addClass("loading"),this.getContentContainer().attr("aria-busy","true"),this.root.trigger(this.events().startLoading)},e.prototype.stopLoading=function(){this.isLoading=!1,this.getContentContainer().removeClass("loading"),this.getContentContainer().attr("aria-busy","false"),this.root.trigger(this.events().stopLoading)},e.prototype.focusMenuToggle=function(){this.menuToggle.focus()},e.prototype.contentItemHasFocus=function(){return this.getContentItemWithFocus().length>0},e.prototype.getContentItemWithFocus=function(){var b=a(document.activeElement),c=this.getContent().children(),d=c.filter(b);return d.length||(d=c.has(b)),d},e.prototype.focusContentItem=function(a){a.is(d.CAN_RECEIVE_FOCUS)?a.focus():a.find(d.CAN_RECEIVE_FOCUS).first().focus()},e.prototype.focusFirstContentItem=function(){this.focusContentItem(this.getContent().children().first())},e.prototype.focusLastContentItem=function(){this.focusContentItem(this.getContent().children().last())},e.prototype.focusNextContentItem=function(){var a=this.getContentItemWithFocus();a.length&&a.next()&&this.focusContentItem(a.next())},e.prototype.focusPreviousContentItem=function(){var a=this.getContentItemWithFocus();a.length&&a.prev()&&this.focusContentItem(a.prev())},e.prototype.registerBaseEventListeners=function(){c.define(this.root,[c.events.activate,c.events.escape]),this.root.on(c.events.activate,d.MENU_TOGGLE,function(){this.toggleMenu()}.bind(this)),this.promises.closeHandlers.done(function(){this.root.on(c.events.escape,function(){this.closeMenu(),this.focusMenuToggle()}.bind(this)),a("html").on("focusin click",function(b){var c=a(b.target);this.root.is(c)||this.root.has(c).length||this.closeMenu()}.bind(this)),c.define(this.getContentContainer(),[c.events.scrollBottom])}.bind(this))},e.prototype.registerListNavigationEventListeners=function(){c.define(this.root,[c.events.down]),this.root.on(c.events.down,function(a,b){this.isMenuOpen()?this.contentItemHasFocus()?this.focusNextContentItem():this.focusFirstContentItem():(this.openMenu(),this.focusFirstContentItem()),b.originalEvent.preventDefault()}.bind(this)),this.promises.navigationHandlers.done(function(){c.define(this.root,[c.events.up,c.events.home,c.events.end]),this.root.on(c.events.up,function(a,b){this.focusPreviousContentItem(),b.originalEvent.preventDefault()}.bind(this)),this.root.on(c.events.home,function(a,b){this.focusFirstContentItem(),b.originalEvent.preventDefault()}.bind(this)),this.root.on(c.events.end,function(a,b){this.focusLastContentItem(),b.originalEvent.preventDefault()}.bind(this))}.bind(this))},e});
define('core/form-course-selector', ["core/ajax","jquery"],function(a,b){return{processResults:function(a,c){var d=[],e=0,f=String(b(a).data("exclude")).split(",");for(e=0;e<c.courses.length;e++)f.indexOf(String(c.courses[e].id))===-1&&d.push({value:c.courses[e].id,label:c.courses[e].displayname});return d},transport:function(c,d,e,f){var g=b(c),h=g.data("requiredcapabilities");h=""!==h.trim()?h.split(","):[];var i=g.data("limittoenrolled"),j=g.data("includefrontpage"),k=null;"undefined"==typeof d&&(d="");var l={criterianame:"search",criteriavalue:d,page:0,perpage:100,requiredcapabilities:h,limittoenrolled:i},m=[{methodname:"core_course_search_courses",args:l}];j&&m.push({methodname:"core_course_get_courses",args:{options:{ids:[j]}}}),k=a.call(m),b.when.apply(b.when,k).done(function(a,b){if(b&&1==b.length){var c=b.pop(),f=""===d||c.fullname.toUpperCase().indexOf(d.toUpperCase())>-1||c.shortname.toUpperCase().indexOf(d.toUpperCase())>-1;f&&a.courses.splice(0,0,c)}e(a)}).fail(f)}}});
define('core/url', ["jquery","core/config"],function(a,b){return{fileUrl:function(a,c){var d=b.wwwroot+a;return"/"!=c.charAt(0)&&(c="/"+c),d+=b.slasharguments?c:"?file="+encodeURIComponent(c)},relativeUrl:function(c,d,e){if(0===c.indexOf("http:")||0===c.indexOf("https:")||c.indexOf("://")>=0)throw new Error("relativeUrl function does not accept absolute urls");"/"!=c.charAt(0)&&(c="/"+c),"admin"!==b.admin&&(c=c.replace(/^\/admin\//,"/"+b.admin+"/")),d=d||{},e&&(d.sesskey=b.sesskey);var f="";return Object.keys(d).length&&(f=a.map(d,function(a,b){return b+"="+a}).join("&")),""!==f?b.wwwroot+c+"?"+f:b.wwwroot+c},imageUrl:function(a,b){return M.util.image_url(a,b)}}});
define('core/chart_axis', [],function(){function a(){}return a.prototype.POS_DEFAULT=null,a.prototype.POS_BOTTOM="bottom",a.prototype.POS_LEFT="left",a.prototype.POS_RIGHT="right",a.prototype.POS_TOP="top",a.prototype._label=null,a.prototype._labels=null,a.prototype._max=null,a.prototype._min=null,a.prototype._position=null,a.prototype._stepSize=null,a.prototype.create=function(b){var c=new a;return c.setPosition(b.position),c.setLabel(b.label),c.setStepSize(b.stepSize),c.setMax(b.max),c.setMin(b.min),c.setLabels(b.labels),c},a.prototype.getLabel=function(){return this._label},a.prototype.getLabels=function(){return this._labels},a.prototype.getMax=function(){return this._max},a.prototype.getMin=function(){return this._min},a.prototype.getPosition=function(){return this._position},a.prototype.getStepSize=function(){return this._stepSize},a.prototype.setLabel=function(a){this._label=a||null},a.prototype.setLabels=function(a){this._labels=a||null,null===this._labels||null!==this._stepSize||null!==this._min&&0!==this._min||null!==this._max||(this.setStepSize(1),this.setMin(0),this.setMax(a.length-1))},a.prototype.setMax=function(a){this._max="undefined"!=typeof a?a:null},a.prototype.setMin=function(a){this._min="undefined"!=typeof a?a:null},a.prototype.setPosition=function(a){if(a!=this.POS_DEFAULT&&a!=this.POS_BOTTOM&&a!=this.POS_LEFT&&a!=this.POS_RIGHT&&a!=this.POS_TOP)throw new Error("Invalid axis position.");this._position=a},a.prototype.setStepSize=function(a){if("undefined"==typeof a||null===a)a=null;else{if(isNaN(Number(a)))throw new Error("Value for stepSize is not a number.");a=Number(a)}this._stepSize=a},a});
define('core/backoff_timer', function(){var a=function(a,b){this.callback=a,this.backOffFunction=b};return a.prototype.callback=null,a.prototype.backOffFunction=null,a.prototype.time=null,a.prototype.timeout=null,a.prototype.generateNextTime=function(){var a=this.backOffFunction(this.time);return this.time=a,a},a.prototype.reset=function(){return this.time=null,this.stop(),this},a.prototype.stop=function(){return this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null),this},a.prototype.start=function(){if(!this.timeout){var a=this.generateNextTime();this.timeout=window.setTimeout(function(){this.callback(),this.stop(),this.start()}.bind(this),a)}return this},a.prototype.restart=function(){return this.reset().start()},a.getIncrementalCallback=function(a,b,c,d){return function(e){return e?e+b>c?d:e+b:a}},a});
define('core/modal', ["jquery","core/templates","core/notification","core/key_codes","core/custom_interaction_events","core/modal_backdrop","core/modal_events"],function(a,b,c,d,e,f,g){var h,i={CONTAINER:'[data-region="modal-container"]',MODAL:'[data-region="modal"]',HEADER:'[data-region="header"]',TITLE:'[data-region="title"]',BODY:'[data-region="body"]',FOOTER:'[data-region="footer"]',HIDE:'[data-action="hide"]',DIALOG:"[role=dialog]",MENU_BAR:"[role=menubar]",HAS_Z_INDEX:".moodle-has-zindex",CAN_RECEIVE_FOCUS:'input:not([type="hidden"]), a[href], button, textarea, select, [tabindex]'},j={LOADING:"core/loading",BACKDROP:"core/modal_backdrop"},k=0,l=function(b){this.root=a(b),this.modal=this.root.find(i.MODAL),this.header=this.modal.find(i.HEADER),this.title=this.header.find(i.TITLE),this.body=this.modal.find(i.BODY),this.footer=this.modal.find(i.FOOTER),this.hiddenSiblings=[],this.isAttached=!1,this.bodyJS=null,this.footerJS=null,this.modalCount=k++,this.root.is(i.CONTAINER)||c.exception({message:"Element is not a modal container"}),this.modal.length||c.exception({message:"Container does not contain a modal"}),this.header.length||c.exception({message:"Modal is missing a header region"}),this.title.length||c.exception({message:"Modal header is missing a title region"}),this.body.length||c.exception({message:"Modal is missing a body region"}),this.footer.length||c.exception({message:"Modal is missing a footer region"}),this.registerEventListeners()};return l.prototype.attachToDOM=function(){this.isAttached||(a("body").append(this.root),this.bodyJS&&(b.runTemplateJS(this.bodyJS),this.bodyJS=null),this.footerJS&&(b.runTemplateJS(this.footerJS),this.footerJS=null),this.isAttached=!0)},l.prototype.countOtherVisibleModals=function(){var b=0;return a("body").find(i.CONTAINER).each(function(c,d){d=a(d),!this.root.is(d)&&d.hasClass("show")&&b++}.bind(this)),b},l.prototype.getBackdrop=function(){return h||(h=b.render(j.BACKDROP,{}).then(function(b){var c=a(b);return new f(c)}).fail(c.exception)),h},l.prototype.getRoot=function(){return this.root},l.prototype.getModal=function(){return this.modal},l.prototype.getTitle=function(){return this.title},l.prototype.getBody=function(){return this.body},l.prototype.getFooter=function(){return this.footer},l.prototype.getModalCount=function(){return this.modalCount},l.prototype.setTitle=function(a){var b=this.getTitle();"string"==typeof a?b.html(a):a.then(function(a){return b.html(a)})},l.prototype.setBody=function(d){var e=this.getBody();if("string"==typeof d)e.html(d);else{var f="amd-modal-js-pending-id-"+this.getModalCount();M.util.js_pending(f);var g=null;e.css("overflow","hidden"),"pending"==d.state()?(e.animate({height:"100px"},150),e.html(""),g=b.render(j.LOADING,{}).then(function(b){var c=a(b).hide();return e.html(c),c.fadeIn(150),a.when(c.promise(),d)}).then(function(a){return a.fadeOut(100).promise()}).then(function(){return d})):g=d,g.then(function(a,c){var d=null;if(this.isVisible()){e.css("opacity",0);var f=e.innerHeight();e.html(a),e.css("height","");var g=e.innerHeight();e.css("height",f+"px"),d=e.animate({height:g+"px",opacity:1},{duration:150,queue:!1}).promise()}else e.html(a);return c&&(this.isAttached?b.runTemplateJS(c):this.bodyJS=c),d}.bind(this)).fail(c.exception).always(function(){e.css("height",""),e.css("overflow",""),e.css("opacity",""),M.util.js_complete(f)}).fail(c.exception)}},l.prototype.setFooter=function(a){var c=this.getFooter();"string"==typeof a?c.html(a):b.render(j.LOADING,{}).done(function(d){c.html(d),a.done(function(a,d){c.html(a),d&&(this.isAttached?b.runTemplateJS(d):this.footerJS=d)}.bind(this))}.bind(this))},l.prototype.setLarge=function(){this.isLarge()||this.getRoot().addClass("large")},l.prototype.isLarge=function(){return this.getRoot().hasClass("large")},l.prototype.setSmall=function(){this.isSmall()||this.getRoot().removeClass("large")},l.prototype.isSmall=function(){return!this.getRoot().hasClass("large")},l.prototype.calculateZIndex=function(){var b=a(i.DIALOG+", "+i.MENU_BAR+", "+i.HAS_Z_INDEX),c=parseInt(this.root.css("z-index"));return b.each(function(b,d){d=a(d);var e=d.css("z-index")?parseInt(d.css("z-index")):0;e>c&&(c=e)}),c},l.prototype.isVisible=function(){return this.root.hasClass("show")},l.prototype.hasFocus=function(){var b=a(document.activeElement);return this.root.is(b)||this.root.has(b).length},l.prototype.hasTransitions=function(){return this.getRoot().hasClass("fade")},l.prototype.show=function(){this.isVisible()||(this.isAttached||this.attachToDOM(),this.getBackdrop().done(function(b){var c=this.calculateZIndex(),d=c+2,e=d-1;this.root.css("z-index",d),b.setZIndex(e),b.show(),this.root.removeClass("hide").addClass("show"),this.accessibilityShow(),this.getTitle().focus(),a("body").addClass("modal-open"),this.root.trigger(g.shown,this)}.bind(this)))},l.prototype.hide=function(){this.isVisible()&&this.getBackdrop().done(function(b){this.countOtherVisibleModals()||(b.hide(),a("body").removeClass("modal-open"));var c=parseInt(this.root.css("z-index"));this.root.css("z-index",""),b.setZIndex(c-3),this.accessibilityHide(),this.hasTransitions()?this.getRoot().one("transitionend webkitTransitionEnd oTransitionEnd",function(){this.getRoot().removeClass("show").addClass("hide")}.bind(this)):this.getRoot().removeClass("show").addClass("hide"),this.root.trigger(g.hidden,this)}.bind(this))},l.prototype.destroy=function(){this.root.remove(),this.root.trigger(g.destroyed,this)},l.prototype.accessibilityShow=function(){a("body").children().each(function(b,c){if(!this.root.is(c)){c=a(c);var d=c.attr("aria-hidden");"true"!==d&&(c.data("previous-aria-hidden",d),this.hiddenSiblings.push(c),c.attr("aria-hidden","true"))}}.bind(this)),this.root.attr("aria-hidden","false")},l.prototype.accessibilityHide=function(){this.root.attr("aria-hidden","true"),a.each(this.hiddenSiblings,function(b,c){c=a(c);var d=c.data("previous-aria-hidden");"undefined"==typeof d?c.removeAttr("aria-hidden"):c.attr("aria-hidden",d)}),this.hiddenSiblings=[]},l.prototype.handleTabLock=function(b){if(this.hasFocus()){var c=a(document.activeElement),d=this.modal.find(i.CAN_RECEIVE_FOCUS),e=d.first(),f=d.last();c.is(e)&&b.shiftKey?(f.focus(),b.preventDefault()):c.is(f)&&!b.shiftKey&&(e.focus(),b.preventDefault())}},l.prototype.registerEventListeners=function(){this.getRoot().on("keydown",function(a){this.isVisible()&&(a.keyCode==d.tab?this.handleTabLock(a):a.keyCode==d.escape&&this.hide())}.bind(this)),e.define(this.getModal(),[e.events.activate]),this.getModal().on(e.events.activate,i.HIDE,function(a,b){this.hide(),b.originalEvent.preventDefault()}.bind(this))},l});
define('core/chart_output', ["core/chart_output_chartjs"],function(a){var b=a;return b});
define('core/chart_line', ["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}return b.prototype=Object.create(a.prototype),b.prototype.TYPE="line",b.prototype._smooth=!1,b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);return d.setSmooth(c.smooth),d},b.prototype.getSmooth=function(){return this._smooth},b.prototype.setSmooth=function(a){this._smooth=Boolean(a)},b});
!function(a,b){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?b(exports):"function"==typeof define&&define.amd?define('core/mustache', ["exports"],b):(a.Mustache={},b(a.Mustache))}(this,function(a){function b(a){return"function"==typeof a}function c(a){return p(a)?"array":typeof a}function d(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function e(a,b){return null!=a&&"object"==typeof a&&b in a}function f(a,b){return q.call(a,b)}function g(a){return!f(r,a)}function h(a){return String(a).replace(/[&<>"'`=\/]/g,function(a){return s[a]})}function i(b,c){function e(){if(r&&!s)for(;q.length;)delete o[q.pop()];else q=[];r=!1,s=!1}function f(a){if("string"==typeof a&&(a=a.split(u,2)),!p(a)||2!==a.length)throw new Error("Invalid tags: "+a);h=new RegExp(d(a[0])+"\\s*"),i=new RegExp("\\s*"+d(a[1])),m=new RegExp("\\s*"+d("}"+a[1]))}if(!b)return[];var h,i,m,n=[],o=[],q=[],r=!1,s=!1;f(c||a.tags);for(var y,z,A,B,C,D,E=new l(b);!E.eos();){if(y=E.pos,A=E.scanUntil(h))for(var F=0,G=A.length;F<G;++F)B=A.charAt(F),g(B)?q.push(o.length):s=!0,o.push(["text",B,y,y+1]),y+=1,"\n"===B&&e();if(!E.scan(h))break;if(r=!0,z=E.scan(x)||"name",E.scan(t),"="===z?(A=E.scanUntil(v),E.scan(v),E.scanUntil(i)):"{"===z?(A=E.scanUntil(m),E.scan(w),E.scanUntil(i),z="&"):A=E.scanUntil(i),!E.scan(i))throw new Error("Unclosed tag at "+E.pos);if(C=[z,A,y,E.pos],o.push(C),"#"===z||"^"===z||"$"===z||"<"===z)n.push(C);else if("/"===z){if(D=n.pop(),!D)throw new Error('Unopened section "'+A+'" at '+y);if(D[1]!==A)throw new Error('Unclosed section "'+D[1]+'" at '+y)}else"name"===z||"{"===z||"&"===z?s=!0:"="===z&&f(A)}if(D=n.pop())throw new Error('Unclosed section "'+D[1]+'" at '+E.pos);return k(j(o))}function j(a){for(var b,c,d=[],e=0,f=a.length;e<f;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function k(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;g<h;++g)switch(b=a[g],b[0]){case"$":case"<":case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function l(a){this.string=a,this.tail=a,this.pos=0}function m(a,b){this.view=a,this.blocks={},this.cache={".":this.view},this.parent=b}function n(){this.cache={}}var o=Object.prototype.toString,p=Array.isArray||function(a){return"[object Array]"===o.call(a)},q=RegExp.prototype.test,r=/\S/,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},t=/\s*/,u=/\s+/,v=/\s*=/,w=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!|\$|</;l.prototype.eos=function(){return""===this.tail},l.prototype.scan=function(a){var b=this.tail.match(a);if(!b||0!==b.index)return"";var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c},l.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},m.prototype.push=function(a){return new m(a,this)},m.prototype.setBlockVar=function(a,b){var c=this.blocks;return c[a]=b,b},m.prototype.clearBlockVars=function(){this.blocks={}},m.prototype.getBlockVar=function(a){var b,c=this.blocks;return c.hasOwnProperty(a)?b=c[a]:this.parent&&(b=this.parent.getBlockVar(a)),b},m.prototype.lookup=function(a){var c,d=this.cache;if(d.hasOwnProperty(a))c=d[a];else{for(var f,g,h=this,i=!1;h;){if(a.indexOf(".")>0)for(c=h.view,f=a.split("."),g=0;null!=c&&g<f.length;)g===f.length-1&&(i=e(c,f[g])),c=c[f[g++]];else c=h.view[a],i=e(h.view,a);if(i)break;h=h.parent}d[a]=c}return b(c)&&(c=c.call(this.view)),c},n.prototype.clearCache=function(){this.cache={}},n.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=i(a,b)),d},n.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof m?b:new m(b);return this.renderTokens(d,e,c,a)},n.prototype.renderTokens=function(a,b,c,d){for(var e,f,g,h="",i=0,j=a.length;i<j;++i)g=void 0,e=a[i],f=e[0],"#"===f?g=this.renderSection(e,b,c,d):"^"===f?g=this.renderInverted(e,b,c,d):">"===f?g=this.renderPartial(e,b,c,d):"<"===f?g=this.renderBlock(e,b,c,d):"$"===f?g=this.renderBlockVariable(e,b,c,d):"&"===f?g=this.unescapedValue(e,b):"name"===f?g=this.escapedValue(e,b):"text"===f&&(g=this.rawValue(e)),void 0!==g&&(h+=g);return h},n.prototype.renderSection=function(a,c,d,e){function f(a){return g.render(a,c,d)}var g=this,h="",i=c.lookup(a[1]);if(i){if(p(i))for(var j=0,k=i.length;j<k;++j)h+=this.renderTokens(a[4],c.push(i[j]),d,e);else if("object"==typeof i||"string"==typeof i||"number"==typeof i)h+=this.renderTokens(a[4],c.push(i),d,e);else if(b(i)){if("string"!=typeof e)throw new Error("Cannot use higher-order sections without the original template");i=i.call(c.view,e.slice(a[3],a[5]),f),null!=i&&(h+=i)}else h+=this.renderTokens(a[4],c,d,e);return h}},n.prototype.renderInverted=function(a,b,c,d){var e=b.lookup(a[1]);if(!e||p(e)&&0===e.length)return this.renderTokens(a[4],b,c,d)},n.prototype.renderPartial=function(a,c,d){if(d){if(a[1].startsWith("&&"))var e=c.lookup(a[1].substr(2)),f=b(d)?d(e):d[e];else var f=b(d)?d(a[1]):d[a[1]];return null!=f?this.renderTokens(this.parse(f),c,d,f):void 0}},n.prototype.renderBlock=function(a,c,d,e){if(d){var f=b(d)?d(a[1]):d[a[1]];null!=f&&c.clearBlockVars(),this.renderTokens(a[4],c,d,e);var g=this.renderTokens(this.parse(f),c,d,f);return c.clearBlockVars(),g}},n.prototype.renderBlockVariable=function(a,b,c,d){var e=a[1],f=b.getBlockVar(e);return f?this.renderTokens(this.parse(f),b,c,f):(b.setBlockVar(e,d.slice(a[3],a[5])),this.renderTokens(a[4],b,c,d))},n.prototype.unescapedValue=function(a,b){var c=b.lookup(a[1]);if(null!=c)return c},n.prototype.escapedValue=function(b,c){var d=c.lookup(b[1]);if(null!=d)return a.escape(d)},n.prototype.rawValue=function(a){return a[1]},a.name="mustache.js",a.version="2.2.1",a.tags=["{{","}}"];var y=new n;a.clearCache=function(){return y.clearCache()},a.parse=function(a,b){return y.parse(a,b)},a.render=function(a,b,d){if("string"!=typeof a)throw new TypeError('Invalid template! Template should be a "string" but "'+c(a)+'" was given as the first argument for mustache#render(template, view, partials)');return y.render(a,b,d)},a.to_html=function(c,d,e,f){var g=a.render(c,d,e);return b(f)?void f(g):g},a.escape=h,a.Scanner=l,a.Context=m,a.Writer=n});
define('core/add_block_popover', ["jquery","core/templates","core/str","core/flex_icon"],function(a,b,c,d){function e(){if(!(this instanceof e))return new e}e.prototype={constructor:e,addToPage:function(e,f){var g=this;null!==document.querySelector('[data-addblock="'+f+'"]')&&(M.util.js_pending("core_add_block"),c.get_strings([{key:"closebuttontitle",component:"core"},{key:"search",component:"core"}]).then(function(b){return a.when(d.getIconData("delete","core",{alt:b[0]}),d.getIconData("search","core",{alt:b[1]}))}).then(function(a,c){var d={contenttemplate:"core/add_block_popover_content",contenttemplatecontext:{close_icon:a,has_focus:!0,item_list:e,placement_max_height:600,placement_max_width:600,search_icon:c},arrow_placement:"smartPosition",close_on_focus_out:!0,trigger:"click"};return b.render("core/popover",d)}).then(function(a,c){var d,e=document.querySelector('[data-addblock="'+f+'"]'),h=document.createRange(),i=e.parentNode;h.selectNode(e),d=h.createContextualFragment(a),e.appendChild(d),b.runTemplateJS(c),g.events(i,e),M.util.js_complete("core_add_block")}))},changeListItemFocus:function(a){var b=a.target.closest(".addBlockPopover--results_list_item"),c=a.target.closest(".addBlockPopover--results");if("38"==a.keyCode)for(;b.previousElementSibling&&(b=b.previousElementSibling,b.classList.contains("hide")););else if("40"==a.keyCode)for(;b.nextElementSibling&&(b=b.nextElementSibling,b.classList.contains("hide")););b.classList.contains("hide")||(b.querySelector("a").focus(),c.scrollTop=b.offsetTop)},closeAddBlockPopover:function(b){a(b).popover("hide")},events:function(b,c){var d=this;b.addEventListener("click",function(a){a.preventDefault(),a.target&&(a.target.closest("[data-addblockpopover-close]")&&d.closeAddBlockPopover(c),a.target.closest(".addBlockPopover--results_list_item")&&d.submitAddBlock(this,a.target.closest(".addBlockPopover--results_list_item")))}),b.addEventListener("keydown",function(a){a.target&&(!a.target.closest(".addBlockPopover--results_list_item")||"38"!=a.keyCode&&"40"!=a.keyCode?a.target.closest("#addBlockPopover--search_query")&&a.shiftKey&&9==a.keyCode&&d.closeAddBlockPopover(c):(a.preventDefault(),d.changeListItemFocus(a)))}),b.addEventListener("keyup",function(a){a.target&&("27"==a.keyCode&&d.closeAddBlockPopover(c),a.target.closest("#addBlockPopover--search_query")&&("13"==a.keyCode?d.searchListEnter(b):d.searchListItems(b,a)))}),b.addEventListener("focusout",function(a){a.target&&a.relatedTarget&&a.target.closest(".addBlockPopover--close")&&!a.relatedTarget.closest(".popover")&&d.closeAddBlockPopover(c)}),a(c).on("shown.bs.popover",function(){d.setFocusToInput(b)})},searchListEnter:function(a){var b=a.querySelectorAll(".popover .addBlockPopover--results_list_item:not(.hide)");1===b.length?this.submitAddBlock(a,b[0]):b.length>=2&&b[0].querySelector("a").focus()},searchListItems:function(a,b){for(var c=b.target.value.toLowerCase(),d=a.querySelectorAll(".popover .addBlockPopover--results_list_item"),e=0;e<d.length;e++){var f=d[e],g=f.getAttribute("data-addblockpopover-blocktitle");if(g.toLowerCase().indexOf(c)===-1)f.classList.add("hide");else{f.classList.remove("hide");var h=f.querySelector("a");h.innerHTML=g.replace(new RegExp(c,"i"),"<b>$&</b>")}}},setFocusToInput:function(a){a.querySelector(".popover #addBlockPopover--search_query").focus()},submitAddBlock:function(a,b){b.closest(".addBlockPopover").classList.add("addBlockPopover--overlay");var c=b.getAttribute("data-addblockpopover-blockname");a.querySelector("input[name=bui_addblock]").setAttribute("value",c),a.querySelector("form").submit()}};var f=function(a,b){var c=new e;c.addToPage(a,b)};return{init:f}});
define('core/fragment', ["jquery","core/ajax"],function(a,b){var c=function(c,d,e,f){var g=[];for(var h in f)g.push({name:h,value:f[h]});var i=a.Deferred(),j=b.call([{methodname:"core_get_fragment",args:{component:c,callback:d,contextid:e,args:g}}],!1);return j[0].done(function(a){i.resolve(a)}).fail(function(a){i.reject(a)}),i.promise()};return{loadFragment:function(b,d,e,f){var g=a.Deferred();return a.when(c(b,d,e,f)).then(function(b){var c=a(b.javascript),d="";c.each(function(b,c){c=a(c);var e=c.prop("tagName");if(e&&"script"==e.toLowerCase())if(c.attr("src")){var f=!1;a("script").each(function(b,d){return a(d).attr("src")==c.attr("src")&&(f=!0),!f}),f||(d+=" { ",d+=' node = document.createElement("script"); ',d+=' node.type = "text/javascript"; ',d+=' node.src = decodeURI("'+encodeURI(c.attr("src"))+'"); ',d+=' document.getElementsByTagName("head")[0].appendChild(node); ',d+=" } ")}else d+=" "+c.text()}),g.resolve(b.html,d)}).fail(function(a){g.reject(a)}),g.promise()}}});
define('core/localstorage', ["core/config","core/storagewrapper"],function(a,b){var c=new b(window.localStorage);return{get:function(a){return c.get(a)},set:function(a,b){return c.set(a,b)}}});
define('core/form-autocomplete', ["jquery","core/log","core/str","core/templates","core/notification"],function(a,b,c,d,e){var f={DOWN:40,ENTER:13,SPACE:32,ESCAPE:27,COMMA:44,UP:38},g={},h=0,i=function(b,c){var d=a(document.getElementById(c.selectionId)),e=d.children("[aria-selected=true]").length;for(b%=e;b<0;)b+=e;var f=a(d.children("[aria-selected=true]").get(b)),g=c.selectionId+"-"+b;d.children().attr("data-active-selection",!1).attr("id",""),f.attr("data-active-selection",!0).attr("id",g),d.attr("aria-activedescendant",g)},j=function(b,c,f){var g=[],h=a(document.getElementById(c.selectionId)),j=h.attr("aria-activedescendant"),k=!1;j&&(k=a(document.getElementById(j)).attr("data-value")),f.children("option").each(function(b,c){a(c).prop("selected")&&g.push({label:a(c).html(),value:a(c).attr("value")})});var l=a.extend({items:g},b,c);d.render("core/form_autocomplete_selection",l).done(function(b){h.empty().append(a(b).html()),k!==!1&&h.children("[aria-selected=true]").each(function(b,d){a(d).attr("data-value")===k&&i(b,c)})}).fail(e.exception)},k=function(a){"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed(),a.change()},l=function(b,c,d,e){var f=a(d).attr("data-value");b.multiple&&e.children("option").each(function(b,c){a(c).attr("value")==f&&(a(c).prop("selected",!1),a(c).attr("data-iscustom")&&a(c).remove())}),j(b,c,e),k(e)},m=function(b,c){var d=a(document.getElementById(c.inputId)),e=a(document.getElementById(c.suggestionsId)),f=e.children("[aria-hidden=false]").length;for(b%=f;b<0;)b+=f;var g=a(e.children("[aria-hidden=false]").get(b)),h=a(e.children("[role=option]")).index(g),i=c.suggestionsId+"-"+h;e.children().attr("aria-selected",!1).attr("id",""),g.attr("aria-selected",!0).attr("id",i),d.attr("aria-activedescendant",i);var j=g.offset().top-e.offset().top+e.scrollTop()-e.height()/2;e.animate({scrollTop:j},100)},n=function(b){var c=a(document.getElementById(b.suggestionsId)),d=c.children("[aria-selected=true]"),e=c.children("[aria-hidden=false]").index(d);m(e+1,b)},o=function(b){var c=a(document.getElementById(b.selectionId)),d=c.children("[data-active-selection=true]");if(!d)return void i(0,b);var e=c.children("[aria-selected=true]").index(d);i(e-1,b)},p=function(b){var c=a(document.getElementById(b.selectionId)),d=c.children("[data-active-selection=true]");if(!d)return void i(0,b);var e=c.children("[aria-selected=true]").index(d);i(e+1,b)},q=function(b){var c=a(document.getElementById(b.suggestionsId)),d=c.children("[aria-selected=true]"),e=c.children("[aria-hidden=false]").index(d);m(e-1,b)},r=function(b){var c=a(document.getElementById(b.inputId)),d=a(document.getElementById(b.suggestionsId));c.attr("aria-expanded",!1).attr("aria-activedescendant",b.selectionId),d.hide().attr("aria-hidden",!0)},s=function(b,f,g,h){var i=a(document.getElementById(f.inputId)),j=a(document.getElementById(f.suggestionsId)),k=!1,l=[];h.children("option").each(function(b,c){a(c).prop("selected")!==!0&&(l[l.length]={label:c.innerHTML,value:a(c).attr("value")})});var n=f.caseSensitive?g:g.toLocaleLowerCase(),o=a.extend({options:l},b,f);i.data("autocomplete-query",g),d.render("core/form_autocomplete_suggestions",o).done(function(d){i.data("autocomplete-query")===g&&(j.replaceWith(d),j=a(document.getElementById(f.suggestionsId)),j.show().attr("aria-hidden",!1),j.children().each(function(c,d){d=a(d),b.caseSensitive&&d.text().indexOf(n)>-1||!b.caseSensitive&&d.text().toLocaleLowerCase().indexOf(n)>-1?(d.show().attr("aria-hidden",!1),k=!0):d.hide().attr("aria-hidden",!0)}),i.attr("aria-expanded",!0),k?b.tags||m(0,f):c.get_string("nosuggestions","form").done(function(a){i.data("autocomplete-query")===g&&j.html(a)}))}).fail(e.exception)},t=function(b,c,d){var e=a(document.getElementById(c.inputId)),f=e.val(),g=f.split(","),h=!1;a.each(g,function(c,e){if(e=e.trim(),""!==e&&(b.multiple||d.children("option").prop("selected",!1),d.children("option").each(function(b,c){a(c).attr("value")==e&&(h=!0,a(c).prop("selected",!0))}),!h)){var f=a("<option>");f.append(document.createTextNode(e)),f.attr("value",e),d.append(f),f.prop("selected",!0),f.attr("data-iscustom",!0)}}),j(b,c,d),k(d),e.val(""),r(c)},u=function(b,c,d){var e=a(document.getElementById(c.inputId)),f=a(document.getElementById(c.suggestionsId)),g=f.children("[aria-selected=true]").attr("data-value");b.multiple||d.children("option").prop("selected",!1),d.children("option").each(function(b,c){a(c).attr("value")==g&&a(c).prop("selected",!0)}),j(b,c,d),k(d),e.val(""),r(c)},v=function(b,c,d,f,h){var i="form-autocomplete-updateajax";M.util.js_pending(i);var j=a(b.currentTarget).val();g[c.selector]=j,h.transport(c.selector,j,function(b){if(g[c.selector]===j){var e=h.processResults(c.selector,b),k=[];if(f.children("option").each(function(b,c){c=a(c),c.prop("selected")?k.push(String(c.attr("value"))):c.remove()}),!c.multiple&&0===f.children("option").length){var l=a("<option>");f.append(l)}a.each(e,function(b,c){if(k.indexOf(String(c.value))===-1){var d=a("<option>");d.append(c.label),d.attr("value",c.value),f.append(d)}}),s(c,d,"",f),M.util.js_complete(i)}},function(a){M.util.js_complete(i),e.exception(a)})},w=function(b,c,d){var e=a(document.getElementById(c.inputId));if(e.on("keydown",function(g){var h="form-autocomplete-addnav-"+c.inputId+"-"+g.keyCode;switch(M.util.js_pending(h),g.keyCode){case f.DOWN:return b.showSuggestions?("true"===e.attr("aria-expanded")?n(c):!e.val()&&b.ajax?require([b.ajax],function(a){v(g,b,c,d,a)}):s(b,c,e.val(),d),g.preventDefault(),M.util.js_complete(h),!1):(M.util.js_complete(h),!0);case f.UP:return q(c),g.preventDefault(),M.util.js_complete(h),!1;case f.ENTER:var i=a(document.getElementById(c.suggestionsId));return"true"===e.attr("aria-expanded")&&i.children("[aria-selected=true]").length>0?u(b,c,d):b.tags&&t(b,c,d),g.preventDefault(),M.util.js_complete(h),!1;case f.ESCAPE:return"true"===e.attr("aria-expanded")&&r(c),g.preventDefault(),M.util.js_complete(h),!1}return M.util.js_complete(h),!0}),e.on("keypress",function(a){var e="form-autocomplete-keypress-"+a.keyCode;return M.util.js_pending(e),a.keyCode===f.COMMA?(b.tags&&t(b,c,d),a.preventDefault(),M.util.js_complete(e),!1):(M.util.js_complete(e),!0)}),e.on("behat:set-value",function(){var f=a(document.getElementById(c.suggestionsId)),g="form-autocomplete-behat";M.util.js_pending(g),"true"===e.attr("aria-expanded")&&f.children("[aria-selected=true]").length>0?u(b,c,d):b.tags&&t(b,c,d),M.util.js_complete(g)}),e.on("blur",function(){var f="form-autocomplete-blur";M.util.js_pending(f),window.setTimeout(function(){var g=a(document.activeElement);g.attr("id")!=e.attr("id")&&(b.tags&&t(b,c,d),r(c)),M.util.js_complete(f)},500)}),b.showSuggestions){var g=a(document.getElementById(c.downArrowId));g.on("click",function(a){var f="form-autocomplete-show-suggestions";M.util.js_pending(f),e.focus(),!e.val()&&b.ajax?require([b.ajax],function(e){v(a,b,c,d,e)}):s(b,c,e.val(),d),M.util.js_complete(f)})}var h=a(document.getElementById(c.suggestionsId));h.parent().on("click","[role=option]",function(e){var f="form-autocomplete-parent";M.util.js_pending(f);var g=a(e.currentTarget).closest("[role=option]"),h=a(document.getElementById(c.suggestionsId)),i=h.children("[aria-hidden=false]").index(g);m(i,c),u(b,c,d),M.util.js_complete(f)});var i=a(document.getElementById(c.selectionId));i.on("click","[role=listitem]",function(e){var f="form-autocomplete-clicks";M.util.js_pending(f);var g=a(e.currentTarget);l(b,c,g,d),M.util.js_complete(f)}),i.on("keydown",function(e){var g="form-autocomplete-keydown-"+e.keyCode;switch(M.util.js_pending(g),e.keyCode){case f.DOWN:return p(c),e.preventDefault(),M.util.js_complete(g),!1;case f.UP:return o(c),e.preventDefault(),M.util.js_complete(g),!1;case f.SPACE:case f.ENTER:var h=a(document.getElementById(c.selectionId)).children("[data-active-selection=true]");return h&&(l(b,c,h,d),e.preventDefault()),M.util.js_complete(g),!1}return M.util.js_complete(g),!0}),b.showSuggestions&&(b.ajax?require([b.ajax],function(a){var f=null,g="autocomplete-throttledhandler",h=function(e){v(e,b,c,d,a),M.util.js_complete(g)},i=function(a){null!==f?(window.clearTimeout(f),f=null):M.util.js_pending(g),f=window.setTimeout(h.bind(this,a),300)};e.on("input",i)}):e.on("input",function(e){var f=a(e.currentTarget).val(),g=a(e.currentTarget).data("last-value");g!==f&&s(b,c,f,d),a(e.currentTarget).data("last-value",f)}))};return{enhance:function(f,g,i,k,l,m,n){var o={selector:f,tags:!1,ajax:!1,placeholder:k,caseSensitive:!1,showSuggestions:!0,noSelectionString:n},p="autocomplete-setup-"+f;M.util.js_pending(p),"undefined"!=typeof g&&(o.tags=g),"undefined"!=typeof i&&(o.ajax=i),"undefined"!=typeof l&&(o.caseSensitive=l),"undefined"!=typeof m&&(o.showSuggestions=m),"undefined"==typeof n&&c.get_string("noselection","form").done(function(a){o.noSelectionString=a}).fail(e.exception);var q=a(f);if(!q)return b.debug("Selector not found: "+f),void M.util.js_complete(p);q.hide().attr("aria-hidden",!0);var r={selectId:q.attr("id"),inputId:"form_autocomplete_input-"+h,suggestionsId:"form_autocomplete_suggestions-"+h,selectionId:"form_autocomplete_selection-"+h,downArrowId:"form_autocomplete_downarrow-"+h};h++,o.multiple=q.attr("multiple");var s=a("[for="+r.selectId+"]"),t=[];q.children("option").each(function(b,c){t[b]={label:c.innerHTML,value:a(c).attr("value")}});var u=a.extend({},o,r);u.options=t,u.items=[];var v=d.render("core/form_autocomplete_input",u),x=d.render("core/form_autocomplete_suggestions",u),y=d.render("core/form_autocomplete_selection",u);a.when(v,x,y).done(function(b,c,d){q.after(c),q.after(b),q.after(d),s.attr("for",r.inputId),w(o,r,q);var e=a(document.getElementById(r.suggestionsId));return e.hide().attr("aria-hidden",!0),j(o,r,q),M.util.js_complete(p),!0}).fail(function(a){M.util.js_complete(p),e.exception(a)})}}});
define('core/notification', ["core/yui","jquery","core/log"],function(a,b,c){var d={types:{success:"core/notification_success",info:"core/notification_info",warning:"core/notification_warning",error:"core/notification_error"},fieldName:"user-notifications",fetchNotifications:function(){require(["core/ajax"],function(a){var b=a.call([{methodname:"core_fetch_notifications",args:{contextid:d.contextid}}]);b[0].done(d.addNotifications)})},addNotifications:function(a){a||(a=[]),b.each(a,function(a,b){d.renderNotification(b.template,b.variables)})},setupTargetRegion:function(){var a=b("#"+d.fieldName);if(a.length)return!1;var c=b("<span>").attr("id",d.fieldName);return a=b("#region-main"),a.length?a.prepend(c):(a=b('[role="main"]'),a.length?a.prepend(c):(a=b("body"),a.prepend(c)))},addNotification:function(a){var c=d.types.error;return a=b.extend({closebutton:!0,announce:!0,type:"error"},a),a.template?(c=a.template,delete a.template):a.type&&("undefined"!=typeof d.types[a.type]&&(c=d.types[a.type]),delete a.type),d.renderNotification(c,a)},renderNotification:function(a,e){return"undefined"!=typeof e.message&&e.message?void require(["core/templates"],function(c){c.render(a,e).done(function(a,e){b("#"+d.fieldName).prepend(a),c.runTemplateJS(e)}).fail(d.exception)}):void c.debug("Notification received without content. Skipping.")},alert:function(b,c,d){a.use("moodle-core-notification-alert",function(){var a=new M.core.alert({title:b,message:c,yesLabel:d});a.show()})},confirm:function(b,c,d,e,f,g){a.use("moodle-core-notification-confirm",function(){var a=new M.core.confirm({title:b,question:c,yesLabel:d,noLabel:e});a.on("complete-yes",function(){f()}),g&&a.on("complete-no",function(){g()}),a.show()})},exception:function(b){if("undefined"==typeof b.stack&&(b.stack=""),b.debuginfo&&(b.stack+=b.debuginfo+"\n"),!b.backtrace&&b.stacktrace&&(b.backtrace=b.stacktrace),b.backtrace){b.stack+=b.backtrace;var c=b.backtrace.match(/line ([^ ]*) of/),d=b.backtrace.match(/ of ([^:]*): /);c&&c[1]&&(b.lineNumber=c[1]),d&&d[1]&&(b.fileName=d[1],b.fileName.length>30&&(b.fileName="..."+b.fileName.substr(b.fileName.length-27)))}"undefined"==typeof b.name&&b.errorcode&&(b.name=b.errorcode),a.use("moodle-core-notification-exception",function(){var a=new M.core.exception(b);a.show()})}};return{init:function(a,b){d.contextid=a,d.setupTargetRegion(),d.addNotifications(b),d.fetchNotifications()},fetchNotifications:d.fetchNotifications,addNotification:d.addNotification,alert:d.alert,confirm:d.confirm,exception:d.exception}});
!function(a,b){"use strict";"function"==typeof define&&define.amd?define('core/loglevel', b):"object"==typeof module&&module.exports?module.exports=b():a.log=b()}(this,function(){"use strict";function a(a){return typeof console!==h&&(void 0!==console[a]?b(console,a):void 0!==console.log?b(console,"log"):g)}function b(a,b){var c=a[b];if("function"==typeof c.bind)return c.bind(a);try{return Function.prototype.bind.call(c,a)}catch(d){return function(){return Function.prototype.apply.apply(c,[a,arguments])}}}function c(a,b,c){return function(){typeof console!==h&&(d.call(this,b,c),this[a].apply(this,arguments))}}function d(a,b){for(var c=0;c<i.length;c++){var d=i[c];this[d]=c<a?g:this.methodFactory(d,a,b)}}function e(b,d,e){return a(b)||c.apply(this,arguments)}function f(a,b,c){function f(a){var b=(i[a]||"silent").toUpperCase();try{return void(window.localStorage[l]=b)}catch(c){}try{window.document.cookie=encodeURIComponent(l)+"="+b+";"}catch(c){}}function g(){var a;try{a=window.localStorage[l]}catch(b){}if(typeof a===h)try{var c=window.document.cookie,d=c.indexOf(encodeURIComponent(l)+"=");d&&(a=/^([^;]+)/.exec(c.slice(d))[1])}catch(b){}return void 0===k.levels[a]&&(a=void 0),a}var j,k=this,l="loglevel";a&&(l+=":"+a),k.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},k.methodFactory=c||e,k.getLevel=function(){return j},k.setLevel=function(b,c){if("string"==typeof b&&void 0!==k.levels[b.toUpperCase()]&&(b=k.levels[b.toUpperCase()]),!("number"==typeof b&&b>=0&&b<=k.levels.SILENT))throw"log.setLevel() called with invalid level: "+b;if(j=b,c!==!1&&f(b),d.call(k,b,a),typeof console===h&&b<k.levels.SILENT)return"No console available for logging"},k.setDefaultLevel=function(a){g()||k.setLevel(a,!1)},k.enableAll=function(a){k.setLevel(k.levels.TRACE,a)},k.disableAll=function(a){k.setLevel(k.levels.SILENT,a)};var m=g();null==m&&(m=null==b?"WARN":b),k.setLevel(m,!1)}var g=function(){},h="undefined",i=["trace","debug","info","warn","error"],j=new f,k={};j.getLogger=function(a){if("string"!=typeof a||""===a)throw new TypeError("You must supply a name when creating a logger.");var b=k[a];return b||(b=k[a]=new f(a,j.getLevel(),j.methodFactory)),b};var l=typeof window!==h?window.log:void 0;return j.noConflict=function(){return typeof window!==h&&window.log===j&&(window.log=l),j},j});
define('core/first', ["core/log"],function(a){a.debug("core/first amd module is obsolete, do not use it any more")});
define('core/event', ["jquery","core/yui"],function(a,b){return{Events:{FORM_FIELD_VALIDATION:"core_form-field-validation"},getLegacyEvents:function(){var c=a.Deferred();return b.use("event","moodle-core-event",function(){c.resolve(window.M.core.event)}),c.promise()},notifyFilterContentUpdated:function(c){c=a(c),b.use("event","moodle-core-event",function(b){a(document).trigger(M.core.event.FILTER_CONTENT_UPDATED,[c]);var d=new b.NodeList(c.get());b.fire(M.core.event.FILTER_CONTENT_UPDATED,{nodes:d})})},notifyEditorContentRestored:function(){b.use("event","moodle-core-event",function(b){a(document).trigger(M.core.event.EDITOR_CONTENT_RESTORED),b.fire(M.core.event.EDITOR_CONTENT_RESTORED)})}}});
define('core_calendar/calendar', [],function(){function a(a){var b,c=a.target.closest('[data-calendar-popover-shown="true"]'),d=0;b=document.querySelectorAll('[data-calendar-popover-shown="true"]');var e=new CustomEvent("core/popover:hide");for(d=0;d<b.length;d++)b[d]!==c&&(b[d].removeAttribute("data-calendar-popover-shown"),b[d].querySelector('[data-component="/core/output/popover"]').parentElement.dispatchEvent(e))}function b(a){var b=a.target.closest(".hasevent, .today");if(b&&"true"!==b.getAttribute("data-calendar-popover-shown")){var c=new CustomEvent("core/popover:show");a.preventDefault(),b.setAttribute("data-calendar-popover-shown",!0),b.querySelector('[data-component="/core/output/popover"]').parentElement.dispatchEvent(c)}}return document.addEventListener("focusin",a),{init:function(){var c=document.querySelectorAll(".minicalendar"),d=0;for(d=0;d<c.length;d++)c[d].addEventListener("mouseover",b),c[d].addEventListener("focusin",b),c[d].addEventListener("mouseout",a)}}});
define('core_form/passwordunmask', ["jquery"],function(a){String.prototype.repeat||(String.prototype.repeat=function(a){"use strict";if(null==this)throw new TypeError("can't convert "+this+" to object");var b=""+this;if(a=+a,a!=a&&(a=0),a<0)throw new RangeError("repeat count must be non-negative");if(a==1/0)throw new RangeError("repeat count must be less than infinity");if(a=Math.floor(a),0==b.length||0==a)return"";if(b.length*a>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var c="";1==(1&a)&&(c+=b),a>>>=1,0!=a;)b+=b;return c});var b=function(b){var c=a("#"+b);this.id=b,this.input=null,this.unmaskinput=null,this.input=c,this.unmaskinput=a("#"+b+"unmask"),this.wrap=this.input.parent(".wrap");var d=a('<input type="text" value="" class="inputmask" />');this.input.attr("readonly")&&d.attr("readonly","readonly"),d.insertBefore("#"+b),this.mask=this.wrap.find(".inputmask"),this.updateMask(),this.mask.focus(function(a){c.focus()}),this.unmaskinput.change(a.proxy(this.unmask,this)),this.input.keyup(a.proxy(this.updateMask,this)),this.input.mouseup()};return b.prototype.toString=function(){return"[object PasswordUnmask]"},b.prototype.updateMask=function(){this.mask.val("●".repeat(this.input.val().length))},b.prototype.unmask=function(){this.unmaskinput.is(":checked")?this.input.parents(".totara_passwordunmask").addClass("unmask-password"):this.input.parents(".totara_passwordunmask").removeClass("unmask-password")},b});
define('core_grades/edittree_index', ["jquery"],function(a){var b=function(){a("body").on("change",".itemselect.ignoredirty",b.checkMoveMenuState),a("body").on("click",'[data-action="grade_edittree-index-bulkselect"]',b.toggleAllSelectItems),a("body").on("change",".weightoverride",b.toggleWeightInput),a("#menumoveafter").on("change",function(){var b=a(this).closest("form"),c=b.find("#bulkmoveinput");c.val(1),b.submit()}),b.checkMoveMenuState()};return b.toggleWeightInput=function(b){b.preventDefault();var c=a(this),d=c.closest("tr");a('input[name="weight_'+d.data("itemid")+'"]').prop("disabled",!c.prop("checked"))},b.toggleAllSelectItems=function(c){c.preventDefault();var d=a(this),e=d.closest("tr");a("."+e.data("category")+" .itemselect").prop("checked",d.data("checked")),b.checkMoveMenuState()},b.getMoveMenu=function(){return a("#menumoveafter")},b.checkMoveMenuState=function(){var c=b.getMoveMenu();if(!c.length)return!1;var d;return a(".itemselect").each(function(){return d=a(this).prop("checked"),!d}),c.prop("disabled",!d),d},{enhance:b}});
define('core_message/message_area_actions', ["core_message/message_area_events"],function(a){function b(a){this.messageArea=a}var c={MESSAGES:"[data-region='messages']"};return b.prototype.messageArea=null,b.prototype.chooseMessagesToDelete=function(){0!==this.messageArea.find(c.MESSAGES).length&&this.messageArea.trigger(a.CHOOSEMESSAGESTODELETE)},b});
define('core_message/message_area_profile', ["jquery","core/ajax","core/templates","core/notification","core/str","core/config","core/custom_interaction_events","core_message/message_area_events"],function(a,b,c,d,e,f,g,h){function i(a){this.messageArea=a,this._init()}var j={PROFILE:"[data-region='profile']",PROFILEADDCONTACT:"[data-action='profile-add-contact']",PROFILEBLOCKCONTACT:"[data-action='profile-block-contact']",PROFILEREMOVECONTACT:"[data-action='profile-remove-contact']",PROFILESENDMESSAGE:"[data-action='profile-send-message']",PROFILEUNBLOCKCONTACT:"[data-action='profile-unblock-contact']",PROFILEVIEW:"[data-action='profile-view']",SHOWCONTACTS:"[data-action='show-contacts']",MESSAGESAREA:"[data-region='messages-area']",MESSAGINGAREA:"[data-region='messaging-area']"};return i.prototype.messageArea=null,i.prototype._init=function(){g.define(this.messageArea.node,[g.events.activate]),this.messageArea.onCustomEvent(h.CONTACTSELECTED,this._viewProfile.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEVIEW,function(a,b){this._viewFullProfile(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILESENDMESSAGE,function(a,b){this._sendMessage(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEUNBLOCKCONTACT,function(a,b){this._unblockContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEBLOCKCONTACT,function(a,b){this._blockContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEADDCONTACT,function(a,b){this._addContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEREMOVECONTACT,function(a,b){this._removeContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.SHOWCONTACTS,this._hideMessagingArea.bind(this))},i.prototype._viewProfile=function(a,f){c.render("core/loading",{}).done(function(a,b){c.replaceNodeContents(this.messageArea.find(j.MESSAGESAREA),a,b)}.bind(this));var g=b.call([{methodname:"core_message_data_for_messagearea_get_profile",args:{currentuserid:this.messageArea.getCurrentUserId(),otheruserid:f}}]);return g[0].then(function(a){return e.get_string("pictureof","core",a.fullname).then(function(b){return a.str_pictureof=b,c.render("core_message/message_area_profile",a)})}).then(function(a,b){c.replaceNodeContents(this.messageArea.find(j.MESSAGESAREA),a,b)}.bind(this)).fail(d.exception)},i.prototype._viewFullProfile=function(){window.location.href=f.wwwroot+"/user/profile.php?id="+this._getUserId()},i.prototype._sendMessage=function(){this.messageArea.trigger(h.SENDMESSAGE,this._getUserId())},i.prototype._blockContact=function(){var a=this._performAction("core_message_block_contacts","unblockcontact","profile-block-contact","profile-unblock-contact","");return a.then(function(){this.messageArea.trigger(h.CONTACTBLOCKED,this._getUserId())}.bind(this))},i.prototype._unblockContact=function(){var a=this._performAction("core_message_unblock_contacts","blockcontact","profile-unblock-contact","profile-block-contact","danger");return a.then(function(){this.messageArea.trigger(h.CONTACTUNBLOCKED,this._getUserId())}.bind(this))},i.prototype._addContact=function(){var a=this._performAction("core_message_create_contacts","removecontact","profile-add-contact","profile-remove-contact","danger");return a.then(function(){this.messageArea.trigger(h.CONTACTADDED,this._getUserId())}.bind(this))},i.prototype._removeContact=function(){var a=this._performAction("core_message_delete_contacts","addcontact","profile-remove-contact","profile-add-contact","");return a.then(function(){this.messageArea.trigger(h.CONTACTREMOVED,this._getUserId())}.bind(this))},i.prototype._performAction=function(a,c,f,g,h){var i=b.call([{methodname:a,args:{userid:this.messageArea.getCurrentUserId(),userids:[this._getUserId()]}}]);return i[0].then(function(){return e.get_string(c,"message")}).then(function(a){this._changeText(a,f,g,h)}.bind(this)).fail(d.exception)},i.prototype._changeText=function(a,b,c,d){var e=this.messageArea.find("[data-action='"+b+"']");e.text(a),e.removeClass(),d&&e.addClass(d),e.attr("data-action",c)},i.prototype._getUserId=function(){return this.messageArea.find(j.PROFILE).data("userid")},i.prototype._hideMessagingArea=function(){this.messageArea.find(j.MESSAGINGAREA).removeClass("show-messages").addClass("hide-messages")},i});
define('core_message/notification_processor', ["jquery"],function(a){var b={STATE_NONE:'[data-state="none"]',STATE_BOTH:'[data-state="both"]',STATE_LOGGED_IN:'[data-state="loggedin"]',STATE_LOGGED_OFF:'[data-state="loggedoff"]'},c=function(b){this.root=a(b)};return c.prototype.getName=function(){return this.root.attr("data-processor-name")},c.prototype.isLoggedInEnabled=function(){var a=this.root.find(b.STATE_NONE).find("input");if(a.prop("checked"))return!1;var c=this.root.find(b.STATE_BOTH).find("input"),d=this.root.find(b.STATE_LOGGED_IN).find("input");return d.prop("checked")||c.prop("checked")},c.prototype.isLoggedOffEnabled=function(){var a=this.root.find(b.STATE_NONE).find("input");if(a.prop("checked"))return!1;var c=this.root.find(b.STATE_BOTH).find("input"),d=this.root.find(b.STATE_LOGGED_OFF).find("input");return d.prop("checked")||c.prop("checked")},c});
define('core_message/message_area_tabs', ["core/custom_interaction_events","core_message/message_area_events"],function(a,b){function c(a){this.messageArea=a,this._init()}var d={ACTIVECONTACTSTAB:"[data-region='contacts-area'] [role='tab'][aria-selected='true']",CONTACTSPANELS:"[data-region='contacts']",VIEWCONTACTS:"[data-action='contacts-view']",VIEWCONVERSATIONS:"[data-action='conversations-view']"};return c.prototype.messageArea=null,c.prototype._init=function(){a.define(this.messageArea.node,[a.events.activate,a.events.up,a.events.down,a.events.next,a.events.previous,a.events.ctrlPageUp,a.events.ctrlPageDown]),this.messageArea.onDelegateEvent(a.events.activate,d.VIEWCONVERSATIONS,this._viewConversations.bind(this)),this.messageArea.onDelegateEvent(a.events.activate,d.VIEWCONTACTS,this._viewContacts.bind(this)),this.messageArea.onDelegateEvent(a.events.up,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.down,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.next,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.previous,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.up,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.down,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.next,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.previous,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.ctrlPageUp,d.CONTACTSPANELS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.ctrlPageDown,d.CONTACTSPANELS,this._toggleTabs.bind(this)),this.messageArea.onCustomEvent(b.MESSAGESENT,function(){this._selectTab(d.VIEWCONVERSATIONS,d.VIEWCONTACTS)}.bind(this))},c.prototype._viewConversations=function(){this.messageArea.trigger(b.CONVERSATIONSSELECTED),this._selectTab(d.VIEWCONVERSATIONS,d.VIEWCONTACTS)},c.prototype._viewContacts=function(){this.messageArea.trigger(b.CONTACTSSELECTED),this._selectTab(d.VIEWCONTACTS,d.VIEWCONVERSATIONS)},c.prototype._selectTab=function(a,b){b=this.messageArea.find(b),b.removeClass("selected"),b.attr("aria-selected","false"),b.attr("tabindex","-1"),a=this.messageArea.find(a),a.addClass("selected"),a.attr("aria-selected","true"),a.attr("tabindex","0")},c.prototype._toggleTabs=function(a,b){var c=this.messageArea.find(d.ACTIVECONTACTSTAB);c.is(d.VIEWCONVERSATIONS)?this._viewContacts():this._viewConversations(),this.messageArea.find(d.ACTIVECONTACTSTAB).focus(),a.preventDefault(),a.stopPropagation(),b.originalEvent.preventDefault(),b.originalEvent.stopPropagation()},c});
define('core_message/notification_preference', ["jquery","core/ajax","core/notification","core_message/notification_processor"],function(a,b,c,d){var e={PROCESSOR:"[data-processor-name]",STATE_INPUTS:"[data-state] input"},f=function(b,c){this.root=a(b),this.userId=c};return f.prototype.getPreferenceKey=function(){return this.root.attr("data-preference-key")},f.prototype.getLoggedInPreferenceKey=function(){return this.getPreferenceKey()+"_loggedin"},f.prototype.getLoggedOffPreferenceKey=function(){return this.getPreferenceKey()+"_loggedoff"},f.prototype.getProcessors=function(){return this.root.find(e.PROCESSOR).map(function(b,c){return new d(a(c))})},f.prototype.startLoading=function(){this.root.addClass("loading"),this.root.find(e.STATE_INPUTS).prop("disabled",!0)},f.prototype.stopLoading=function(){this.root.removeClass("loading"),this.root.find(e.STATE_INPUTS).prop("disabled",!1)},f.prototype.isLoading=function(){return this.root.hasClass("loading")},f.prototype.save=function(){if(this.isLoading())return a.Deferred().resolve();this.startLoading();var d="",e="";this.getProcessors().each(function(a,b){b.isLoggedInEnabled()&&(""===d?d=b.getName():d+=","+b.getName()),b.isLoggedOffEnabled()&&(""===e?e=b.getName():e+=","+b.getName())}),""===d&&(d="none"),""===e&&(e="none");var f={userid:this.userId,preferences:[{type:this.getLoggedInPreferenceKey(),value:d},{type:this.getLoggedOffPreferenceKey(),value:e}]},g={methodname:"core_user_update_user_preferences",args:f};return b.call([g])[0].fail(c.exception).always(function(){this.stopLoading()}.bind(this))},f});
define('core_message/message_preferences', ["jquery","core/ajax","core/notification","core_message/message_notification_preference","core/custom_interaction_events"],function(a,b,c,d,e){var f={PREFERENCE:"[data-state]",PREFERENCES_CONTAINER:'[data-region="preferences-container"]',BLOCK_NON_CONTACTS:'[data-region="block-non-contacts-container"] [data-block-non-contacts]',BLOCK_NON_CONTACTS_CONTAINER:'[data-region="block-non-contacts-container"]'},g=function(b){this.root=a(b),this.userId=this.root.find(f.PREFERENCES_CONTAINER).attr("data-user-id"),this.registerEventListeners()};return g.prototype.preferencesDisabled=function(){return this.root.find(f.PREFERENCES_CONTAINER).hasClass("disabled")},g.prototype.saveBlockNonContactsStatus=function(){var d=this.root.find(f.BLOCK_NON_CONTACTS),e=this.root.find(f.BLOCK_NON_CONTACTS_CONTAINER),g=d.prop("checked");if(e.hasClass("loading"))return a.Deferred().resolve();e.addClass("loading");var h={methodname:"core_user_update_user_preferences",args:{userid:this.userId,preferences:[{type:d.attr("data-preference-key"),value:g?1:0}]}};return b.call([h])[0].fail(c.exception).always(function(){e.removeClass("loading")})},g.prototype.registerEventListeners=function(){e.define(this.root,[e.events.activate]),this.root.on(e.events.activate,f.BLOCK_NON_CONTACTS,function(){this.saveBlockNonContactsStatus()}.bind(this)),this.root.on("change",function(b){if(!this.preferencesDisabled()){var c=a(b.target).closest(f.PREFERENCES_CONTAINER),e=a(b.target).closest(f.PREFERENCE),g=new d(c,this.userId);e.addClass("loading"),g.save().always(function(){e.removeClass("loading")})}}.bind(this))},g});
define('core_message/preferences_processor_form', ["jquery","core/ajax","core/notification","core/custom_interaction_events"],function(a,b,c,d){var e=function(b){this.root=a(b),this.userId=this.root.attr("data-user-id"),this.name=this.root.attr("data-processor-name"),this.root.find("form").on("submit",function(b){b.preventDefault(),this.save().done(function(){a(document).trigger("mpp:formsubmitted")})}.bind(this));var c=this.root.find("[data-cancel-button]");d.define(c,[d.events.activate]),c.on(d.events.activate,function(){a(document).trigger("mpp:formcancelled")})};return e.prototype.startLoading=function(){this.root.addClass("loading")},e.prototype.stopLoading=function(){this.root.removeClass("loading")},e.prototype.isLoading=function(){return this.root.hasClass("loading")},e.prototype.save=function(){if(this.isLoading())return a.Deferred();this.startLoading();var d=this.root.find("form").serializeArray(),e={methodname:"core_message_message_processor_config_form",args:{userid:this.userId,name:this.name,formvalues:d}};return b.call([e])[0].fail(c.exception).always(function(){this.stopLoading()}.bind(this))},e});
define('core_message/dialogue', ["core/yui"],function(a){var b=function(b,c,d,e,f){this.yuiDialogue=null;var g=this;"undefined"==typeof f&&(f=!1),a.use("moodle-core-notification","timers",function(){var h="480px";f&&(h="800px"),g.yuiDialogue=new M.core.dialogue({headerContent:b,bodyContent:c,draggable:!0,visible:!1,center:!0,modal:!0,width:h}),g.yuiDialogue.after("visibleChange",function(b){b.newVal?"undefined"!=typeof d&&a.soon(function(){d(g),g.yuiDialogue.centerDialogue()}):"undefined"!=typeof e&&a.soon(function(){e(g)})}),g.yuiDialogue.show()})};return b.prototype.close=function(){this.yuiDialogue.hide(),this.yuiDialogue.destroy()},b.prototype.getContent=function(){return this.yuiDialogue.bodyNode.getDOMNode()},b});
define('core_message/preferences_notifications_list_controller', ["jquery","core/ajax","core/notification","core/custom_interaction_events","core_message/notification_preference","core_message/notification_processor_settings"],function(a,b,c,d,e,f){var g={DISABLE_NOTIFICATIONS:'[data-region="disable-notification-container"] [data-disable-notifications]',DISABLE_NOTIFICATIONS_CONTAINER:'[data-region="disable-notification-container"]',PREFERENCE:"[data-state]",PREFERENCE_ROW:'[data-region="preference-row"]',PREFERENCE_INPUT:"[data-state] input",PROCESSOR_SETTING:"[data-processor-setting]"},h=function(b){this.root=a(b),this.userId=this.root.attr("data-user-id"),this.registerEventListeners()};return h.prototype.isDisabled=function(){return this.root.hasClass("disabled")},h.prototype.setDisabled=function(){this.root.addClass("disabled"),this.root.find(g.PREFERENCE_INPUT).prop("disabled",!0)},h.prototype.setEnabled=function(){this.root.removeClass("disabled"),this.root.find(g.PREFERENCE_INPUT).prop("disabled",!1)},h.prototype.toggleDisableAllStatus=function(){var d=a(g.DISABLE_NOTIFICATIONS),e=a(g.DISABLE_NOTIFICATIONS_CONTAINER),f=d.prop("checked");if(e.hasClass("loading"))return a.Deferred().resolve();e.addClass("loading");var h={methodname:"core_user_update_user_preferences",args:{userid:this.userId,emailstop:f?1:0}};return b.call([h])[0].done(function(){f?this.setDisabled():this.setEnabled()}.bind(this)).always(function(){e.removeClass("loading")}).fail(c.exception)},h.prototype.registerEventListeners=function(){var b=a(g.DISABLE_NOTIFICATIONS);d.define(this.root,[d.events.activate]),this.root.on("change",function(b){if(!this.isDisabled()){var c=a(b.target).closest(g.PREFERENCE),d=a(b.target).closest(g.PREFERENCE_ROW),f=new e(d,this.userId);c.addClass("loading"),f.save().always(function(){c.removeClass("loading")})}}.bind(this)),this.root.on(d.events.activate,g.PROCESSOR_SETTING,function(b,c){var d=a(b.target).closest(g.PROCESSOR_SETTING),e=new f(d);e.show(),c.originalEvent.preventDefault()}),d.define(b,[d.events.activate]),b.on(d.events.activate,function(){this.toggleDisableAllStatus()}.bind(this))},h});
define('core_message/message_repository', ["jquery","core/ajax","core/notification"],function(a,b,c){var d=function(a){"undefined"==typeof a.limit&&(a.limit=0),"undefined"==typeof a.offset&&(a.offset=0),a.limitfrom=a.offset,a.limitnum=a.limit,delete a.limit,delete a.offset;var d={methodname:"core_message_data_for_messagearea_conversations",args:a},e=b.call([d])[0];return e.fail(c.exception),e},e=function(a){var d={methodname:"core_message_get_unread_conversations_count",args:a},e=b.call([d])[0];return e.fail(c.exception),e},f=function(a){var d={methodname:"core_message_mark_all_messages_as_read",args:a},e=b.call([d])[0];return e.fail(c.exception),e};return{query:d,countUnreadConversations:e,markAllAsRead:f}});
define('core_message/message_notification_preference', ["jquery","core_message/notification_preference"],function(a,b){var c={PREFERENCE_KEY:"[data-preference-key]"},d=function(a,c){b.call(this,a,c)};return d.prototype=Object.create(b.prototype),d.prototype.constructor=d,d.prototype.getPreferenceKey=function(){return this.root.find(c.PREFERENCE_KEY).attr("data-preference-key")},d});
define('core_message/message_area_messages', ["jquery","core/ajax","core/templates","core/notification","core/custom_interaction_events","core/auto_rows","core_message/message_area_actions","core/modal_factory","core/modal_events","core/str","core_message/message_area_events","core/backoff_timer"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){this.messageArea=a,this._init()}var n=500,o=50,p={BLOCKTIME:"[data-region='blocktime']",CANCELDELETEMESSAGES:"[data-action='cancel-delete-messages']",CONTACT:"[data-region='contact']",CONVERSATIONS:"[data-region='contacts'][data-region-content='conversations']",DELETEALLMESSAGES:"[data-action='delete-all-messages']",DELETEMESSAGES:"[data-action='delete-messages']",LOADINGICON:".loading-icon",MESSAGE:"[data-region='message']",MESSAGERESPONSE:"[data-region='response']",MESSAGES:"[data-region='messages']",MESSAGESAREA:"[data-region='messages-area']",MESSAGINGAREA:"[data-region='messaging-area']",SENDMESSAGE:"[data-action='send-message']",SENDMESSAGETEXT:"[data-region='send-message-txt']",SHOWCONTACTS:"[data-action='show-contacts']",STARTDELETEMESSAGES:"[data-action='start-delete-messages']"},q=1e3;return m.prototype._isSendingMessage=!1,m.prototype._isLoadingMessages=!1,m.prototype._numMessagesDisplayed=0,m.prototype._messageQueue=[],m.prototype._numMessagesToRetrieve=20,m.prototype._confirmationModal=null,m.prototype._latestMessageTimestamp=0,m.prototype._backoffTimer=null,m.prototype.messageArea=null,m.prototype._init=function(){e.define(this.messageArea.node,[e.events.activate,e.events.up,e.events.down,e.events.enter]),a(window).height()<=670&&(n=400),f.init(this.messageArea.node),this.messageArea.onCustomEvent(k.CONVERSATIONSELECTED,this._viewMessages.bind(this)),this.messageArea.onCustomEvent(k.SENDMESSAGE,this._viewMessages.bind(this)),this.messageArea.onCustomEvent(k.CHOOSEMESSAGESTODELETE,this._chooseMessagesToDelete.bind(this)),this.messageArea.onCustomEvent(k.CANCELDELETEMESSAGES,this._hideDeleteAction.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.SENDMESSAGE,this._sendMessage.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.STARTDELETEMESSAGES,this._startDeleting.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.DELETEMESSAGES,this._deleteMessages.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.DELETEALLMESSAGES,this._deleteAllMessages.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.CANCELDELETEMESSAGES,this._triggerCancelMessagesToDelete.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.MESSAGE,this._toggleMessage.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.SHOWCONTACTS,this._hideMessagingArea.bind(this)),this.messageArea.onDelegateEvent(e.events.up,p.MESSAGE,this._selectPreviousMessage.bind(this)),this.messageArea.onDelegateEvent(e.events.down,p.MESSAGE,this._selectNextMessage.bind(this)),this.messageArea.onDelegateEvent("focus",p.SENDMESSAGETEXT,this._setMessaging.bind(this)),this.messageArea.onDelegateEvent("blur",p.SENDMESSAGETEXT,this._clearMessaging.bind(this)),a(document).on(f.events.ROW_CHANGE,this._adjustMessagesAreaHeight.bind(this));var b=this.messageArea.find(p.MESSAGES);b.length&&(this._addScrollEventListener(b.find(p.MESSAGE).length),this._latestMessageTimestamp=b.find(p.MESSAGE+":last").data("timecreated")),this._backoffTimer=new l(this._loadNewMessages.bind(this),l.getIncrementalCallback(this.messageArea.pollmin*q,q,this.messageArea.pollmax*q,this.messageArea.polltimeout*q)),this._backoffTimer.start()},m.prototype._viewMessages=function(e,f){this._numMessagesDisplayed=0,this._backoffTimer.stop(),this._latestMessageTimestamp=0;var g=b.call([{methodname:"core_message_mark_all_messages_as_read",args:{useridto:this.messageArea.getCurrentUserId(),useridfrom:f}}]),h=0;return c.render("core/loading",{}).then(function(a,b){return c.replaceNodeContents(this.messageArea.find(p.MESSAGESAREA),a,b),g[0]}.bind(this)).then(function(){var b=this.messageArea.find(p.CONVERSATIONS+" "+p.CONTACT+"[data-userid='"+f+"']");return b.hasClass("unread")&&(b.removeClass("unread"),a(document).trigger("messagearea:conversationselected",f)),this._getMessages(f)}.bind(this)).then(function(a){return h=a.messages.length,c.render("core_message/message_area_messages_area",a)}).then(function(a,b){c.replaceNodeContents(this.messageArea.find(p.MESSAGESAREA),a,b),this._addScrollEventListener(h),this._backoffTimer.restart(),this.messageArea.find(p.SENDMESSAGETEXT).focus()}.bind(this)).fail(d.exception)},m.prototype._loadMessages=function(){if(this._isLoadingMessages)return!1;this._isLoadingMessages=!0;var b=0;return c.render("core/loading",{}).then(function(a,b){return c.prependNodeContents(this.messageArea.find(p.MESSAGES),"<div style='text-align:center'>"+a+"</div>",b),this._getMessages(this._getUserId())}.bind(this)).then(function(a){return b=a.messages.length,c.render("core_message/message_area_messages",a)}).then(function(d,e){if(this.messageArea.find(p.MESSAGES+" "+p.LOADINGICON).remove(),b>0){var f=a("<div>"+d+"</div>");this._hasMatchingBlockTime(this.messageArea.node,f,!0)&&this.messageArea.node.find(p.BLOCKTIME+":first").remove();var g=this.messageArea.find(p.MESSAGES)[0].scrollHeight;c.prependNodeContents(this.messageArea.find(p.MESSAGES),d,e);var h=this.messageArea.find(p.MESSAGES)[0].scrollHeight;this.messageArea.find(p.MESSAGES).scrollTop(h-g),this._numMessagesDisplayed+=b}this._isLoadingMessages=!1}.bind(this)).fail(d.exception)},m.prototype._loadNewMessages=function(){if(this._isLoadingMessages)return!1;if(!this._getUserId())return!1;this._isLoadingMessages=!0;var a=!1,b=this.messageArea.find(p.MESSAGES);if(0!==b.length){var c=b.scrollTop(),e=b.innerHeight(),f=b[0].scrollHeight;c+e>=f&&(a=!0)}return this._getMessages(this._getUserId(),!0).then(function(b){return this._addMessagesToDom(b.messages,a)}.bind(this)).always(function(){this._isLoadingMessages=!1}.bind(this)).fail(d.exception)},m.prototype._getMessages=function(a,c){var e={currentuserid:this.messageArea.getCurrentUserId(),otheruserid:a,limitfrom:this._numMessagesDisplayed,limitnum:this._numMessagesToRetrieve,newest:!0};c&&(e.timefrom=this._latestMessageTimestamp,e.limitfrom=0,e.limitnum=0);var f=b.call([{methodname:"core_message_data_for_messagearea_messages",args:e}]);return f[0].then(function(a){var b=a.messages;if(b&&b.length){var c=b[b.length-1];c.timecreated>this._latestMessageTimestamp&&(this._latestMessageTimestamp=c.timecreated+1)}return a}.bind(this)).fail(function(a){this._backoffTimer.stop(),d.exception(a)}.bind(this))},m.prototype._sendMessage=function(){var a=this.messageArea.find(p.SENDMESSAGETEXT),c=a.val().trim();if(""===c)return!1;if(this._isSendingMessage)return!1;this._isSendingMessage=!0;var e=b.call([{methodname:"core_message_send_instant_messages",args:{messages:[{touserid:this._getUserId(),text:c}]}}]);return a.prop("disabled",!0),e[0].then(function(a){if(a.length<0)throw new Error("Invalid response");if(a[0].errormessage)throw this._isSendingMessage=!1,new Error(a[0].errormessage);return this.messageArea.trigger(k.MESSAGESENT,[this._getUserId(),c]),this._addLastMessageToDom()}.bind(this)).then(function(){this._isSendingMessage=!1}.bind(this)).always(function(){a.prop("disabled",!1),a.focus()}).fail(d.exception)},m.prototype._chooseMessagesToDelete=function(){this.messageArea.find(p.MESSAGESAREA).addClass("editing"),this.messageArea.find(p.MESSAGE).attr("role","checkbox").attr("aria-checked","false")},m.prototype._deleteMessages=function(){var c=this.messageArea.getCurrentUserId(),e=this.messageArea.find(p.MESSAGE+"[aria-checked='true']"),f=[],g=[];e.each(function(b,d){var e=a(d),h=e.data("messageid"),i=e.data("messageread")?1:0;g.push(e),f.push({methodname:"core_message_delete_message",args:{messageid:h,userid:c,read:i}})}),f.length>0?b.call(f)[f.length-1].then(function(){var b=null,c=this.messageArea.find(p.MESSAGE),d=c.last(),e=g[g.length-1];a.each(g,function(a,b){b.remove()}),d.data("id")===e.data("id")&&(b=this.messageArea.find(p.MESSAGE).last()),a.each(g,function(a,b){var c=b.data("blocktime");0===this.messageArea.find(p.MESSAGE+"[data-blocktime='"+c+"']").length&&this.messageArea.find(p.BLOCKTIME+"[data-blocktime='"+c+"']").remove()}.bind(this)),0===this.messageArea.find(p.MESSAGE).length&&this.messageArea.find(p.CONVERSATIONS+" "+p.CONTACT+"[data-userid='"+this._getUserId()+"']").remove(),this.messageArea.trigger(k.MESSAGESDELETED,[this._getUserId(),b])}.bind(this),d.exception):this.messageArea.trigger(k.MESSAGESDELETED,this._getUserId()),this._hideDeleteAction()},m.prototype._addScrollEventListener=function(a){this._scrollBottom(),this._numMessagesDisplayed=a,e.define(this.messageArea.find(p.MESSAGES),[e.events.scrollTop]),this.messageArea.onCustomEvent(e.events.scrollTop,this._loadMessages.bind(this))},m.prototype._deleteAllMessages=function(){this._confirmationModal?this._confirmationModal.show():j.get_strings([{key:"confirm"},{key:"deleteallconfirm",component:"message"}]).done(function(a){h.create({title:a[0],type:h.types.CONFIRM,body:a[1]},this.messageArea.find(p.DELETEALLMESSAGES)).done(function(a){this._confirmationModal=a,a.getRoot().on(i.yes,function(){var a=this._getUserId(),c={methodname:"core_message_delete_conversation",args:{userid:this.messageArea.getCurrentUserId(),otheruserid:a}};b.call([c])[0].then(function(){this.messageArea.find(p.MESSAGESAREA).empty(),this.messageArea.trigger(k.CONVERSATIONDELETED,a),this._hideDeleteAction()}.bind(this),d.exception)}.bind(this)),a.show()}.bind(this))}.bind(this))},m.prototype._hideDeleteAction=function(){this.messageArea.find(p.MESSAGE).removeAttr("role").removeAttr("aria-checked"),this.messageArea.find(p.MESSAGESAREA).removeClass("editing")},m.prototype._triggerCancelMessagesToDelete=function(){this.messageArea.trigger(k.CANCELDELETEMESSAGES)},m.prototype._addMessagesToDom=function(b,d){var e=0,f=this.messageArea.find(p.MESSAGES);return b=b.filter(function(a){var b=""+a.id+a.isread;if(this._messageQueue[b])return!1;var c=f.find(p.MESSAGE+'[data-id="'+b+'"]');return c.length||(this._messageQueue[b]=!0),!c.length}.bind(this)),e=b.length,c.render("core_message/message_area_messages",{messages:b}).then(function(b,f){if(e>0){var g=a("<div>"+b+"</div>");this._hasMatchingBlockTime(this.messageArea.node,g,!1)&&g.find(p.BLOCKTIME+":first").remove(),c.appendNodeContents(this.messageArea.find(p.MESSAGES),g,f),d&&this._scrollBottom(),this._numMessagesDisplayed+=e,this._backoffTimer.restart()}}.bind(this))},m.prototype._addLastMessageToDom=function(){var a=b.call([{methodname:"core_message_data_for_messagearea_get_most_recent_message",args:{currentuserid:this.messageArea.getCurrentUserId(),otheruserid:this._getUserId()}}]);return a[0].then(function(a){return this._addMessagesToDom([a],!0)}.bind(this)).always(function(){this.messageArea.find(p.SENDMESSAGETEXT).val("").trigger("input")}.bind(this)).fail(d.exception)},m.prototype._getUserId=function(){return this.messageArea.find(p.MESSAGES).data("userid")},m.prototype._scrollBottom=function(){var a=this.messageArea.find(p.MESSAGES);0!==a.length&&a.scrollTop(a[0].scrollHeight)},m.prototype._selectPreviousMessage=function(b,c){var d=a(b.target).closest(p.MESSAGE);do d=d.prev();while(d.length&&!d.is(p.MESSAGE));d.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},m.prototype._selectNextMessage=function(b,c){var d=a(b.target).closest(p.MESSAGE);do d=d.next();while(d.length&&!d.is(p.MESSAGE));d.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},m.prototype._setMessaging=function(b){a(b.target).closest(p.MESSAGERESPONSE).addClass("messaging")},m.prototype._clearMessaging=function(b){a(b.target).closest(p.MESSAGERESPONSE).removeClass("messaging")},m.prototype._startDeleting=function(a){var b=new g(this.messageArea);b.chooseMessagesToDelete(),a.preventDefault()},m.prototype._isEditing=function(){return this.messageArea.find(p.MESSAGESAREA).hasClass("editing")},m.prototype._toggleMessage=function(b){if(this._isEditing()){var c=a(b.target).closest(p.MESSAGE);"true"===c.attr("aria-checked")?c.attr("aria-checked","false"):c.attr("aria-checked","true")}},m.prototype._adjustMessagesAreaHeight=function(){var a=this.messageArea.find(p.MESSAGES),b=this.messageArea.find(p.MESSAGERESPONSE),c=b.outerHeight(),d=c-o,e=n-d;a.outerHeight(e)},m.prototype._sendMessageHandler=function(a,b){b.originalEvent.preventDefault(),this._sendMessage()},m.prototype._hideMessagingArea=function(){this.messageArea.find(p.MESSAGINGAREA).removeClass("show-messages").addClass("hide-messages")},m.prototype._hasMatchingBlockTime=function(a,b,c){var d,e,f,g;return c?(e=":first",g=":last"):(e=":last",g=":first"),d=a.find(p.BLOCKTIME+e),f=b.find(p.BLOCKTIME+g),!(!d.length||!f.length)&&d.data("blocktime")==f.data("blocktime")},m});
define('core_message/toggle_contact_button', ["jquery","core/ajax","core/templates","core/notification","core/custom_interaction_events"],function(a,b,c,d,e){var f=function(a){return"1"==a.attr("data-is-contact")},g=function(a){a.attr("data-is-contact","1")},h=function(a){a.attr("data-is-contact","0")},i=function(a){return a.attr("data-userid")},j=function(a){return a.hasClass("loading")||a.attr("disabled")},k=function(c,e){return j(c)?a.Deferred():(c.addClass("loading"),c.attr("disabled","disabled"),b.call([e])[0].fail(d.exception).always(function(){c.removeClass("loading"),c.removeAttr("disabled")}))},l=function(a){if(!j(a)){var b={methodname:"core_message_create_contacts",args:{userids:[i(a)]}};k(a,b).done(function(){g(a),c.render("message/remove_contact_button",{}).done(function(b,d){c.replaceNodeContents(a,b,d)})})}},m=function(a){if(!j(a)){var b={methodname:"core_message_delete_contacts",args:{userids:[i(a)]}};k(a,b).done(function(){h(a),c.render("message/add_contact_button",{}).done(function(b,d){c.replaceNodeContents(a,b,d)})})}},n=function(b){b=a(b),b.children(".loading-icon").length||c.render("core/loading",{}).done(function(a,c){b.append(a,c)}),e.define(b,[e.events.activate]),b.on(e.events.activate,function(a,c){f(b)?m(b):l(b),a.preventDefault(),c.originalEvent.preventDefault()})};return{enhance:n}});
define('core_message/message_area_events', [],function(){return{CANCELDELETEMESSAGES:"cancel-delete-messages",CHOOSEMESSAGESTODELETE:"choose-messages-to-delete",CONTACTADDED:"contact-added",CONTACTBLOCKED:"contact-blocked",CONTACTREMOVED:"contact-removed",CONTACTSELECTED:"contact-selected",CONTACTSSELECTED:"contacts-selected",CONTACTUNBLOCKED:"contact-unblocked",CONVERSATIONDELETED:"conversation-deleted",CONVERSATIONSELECTED:"conversation-selected",CONVERSATIONSSELECTED:"conversations-selected",MESSAGESDELETED:"messages-deleted",MESSAGESEARCHCANCELED:"message-search-canceled",MESSAGESENT:"message-sent",SENDMESSAGE:"message-send",USERSSEARCHCANCELED:"users-search-canceled"}});
define('core_message/message_area_search', ["jquery","core/ajax","core/templates","core/notification","core/str","core/custom_interaction_events","core_message/message_area_events"],function(a,b,c,d,e,f,g){function h(a){this.messageArea=a,this._init()}var i={CONTACTS:"[data-region='contacts'][data-region-content='contacts']",CONTACTSAREA:"[data-region='contacts-area']",CONVERSATIONS:"[data-region='contacts'][data-region-content='conversations']",DELETESEARCHFILTER:"[data-region='search-filter-area']",LOADINGICON:".loading-icon",SEARCHBOX:"[data-region='search-box']",SEARCHFILTER:"[data-region='search-filter']",SEARCHFILTERAREA:"[data-region='search-filter-area']",SEARCHRESULTSAREA:"[data-region='search-results-area']",SEARCHTEXTAREA:"[data-region='search-text-area']",SEARCHUSERSINCOURSE:"[data-action='search-users-in-course']"};return h.prototype.messageArea=null,h.prototype._searchArea=null,h.prototype._courseid=null,h.prototype._isLoading=!1,h.prototype._numMessagesDisplayed=0,h.prototype._numMessagesToRetrieve=20,h.prototype._numUsersDisplayed=0,h.prototype._numUsersToRetrieve=20,h.prototype._searchAreas={MESSAGES:"messages",USERS:"users",USERSINCOURSE:"usersincourse"},h.prototype._requestTimeout=null,h.prototype._init=function(){this.messageArea.find(i.SEARCHTEXTAREA).on("input",this._searchRequest.bind(this)),this.messageArea.onDelegateEvent(f.events.activate,i.SEARCHUSERSINCOURSE,function(b){this._setFilter(a(b.currentTarget).html()),this._setPlaceholderText("searchforuser"),this._clearSearchArea(),this._searchArea=this._searchAreas.USERSINCOURSE,this._courseid=a(b.currentTarget).data("courseid"),this._searchUsersInCourse(),this.messageArea.find(i.SEARCHBOX).focus()}.bind(this)),this.messageArea.onDelegateEvent(f.events.activate,i.DELETESEARCHFILTER,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.USERS,this._setPlaceholderText("searchforuserorcourse"),this.messageArea.trigger(g.USERSSEARCHCANCELED),this.messageArea.find(i.SEARCHBOX).focus()}.bind(this)),this.messageArea.onCustomEvent(g.CONVERSATIONSSELECTED,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.MESSAGES,this._setPlaceholderText("searchmessages")}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTSSELECTED,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.USERS,this._setPlaceholderText("searchforuserorcourse")}.bind(this)),this.messageArea.onCustomEvent(g.MESSAGESENT,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.MESSAGES,this._setPlaceholderText("searchmessages")}.bind(this)),f.define(this.messageArea.find(i.SEARCHRESULTSAREA),[f.events.scrollBottom]),this.messageArea.onDelegateEvent(f.events.scrollBottom,i.SEARCHRESULTSAREA,function(){this._searchArea==this._searchAreas.MESSAGES?this._searchMessages():this._searchArea==this._searchAreas.USERSINCOURSE&&this._searchUsersInCourse()}.bind(this)),this._searchArea=this.messageArea.showContactsFirst()?this._searchAreas.USERS:this._searchAreas.MESSAGES},h.prototype._searchRequest=function(){var a=this.messageArea.find(i.SEARCHTEXTAREA+" input").val();return this._requestTimeout&&clearTimeout(this._requestTimeout),""===a.trim()?void(this._searchArea==this._searchAreas.MESSAGES?(this._hideSearchResults(),this.messageArea.trigger(g.MESSAGESEARCHCANCELED)):this._searchArea==this._searchAreas.USERS?(this._hideSearchResults(),this.messageArea.trigger(g.USERSSEARCHCANCELED)):this._searchArea==this._searchAreas.USERSINCOURSE&&(this._clearSearchArea(),this._searchUsersInCourse())):(this.messageArea.find(i.CONVERSATIONS).hide(),this.messageArea.find(i.CONTACTS).hide(),this.messageArea.find(i.SEARCHRESULTSAREA).show(),void(this._searchArea==this._searchAreas.MESSAGES?this._requestTimeout=setTimeout(function(){this._clearSearchArea(),this._numMessagesDisplayed=0,this._searchMessages()}.bind(this),300):this._searchArea==this._searchAreas.USERSINCOURSE?this._requestTimeout=setTimeout(function(){this._clearSearchArea(),this._numUsersDisplayed=0,this._searchUsersInCourse()}.bind(this),300):this._requestTimeout=setTimeout(function(){this._clearSearchArea(),this._numUsersDisplayed=0,this._searchUsers()}.bind(this),300)))},h.prototype._searchMessages=function(){if(this._isLoading)return!1;var a=this.messageArea.find(i.SEARCHBOX).val();this._isLoading=!0;var e=b.call([{methodname:"core_message_data_for_messagearea_search_messages",args:{userid:this.messageArea.getCurrentUserId(),search:a,limitfrom:this._numMessagesDisplayed,limitnum:this._numMessagesToRetrieve}}]),f=0;return c.render("core/loading",{}).then(function(a,b){return c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),"<div style='text-align:center'>"+a+"</div>",b),e[0]}.bind(this)).then(function(a){return f=a.contacts.length,c.render("core_message/message_area_message_search_results",a)}).then(function(a,b){this.messageArea.find(i.SEARCHRESULTSAREA+" "+i.LOADINGICON).remove(),f>0?(c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._numMessagesDisplayed+=f):0==this._numMessagesDisplayed&&c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._isLoading=!1}.bind(this)).fail(d.exception)},h.prototype._searchUsers=function(){var a=this.messageArea.find(i.SEARCHBOX).val(),e=b.call([{methodname:"core_message_data_for_messagearea_search_users",args:{userid:this.messageArea.getCurrentUserId(),search:a,limitnum:this._numUsersToRetrieve}}]);return c.render("core/loading",{}).then(function(a,b){return c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),"<div style='text-align:center'>"+a+"</div>",b),e[0]}.bind(this)).then(function(a){return a.contacts.length>0&&(a.hascontacts=!0),a.courses.length>0&&(a.hascourses=!0),a.noncontacts.length>0&&(a.hasnoncontacts=!0),c.render("core_message/message_area_user_search_results",a)}).then(function(a,b){c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b)}.bind(this)).fail(d.exception)},h.prototype._searchUsersInCourse=function(){if(this._isLoading)return!1;var a=this.messageArea.find(i.SEARCHBOX).val();this._isLoading=!0;var e=b.call([{methodname:"core_message_data_for_messagearea_search_users_in_course",args:{userid:this.messageArea.getCurrentUserId(),courseid:this._courseid,search:a,limitfrom:this._numUsersDisplayed,limitnum:this._numUsersToRetrieve}}]),f=0;return c.render("core/loading",{}).then(function(a,b){return c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),"<div style='text-align:center'>"+a+"</div>",b),e[0]}.bind(this)).then(function(a){return f=a.contacts.length,f>0&&(a.hascontacts=!0),c.render("core_message/message_area_user_search_results",a)}).then(function(a,b){this.messageArea.find(i.SEARCHRESULTSAREA+" "+i.LOADINGICON).remove(),f>0?(c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._numUsersDisplayed+=f):0==this._numUsersDisplayed&&c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._isLoading=!1}.bind(this)).fail(d.exception)},h.prototype._setPlaceholderText=function(a){return e.get_string(a,"message").then(function(a){this.messageArea.find(i.SEARCHTEXTAREA+" input").attr("placeholder",a)}.bind(this))},h.prototype._setFilter=function(a){this.messageArea.find(i.SEARCHBOX).val(""),this.messageArea.find(i.CONTACTSAREA).addClass("searchfilter"),this.messageArea.find(i.SEARCHFILTERAREA).show(),this.messageArea.find(i.SEARCHFILTER).html(a),e.get_string("removecoursefilter","message",a).then(function(a){this.messageArea.find(i.SEARCHFILTERAREA).attr("aria-label",a)}.bind(this))},h.prototype._clearFilters=function(){this.messageArea.find(i.CONTACTSAREA).removeClass("searchfilter"),this.messageArea.find(i.SEARCHFILTER).empty(),this.messageArea.find(i.SEARCHFILTERAREA).hide(),this.messageArea.find(i.SEARCHFILTERAREA).removeAttr("aria-label")},h.prototype._clearSearchArea=function(){this.messageArea.find(i.SEARCHRESULTSAREA).empty()},h.prototype._hideSearchResults=function(){this._clearFilters(),this.messageArea.find(i.SEARCHTEXTAREA+" input").val(""),this._clearSearchArea(),this.messageArea.find(i.SEARCHRESULTSAREA).hide()},h});
define('core_message/message_area', ["jquery","core_message/message_area_contacts","core_message/message_area_messages","core_message/message_area_profile","core_message/message_area_tabs","core_message/message_area_search"],function(a,b,c,d,e,f){function g(b,c,d,e){this.node=a(b),this.pollmin=c,this.pollmax=d,this.polltimeout=e,this._init()}return g.prototype.node=null,g.prototype.pollmin=null,g.prototype.pollmax=null,g.prototype.polltimeout=null,g.prototype._init=function(){new b(this),new c(this),new d(this),new e(this),new f(this)},g.prototype.onDelegateEvent=function(a,b,c){this.node.on(a,b,c)},g.prototype.onCustomEvent=function(a,b){this.node.on(a,b)},g.prototype.trigger=function(a,b){"undefined"==typeof b&&(b=""),this.node.trigger(a,b)},g.prototype.find=function(a){return this.node.find(a)},g.prototype.getCurrentUserId=function(){return this.node.data("userid")},g.prototype.showContactsFirst=function(){return!!this.node.data("displaycontacts")},g});
define('core_message/message_area_contacts', ["jquery","core/ajax","core/templates","core/notification","core/custom_interaction_events","core/str","core_message/message_area_events"],function(a,b,c,d,e,f,g){function h(a){this.messageArea=a,this._init()}var i={CONTACT:"[data-region='contact']",CONTACTICONBLOCKED:"[data-region='contact-icon-blocked']",CONTACTS:"[data-region='contacts'][data-region-content='contacts']",CONTACTSAREA:"[data-region='contacts-area']",CONVERSATIONS:"[data-region='contacts'][data-region-content='conversations']",COURSE:"[data-region='course']",LASTMESSAGETEXT:"[data-region='last-message-text']",LASTMESSAGEUSER:"[data-region='last-message-user']",LOADINGICON:".loading-icon",MESSAGETEXT:"[data-region='message-text']",MESSAGINGAREA:"[data-region='messaging-area']",NOCONTACTS:"[data-region=no-contacts]",SEARCHBOX:"[data-region='search-box']",SEARCHRESULTSAREA:"[data-region='search-results-area']",SEARCHTEXTAREA:"[data-region='search-text-area']",SELECTEDVIEWCONVERSATION:"[data-action='view-contact-msg'].selected",SELECTEDVIEWPROFILE:"[data-action='view-contact-profile'].selected",SHOWMESSAGES:"[data-action='show-messages']",VIEWCONVERSATION:"[data-action='view-contact-msg']",VIEWPROFILE:"[data-action='view-contact-profile']"};return h.prototype._isLoadingConversations=!1,h.prototype._isLoadingContacts=!1,h.prototype._numContactsDisplayed=0,h.prototype._numContactsToRetrieve=20,h.prototype._numConversationsDisplayed=0,h.prototype._numConversationsToRetrieve=20,h.prototype._messageLength=60,h.prototype.messageArea=null,h.prototype._init=function(){e.define(this.messageArea.node,[e.events.activate,e.events.down,e.events.up]),this.messageArea.onCustomEvent(g.MESSAGESEARCHCANCELED,this._viewConversations.bind(this)),this.messageArea.onCustomEvent(g.USERSSEARCHCANCELED,this._viewContacts.bind(this)),this.messageArea.onCustomEvent(g.CONTACTSSELECTED,this._viewContacts.bind(this)),this.messageArea.onCustomEvent(g.CONVERSATIONDELETED,this._deleteConversation.bind(this)),this.messageArea.onCustomEvent(g.CONVERSATIONSSELECTED,this._viewConversations.bind(this)),this.messageArea.onCustomEvent(g.CONTACTSSELECTED,this._viewContacts.bind(this)),this.messageArea.onCustomEvent(g.MESSAGESDELETED,this._updateLastMessage.bind(this)),this.messageArea.onCustomEvent(g.MESSAGESENT,this._handleMessageSent.bind(this)),this.messageArea.onCustomEvent(g.CONTACTREMOVED,function(a,b){this._removeContact(i.CONTACTS,b)}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTADDED,function(a,b){this._addContact(b)}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTBLOCKED,function(a,b){this._blockContact(b)}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTUNBLOCKED,function(a,b){this._unblockContact(b)}.bind(this)),this.messageArea.onCustomEvent(g.CHOOSEMESSAGESTODELETE,this._startDeleting.bind(this)),this.messageArea.onCustomEvent(g.CANCELDELETEMESSAGES,this._stopDeleting.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,i.VIEWCONVERSATION,this._viewConversation.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,i.VIEWPROFILE,this._viewContact.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,i.SHOWMESSAGES,this._showMessagingArea.bind(this)),this.messageArea.onDelegateEvent(e.events.up,i.CONTACT,this._selectPreviousContact.bind(this)),this.messageArea.onDelegateEvent(e.events.down,i.CONTACT,this._selectNextContact.bind(this)),this.messageArea.onDelegateEvent(e.events.up,i.VIEWCONVERSATION,this._selectPreviousConversation.bind(this)),this.messageArea.onDelegateEvent(e.events.down,i.VIEWCONVERSATION,this._selectNextConversation.bind(this)),this.messageArea.onDelegateEvent(e.events.up,i.COURSE,this._selectPreviousCourse.bind()),this.messageArea.onDelegateEvent(e.events.down,i.COURSE,this._selectNextCourse.bind()),this.messageArea.onDelegateEvent("focus",i.SEARCHBOX,this._setSearching.bind(this)),this.messageArea.onDelegateEvent("blur",i.SEARCHBOX,this._clearSearching.bind(this)),e.define(this.messageArea.find(i.CONVERSATIONS),[e.events.scrollBottom]),e.define(this.messageArea.find(i.CONTACTS),[e.events.scrollBottom]),this.messageArea.onDelegateEvent(e.events.scrollBottom,i.CONVERSATIONS,this._loadConversations.bind(this)),this.messageArea.onDelegateEvent(e.events.scrollBottom,i.CONTACTS,this._loadContacts.bind(this)),this.messageArea.showContactsFirst()||(this._numConversationsDisplayed=20)},h.prototype._startDeleting=function(){this.messageArea.find(i.CONTACTSAREA).addClass("editing")},h.prototype._stopDeleting=function(){this.messageArea.find(i.CONTACTSAREA).removeClass("editing")},h.prototype._viewConversations=function(){0===this._numConversationsDisplayed&&this._loadConversations(),this.messageArea.find(i.CONTACTS).hide(),this.messageArea.find(i.CONVERSATIONS).show()},h.prototype._viewContacts=function(){0===this._numContactsDisplayed&&this._loadContacts(),this.messageArea.find(i.CONVERSATIONS).hide(),this.messageArea.find(i.CONTACTS).show()},h.prototype._handleMessageSent=function(a,b,c){this._viewConversations();var d=this._getUserNode(i.CONVERSATIONS,b);if(0===d.length){var e=this._getUserNode(i.CONTACTS,b);if(0===e.length&&(e=this._getUserNode(i.SEARCHRESULTSAREA,b)),0==e.length)return;d=e.clone(),d.attr("data-action","view-contact-msg"),this.messageArea.find(i.CONVERSATIONS+" "+i.NOCONTACTS).remove(),this._numConversationsDisplayed++}d.prependTo(this.messageArea.find(i.CONVERSATIONS)),this.messageArea.find(i.CONVERSATIONS).scrollTop(0),this._updateContactText(d,c,!0),this._setSelectedUser("[data-userid='"+b+"']")},h.prototype._loadConversations=function(){if(this._isLoadingConversations)return!1;this._isLoadingConversations=!0;var a=0;return c.render("core/loading",{}).then(function(a,b){return this._numConversationsDisplayed?c.appendNodeContents(this.messageArea.find(i.CONVERSATIONS),"<div style='text-align:center'>"+a+"</div>",b):c.replaceNodeContents(this.messageArea.find(i.CONVERSATIONS),"<div style='text-align:center'>"+a+"</div>",b),this._getItems("core_message_data_for_messagearea_conversations",this._numConversationsDisplayed,this._numConversationsToRetrieve)}.bind(this)).then(function(b){return a=b.contacts.length,b.isconversation=!0,c.render("core_message/message_area_contacts",b)}).then(function(b,d){this.messageArea.find(i.CONVERSATIONS+" "+i.LOADINGICON).remove(),a>0?(c.appendNodeContents(this.messageArea.find(i.CONVERSATIONS),b,d),this._numConversationsDisplayed+=this._numConversationsToRetrieve):this._numConversationsDisplayed||c.replaceNodeContents(this.messageArea.find(i.CONVERSATIONS),b,d),this._isLoadingConversations=!1}.bind(this)).fail(d.exception)},h.prototype._loadContacts=function(){if(this._isLoadingContacts)return!1;this._isLoadingContacts=!0;var a=0;return c.render("core/loading",{}).then(function(a,b){return this._numContactsDisplayed?c.appendNodeContents(this.messageArea.find(i.CONTACTS),"<div style='text-align:center'>"+a+"</div>",b):c.replaceNodeContents(this.messageArea.find(i.CONTACTS),"<div style='text-align:center'>"+a+"</div>",b),this._getItems("core_message_data_for_messagearea_contacts",this._numContactsDisplayed,this._numContactsToRetrieve)}.bind(this)).then(function(b){return a=b.contacts.length,b.isconversation=!1,c.render("core_message/message_area_contacts",b)}).then(function(b,d){this.messageArea.find(i.CONTACTS+" "+i.LOADINGICON).remove(),a>0?(c.appendNodeContents(this.messageArea.find(i.CONTACTS),b,d),this._numContactsDisplayed+=a):this._numContactsDisplayed||c.replaceNodeContents(this.messageArea.find(i.CONTACTS),b,d),this._isLoadingContacts=!1}.bind(this)).fail(d.exception)},h.prototype._viewConversation=function(b){this.messageArea.trigger(g.CANCELDELETEMESSAGES);var c=a(b.currentTarget).data("userid"),d=a(b.currentTarget).data("messageid"),e="[data-userid='"+c+"']";d&&(e="[data-messageid='"+d+"']"),this._setSelectedUser(e),this.messageArea.trigger(g.CONVERSATIONSELECTED,c),this.messageArea.find(i.SELECTEDVIEWPROFILE).removeClass("selected"),this._showMessagingArea()},h.prototype._viewContact=function(b){this.messageArea.trigger(g.CANCELDELETEMESSAGES);var c=a(b.currentTarget).data("userid");this._setSelectedUser("[data-userid='"+c+"']"),this.messageArea.trigger(g.CONTACTSELECTED,c),this.messageArea.find(i.SELECTEDVIEWCONVERSATION).removeClass("selected"),this._showMessagingArea()},h.prototype._getItems=function(a,c,d){var e=b.call([{methodname:a,args:{userid:this.messageArea.getCurrentUserId(),limitfrom:c,limitnum:d}}]);return e[0]},h.prototype._deleteConversation=function(a,b){this._removeContact(i.CONVERSATIONS,b),this._numConversationsDisplayed--,this._hideMessagingArea(),this._stopDeleting()},h.prototype._updateLastMessage=function(a,b,c){if(c){var d=this._getUserNode(i.CONVERSATIONS,b),e=c.find(i.MESSAGETEXT).text().trim(),f=!1;c.data("useridto")==b&&(f=!0),this._updateContactText(d,e,f)}this._stopDeleting()},h.prototype._addContact=function(){this.messageArea.find(i.CONTACTS).empty(),this._numContactsDisplayed=0,this._loadContacts()},h.prototype._removeContact=function(a,b){this._getUserNode(a,b).remove(),this._numContactsDisplayed--},h.prototype._blockContact=function(a){var b=this._getUserNode(i.CONTACTS,a);b.find(i.CONTACTICONBLOCKED).removeClass("hidden"),b=this._getUserNode(i.CONVERSATIONS,a),b.find(i.CONTACTICONBLOCKED).removeClass("hidden"),b=this._getUserNode(i.SEARCHRESULTSAREA,a),b.find(i.CONTACTICONBLOCKED).removeClass("hidden")},h.prototype._unblockContact=function(a){var b=this._getUserNode(i.CONTACTS,a);b.find(i.CONTACTICONBLOCKED).addClass("hidden"),b=this._getUserNode(i.CONVERSATIONS,a),b.find(i.CONTACTICONBLOCKED).addClass("hidden"),b=this._getUserNode(i.SEARCHRESULTSAREA,a),b.find(i.CONTACTICONBLOCKED).addClass("hidden")},h.prototype._getUserNode=function(a,b){return this.messageArea.find(a+" "+i.CONTACT+"[data-userid='"+b+"']")},h.prototype._setSelectedUser=function(a){this.messageArea.find(i.CONTACT).removeClass("selected"),this.messageArea.find(i.CONTACT).attr("aria-pressed",!1),this.messageArea.find(i.CONTACT+a).addClass("selected"),this.messageArea.find(i.CONTACT+a).attr("aria-pressed",!0)},h.prototype._getContactText=function(b){return b=a(document.createElement("div")).html(b).text(),b.length>this._messageLength&&(b=b.substr(0,this._messageLength-3),b+="..."),b},h.prototype._updateContactText=function(a,b,c){b=this._getContactText(b),c?f.get_string("you","message",b).done(function(b){a.find(i.LASTMESSAGEUSER).empty().append(b)}):(a.find(i.LASTMESSAGEUSER).empty(),a.find(i.LASTMESSAGETEXT).empty().append(b))},h.prototype._selectNextContact=function(b,c){var d=a(b.target).closest(i.CONTACT),e=d.next();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectPreviousContact=function(b,c){var d=a(b.target).closest(i.CONTACT),e=d.prev();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectNextCourse=function(b,c){var d=a(b.target).closest(i.COURSE);d.next().focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectPreviousCourse=function(b,c){var d=a(b.target).closest(i.COURSE);d.prev().focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectNextConversation=function(b,c){var d=a(b.target).closest(i.VIEWCONVERSATION),e=d.next();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectPreviousConversation=function(b,c){var d=a(b.target).closest(i.VIEWCONVERSATION),e=d.prev();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._setSearching=function(){a(i.SEARCHTEXTAREA).addClass("searching")},h.prototype._clearSearching=function(){a(i.SEARCHTEXTAREA).removeClass("searching")},h.prototype._showMessagingArea=function(){this.messageArea.find(i.MESSAGINGAREA).removeClass("hide-messages").addClass("show-messages")},h.prototype._hideMessagingArea=function(){this.messageArea.find(i.MESSAGINGAREA).removeClass("show-messages").addClass("hide-messages")},h});
define('core_message/notification_processor_settings', ["jquery","core/ajax","core/notification","core/fragment","core/templates","core/str","core_message/dialogue"],function(a,b,c,d,e,f,g){var h={PROCESSOR:"[data-processor-name]",PREFERENCE_ROW:'[data-region="preference-row"]'},i=function(b){this.root=a(b),this.name=this.root.attr("data-name"),this.userId=this.root.attr("data-user-id"),this.contextId=this.root.attr("data-context-id")};return i.prototype.show=function(){d.loadFragment("message","processor_settings",this.contextId,{userid:this.userId,type:this.name}).done(function(b,c){f.get_string("processorsettings","message").done(function(d){var f=new g(d,b,function(){e.runTemplateJS(c)},function(){f.close()});a(document).on("mpp:formsubmitted",function(){f.close(),this.updateConfiguredStatus()}.bind(this)),a(document).on("mpp:formcancelled",function(){f.close()})}.bind(this))}.bind(this))},i.prototype.updateConfiguredStatus=function(){var d=this.root.closest(h.PROCESSOR);if(!d.hasClass("unconfigured"))return!1;var e=d.attr("data-processor-name"),f={methodname:"core_message_get_message_processor",args:{name:e,userid:this.userId}};return b.call([f])[0].fail(c.exception).done(function(b){if(b.userconfigured){var c=a(h.PREFERENCE_ROW+' [data-processor-name="'+e+'"]');d.removeClass("unconfigured"),c.removeClass("disabled")}})},i});
define('core_elementlibrary/competency_item', ["core/config","core/str"],function(a,b){var c={id:0,init:function(){var d=a.wwwroot+"/totara/hierarchy/prefix/competency/related/",e=[];e.push({key:"save",component:"totara_core"}),e.push({key:"cancel",component:"moodle"}),e.push({key:"assignrelatedcompetencies",component:"totara_hierarchy"}),b.get_strings(e).done(function(a){for(var b=[],f=0;f<e.length;f++)b[e[f].key]=a[f];var g=new totaraDialog_handler_treeview_multiselect,h={};h[b.save]=function(){g._dialog.hide()},h[b.cancel]=function(){g._cancel()},totaraDialogs[name]=new totaraDialog("related","show-related-dialog",{buttons:h,title:"<h2>"+b.assignrelatedcompetencies+"</h2>"},d+"find.php?id="+c.id,g)})}};return c});
define('core_elementlibrary/pattern_library', ["jquery","core_elementlibrary/animate_scroll"],function(a){return{init:function(){a('.pattern-library__nav a, a[href^="#"]').animateScroll(),a(".nav-tabs li a").on("click",function(a){a.preventDefault()})}}});
define('core_elementlibrary/animate_scroll', ["jquery","core/log"],function(a,b){a.fn.animateScroll=function(c){c=a.extend({},a.fn.animateScroll.defaults,c);var d=a("html, body"),e=this.filter('a[href^="#"][href!="#"]');return e.on("click.animateScroll",function(e){e.preventDefault();var f=e.target.getAttribute("href"),g=a(f);if(g.length<1)return void b.debug("elementlibrary/pattern_library: Scroll target '"+f+"' not found in document");var h=g.first().offset().top+"px";d.stop().animate({"scroll-top":h},c.duration,c.easing)}),this},a.fn.animateScroll.defaults={duration:500,easing:"swing"}});
define('availability_audience/ajax_handler', ["jquery","core/config"],function(a,b){var c={};return{processResults:function(a,b){return b},transport:function(d,e,f,g){function h(){for(var a,b=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),c=0;c<b.length;c++)if(a=b[c].split("="),"course"===a[0])return a[1];return null}if(""!==e.trim()){var i=h();void 0===c[e]&&(c[e]=a.ajax({url:b.wwwroot+"/availability/condition/audience/ajax.php",type:"POST",data:{filter:e,course:i}})),c[e].done(function(a){f(a)}).fail(g)}}}});
define('availability_hierarchy_organisation/ajax_handler', ["jquery","core/config"],function(a,b){var c={};return{processResults:function(a,b){return b},transport:function(b,d,e,f){""!==d.trim()&&(void 0===c[d]&&(c[d]=a.ajax({url:M.cfg.wwwroot+"/availability/condition/hierarchy_organisation/ajax.php",type:"POST",data:{filter:d}})),c[d].done(function(a){e(a)}).fail(f))}}});
define('availability_hierarchy_position/ajax_handler', ["jquery","core/config"],function(a,b){var c={};return{processResults:function(a,b){return b},transport:function(b,d,e,f){""!==d.trim()&&(void 0===c[d]&&(c[d]=a.ajax({url:M.cfg.wwwroot+"/availability/condition/hierarchy_position/ajax.php",type:"POST",data:{filter:d}})),c[d].done(function(a){e(a)}).fail(f))}}});
define('mod_assign/grading_navigation_user_info', ["jquery","core/notification","core/ajax","core/templates"],function(a,b,c,d){var e=function(b){this._regionSelector=b,this._region=a(b),this._userCache={},a(document).on("user-changed",this._refreshUserInfo.bind(this))};return e.prototype._regionSelector=null,e.prototype._userCache=null,e.prototype._region=null,e.prototype._lastUserId=0,e.prototype._getAssignmentId=function(){return this._region.attr("data-assignmentid")},e.prototype._refreshUserInfo=function(e,f){var g=a.Deferred();this._lastUserId!=f&&(this._lastUserId=f,d.render("mod_assign/loading",{}).done(function(e,h){if(this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,e,h),this._region.fadeIn("fast")}.bind(this)),f<0)return void d.render("mod_assign/grading_navigation_no_users",{}).done(function(a,b){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b),this._region.fadeIn("fast")}.bind(this))}.bind(this)).fail(b.exception);if("undefined"!=typeof this._userCache[f])g.resolve(this._userCache[f]);else{var i=this._getAssignmentId(),j=c.call([{methodname:"mod_assign_get_participant",args:{userid:f,assignid:i,embeduser:!0}}]);j[0].done(function(a){a.hasOwnProperty("id")?(this._userCache[f]=a,g.resolve(this._userCache[f])):g.reject("No users")}.bind(this)).fail(b.exception)}g.done(function(c){var e=a("[data-showuseridentity]").data("showuseridentity").split(","),f=[];c.courseid=a('[data-region="grading-navigation-panel"]').attr("data-courseid"),c.user&&(a.each(e,function(a,b){"undefined"!=typeof c.user[b]&&""!==c.user[b]&&(c.hasidentity=!0,f.push(c.user[b]))}),c.identity=f.join(", "),c.user.profileimageurl&&(c.profileimageurl=c.user.profileimageurl)),d.render("mod_assign/grading_navigation_user_summary",c).done(function(a,b){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b),this._region.fadeIn("fast")}.bind(this))}.bind(this)).fail(b.exception)}.bind(this)).fail(function(){d.render("mod_assign/grading_navigation_no_users",{}).done(function(a,b){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b),this._region.fadeIn("fast")}.bind(this))}.bind(this)).fail(b.exception)}.bind(this))}.bind(this)).fail(b.exception))},e});
define('mod_assign/grading_form_change_checker', ["jquery"],function(a){return{saveFormState:function(b){a(b).trigger("save-form-state");var c=a(b).serialize();a(b).data("saved-form-state",c)},checkFormForChanges:function(b){a(b).trigger("save-form-state");var c=a(b).serialize(),d=a(b).data("saved-form-state");return"undefined"!=typeof d&&d!=c}}});
define('mod_assign/grading_actions', ["jquery","mod_assign/grading_events"],function(a,b){var c=function(b){this._regionSelector=b,this._region=a(b),this.registerEventListeners()};return c.prototype._regionSelector=null,c.prototype._lastUserId=0,c.prototype._region=null,c.prototype._showActionsForm=function(a,b){var c=this._region.find("[data-region=grading-actions-form]");b!=this._lastUserId&&b>0&&(this._lastUserId=b),b>0?c.removeClass("hide"):c.addClass("hide")},c.prototype._trigger=function(b){a(document).trigger(b)},c.prototype.getReviewPanelElement=function(){return a('[data-region="review-panel"]')},c.prototype.hasReviewPanelElement=function(){return this.getReviewPanelElement().length>0},c.prototype.getCollapseGradePanelButton=function(){return a('[data-region="grade-actions"] .collapse-grade-panel')},c.prototype.getCollapseReviewPanelButton=function(){return a('[data-region="grade-actions"] .collapse-review-panel')},c.prototype.getExpandAllPanelsButton=function(){return a('[data-region="grade-actions"] .collapse-none')},c.prototype.resetLayoutButtons=function(){this.getCollapseGradePanelButton().removeClass("active"),this.getCollapseReviewPanelButton().removeClass("active"),this.getExpandAllPanelsButton().removeClass("active")},c.prototype.collapseReviewPanel=function(){a(document).trigger(b.COLLAPSE_REVIEW_PANEL),a(document).trigger(b.EXPAND_GRADE_PANEL),this.resetLayoutButtons(),this.getCollapseReviewPanelButton().addClass("active")},c.prototype.collapseGradePanel=function(){a(document).trigger(b.COLLAPSE_GRADE_PANEL),a(document).trigger(b.EXPAND_REVIEW_PANEL),this.resetLayoutButtons(),this.getCollapseGradePanelButton().addClass("active")},c.prototype.expandAllPanels=function(){a(document).trigger(b.EXPAND_GRADE_PANEL),a(document).trigger(b.EXPAND_REVIEW_PANEL),this.resetLayoutButtons(),this.getExpandAllPanelsButton().addClass("active")},c.prototype.registerEventListeners=function(){if(this.hasReviewPanelElement()){var b=this.getCollapseReviewPanelButton();b.click(function(a){this.collapseReviewPanel(),a.preventDefault()}.bind(this)),b.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.collapseReviewPanel(),a.preventDefault())}.bind(this));var c=this.getCollapseGradePanelButton();c.click(function(a){this.collapseGradePanel(),a.preventDefault()}.bind(this)),c.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.collapseGradePanel(),a.preventDefault())}.bind(this));var d=this.getExpandAllPanelsButton();d.click(function(a){this.expandAllPanels(),a.preventDefault()}.bind(this)),d.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.expandAllPanels(),a.preventDefault())}.bind(this))}a(document).on("user-changed",this._showActionsForm.bind(this)),this._region.find('[name="savechanges"]').on("click",this._trigger.bind(this,"save-changes")),this._region.find('[name="resetbutton"]').on("click",this._trigger.bind(this,"reset")),this._region.find("form").on("submit",function(a){a.preventDefault()})},c});
define('mod_assign/grading_panel', ["jquery","core/yui","core/notification","core/templates","core/fragment","core/ajax","core/str","mod_assign/grading_form_change_checker","mod_assign/grading_events"],function(a,b,c,d,e,f,g,h,i){var j=function(b){this._regionSelector=b,this._region=a(b),this._userCache=[],this.registerEventListeners()};return j.prototype._regionSelector=null,j.prototype._lastUserId=0,j.prototype._lastAttemptNumber=-1,j.prototype._region=null,j.prototype._niceReplaceNodeContents=function(b,c,e){var f=a.Deferred();return b.fadeOut("fast",function(){d.replaceNodeContents(b,c,e),b.fadeIn("fast",function(){f.resolve()})}),f.promise()},j.prototype._saveFormState=function(){var b=a('[data-region="grading-actions-form"] [name="sendstudentnotifications"]').prop("checked");a('.gradeform [name="sendstudentnotifications"]').val(b)},j.prototype._submitForm=function(b,d){var e=a(this._region.find("form.gradeform"));a('[data-region="overlay"]').show(),e.trigger("save-form-state");var g=e.serialize(),h=this._region.attr("data-assignmentid");f.call([{methodname:"mod_assign_submit_grading_form",args:{assignmentid:h,userid:this._lastUserId,jsonformdata:JSON.stringify(g)},done:this._handleFormSubmissionResponse.bind(this,g,d),fail:c.exception}])},j.prototype._handleFormSubmissionResponse=function(d,e,f){"undefined"==typeof e&&(e=this._lastUserId),f.length?a(document).trigger("reset",[this._lastUserId,d]):(g.get_strings([{key:"changessaved",component:"core"},{key:"gradechangessaveddetail",component:"mod_assign"}]).done(function(a){c.alert(a[0],a[1])}).fail(c.exception),b.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()}),e==this._lastUserId?a(document).trigger("reset",e):a(document).trigger("user-changed",e)),a('[data-region="overlay"]').hide()},j.prototype._resetForm=function(b,c,d){var e=a.Event("custom");"undefined"==typeof c&&(c=this._lastUserId),this._lastUserId=0,this._refreshGradingPanel(e,c,d)},j.prototype._chooseAttempt=function(b){var d=a(b.target),e=d.data("submissions"),f=a(document.getElementById(e)),h=f.clone(),i=h.wrap(a("<form/>")).html();g.get_strings([{key:"viewadifferentattempt",component:"mod_assign"},{key:"view",component:"core"},{key:"cancel",component:"core"}]).done(function(b){c.confirm(b[0],i,b[1],b[2],function(){var b=a("input:radio[name='select-attemptnumber']:checked").val();this._refreshGradingPanel(null,this._lastUserId,"",b)}.bind(this))}.bind(this)).fail(c.exception)},j.prototype._addPopoutButtons=function(b){var e=a(b);d.render("mod_assign/popout_button",{}).done(function(a){var b=e.find('[data-fieldtype="filemanager"],[data-fieldtype="editor"],[data-fieldtype="grading"]').closest(".fitem");b.addClass("has-popout").find("label").parent().append(a),e.on("click",'[data-region="popout-button"]',this._togglePopout.bind(this))}.bind(this)).fail(c.exception)},j.prototype._togglePopout=function(b){b.preventDefault();var c=a(b.target).closest(".fitem");c.hasClass("popout")?a(".popout").removeClass("popout"):(a(".popout").removeClass("popout"),c.addClass("popout"),c.addClass("moodle-has-zindex"))},j.prototype._refreshGradingPanel=function(b,f,g,i){var j=this._region.attr("data-contextid");"undefined"==typeof g&&(g=""),"undefined"==typeof i&&(i=-1),this._lastUserId==f&&this._lastAttemptNumber==i&&""===g||(this._lastUserId=f,this._lastAttemptNumber=i,a(document).trigger("start-loading-user"),window.M.util.js_pending("mod-assign-loading-user"),d.render("mod_assign/loading",{}).done(function(b,d){this._niceReplaceNodeContents(this._region,b,d).done(function(){if(f>0){this._region.show();var b={userid:f,attemptnumber:i,jsonformdata:JSON.stringify(g)};e.loadFragment("mod_assign","gradingpanel",j,b).done(function(b,d){this._niceReplaceNodeContents(this._region,b,d).done(function(){h.saveFormState('[data-region="grade-panel"] .gradeform'),a(document).on("editor-content-restored",function(){h.saveFormState('[data-region="grade-panel"] .gradeform')}),a('[data-region="attempt-chooser"]').on("click",this._chooseAttempt.bind(this)),this._addPopoutButtons('[data-region="grade-panel"] .gradeform'),a(document).trigger("finish-loading-user"),window.M.util.js_complete("mod-assign-loading-user")}.bind(this)).fail(c.exception)}.bind(this)).fail(c.exception),a('[data-region="review-panel"]').show()}else this._region.hide(),a('[data-region="review-panel"]').hide(),a(document).trigger("finish-loading-user"),window.M.util.js_complete("mod-assign-loading-user")}.bind(this))}.bind(this)).fail(c.exception))},j.prototype.getPanelElement=function(){return a('[data-region="grade-panel"]')},j.prototype.collapsePanel=function(){this.getPanelElement().addClass("collapsed")},j.prototype.expandPanel=function(){this.getPanelElement().removeClass("collapsed")},j.prototype.registerEventListeners=function(){var b=a(document),c=a(this._region);c.on("submit","form",function(a){a.preventDefault()}),b.on("user-changed",this._refreshGradingPanel.bind(this)),b.on("save-changes",this._submitForm.bind(this)),b.on("reset",this._resetForm.bind(this)),b.on("save-form-state",this._saveFormState.bind(this)),b.on(i.COLLAPSE_GRADE_PANEL,function(){this.collapsePanel()}.bind(this)),b.on(i.COLLAPSE_REVIEW_PANEL,function(){this.expandPanel()}.bind(this)),b.on(i.EXPAND_GRADE_PANEL,function(){this.expandPanel()}.bind(this))},j});
define('mod_assign/grading_navigation', ["jquery","core/notification","core/str","core/form-autocomplete","core/ajax","mod_assign/grading_form_change_checker"],function(a,b,c,d,e,f){var g=function(e){this._regionSelector=e,this._region=a(e),this._filters=[],this._users=[],this._filteredUsers=[],this._loadAllUsers(),this._region.find('[data-action="previous-user"]').on("click",this._handlePreviousUser.bind(this)),this._region.find('[data-action="next-user"]').on("click",this._handleNextUser.bind(this)),this._region.find('[data-action="change-user"]').on("change",this._handleChangeUser.bind(this)),this._region.find('[data-region="user-filters"]').on("click",this._toggleExpandFilters.bind(this)),a(document).on("user-changed",this._refreshSelector.bind(this));var f=this._region.find('[data-region="user-filters"]'),g=a(document.getElementById(f.attr("aria-controls")));g.on("change",'[type="checkbox"]',this._filterChanged.bind(this));var h=a('[data-region="grading-navigation-panel"]').data("first-userid");h&&this._selectUserById(h),c.get_string("changeuser","mod_assign").done(function(a){d.enhance("[data-action=change-user]",!1,"mod_assign/participant_selector",a)}).fail(b.exception),a(document).on("start-loading-user",function(){this._isLoading=!0}.bind(this)),a(document).on("finish-loading-user",function(){this._isLoading=!1}.bind(this))};return g.prototype._isLoading=!1,g.prototype._regionSelector=null,g.prototype._filters=null,g.prototype._users=null,g.prototype._region=null,g.prototype._loadAllUsers=function(){var a=this._region.find("[data-action=change-user]"),c=a.attr("data-assignmentid"),d=a.attr("data-groupid");e.call([{methodname:"mod_assign_list_participants",args:{assignid:c,groupid:d,filter:"",onlyids:!0},done:this._usersLoaded.bind(this),fail:b.exception}])},g.prototype._usersLoaded=function(b){if(this._filteredUsers=this._users=b,this._users.length){var c=this._region.find('[data-region="user-filters"]'),d=a(document.getElementById(c.attr("aria-controls")));d.find('[type="checkbox"]').trigger("change")}else this._selectNoUser()},g.prototype._checkClickOutsideConfigureFilters=function(b){var c=this._region.find('[data-region="configure-filters"]');if(!c.is(b.target)&&0===c.has(b.target).length){var d=this._region.find('[data-region="user-filters"]');c.hide(),c.attr("aria-hidden","true"),d.attr("aria-expanded","false"),a(document).off("click.mod_assign_grading_navigation")}},g.prototype._filterChanged=function(d){var e=a(d.target).attr("name"),f=e.split("_").pop(),g=a(d.target).prop("checked");if(g)this._filters.indexOf(f)==-1&&(this._filters[this._filters.length]=f);else{var h=this._filters.indexOf(f);h!=-1&&this._filters.splice(h,1)}var i=[];this._region.find('[data-region="configure-filters"]').find('[type="checkbox"]').each(function(b,c){a(c).prop("checked")&&(i[i.length]=a(c).closest("label").text())}),i.length?this._region.find('[data-region="user-filters"] span.accesshide').text(i.join(", ")):c.get_string("nofilters","mod_assign").done(function(a){this._region.find('[data-region="user-filters"] span.accesshide').text(a)}.bind(this)).fail(b.exception);var j=this._region.find("[data-action=change-user]"),k=j.attr("data-selected"),l=0;this._filteredUsers=[],a.each(this._users,function(b,c){var d=!0;a.each(this._filters,function(a,b){"submitted"==b?"0"==c.submitted&&(d=!1):"notsubmitted"==b?"1"==c.submitted&&(d=!1):"requiregrading"==b?"0"==c.requiregrading&&(d=!1):"grantedextension"==b&&"0"==c.grantedextension&&(d=!1)}),d&&(this._filteredUsers[this._filteredUsers.length]=c,k==c.id&&(l=this._filteredUsers.length-1))}.bind(this)),this._filteredUsers.length?this._selectUserById(this._filteredUsers[l].id):this._selectNoUser()},g.prototype._selectNoUser=function(){this._isLoading||(f.checkFormForChanges('[data-region="grade-panel"] .gradeform')?c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",-1)})}):a(document).trigger("user-changed",-1))},g.prototype._selectUserById=function(d){var e=this._region.find("[data-action=change-user]"),g=parseInt(d,10);this._isLoading||(f.checkFormForChanges('[data-region="grade-panel"] .gradeform')?c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",g)})}):(e.attr("data-selected",d),!isNaN(g)&&g>0&&a(document).trigger("user-changed",d)))},g.prototype._toggleExpandFilters=function(b){b.preventDefault();var c=a(b.target).closest('[data-region="user-filters"]'),d="true"==c.attr("aria-expanded"),e=a(document.getElementById(c.attr("aria-controls")));d?(e.hide(),e.attr("aria-hidden","true"),c.attr("aria-expanded","false"),a(document).off("click.mod_assign_grading_navigation")):(e.css("display","inline-block"),e.attr("aria-hidden","false"),c.attr("aria-expanded","true"),b.stopPropagation(),a(document).on("click.mod_assign_grading_navigation",this._checkClickOutsideConfigureFilters.bind(this)))},g.prototype._handlePreviousUser=function(a){a.preventDefault();var b=this._region.find("[data-action=change-user]"),c=b.attr("data-selected"),d=0,e=0;for(d=0;d<this._filteredUsers.length;d++)if(this._filteredUsers[d].id==c){e=d;break}var f=this._filteredUsers.length,g=e-1;g<0&&(g=f-1),f&&this._selectUserById(this._filteredUsers[g].id)},g.prototype._handleNextUser=function(a){a.preventDefault();var b=this._region.find("[data-action=change-user]"),c=b.attr("data-selected"),d=0,e=0;for(d=0;d<this._filteredUsers.length;d++)if(this._filteredUsers[d].id==c){e=d;break}var f=this._filteredUsers.length,g=(e+1)%f;f&&this._selectUserById(this._filteredUsers[g].id)},g.prototype._refreshCount=function(){var a=this._region.find("[data-action=change-user]"),d=a.attr("data-selected"),e=0,f=0;if(isNaN(d)||d<=0)this._region.find('[data-region="user-count"]').hide();else{for(this._region.find('[data-region="user-count"]').show(),e=0;e<this._filteredUsers.length;e++)if(this._filteredUsers[e].id==d){f=e;break}var g=this._filteredUsers.length;g&&(f+=1);var h={x:f,y:g};c.get_string("xofy","mod_assign",h).done(function(a){this._region.find('[data-region="user-count-summary"]').text(a)}.bind(this)).fail(b.exception)}},g.prototype._refreshSelector=function(a,b){var c=this._region.find("[data-action=change-user]");b=parseInt(b,10),!isNaN(b)&&b>0&&c.attr("data-selected",b),this._refreshCount()},g.prototype._handleChangeUser=function(){var d=this._region.find("[data-action=change-user]"),e=parseInt(d.val(),10);this._isLoading||(f.checkFormForChanges('[data-region="grade-panel"] .gradeform')?c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",e)})}):!isNaN(e)&&e>0&&(d.attr("data-selected",e),a(document).trigger("user-changed",e)))},g});
define('mod_assign/grading_events', function(){return{COLLAPSE_REVIEW_PANEL:"grading:collapse-review-panel",EXPAND_REVIEW_PANEL:"grading:expand-review-panel",COLLAPSE_GRADE_PANEL:"grading:collapse-grade-panel",EXPAND_GRADE_PANEL:"grading:expand-grade-panel"}});
define('mod_assign/participant_selector', ["core/ajax","jquery","core/templates"],function(a,b,c){return{processResults:function(a,b){return b},transport:function(d,e,f,g){var h=b(d).attr("data-assignmentid"),i=b(d).attr("data-groupid"),j=b('[data-region="configure-filters"] input[type="checkbox"]'),k=[];j.each(function(a,c){k[b(c).attr("name")]=b(c).prop("checked")}),a.call([{methodname:"mod_assign_list_participants",args:{assignid:h,groupid:i,filter:e,limit:30,includeenrolments:!1}}])[0].then(function(a){var d=[],e=b("[data-showuseridentity]").data("showuseridentity").split(",");return b.each(a,function(a,f){var g=f,h=[],i=!0;k.filter_submitted&&!f.submitted&&(i=!1),k.filter_notsubmitted&&f.submitted&&(i=!1),k.filter_requiregrading&&!f.requiregrading&&(i=!1),k.filter_grantedextension&&!f.grantedextension&&(i=!1),i&&(b.each(e,function(a,b){"undefined"!=typeof f[b]&&""!==f[b]&&(g.hasidentity=!0,h.push(f[b]))}),g.identity=h.join(", "),d.push(c.render("mod_assign/list_participant_user_summary",g).then(function(a){return{value:f.id,label:a}})))}),b.when.apply(b,d)}).then(function(){var a=[];arguments[0]&&(a=Array.prototype.slice.call(arguments)),f(a)})["catch"](g)}}});
define('mod_assign/grading_review_panel', ["jquery","mod_assign/grading_events"],function(a,b){var c=function(){this._region=a('[data-region="review-panel-content"]'),this.registerEventListeners()};return c.prototype._region=null,c.prototype.getReviewPanel=function(a){var b=this._region.data("panel-owner");return"undefined"==typeof b&&this._region.data("review-panel-plugin",a),this._region.data("review-panel-plugin")==a&&this._region[0]},c.prototype.getTogglePanelButton=function(){return this.getPanelElement().find('[data-region="review-panel-toggle"]')},c.prototype.getPanelElement=function(){return a('[data-region="review-panel"]')},c.prototype.getPanelContentElement=function(){return a('[data-region="review-panel-content"]')},c.prototype.togglePanel=function(){this.getPanelElement().hasClass("collapsed")?a(document).trigger(b.EXPAND_REVIEW_PANEL):a(document).trigger(b.COLLAPSE_REVIEW_PANEL)},c.prototype.collapsePanel=function(){this.getPanelElement().addClass("collapsed").removeClass("grade-panel-collapsed"),this.getPanelContentElement().attr("aria-hidden",!0)},c.prototype.expandPanel=function(){this.getPanelElement().removeClass("collapsed"),this.getPanelContentElement().removeAttr("aria-hidden")},c.prototype.registerEventListeners=function(){var c=this.getTogglePanelButton();c.click(function(a){this.togglePanel(),a.preventDefault()}.bind(this)),c.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.togglePanel(),a.preventDefault())}.bind(this));var d=a(document);d.on(b.COLLAPSE_REVIEW_PANEL,function(){this.collapsePanel()}.bind(this)),d.on(b.COLLAPSE_GRADE_PANEL,function(){this.expandPanel(),this.getPanelElement().addClass("grade-panel-collapsed")}.bind(this)),d.on(b.EXPAND_REVIEW_PANEL,function(){this.expandPanel()}.bind(this)),d.on(b.EXPAND_GRADE_PANEL,function(){this.getPanelElement().removeClass("grade-panel-collapsed")}.bind(this))},c});
define('mod_choice/select_all_choices', [],function(){return{init:function(){for(var a=document.querySelectorAll(".path-mod-choice .selectallnone a"),b=function(a){a.preventDefault();var b,c=document.getElementById("attemptsform").querySelectorAll("input[type=checkbox]");b=!!a.target.classList.contains("mod_choice-selectall");for(var d=0;d<c.length;d++)c[d].checked=b},c=0;c<a.length;c++)a[c].addEventListener("click",b)}}});
define('mod_facetoface/user_conflicts_confirm', ["jquery","core/modal_factory","core/modal_events","core/str"],function(a,b,c,d){var e={init:function(b){var c=a("#mform_seminar_event");void 0!==b&&b.length&&e.overrideUserConflictsModalForm(c,b)},overrideUserConflictsModalForm:function(e,f){var g=[{key:"savewithuserconflicts_header",component:"facetoface"},{key:"savewithuserconflicts",component:"facetoface"},{key:"cancel",component:"moodle"}];d.get_strings(g).then(function(d){var g=d[0],h=d[1],i=d[2];return b.create({title:g,body:f,type:b.types.CONFIRM},void 0,{yesstr:h,nostr:i}).then(function(b){b.show(),b.getRoot().on(c.yes,function(){var b=e.attr("action")+"?savewithconflicts=1";e.attr("action",b),a("#id_submitbutton").trigger("click")})})})}};return e});
define('mod_facetoface/attendees_addremove', ["jquery","core/str","core/config"],function(a,b,c){var d={init:function(b){var c=a("a.viewbulkresults:first");c.length>0&&d.setupResultsDialog(c,b.s,b.listid),a("#add").click(function(b){b.preventDefault();var c=a("#addselect").find("option:selected");c.each(function(b,c){var d=0;a("#removeselect option").length&&a("#removeselect option").each(function(b,e){a(e).data("idx")<a(c).data("idx")&&(d=a(e).data("idx"))}),d>0?a(c).insertAfter(a("#removeselect option[data-idx="+d+"]")):a("#removeselect").append(c)})}),a("#remove").click(function(b){b.preventDefault();var c=a("#removeselect").find("option:selected");c.each(function(b,c){var d=0;a("#addselect option").length&&a("#addselect option").each(function(b,e){a(e).data("idx")<a(c).data("idx")&&(d=a(e).data("idx"))}),d>0?a(c).insertAfter(a("#addselect option[data-idx="+d+"]")):a("#addselect").append(c)})}),a("#interested").click(function(){a("form#assignform").submit()}),a("#searchtext, #searchtoremovetext").focus(function(){a("#add").attr("disabled","disabled"),a("#remove").attr("disabled","disabled")}),a("#removeselect").focus(function(){a("#add").attr("disabled","disabled"),a("#remove").removeAttr("disabled")}),a("#addselect").focus(function(){a("#add").removeAttr("disabled"),a("#remove").attr("disabled","disabled")}),a("#assignform").submit(function(){a("#removeselect option").each(function(){a(this).prop("disabled")?a(this).prop("selected",!1):a(this).prop("selected",!0)})}),a("#searchtoremovetext").on("keyup keypress blur change",function(){var b=a("#searchtoremovetext").val();b.length>0?(a("#searchtoremovereset").show(),a("#removeselect option").each(function(c,d){var e=a(d);e.text().search(b)!==-1?e.show():e.hide()})):(a("#searchtoremovereset").hide(),a("#removeselect option").show())}),a("#searchtoremovereset").click(function(b){b.preventDefault(),a("#searchtoremovetext").val(""),a("#searchtoremovetext").trigger("change")})},setupResultsDialog:function(a,d,e){a.attr("id","viewbulkresults");var f=[];f.push({key:"bulkaddattendeesresults",component:"facetoface"}),f.push({key:"closebuttontitle",component:"moodle"}),b.get_strings(f).done(function(a){var b=function(){for(var b=new totaraDialog_handler,g=[],h=0;h<f.length;h++)g[f[h].key]=a[h];var i="bulkaddvalidation",j={};j[g.closebuttontitle]=function(){b._cancel()},totaraDialogs[i]=new totaraDialog(i,"viewbulkresults",{title:"<h2>"+g.bulkaddattendeesresults+"</h2>",buttons:j},c.wwwroot+"/mod/facetoface/attendees/ajax/bulk_add.php?s="+d+"&listid="+e,b)};window.dialogsInited?b():(window.dialoginits=window.dialoginits||[],window.dialoginits.push(b))})}};return d});
define('mod_facetoface/attendees_addconfirm', ["jquery","core/yui","core/str","core/config"],function(a,b,c,d){var e={init:function(b){this.attachCustomClickEvents=function(){a("a.attendee-edit-job-assignment").on("click",function(){return a.get(a(this).attr("href"),function(a){e.editJobAssignmentModalForm(a)}),!1})},this.attachCustomClickEvents()},editJobAssignmentModalForm:function(c){b.use("panel",function(b){var d=new b.Panel({headerContent:null,bodyContent:c,width:600,zIndex:5,centered:!0,modal:!0,render:!0}),e=a("#"+d.get("id"));e.find('input[type="text"]').eq(0).focus(),e.find("#id_submitbutton").on("click",function(){var b=e.find("form.mform"),c=b.serialize();return c+="&submitbutton="+a(this).attr("value"),a.post(b.attr("action"),c).done(function(b){if("success"==b.result){var c="#jobassign"+b.id;a(c).html(b.jobassignmentdisplayname),d.destroy(!0)}else a("#attendee_job_assignment_err").text(b.error)}),!1}),e.find("#id_cancel").on("click",function(){return d.destroy(!0),!1}),d.show()})}};return e});
define('mod_feedback/edit', ["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){var e={deleteItem:function(b){b.preventDefault(),c.get_strings([{key:"confirmation",component:"admin"},{key:"confirmdeleteitem",component:"mod_feedback"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],a.proxy(function(){window.location=a(this).attr("href")},b.currentTarget))})},setup:function(){a("body").delegate('[data-action="delete"]',"click",e.deleteItem)}};return{setup:e.setup}});
define('mod_forum/post', ["jquery","core/notification","core/str"],function(a,b,c){var d={confirm:function(d){d.preventDefault(),c.get_strings([{key:"confirm",component:"moodle"},{key:"postingwillunlock",component:"mod_forum"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],a.proxy(function(){window.onbeforeunload=null,a("#mformforum").submit()}))})},setup:function(){a("body").delegate("#mformforum #id_submitbutton","click",d.confirm)}};return{setup:d.setup}});
define('mod_forum/big_search_form', [],function(){return{init:function(){var a=document.getElementById("searchform"),b=function(b,c){for(var d=a.querySelectorAll("select[name^="+b+"]"),e=0;e<d.length;e++)d[e].disabled=c;for(var f=a.querySelectorAll("input[name^="+b+"]"),g=c?1:0,h=0;h<f.length;h++)f[h].value=g};b("from",!a.querySelector("input[name='timefromrestrict']").checked),b("to",!a.querySelector("input[name='timetorestrict']").checked),a.addEventListener("click",function(a){a.target.matches("input[name='timefromrestrict']")?b("from",!a.target.checked):a.target.matches("input[name='timetorestrict']")&&b("to",!a.target.checked)})}}});
define('mod_lti/form-field', ["jquery"],function(a){var b=function(a,b,c,d){this.name=a,this.id="id_"+this.name,this.selector="#"+this.id,this.type=b,this.resetIfUndefined=c,this.defaultValue=d};return b.TYPES={TEXT:1,SELECT:2,CHECKBOX:3,EDITOR:4},b.prototype.setFieldValue=function(c){if(null===c){if(!this.resetIfUndefined)return;c=this.defaultValue}switch(this.type){case b.TYPES.CHECKBOX:c?a(this.selector).prop("checked",!0):a(this.selector).prop("checked",!1);break;case b.TYPES.EDITOR:if("undefined"!==a.type(c.text)){var d=a(this.selector+"editable");d.length&&d.html(c.text),a(this.selector).val(c.text)}break;default:a(this.selector).val(c)}},b});
define('mod_lti/tool_configure_controller', ["jquery","core/ajax","core/notification","core/templates","mod_lti/events","mod_lti/keys","mod_lti/tool_type","mod_lti/tool_proxy","core/str"],function(a,b,c,d,e,f,g,h,i){var j={EXTERNAL_REGISTRATION_CONTAINER:"#external-registration-container",EXTERNAL_REGISTRATION_PAGE_CONTAINER:"#external-registration-page-container",CARTRIDGE_REGISTRATION_CONTAINER:"#cartridge-registration-container",CARTRIDGE_REGISTRATION_FORM:"#cartridge-registration-form",ADD_TOOL_FORM:"#add-tool-form",TOOL_LIST_CONTAINER:"#tool-list-container",TOOL_CREATE_BUTTON:"#tool-create-button",REGISTRATION_CHOICE_CONTAINER:"#registration-choice-container",TOOL_URL:"#tool-url"},k=function(){return a(j.TOOL_CREATE_BUTTON)},l=function(){return a(j.TOOL_LIST_CONTAINER)},m=function(){return a(j.EXTERNAL_REGISTRATION_CONTAINER)},n=function(){return a(j.CARTRIDGE_REGISTRATION_CONTAINER)},o=function(){return a(j.REGISTRATION_CHOICE_CONTAINER)},p=function(){return a(j.TOOL_URL).val()},q=function(){m().addClass("hidden")},r=function(){n().addClass("hidden")},s=function(){o().addClass("hidden")},t=function(){r(),s(),m().removeClass("hidden"),w(m())},u=function(a){q(),s(),n().removeClass("hidden"),n().find(j.CARTRIDGE_REGISTRATION_FORM).attr("data-cartridge-url",a),w(n())},v=function(){q(),r(),o().removeClass("hidden"),w(o())},w=function(a){var b=a.children().detach();b.appendTo(a)},x=function(){l().addClass("hidden")},y=function(){l().removeClass("hidden")},z=function(a){var b=a.error?"error":"success";c.addNotification({message:a.message,type:b})},A=function(a){a.addClass("loading")},B=function(a){a.removeClass("loading")},C=function(){var b=a.Deferred(),e=l();A(e),a.when(g.query(),h.query({orphanedonly:!0})).done(function(a,c){var f=[];a.map(function(a,b){var c={key:"toolisbeingused",component:"mod_lti",param:a.instancecount};f.push(c)}),c.map(function(a,b){var c={key:"toolisbeingused",component:"mod_lti",param:a.instancecount};f.push(c)}),i.get_strings(f).then(function(b){var e=0;return a.map(function(c,d){a[d].toolusedcountstr=b[e],e++}),c.map(function(a,d){c[d].toolusedcountstr=b[e],e++}),d.render("mod_lti/tool_list",{tools:a,proxies:c})}).then(function(a,c){e.empty(),e.append(a),d.runTemplateJS(c),b.resolve()}).fail(b.reject)}).fail(b.reject),b.fail(c.exception).always(function(){B(e)})},D=function(){var b=a.trim(p());if(""===b)return a.Deferred().resolve();var d=k();A(d);var f=g.isCartridge(b);return f.always(function(){B(d)}),f.done(function(c){c.iscartridge?(a(j.TOOL_URL).val(""),a(document).trigger(e.START_CARTRIDGE_REGISTRATION,b)):a(document).trigger(e.START_EXTERNAL_REGISTRATION,{url:b})}),f.fail(function(){i.get_string("errorbadurl","mod_lti").done(function(b){a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b,error:!0})}).fail(c.exception)}),f},E=function(){a(document).on(e.NEW_TOOL_TYPE,function(){C()}),a(document).on(e.START_EXTERNAL_REGISTRATION,function(){t(),a(j.TOOL_URL).val(""),x()}),a(document).on(e.STOP_EXTERNAL_REGISTRATION,function(){y(),v()}),a(document).on(e.START_CARTRIDGE_REGISTRATION,function(a,b){u(b)}),a(document).on(e.STOP_CARTRIDGE_REGISTRATION,function(){n().find(j.CARTRIDGE_REGISTRATION_FORM).removeAttr("data-cartridge-url"),v()}),a(document).on(e.REGISTRATION_FEEDBACK,function(a,b){z(b)});var b=a(j.ADD_TOOL_FORM);b.submit(function(a){a.preventDefault(),D()})};return{init:function(){E(),C()}}});
define('mod_lti/events', [],function(){return{NEW_TOOL_TYPE:"lti.tool.type.new",START_EXTERNAL_REGISTRATION:"lti.registration.external.start",STOP_EXTERNAL_REGISTRATION:"lti.registration.external.stop",START_CARTRIDGE_REGISTRATION:"lti.registration.cartridge.start",STOP_CARTRIDGE_REGISTRATION:"lti.registration.cartridge.stop",REGISTRATION_FEEDBACK:"lti.registration.feedback",CAPABILITIES_AGREE:"lti.tool.type.capabilities.agree",CAPABILITIES_DECLINE:"lti.tool.type.capabilities.decline"}});
define('mod_lti/tool_proxy', ["core/ajax","core/notification"],function(a,b){return{query:function(c){var d={methodname:"mod_lti_get_tool_proxies",args:c||{}},e=a.call([d])[0];return e.fail(b.exception),e},"delete":function(c){var d={methodname:"mod_lti_delete_tool_proxy",args:{id:c}},e=a.call([d])[0];return e.fail(b.exception),e},create:function(b){var c={methodname:"mod_lti_create_tool_proxy",args:b},d=a.call([c])[0];return d}}});
define('mod_lti/tool_proxy_card_controller', ["jquery","core/ajax","core/notification","core/templates","mod_lti/tool_proxy","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h){var i={DELETE_BUTTON:".delete",CAPABILITIES_CONTAINER:".capabilities-container",ACTIVATE_BUTTON:".tool-card-footer a.activate"},j=2e3,k=function(a){return a.find(i.DELETE_BUTTON)},l=function(a){return a.find(i.ACTIVATE_BUTTON)},m=function(a){return a.attr("data-proxy-id")},n=function(a){a.removeClass("announcement loading success fail capabilities")},o=function(a){n(a),a.addClass("announcement loading")},p=function(a){a.removeClass("announcement loading")},q=function(b){var c=a.Deferred();return n(b),b.addClass("announcement success"),setTimeout(function(){b.removeClass("announcement success"),c.resolve()},j),c},r=function(b){var c=a.Deferred();return n(b),b.addClass("announcement fail"),setTimeout(function(){b.removeClass("announcement fail"),c.resolve()},j),c},s=function(b){var d=a.Deferred(),f=m(b);return o(b),""===f?a.Deferred().resolve():(h.get_strings([{key:"delete",component:"mod_lti"},{key:"delete_confirmation",component:"mod_lti"},{key:"delete",component:"mod_lti"},{key:"cancel",component:"core"}]).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){e["delete"](f).done(function(){p(b),q(b).done(function(){b.remove(),d.resolve()}).fail(c.exception)}).fail(function(a){r(b),d.reject(a)})},function(){p(b),d.resolve()})}).fail(function(a){p(b),c.exception(a),d.reject(a)}),d)},t=function(b){var c={proxyid:m(b)};a(document).trigger(f.START_EXTERNAL_REGISTRATION,c)},u=function(a){var b=k(a);b.click(function(b){b.preventDefault(),s(a)}),b.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=g.ENTER&&a.keyCode!=g.SPACE||(a.preventDefault(),b.click())});var c=l(a);c.click(function(b){b.preventDefault(),t(a)}),c.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=g.ENTER&&a.keyCode!=g.SPACE||(a.preventDefault(),c.click())})};return{init:function(a){u(a)}}});
define('mod_lti/tool_type', ["core/ajax","core/notification"],function(a,b){return{query:function(c){var d={methodname:"mod_lti_get_tool_types",args:c||{}},e=a.call([d])[0];return e.fail(b.exception),e},create:function(b){var c={methodname:"mod_lti_create_tool_type",args:b},d=a.call([c])[0];return d},update:function(c){var d={methodname:"mod_lti_update_tool_type",args:c},e=a.call([d])[0];return e.fail(b.exception),e},"delete":function(c){var d={methodname:"mod_lti_delete_tool_type",args:{id:c}},e=a.call([d])[0];return e.fail(b.exception),e},getFromToolProxyId:function(a){return this.query({toolproxyid:a})},isCartridge:function(b){var c={methodname:"mod_lti_is_cartridge",args:{url:b}},d=a.call([c])[0];return d},constants:{state:{configured:1,pending:2,rejected:3}}}});
define('mod_lti/tool_card_controller', ["jquery","core/ajax","core/notification","core/templates","mod_lti/tool_type","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h){var i={DELETE_BUTTON:".delete",NAME_ELEMENT:".name",DESCRIPTION_ELEMENT:".description",CAPABILITIES_CONTAINER:".capabilities-container",ACTIVATE_BUTTON:".tool-card-footer a.activate"},j=2e3,k=function(a){return a.find(i.DELETE_BUTTON)},l=function(a){return a.find(i.NAME_ELEMENT)},m=function(a){return a.find(i.DESCRIPTION_ELEMENT)},n=function(a){return a.find(i.ACTIVATE_BUTTON)},o=function(a){return!!n(a).length},p=function(a){return a.find(i.CAPABILITIES_CONTAINER)},q=function(a){return!!p(a).length},r=function(a){return a.attr("data-type-id")},s=function(a){a.removeClass("announcement loading success fail capabilities")},t=function(a){s(a),a.addClass("announcement loading")},u=function(a){a.removeClass("announcement loading")},v=function(b){var c=a.Deferred();return s(b),b.addClass("announcement success"),setTimeout(function(){b.removeClass("announcement success"),c.resolve()},j),c},w=function(b){var c=a.Deferred();return s(b),b.addClass("announcement fail"),setTimeout(function(){b.removeClass("announcement fail"),c.resolve()},j),c},x=function(b){var d=a.Deferred(),f=r(b);return t(b),""===f?a.Deferred().resolve():(h.get_strings([{key:"delete",component:"mod_lti"},{key:"delete_confirmation",component:"mod_lti"},{key:"delete",component:"mod_lti"},{key:"cancel",component:"core"}]).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){e["delete"](f).done(function(){u(b),v(b).done(function(){b.remove()}).fail(c.exception).always(function(){d.resolve()})}).fail(function(a){w(b),d.reject(a)})},function(){u(b),d.resolve()})}).fail(function(a){u(b),c.exception(a),d.reject(a)}),d)},y=function(a,b){a.attr("data-val-snapshot",b)},z=function(a){return a.attr("data-val-snapshot")},A=function(a){var b=m(a);if(!b.hasClass("loading")){var c=b.text().trim();y(b,c)}},B=function(b){var d=r(b);if(""===d)return a.Deferred().resolve();var f=m(b);if(f.hasClass("loading"))return a.Deferred().resolve();var g=f.text().trim(),h=z(f);if(h==g)return a.Deferred().resolve();f.addClass("loading");var i=e.update({id:d,description:g});return i.done(function(a){f.removeClass("loading"),f.text(a.description)}).fail(c.exception),i.fail(function(){f.removeClass("loading")}),i},C=function(a){var b=l(a);if(!b.hasClass("loading")){var c=b.text().trim();y(b,c)}},D=function(b){var c=r(b);if(""===c)return a.Deferred().resolve();var d=l(b);if(d.hasClass("loading"))return a.Deferred().resolve();var f=d.text().trim(),g=z(d);if(g==f)return a.Deferred().resolve();d.addClass("loading");var h=e.update({id:c,name:f});return h.done(function(a){d.removeClass("loading"),d.text(a.name)}),h.fail(function(){d.removeClass("loading")}),h},E=function(b){var c=r(b);if(""===c)return a.Deferred().resolve();t(b);var f=e.update({id:c,state:e.constants.state.configured});return f.done(function(c){u(b);var e=v(b),f=d.render("mod_lti/tool_card",c);a.when(f,e).then(function(a){var c=a[0],e=a[1];d.replaceNode(b,c,e)})}),f.fail(function(){u(b),w(b)}),f},F=function(a){a.addClass("announcement capabilities")},G=function(a){a.removeClass("announcement capabilities")},H=function(a){q(a)?F(a):E(a)},I=function(a){var b=k(a);b.click(function(b){b.preventDefault(),x(a)}),b.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=g.ENTER&&a.keyCode!=g.SPACE||(a.preventDefault(),b.click())});var c=m(a);c.focus(function(b){b.preventDefault(),A(a)}),c.blur(function(b){b.preventDefault(),B(a)}),c.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode==g.ENTER&&(a.preventDefault(),c.blur())});var d=l(a);if(d.focus(function(b){b.preventDefault(),C(a)}),d.blur(function(b){b.preventDefault(),D(a)}),d.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode==g.ENTER&&(a.preventDefault(),d.blur())}),o(a)){var e=n(a);e.click(function(b){b.preventDefault(),H(a)}),e.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=g.ENTER&&a.keyCode!=g.SPACE||(a.preventDefault(),e.click())})}if(q(a)){var h=p(a);h.on(f.CAPABILITIES_AGREE,function(){E(a)}),h.on(f.CAPABILITIES_DECLINE,function(){G(a)})}};return{init:function(a){I(a)}}});
define('mod_lti/contentitem', ["jquery","core/notification","core/str","core/templates","mod_lti/form-field","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f,g){var h,i={init:function(a,e){var i="";c.get_string("selectcontent","lti").then(function(c){i=c;var j={url:a,postData:e},k=d.render("mod_lti/contentitem",j);h?(h.setBody(k),h.show()):f.create({title:i,body:k,large:!0}).done(function(a){h=a,h.show(),a.getRoot().on(g.hidden,function(){a.setBody(""),b.fetchNotifications()})})})}},j=[new e("name",e.TYPES.TEXT,(!1),""),new e("introeditor",e.TYPES.EDITOR,(!1),""),new e("toolurl",e.TYPES.TEXT,(!0),""),new e("securetoolurl",e.TYPES.TEXT,(!0),""),new e("instructorchoiceacceptgrades",e.TYPES.CHECKBOX,(!0),(!0)),new e("instructorchoicesendname",e.TYPES.CHECKBOX,(!0),(!0)),new e("instructorchoicesendemailaddr",e.TYPES.CHECKBOX,(!0),(!0)),new e("instructorcustomparameters",e.TYPES.TEXT,(!0),""),new e("icon",e.TYPES.TEXT,(!0),""),new e("secureicon",e.TYPES.TEXT,(!0),""),new e("launchcontainer",e.TYPES.SELECT,(!0),0)];return window.processContentItemReturnData=function(b){h&&h.hide();var c;for(c in j){var d=j[c],e=null;"undefined"!==a.type(b[d.name])&&(e=b[d.name]),d.setFieldValue(e)}},i});
define('mod_lti/keys', [],function(){return{ENTER:13,SPACE:32}});
define('mod_lti/external_registration_return', [],function(){return{init:function(a,b,c,d){window.parent&&window.parent.triggerExternalRegistrationComplete({message:a,error:b,id:c,status:d})}}});
define('mod_lti/contentitem_return', ["jquery"],function(a){return{init:function(b){a(window).ready(function(){window!=top?parent.processContentItemReturnData(b):window.processContentItemReturnData(b)})}}});
define('mod_lti/cartridge_registration_form', ["jquery","core/ajax","core/notification","mod_lti/tool_type","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g){var h={CARTRIDGE_URL:"#cartridge-url",CONSUMER_KEY:"#registration-key",SHARED_SECRET:"#registration-secret",REGISTRATION_FORM:"#cartridge-registration-form",REGISTRATION_SUBMIT_BUTTON:"#cartridge-registration-submit",REGISTRATION_CANCEL_BUTTON:"#cartridge-registration-cancel"},i=function(){return a(h.REGISTRATION_FORM).attr("data-cartridge-url")},j=function(){return a(h.REGISTRATION_SUBMIT_BUTTON)},k=function(){return a(h.REGISTRATION_CANCEL_BUTTON)},l=function(){return a(h.CONSUMER_KEY).val()},m=function(){return a(h.SHARED_SECRET).val()},n=function(){j().addClass("loading")},o=function(){j().removeClass("loading")},p=function(){return j().hasClass("loading")},q=function(){if(p())return!1;var b=i();if(""===b)return!1;n();var f=l(),h=m(),j=d.create({cartridgeurl:b,key:f,secret:h});return j.done(function(){g.get_string("successfullycreatedtooltype","mod_lti").done(function(b){a(document).trigger(e.NEW_TOOL_TYPE),a(document).trigger(e.STOP_CARTRIDGE_REGISTRATION),a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b})}).fail(c.exception)}).fail(function(){g.get_string("failedtocreatetooltype","mod_lti").done(function(b){a(document).trigger(e.NEW_TOOL_TYPE),a(document).trigger(e.STOP_CARTRIDGE_REGISTRATION),a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b,error:!0})}).fail(c.exception)}).always(function(){o()}),j},r=function(){var b=a(h.REGISTRATION_FORM);b.submit(function(a){a.preventDefault(),q()});var c=k();c.click(function(b){b.preventDefault(),a(document).trigger(e.STOP_CARTRIDGE_REGISTRATION)}),c.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=f.ENTER&&a.keyCode!=f.SPACE||(a.preventDefault(),c.click())})};return{init:function(){r()}}});
define('mod_lti/external_registration', ["jquery","core/ajax","core/notification","core/templates","mod_lti/events","mod_lti/tool_proxy","mod_lti/tool_type","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h,i){var j={EXTERNAL_REGISTRATION_CONTAINER:"#external-registration-page-container",EXTERNAL_REGISTRATION_TEMPLATE_CONTAINER:"#external-registration-template-container",EXTERNAL_REGISTRATION_CANCEL_BUTTON:"#cancel-external-registration",TOOL_TYPE_CAPABILITIES_CONTAINER:"#tool-type-capabilities-container",TOOL_TYPE_CAPABILITIES_TEMPLATE_CONTAINER:"#tool-type-capabilities-template-container",CAPABILITIES_AGREE_CONTAINER:".capabilities-container"},k=function(){return a(j.EXTERNAL_REGISTRATION_CANCEL_BUTTON)},l=function(){return a(j.EXTERNAL_REGISTRATION_CONTAINER)},m=function(){return a(j.EXTERNAL_REGISTRATION_TEMPLATE_CONTAINER)},n=function(){return a(j.TOOL_TYPE_CAPABILITIES_CONTAINER)},o=function(){return a(j.TOOL_TYPE_CAPABILITIES_TEMPLATE_CONTAINER)},p=function(){n().addClass("loading")},q=function(){n().removeClass("loading")},r=function(){k().addClass("loading")},s=function(){k().removeClass("loading")},t=function(){n().addClass("hidden")},u=function(){n().removeClass("hidden")},v=function(){l().addClass("hidden")},w=function(){l().removeClass("hidden")},x=function(a){var b=k();b.attr("data-tool-proxy-id",a)},y=function(){var a=k();return a.attr("data-tool-proxy-id")},z=function(){var a=k();a.removeAttr("data-tool-proxy-id")},A=function(){return!!y()},B=function(){var a=k();return a.attr("data-tool-proxy-new")&&A()},C=function(){var a=k();return a.attr("data-tool-proxy-new","new")},D=function(){var a=k();return a.removeAttr("data-tool-proxy-new")},E=function(a){var c={methodname:"mod_lti_get_tool_proxy_registration_request",args:{id:a}};return b.call([c])[0]},F=function(){r();var b=a.Deferred();if(B()){var d=y();f["delete"](d).done(function(){b.resolve()}).fail(function(a){b.reject(a)})}else b.resolve();return b.done(function(){L(),s()}).fail(function(b){c.exception(b),L(),s(),i.get_string("failedtodeletetoolproxy","mod_lti").done(function(b){var c={message:b,error:!0};a(document).trigger(e.REGISTRATION_FEEDBACK,c)}).fail(c.exception)}),b},G=function(a){var b=d.render("mod_lti/tool_proxy_registration_form",a);return b.done(function(a,b){var c=m();c.append(a),d.runTemplateJS(b),c.find("form").submit(),w()}).fail(c.exception),b},H=function(a){return g.update({id:a.id,state:g.constants.state.configured})},I=function(b){var f=a.Deferred();return d.render("mod_lti/tool_type_capabilities_agree",b).done(function(a,c){var g=o();v(),u(),d.replaceNodeContents(g,a,c);var h=g.find(j.CAPABILITIES_AGREE_CONTAINER);h.on(e.CAPABILITIES_AGREE,function(){p(),H(b).always(function(){q(),g.empty(),f.resolve()})}),h.on(e.CAPABILITIES_DECLINE,function(){g.empty(),f.resolve()})}).fail(f.reject),f.done(function(){t()}).fail(c.exception),f},J=function(b){var c=a.Deferred();return b&&""!==b?f.create({regurl:b}).done(function(a){C(),c=K(a.id)}).fail(function(b){F();var d={message:b.message,error:!0};a(document).trigger(e.REGISTRATION_FEEDBACK,d),c.reject(b)}):c.resolve(),c},K=function(b){var c=a.Deferred();return x(b),E(b).done(function(a){G(a).done(function(){c.resolve()}).fail(c.fail)}).fail(c.fail),c},L=function(){A()&&z(),D(!1),v();var b=m();b.empty(),a(document).trigger(e.STOP_EXTERNAL_REGISTRATION)},M=function(){a(document).on(e.START_EXTERNAL_REGISTRATION,function(a,b){b&&(b.url&&J(b.url),b.proxyid&&K(b.proxyid))});var b=k();b.click(function(a){a.preventDefault(),F()}),b.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=h.ENTER&&a.keyCode!=h.SPACE||(a.preventDefault(),F())}),window.triggerExternalRegistrationComplete=function(b){var d=a.Deferred(),f={message:"",error:!1};if("success"==b.status){if(i.get_string("successfullycreatedtooltype","mod_lti").done(function(a){f.message=a}).fail(c.exception),d.done(function(){L(),a(document).trigger(e.REGISTRATION_FEEDBACK,f),a(document).trigger(e.NEW_TOOL_TYPE)}).fail(c.exception),B()){var h=y();g.getFromToolProxyId(h).done(function(a){if(a&&a.length){var b=a[0];b.hascapabilitygroups?I(b).always(function(){d.resolve()}):d.resolve()}else d.resolve()}).fail(function(){d.resolve()})}}else f.message=b.error,f.error=!0,d.done(function(){F().always(function(){a(document).trigger(e.REGISTRATION_FEEDBACK,f)})}).fail(c.exception),d.resolve();return d}};return{init:function(){M()}}});
define('mod_quiz/warn_add_randomquestions', ["jquery","core/config"],function(a,b){var c,d={init:function(){d.add_onchanges(),void 0!=c&&d.toggle_warning()},set_totara_category_counts:function(a){c=a,d.toggle_warning()},toggle_warning:function(){var b=!1,d=a("#id_category").val(),e=a("#id_includesubcategories").prop("checked"),f=parseInt(a("#id_numbertoadd").val(),10),g=c[d];e?f>g.includedcount&&(b=!0):f>g.questioncount&&(b=!0),b?a("#fitem_id_warn_random").show():a("#fitem_id_warn_random").hide()},add_onchanges:function(){var b="#id_category, #id_includesubcategories, #id_numbertoadd";a(document).on("change",b,function(){void 0!=c&&d.toggle_warning()})}};return d});
define('mod_quiz/preflightcheck', ["jquery","core/yui"],function(a,b){var c={confirmDialogue:null,init:function(a,d,e,f){var g=a;b.use("moodle-core-notification",function(){b.one(e)&&(c.confirmDialogue=new M.core.dialogue({headerContent:d,bodyContent:b.one(e),draggable:!0,visible:!1,center:!0,modal:!0,width:null,extraClasses:["mod_quiz_preflight_popup"]}),b.one(a).on("click",c.displayDialogue),b.one("#id_cancel").on("click",c.hideDialogue),g=c.confirmDialogue.get("boundingBox").one('[name="submitbutton"]')),f&&b.one(g).on("click",c.launchQuizPopup,c,f)})},displayDialogue:function(a){a&&a.halt(),c.confirmDialogue.show()},hideDialogue:function(a){a&&a.halt(),c.confirmDialogue.hide(a)},launchQuizPopup:function(a,c){a.halt(),b.use("moodle-core-formchangechecker","io-form",function(){M.core_formchangechecker.reset_form_dirty_state();var d=a.target.ancestor("form");window.openpopup(a,{url:d.get("action")+"?"+b.IO.stringify(d).replace(/\bcancel=/,"x="),windowname:"quizpopup",options:c,fullscreen:!0})})}};return c});
define('mod_quiz/warn_randomquestions', ["jquery","core/config"],function(a,b){var c,d={init:function(){},set_totara_random_category_selectors:function(a){c=a,d.toggle_random_usage_warning(),d.toggle_question_icons()},toggle_random_usage_warning:function(){void 0==c||0===c.notenough.length?a(".randomnotification").hide():a(".randomnotification").show()},toggle_question_icons:function(){a(".flex-icon.fa-warning").filter(c.hasenough).hide(),a(".flex-icon.fa-warning").filter(c.notenough).show()}};return d});
define('mod_survey/validation', ["jquery","core/str","core/modal_factory","core/notification"],function(a,b,c,d){return{ensureRadiosChosen:function(e){var f=b.get_strings([{key:"error",component:"moodle"},{key:"questionsnotanswered",component:"survey"}]).then(function(a){return c.create({type:c.types.CANCEL,title:a[0],body:a[1]})})["catch"](d.exception),g=a("#"+e);g.submit(function(a){return 0===g.find('input:radio[data-survey-default="true"]:checked').length||(a.preventDefault(),f.then(function(a){a.show()}),!1)})}}});
define('mod_workshop/workshopview', ["jquery"],function(a){function b(b){var c=0;b.height("auto"),b.each(function(){var b=a(this).height();b>c&&(c=b)}),b.height(c)}return{init:function(){var c=a(".path-mod-workshop .userplan dt"),d=a(".path-mod-workshop .userplan dd");b(c),b(d),a(window).on("resize",function(){b(c),b(d)})}}});
define('auth_approved/manager-selector', ["jquery","core/ajax","core/notification"],function(a,b,c){return{processResults:function(a,b){var c,d=[],e=0;for(e=0;e<b.managers.length;e++)c=b.managers[e],d.push({value:c.jaid,label:c.displayname});return d},transport:function(c,d,e,f){"undefined"==typeof d&&(d="");var g=null,h=[{methodname:"auth_approved_job_assignment_by_user_names",args:{searchquery:d,page:0,perpage:100,termaggregation:"AND"}}];g=b.call(h),a.when.apply(a.when,g).done(function(a){e(a)}).fail(f)}}});
define('message_popup/notification_repository', ["core/ajax","core/notification"],function(a,b){var c=function(c){"undefined"==typeof c.limit&&(c.limit=20),"undefined"==typeof c.offset&&(c.offset=0);var d={methodname:"message_popup_get_popup_notifications",args:c},e=a.call([d])[0];return e.fail(b.exception),e},d=function(c){var d={methodname:"message_popup_get_unread_popup_notification_count",args:c},e=a.call([d])[0];return e.fail(b.exception),e},e=function(c){var d={methodname:"core_message_mark_all_notifications_as_read",args:c},e=a.call([d])[0];return e.fail(b.exception),e},f=function(c,d){var e={messageid:c};d&&(e.timeread=d);var f={methodname:"core_message_mark_message_read",args:e},g=a.call([f])[0];return g.fail(b.exception),g};return{query:c,countUnread:d,markAllAsRead:e,markAsRead:f}});
define('message_popup/notification_area_control_area', ["jquery","core/templates","core/notification","core/custom_interaction_events","message_popup/notification_repository","message_popup/notification_area_events","core/str"],function(a,b,c,d,e,f,g){var h={CONTAINER:'[data-region="notification-area"]',CONTENT:'[data-region="content"]',NOTIFICATION:'[data-region="notification-content-item-container"]',CAN_RECEIVE_FOCUS:'input:not([type="hidden"]), a[href], button, textarea, select, [tabindex]'},i=function(b,c){this.root=a(b),this.container=this.root.closest(h.CONTAINER),this.userId=c,this.content=this.root.find(h.CONTENT),this.offset=0,this.limit=20,this.initialLoad=!1,this.isLoading=!1,this.loadedAll=!1,this.notifications={},this.registerEventListeners()};return i.prototype.getRoot=function(){return this.root},i.prototype.getContainer=function(){return this.container},i.prototype.getUserId=function(){return this.userId},i.prototype.getContent=function(){return this.content},i.prototype.getOffset=function(){return this.offset},i.prototype.getLimit=function(){return this.limit},i.prototype.setOffset=function(a){this.offset=a},i.prototype.setLimit=function(a){this.limit=a},i.prototype.incrementOffset=function(){this.offset+=this.limit},i.prototype.startLoading=function(){this.isLoading=!0,this.getRoot().addClass("loading")},i.prototype.stopLoading=function(){this.isLoading=!1,this.getRoot().removeClass("loading")},i.prototype.hasDoneInitialLoad=function(){return this.initialLoad},i.prototype.hasLoadedAllContent=function(){return this.loadedAll},i.prototype.setLoadedAllContent=function(a){this.loadedAll=a},i.prototype.setCacheNotification=function(a){this.notifications[a.id]=a},i.prototype.getCacheNotification=function(a){return this.notifications[a]},i.prototype.getNotificationElement=function(a){var b=this.getRoot().find(h.NOTIFICATION+'[data-id="'+a+'"]');return 1==b.length?b:null},i.prototype.scrollNotificationIntoView=function(a){var b=a.position(),c=this.getRoot(),d=b.top-c.scrollTop();if(d>c.innerHeight()){var e=a.outerHeight();e=4*e;var f=b.top-e;c.scrollTop(f)}},i.prototype.showNotification=function(b){if("object"!=typeof b&&(b=this.getNotificationElement(b)),b&&b.length){this.getRoot().find(h.NOTIFICATION).removeClass("selected"),b.addClass("selected").find(h.CAN_RECEIVE_FOCUS).focus();var c=b.attr("data-id"),d=this.getCacheNotification(c);this.scrollNotificationIntoView(b),this.getContainer().trigger(f.showNotification,[a.extend({},d)])}},i.prototype.markNotificationAsRead=function(a){return e.markAsRead(a.attr("data-id")).done(function(){a.removeClass("unread")})},i.prototype.renderNotifications=function(d){var e=[],f=[],h=[],i=this.getContent();return d.length&&a.each(d,function(d,i){var j=i.contexturl,k=a.Deferred();delete i.contexturl,i.read?k.resolve(i.subject):k=g.get_string("unreadnotification","message",i.subject);var l=k.then(function(a){return i.aria_viewnotification=a,b.render("message_popup/notification_content_item",i)});e.push(l),l.then(function(a,b){f[d]=a,h[d]=b,i.contexturl=j,this.setCacheNotification(i)}.bind(this)).fail(c.exception)}.bind(this)),a.when.apply(a.when,e).then(function(){d.length&&a.each(d,function(a){i.append(f[a]),b.runTemplateJS(h[a])})})},i.prototype.loadMoreNotifications=function(){if(this.isLoading||this.hasLoadedAllContent())return a.Deferred().resolve();this.startLoading();var b={limit:this.getLimit(),offset:this.getOffset(),useridto:this.getUserId()};this.initialLoad||(b.limit=this.getOffset()+this.getLimit(),b.offset=0);var c=e.query(b).then(function(a){var b=a.notifications;return this.unreadCount=a.unreadcount,this.setLoadedAllContent(!b.length||b.length<this.getLimit()),this.initialLoad=!0,!!b.length&&(this.incrementOffset(),this.renderNotifications(b))}.bind(this)).always(function(){this.stopLoading()}.bind(this));return c},i.prototype.registerEventListeners=function(){d.define(this.getRoot(),[d.events.activate,d.events.scrollBottom,d.events.scrollLock,d.events.up,d.events.down]),this.getRoot().on(d.events.scrollBottom,function(){this.loadMoreNotifications()}.bind(this)),this.getRoot().on(d.events.activate,h.NOTIFICATION,function(b){var c=a(b.target).closest(h.NOTIFICATION);this.showNotification(c)}.bind(this)),this.getRoot().on(d.events.up,h.NOTIFICATION,function(b,c){var d=a(b.target).closest(h.NOTIFICATION);this.showNotification(d.prev()),c.originalEvent.preventDefault()}.bind(this)),this.getRoot().on(d.events.down,h.NOTIFICATION,function(b,c){var d=a(b.target).closest(h.NOTIFICATION);this.showNotification(d.next()),c.originalEvent.preventDefault()}.bind(this)),this.getContainer().on(f.notificationShown,function(a,b){if(!b.read){var c=this.getNotificationElement(b.id);c&&this.markNotificationAsRead(c);var d=this.getCacheNotification(b.id);d&&(d.read=!0)}}.bind(this))},i});
define('message_popup/notification_area_events', [],function(){return{showNotification:"notification-area-events:showNotification",notificationShown:"notification-area-events:notificationShown"}});
define('message_popup/message_popover_controller', ["jquery","core/ajax","core/templates","core/str","core/notification","core/custom_interaction_events","core/popover_region_controller","core_message/message_repository","core/url"],function(a,b,c,d,e,f,g,h,i){var j={MARK_ALL_READ_BUTTON:'[data-action="mark-all-read"]',CONTENT:'[data-region="messages"]',CONTENT_ITEM_CONTAINER:'[data-region="message-content-item-container"]',EMPTY_MESSAGE:'[data-region="empty-message"]',COUNT_CONTAINER:'[data-region="count-container"]'},k=function(a){g.call(this,a),this.markAllReadButton=this.root.find(j.MARK_ALL_READ_BUTTON),this.content=this.root.find(j.CONTENT),this.userId=this.root.attr("data-userid"),this.limit=20,this.offset=0,this.loadedAll=!1,this.initialLoad=!1,this.loadUnreadMessageCount()};return k.prototype=Object.create(g.prototype),k.prototype.constructor=k,k.prototype.getContent=function(){return this.content},k.prototype.incrementOffset=function(){this.offset+=this.limit},k.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?d.get_string("hidemessagewindow","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):this.unreadCount?d.get_string("showmessagewindowwithcount","message",this.unreadCount).done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):d.get_string("showmessagewindownonew","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))},k.prototype.renderUnreadCount=function(){var a=this.root.find(j.COUNT_CONTAINER);this.unreadCount?(a.text(this.unreadCount),a.removeClass("hidden")):a.addClass("hidden")},k.prototype.hideUnreadCount=function(){this.root.find(j.COUNT_CONTAINER).addClass("hidden")},k.prototype.loadUnreadMessageCount=function(){h.countUnreadConversations({useridto:this.userId}).then(function(a){this.unreadCount=a,this.renderUnreadCount(),this.updateButtonAriaLabel()}.bind(this))},k.prototype.renderMessages=function(b,e){var f=[],g=[],h=[];return b.length&&a.each(b,function(a,b){var e="";b.contexturl=i.relativeUrl("/message/index.php",{user:this.userId,id:b.userid}),b.profileurl=i.relativeUrl("/user/profile.php",{id:b.userid}),e=b.isread?"viewmessageswith":"viewunreadmessageswith";var j=d.get_string(e,"message",b.fullname).then(function(a){return b.aria_viewmessageswith=a,c.render("message_popup/message_content_item",b)});f.push(j),j.then(function(b,c){g[a]=b,h[a]=c})}.bind(this)),a.when.apply(a.when,f).then(function(){b.length&&a.each(b,function(a){e.append(g[a]),c.runTemplateJS(h[a])})})},k.prototype.loadMoreMessages=function(){if(this.isLoading||this.loadedAll)return a.Deferred().resolve();this.startLoading();var b={userid:this.userId,limit:this.limit,offset:this.offset},c=this.getContent();return h.query(b).then(function(a){var b=a.contacts;return this.loadedAll=!b.length||b.length<this.limit,this.initialLoad=!0,this.updateButtonAriaLabel(),!!b.length&&(this.incrementOffset(),this.renderMessages(b,c))}.bind(this)).always(function(){this.stopLoading()}.bind(this))},k.prototype.markAllAsRead=function(){return this.markAllReadButton.hasClass("loading")?a.Deferred().resolve():(this.markAllReadButton.addClass("loading"),h.markAllAsRead({useridto:this.userId}).then(function(){this.unreadCount=0,this.hideUnreadCount(),this.getContent().find(j.CONTENT_ITEM_CONTAINER).removeClass("unread")}.bind(this)).always(function(){this.markAllReadButton.removeClass("loading")}.bind(this)))},k.prototype.registerEventListeners=function(){f.define(this.root,[f.events.keyboardActivate]),this.root.on(this.events().menuOpened,function(){this.hideUnreadCount(),this.updateButtonAriaLabel(),this.initialLoad||this.loadMoreMessages()}.bind(this)),this.root.on(this.events().menuClosed,function(){this.renderUnreadCount(),this.updateButtonAriaLabel()}.bind(this)),this.root.on(f.events.scrollBottom,function(){this.loadMoreMessages()}.bind(this)),this.root.on(f.events.activate,j.MARK_ALL_READ_BUTTON,function(a,b){this.markAllAsRead(),a.stopPropagation(),b.originalEvent.preventDefault()}.bind(this)),f.define(this.getContentContainer(),[f.events.scrollLock]),a(document).on("messagearea:conversationselected",function(){this.unreadCount--,this.renderUnreadCount()}.bind(this))},k});
define('message_popup/notification_popover_controller', ["jquery","core/ajax","core/templates","core/str","core/url","core/notification","core/custom_interaction_events","core/popover_region_controller","message_popup/notification_repository","message_popup/notification_area_events"],function(a,b,c,d,e,f,g,h,i,j){var k={MARK_ALL_READ_BUTTON:'[data-action="mark-all-read"]',ALL_NOTIFICATIONS_CONTAINER:'[data-region="all-notifications"]',NOTIFICATION:'[data-region="notification-content-item-container"]',UNREAD_NOTIFICATION:'[data-region="notification-content-item-container"].unread',NOTIFICATION_LINK:'[data-action="content-item-link"]',EMPTY_MESSAGE:'[data-region="empty-message"]',COUNT_CONTAINER:'[data-region="count-container"]'},l=function(a){h.call(this,a),this.markAllReadButton=this.root.find(k.MARK_ALL_READ_BUTTON),this.unreadCount=0,this.userId=this.root.attr("data-userid"),this.container=this.root.find(k.ALL_NOTIFICATIONS_CONTAINER),this.limit=20,this.offset=0,this.loadedAll=!1,this.initialLoad=!1,this.loadUnreadNotificationCount()};return l.prototype=Object.create(h.prototype),l.prototype.constructor=l,l.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?d.get_string("hidenotificationwindow","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):this.unreadCount?d.get_string("shownotificationwindowwithcount","message",this.unreadCount).done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):d.get_string("shownotificationwindownonew","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))},l.prototype.getContent=function(){return this.container},l.prototype.getOffset=function(){return this.offset},l.prototype.incrementOffset=function(){this.offset+=this.limit},l.prototype.hasDoneInitialLoad=function(){return this.initialLoad},l.prototype.hasLoadedAllContent=function(){return this.loadedAll},l.prototype.setLoadedAllContent=function(a){this.loadedAll=a},l.prototype.renderUnreadCount=function(){var a=this.root.find(k.COUNT_CONTAINER);this.unreadCount?(a.text(this.unreadCount),a.removeClass("hidden")):a.addClass("hidden")},l.prototype.hideUnreadCount=function(){this.root.find(k.COUNT_CONTAINER).addClass("hidden")},l.prototype.loadUnreadNotificationCount=function(){i.countUnread({useridto:this.userId}).then(function(a){this.unreadCount=a,this.renderUnreadCount(),this.updateButtonAriaLabel()}.bind(this))},l.prototype.getNotificationElement=function(a){var b=this.root.find(k.NOTIFICATION+'[data-id="'+a+'"]');return 1==b.length?b:null},l.prototype.renderNotifications=function(b,g){var h=[],i=[],j=[];return b.length&&a.each(b,function(b,g){var k=this.getOffset()-this.limit,l=a.Deferred();g.viewmoreurl=e.relativeUrl("/message/output/popup/notifications.php",{notificationid:g.id,offset:k}),g.isread?l.resolve(g.subject):l=d.get_string("unreadnotification","message",g.subject);var m=l.then(function(a){return g.aria_viewnotification=a,c.render("message_popup/notification_content_item",g)});h.push(m),m.then(function(a,c){i[b]=a,j[b]=c}).fail(f.exception)}.bind(this)),a.when.apply(a.when,h).then(function(){b.length&&a.each(b,function(a){g.append(i[a]),c.runTemplateJS(j[a])})})},l.prototype.loadMoreNotifications=function(){if(this.isLoading||this.hasLoadedAllContent())return a.Deferred().resolve();this.startLoading();var b={limit:this.limit,offset:this.getOffset(),useridto:this.userId},c=this.getContent();return i.query(b).then(function(a){var b=a.notifications;return this.unreadCount=a.unreadcount,this.setLoadedAllContent(!b.length||b.length<this.limit),this.initialLoad=!0,this.updateButtonAriaLabel(),!!b.length&&(this.incrementOffset(),this.renderNotifications(b,c))}.bind(this)).always(function(){this.stopLoading()}.bind(this))},l.prototype.markAllAsRead=function(){return this.markAllReadButton.addClass("loading"),i.markAllAsRead({useridto:this.userId}).then(function(){this.unreadCount=0,this.root.find(k.UNREAD_NOTIFICATION).removeClass("unread")}.bind(this)).always(function(){this.markAllReadButton.removeClass("loading")}.bind(this))},l.prototype.markNotificationAsRead=function(a){return!!a.hasClass("unread")&&i.markAsRead(a.attr("data-id")).then(function(){this.unreadCount--,a.removeClass("unread")}.bind(this))},l.prototype.registerEventListeners=function(){g.define(this.root,[g.events.activate]),this.root.on(g.events.activate,k.MARK_ALL_READ_BUTTON,function(a){this.markAllAsRead(),a.stopPropagation()}.bind(this)),this.root.on(g.events.activate,k.NOTIFICATION_LINK,function(b){var c=a(b.target).closest(k.NOTIFICATION);this.markNotificationAsRead(c),b.stopPropagation()}.bind(this)),this.root.on(this.events().menuOpened,function(){this.hideUnreadCount(),this.updateButtonAriaLabel(),this.hasDoneInitialLoad()||this.loadMoreNotifications()}.bind(this)),this.root.on(this.events().menuClosed,function(){this.renderUnreadCount(),this.updateButtonAriaLabel()}.bind(this)),this.root.on(this.events().startLoading,function(){this.getContent().attr("aria-busy","true")}.bind(this)),this.root.on(this.events().stopLoading,function(){this.getContent().attr("aria-busy","false")}.bind(this)),this.getContentContainer().on(g.events.scrollBottom,function(){this.isLoading||this.hasLoadedAllContent()||this.loadMoreNotifications()}.bind(this)),g.define(this.getContentContainer(),[g.events.scrollLock]),a(document).on(j.notificationShown,function(a,b){if(!b.read){var c=this.getNotificationElement(b.id);c&&c.removeClass("unread"),this.unreadCount--,this.renderUnreadCount()}}.bind(this))},l});
define('message_popup/notification_area_content_area', ["jquery","core/templates","core/notification","core/custom_interaction_events","message_popup/notification_repository","message_popup/notification_area_events","core/str"],function(a,b,c,d,e,f,g){var h={CONTAINER:'[data-region="notification-area"]',CONTENT:'[data-region="content"]',HEADER:'[data-region="header"]',FOOTER:'[data-region="footer"]',TOGGLE_MODE:'[data-action="toggle-mode"]'},i={HEADER:"message_popup/notification_area_content_area_header",CONTENT:"message_popup/notification_area_content_area_content",FOOTER:"message_popup/notification_area_content_area_footer"},j=function(b,c){this.root=a(b),this.container=this.root.closest(h.CONTAINER),this.userId=c,this.header=this.root.find(h.HEADER),this.content=this.root.find(h.CONTENT),this.footer=this.root.find(h.FOOTER),this.registerEventListeners()};return j.prototype.getRoot=function(){return this.root},j.prototype.getContainer=function(){return this.container},j.prototype.getUserId=function(){return this.userId},j.prototype.getHeader=function(){return this.header},j.prototype.getContent=function(){return this.content},j.prototype.getFooter=function(){return this.footer},j.prototype.show=function(){this.getContainer().addClass("show-content-area")},j.prototype.hide=function(){this.getContainer().removeClass("show-content-area")},j.prototype.setHeaderHTML=function(a){this.getHeader().empty().html(a)},j.prototype.setContentHTML=function(a){this.getContent().empty().html(a)},j.prototype.setFooterHTML=function(a){this.getFooter().empty().html(a)},j.prototype.showNotification=function(c){var d=a.Deferred();return c.contexturlname?d=g.get_string("viewnotificationresource","message",c.contexturlname):d.resolve(""),d.then(function(d){""!==d&&(c.str_viewnotificationresource=d);var e=b.render(i.HEADER,c).done(function(a){this.setHeaderHTML(a)}.bind(this)),g=b.render(i.CONTENT,c).done(function(a){this.setContentHTML(a)}.bind(this)),h=b.render(i.FOOTER,c).done(function(a){this.setFooterHTML(a)}.bind(this));return a.when(e,g,h).done(function(){this.show(),this.getContainer().trigger(f.notificationShown,[c])}.bind(this))}.bind(this))},j.prototype.registerEventListeners=function(){d.define(this.getRoot(),[d.events.activate]),this.getRoot().on(d.events.activate,h.VIEW_TOGGLE,function(){this.hide()}.bind(this)),this.getContainer().on(f.showNotification,function(a,b){this.showNotification(b)}.bind(this))},j});
define('block_admin_subnav/subnavblock', ["core/yui","core/tree"],function(a,b){return{init:function(c){var d=new b(".block_admin_subnav .block_tree");d.finishExpandingGroup=function(d){b.prototype.finishExpandingGroup.call(this,d),a.use("moodle-core-event",function(){a.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})})},d.collapseGroup=function(d){b.prototype.collapseGroup.call(this,d),a.use("moodle-core-event",function(){a.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})})}}}});
define('block_course_navigation/nav_loader', ["jquery","core/ajax","core/config","block_course_navigation/ajax_response_renderer"],function(a,b,c,d){function e(a){return a.closest("[data-block]").attr("data-instanceid")}function f(a){return a.closest("[data-block]").attr("data-block")}var g=c.wwwroot+"/lib/ajax/getnavbranch.php";return{load:function(b){b=a(b);var h=a.Deferred(),i={elementid:b.attr("data-node-id"),id:b.attr("data-node-key"),type:b.attr("data-node-type"),sesskey:c.sesskey,instance:e(b),blocktype:f(b)},j={type:"POST",dataType:"json",data:i};return a.ajax(g,j).done(function(a){d.render(b,a),h.resolve()}),h}}});
define('block_course_navigation/navblock', ["jquery","core/tree"],function(a,b){return{init:function(c){var d=new b(".block_course_navigation .block_tree");d.finishExpandingGroup=function(d){b.prototype.finishExpandingGroup.call(this,d),a(document).trigger(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})},d.collapseGroup=function(d){b.prototype.collapseGroup.call(this,d),a(document).trigger(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})}}}});
define('block_course_navigation/ajax_response_renderer', ["jquery","core/templates"],function(a,b){function c(e,f){var g=a("<ul></ul>");g.attr("role","group"),g.attr("aria-hidden",!0),a.each(f,function(e,f){if("object"==typeof f){var h=a("<li></li>"),i=a("<p></p>"),j=f.id||f.key+"_tree_item",k=null,l=!(!f.expandable&&!f.haschildren);if(i.addClass("tree_item"),i.attr("id",j),i.attr("role","treeitem"),i.attr("tabindex","-1"),f.requiresajaxloading&&(i.attr("data-requires-ajax",!0),i.attr("data-node-id",f.id),i.attr("data-node-key",f.key),i.attr("data-node-type",f.type)),l&&(h.addClass("collapsed contains_branch"),i.attr("aria-expanded",!1),i.addClass("branch"),b.renderIcon("collapsed").done(function(a){"false"===i.attr("aria-expanded")&&(i.find(".flex-icon").remove(),i.prepend(a))})),f.icon&&(!l||f.type===d.ACTIVITY||f.type===d.RESOURCE)){h.addClass("item_with_icon"),i.addClass("hasicon");var m=f.flex_icon;"string"==typeof m?k=a(m):(k=a("<img/>"),k.attr("alt",f.icon.alt),k.attr("title",f.icon.title),k.attr("src",M.util.image_url(f.icon.pix,f.icon.component)),a.each(f.icon.classes,function(a,b){k.addClass(b)}))}if(f.link){var n=a('<a title="'+f.title+'" href="'+f.link+'"></a>');k?(n.append(k),n.append('<span class="item-content-wrap">'+f.name+"</span>")):n.append(f.name),f.hidden&&n.addClass("dimmed"),i.append(n)}else{var o=a("<span></span>");k?(o.append(k),o.append('<span class="item-content-wrap">'+f.name+"</span>")):o.append(f.name),f.hidden&&o.addClass("dimmed"),i.append(o)}h.append(i),g.append(h),f.children&&f.children.length?c(i,f.children):l&&!f.requiresajaxloading&&(h.removeClass("contains_branch"),i.addClass("emptybranch"),b.renderIcon("collapsed-empty").done(function(a){"true"===i.attr("aria-expanded")&&(i.find(".flex-icon").remove(),i.prepend(a))}))}}),e.parent().append(g);var h=e.attr("id")+"_group";g.attr("id",h),e.attr("aria-owns",h),e.attr("role","treeitem")}var d={ACTIVITY:40,RESOURCE:50};return{render:function(a,d){if(d.children&&d.children.length){c(a,d.children);var e=a.children("[role='treeitem']").first(),f=a.find("#"+e.attr("aria-owns"));e.attr("aria-expanded",!0),f.attr("aria-hidden",!1)}else a.parent().hasClass("contains_branch")&&(a.parent().removeClass("contains_branch"),b.renderIcon("collapsed-empty").done(function(b){"true"===a.attr("aria-expanded")&&(a.find(".flex-icon").remove(),a.prepend(b))}))}}});
define('block_current_learning/current_learning', ["jquery","core/templates","core/notification","core/str","core/log"],function(a,b,c,d,e){var f,g=null,h=10,i=function(b,c){var e=parseInt(a(f+" .pagination li.active a").attr("data-page")),g=null;g="next"==c?e+1:"prev"==c?e-1:c;var i=b.learningitems.length,j=Math.ceil(i/h),k={},l=(g-1)*h+1;k.learningitems=b.learningitems.slice(l-1,l-1+h);var m=b.pagination;g>1?m.previousclass="":m.previousclass="disabled",g>=j?m.nextclass="disabled":m.nextclass="",m.pages.forEach(function(a){a.page==g?a.active="active":a.active=""});var n={},o=a.Deferred();n.start=(g-1)*h+1;var p=null;return p=b.pagination.totalitems<g*h?b.pagination.totalitems:g*h,n.end=p,n.total=b.pagination.totalitems,d.get_string("displayingxofx","block_current_learning",n).done(function(a){m.text=a,k.pagination=m,k.haslearningitems=!0,o.resolve(k)}).fail(function(a){o.reject(a)}),o.promise()},j=function(){a(f+" .pagination").on("click","a",function(d){d.preventDefault();var e=a(this),h=e.parent();if(h.hasClass("disabled"))return!1;var k=e.attr("data-page");i(g,k).done(function(d){b.render("block_current_learning/main_content",d).done(function(c,d){a(f+" .current-learning-content").replaceWith(c).trigger("block_current_learning:content_updated"),b.runTemplateJS(d)}).fail(function(a){c.exception(a)}),b.render("block_current_learning/paging",d).done(function(b){a(f+" .panel-footer").replaceWith(b),j()}).fail(function(a){c.exception(a)})})})},k=function(){var b=f+' [data-toggle="tooltip"]';a(b).tooltip(),a(f+" .current-learning-content").on("block_current_learning:content_updated",function(c){a(b).tooltip()})},l=function(b){if(b.pagination.pages.length>1){var c=a(f+" .current-learning-content");c.css("min-height",c.outerHeight())}},m=function(c){f="#inst"+c.instanceid.toString(),c.pagination&&c.pagination.itemsperpage&&(h=c.pagination.itemsperpage);var i=!0;a.fn.collapse&&a.fn.tooltip||(e.debug("Current learning block requires Bootstrap 3 JavaScript, please include it or find your own solution."),i=!1),g=c;var m=["block_current_learning/main_content","block_current_learning/course_row","block_current_learning/program_row"];if(m.forEach(function(a){b.render(a,{})}),c.pagination){var n={pagination:{onepage:!1,previousclass:"disabled",nextclass:""}};b.render("block_current_learning/paging",n),d.get_string("displayingxofx","block_current_learning",{start:1,end:2,total:2}),j(),l(c)}i&&k()};return{init:m}});
define('block_navigation/site_admin_loader', ["jquery","core/ajax","core/config","block_navigation/ajax_response_renderer"],function(a,b,c,d){var e=71,f=c.wwwroot+"/lib/ajax/getsiteadminbranch.php";return{load:function(b){b=a(b);var g=a.Deferred(),h={type:e,sesskey:c.sesskey},i={type:"POST",dataType:"json",data:h};return a.ajax(f,i).done(function(a){d.render(b,a),g.resolve()}),g}}});
define('block_navigation/nav_loader', ["jquery","core/ajax","core/config","block_navigation/ajax_response_renderer"],function(a,b,c,d){function e(a){return a.closest("[data-block]").attr("data-instanceid")}function f(a){return a.closest("[data-block]").attr("data-block")}var g=c.wwwroot+"/lib/ajax/getnavbranch.php";return{load:function(b){b=a(b);var h=a.Deferred(),i={elementid:b.attr("data-node-id"),id:b.attr("data-node-key"),type:b.attr("data-node-type"),sesskey:c.sesskey,instance:e(b),blocktype:f(b)},j={type:"POST",dataType:"json",data:i};return a.ajax(g,j).done(function(a){d.render(b,a),h.resolve()}),h}}});
define('block_navigation/navblock', ["jquery","core/tree"],function(a,b){return{init:function(a){var c=new b(".block_navigation .block_tree");c.finishExpandingGroup=function(c){b.prototype.finishExpandingGroup.call(this,c),Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})},c.collapseGroup=function(c){b.prototype.collapseGroup.call(this,c),Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})}}}});
define('block_navigation/ajax_response_renderer', ["jquery"],function(a){function b(d,e){var f=a("<ul></ul>");f.attr("role","group"),f.attr("aria-hidden",!0),a.each(e,function(d,e){if("object"==typeof e){var g=a("<li></li>"),h=a("<p></p>"),i=e.id||e.key+"_tree_item",j=null,k=!(!e.expandable&&!e.haschildren);if(h.addClass("tree_item"),h.attr("id",i),h.attr("role","treeitem"),h.attr("tabindex","-1"),e.requiresajaxloading&&(h.attr("data-requires-ajax",!0),h.attr("data-node-id",e.id),h.attr("data-node-key",e.key),h.attr("data-node-type",e.type)),k&&(g.addClass("collapsed contains_branch"),h.attr("aria-expanded",!1),h.addClass("branch"),require(["core/templates"],function(a){a.renderIcon("collapsed").done(function(a){"false"===h.attr("aria-expanded")&&(h.find(".flex-icon").remove(),h.prepend(a))})})),e.icon&&(!k||e.type===c.ACTIVITY||e.type===c.RESOURCE)){g.addClass("item_with_icon"),h.addClass("hasicon");var l=e.flex_icon;"string"==typeof l?j=a(l):(j=a("<img/>"),j.attr("alt",e.icon.alt),j.attr("title",e.icon.title),j.attr("src",M.util.image_url(e.icon.pix,e.icon.component)),a.each(e.icon.classes,function(a,b){j.addClass(b)}))}if(e.link){var m=a('<a title="'+e.title+'" href="'+e.link+'"></a>');j?(m.append(j),m.append('<span class="item-content-wrap">'+e.name+"</span>")):m.append(e.name),e.hidden&&m.addClass("dimmed"),h.append(m)}else{var n=a("<span></span>");j?(n.append(j),n.append('<span class="item-content-wrap">'+e.name+"</span>")):n.append(e.name),e.hidden&&n.addClass("dimmed"),h.append(n)}g.append(h),f.append(g),e.children&&e.children.length?b(h,e.children):k&&!e.requiresajaxloading&&(g.removeClass("contains_branch"),h.addClass("emptybranch"),require(["core/templates"],function(a){a.renderIcon("collapsed-empty").done(function(a){"true"===h.attr("aria-expanded")&&(h.find(".flex-icon").remove(),h.prepend(a))})}))}}),d.parent().append(f);var g=d.attr("id")+"_group";f.attr("id",g),d.attr("aria-owns",g),d.attr("role","treeitem")}var c={ACTIVITY:40,RESOURCE:50};return{render:function(a,c){if(c.children&&c.children.length){b(a,c.children);var d=a.children("[role='treeitem']").first(),e=a.find("#"+d.attr("aria-owns"));d.attr("aria-expanded",!0),e.attr("aria-hidden",!1)}else a.parent().hasClass("contains_branch")&&(a.parent().removeClass("contains_branch"),require(["core/templates"],function(b){b.renderIcon("collapsed-empty").done(function(b){"true"===a.attr("aria-expanded")&&(a.find(".flex-icon").remove(),a.prepend(b))})}))}}});
define('block_settings/settingsblock', ["jquery","core/tree"],function(a,b){return{init:function(a,c){var d=new b(".block_settings .block_tree");if(c){var e=d.treeRoot.find("#"+c),f=e.children("a").first();f.replaceWith('<span tabindex="0">'+f.html()+"</span>")}d.finishExpandingGroup=function(c){b.prototype.finishExpandingGroup.call(this,c),Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})},d.collapseGroup=function(c){b.prototype.collapseGroup.call(this,c),Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})}}}});
define('block_totara_featured_links/switcher', ["jquery","core/templates","block_totara_featured_links/slick"],function(a,b){return{init:function(c,d,e,f,g,h,i,j){var k=b.renderIcon("caret-left","Previous","slick-prev"),l=b.renderIcon("caret-right","Next","slick-next"),m="fade"===e,n=g.indexOf("position_indicator")!==-1,o=g.indexOf("arrows")!==-1;a.when(k,l).then(function(b,e){var g=a("#"+d);if(g.slick({autoplay:"1"===h,autoplaySpeed:c,prevArrow:b,nextArrow:e,fade:m,dots:n,rtl:"rtl"===document.dir,arrows:o,infinite:"1"===i,pauseOnHover:"1"===j}),"random"===f&&"1"===h){var k=g.slick("getSlick").slideCount,l=0;g.slick("pause"),window.setInterval(function(){var a=Math.floor(Math.random()*(k-1));a>=l&&(a+=1),g.slick("slickGoTo",a,!1),l=a},c)}})}}});
define('block_totara_featured_links/dragndrop', ["jquery","core/ajax","jqueryui"],function(a,b){return a.widget("custom.sortableGrid",a.ui.sortable,{_onRightSide:function(a,b){return this._isOverAxis(b.pageX,a.left+a.width/2,a.width/2)},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-this.document.scrollTop()<g.scrollSensitivity?h=this.document.scrollTop(this.document.scrollTop()-g.scrollSpeed):this.window.height()-(b.pageY-this.document.scrollTop())<g.scrollSensitivity&&(h=this.document.scrollTop(this.document.scrollTop()+g.scrollSpeed)),b.pageX-this.document.scrollLeft()<g.scrollSensitivity?h=this.document.scrollLeft(this.document.scrollLeft()-g.scrollSpeed):this.window.width()-(b.pageX-this.document.scrollLeft())<g.scrollSensitivity&&(h=this.document.scrollLeft(this.document.scrollLeft()+g.scrollSpeed))),h!==!1&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d)){if(this.direction=this._onRightSide(d,b)===!0?"right":"left",this._rearrange(b,d),!this._intersectsWithSides(d))break;this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"left"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})}}),{init:function(){a(".block-totara-featured-links-layout").sortableGrid({cursor:"move",helper:"clone",placeholder:"block-totara-featured-links-placeholder",tolerance:"intersect",items:" > [id^=block-totara-featured-links-tile-]",opacity:.5,update:function(c,d){var e=a(c.target).sortableGrid("toArray");b.call([{methodname:"block_totara_featured_links_external_reorder_tiles",args:{tiles:e}}])},start:function(b,c){c.item.show(),a(".block-totara-featured-links-layout").sortableGrid("option","cursorAt",{left:c.item.width()/2,top:c.item.height()/2})}}).disableSelection()}}});
define('block_totara_featured_links/spectrum', ["jquery","core/str"],function(a,b){"use strict";function c(b,c,d,e){for(var f=[],g=0;g<b.length;g++){var h=b[g];if(h){var i=tinycolor(h),j=i.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";j+=tinycolor.equals(c,h)?" sp-thumb-active":"";var k=i.toString(e.preferredFormat||"rgb"),l=q?"background-color:"+i.toRgbString():"filter:"+i.toFilter();f.push('<span title="'+k+'" data-color="'+i.toRgbString()+'" class="'+j+'"><span class="sp-thumb-inner" style="'+l+';" /></span>')}else{var m="sp-clear-display";f.push(a("<div />").append(a('<span data-color="" style="background-color:transparent;" class="'+m+'"></span>').attr("title",e.noColorSelectedText)).html())}}return"<div class='sp-cf "+d+"'>"+f.join("")+"</div>"}function d(){for(var a=0;a<o.length;a++)o[a]&&o[a].hide()}function e(b,c){var d=a.extend({},n,b);return d.callbacks={move:j(d.move,c),change:j(d.change,c),show:j(d.show,c),hide:j(d.hide,c),beforeShow:j(d.beforeShow,c)},d}function f(f,h){function j(){if(U.showPaletteOnly&&(U.showPalette=!0),Ma.text(U.showPaletteOnly?U.togglePaletteMoreText:U.togglePaletteLessText),U.palette){na=U.palette.slice(0),oa=a.isArray(na[0])?na:[na],pa={};for(var b=0;b<oa.length;b++)for(var c=0;c<oa[b].length;c++){var d=tinycolor(oa[b][c]).toRgbString();pa[d]=!0}}xa.toggleClass("sp-flat",V),xa.toggleClass("sp-input-disabled",!U.showInput),xa.toggleClass("sp-alpha-enabled",U.showAlpha),xa.toggleClass("sp-clear-enabled",Ya),xa.toggleClass("sp-buttons-disabled",!U.showButtons),xa.toggleClass("sp-palette-buttons-disabled",!U.togglePaletteOnly),xa.toggleClass("sp-palette-disabled",!U.showPalette),xa.toggleClass("sp-palette-only",U.showPaletteOnly),xa.toggleClass("sp-initial-disabled",!U.showInitial),xa.addClass(U.className).addClass(U.containerClassName),O()}function n(){function c(b){return b.data&&b.data.ignore?(H(a(b.target).closest(".sp-thumb-el").data("color")),K()):(H(a(b.target).closest(".sp-thumb-el").data("color")),K(),N(!0),U.hideAfterPaletteSelect&&F()),!1}if(p&&xa.find("*:not(input)").attr("unselectable","on"),j(),Pa&&va.after(Qa).hide(),Ya||Ka.hide(),V)va.after(xa).hide();else{var d="parent"===U.appendTo?va.parent():a(U.appendTo);1!==d.length&&(d=a("body")),d.append(xa)}t(),Ra.bind("click.spectrum touchstart.spectrum",function(b){wa||B(),b.stopPropagation(),a(b.target).is("input")||b.preventDefault()}),(va.is(":disabled")||U.disabled===!0)&&S(),xa.click(i),Ga.change(A),Ga.bind("paste",function(){setTimeout(A,1)}),Ga.keydown(function(a){13==a.keyCode&&A()}),Ja.text(U.cancelText),Ja.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),G(),F()}),Ka.attr("title",U.clearText),Ka.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),Xa=!0,K(),V&&N(!0)}),La.text(U.chooseText),La.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),p&&Ga.is(":focus")&&Ga.trigger("change"),J()&&(N(!0),F())}),b.get_strings([{key:"cancel",component:"moodle"},{key:"choose",component:"moodle"}]).done(function(a){Ja.text(a[0]),La.text(a[1])}),Ma.text(U.showPaletteOnly?U.togglePaletteMoreText:U.togglePaletteLessText),Ma.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),U.showPaletteOnly=!U.showPaletteOnly,U.showPaletteOnly||V||xa.css("left","-="+(ya.outerWidth(!0)+5)),j()}),k(Ea,function(a,b,c){ma=a/ga,Xa=!1,c.shiftKey&&(ma=Math.round(10*ma)/10),K()},y,z),k(Ba,function(a,b){ja=parseFloat(b/ea),Xa=!1,U.showAlpha||(ma=1),K()},y,z),k(za,function(a,b,c){if(c.shiftKey){if(!ta){var d=ka*ba,e=ca-la*ca,f=Math.abs(a-d)>Math.abs(b-e);ta=f?"x":"y"}}else ta=null;var g=!ta||"x"===ta,h=!ta||"y"===ta;g&&(ka=parseFloat(a/ba)),h&&(la=parseFloat((ca-b)/ca)),Xa=!1,U.showAlpha||(ma=1),K()},y,z),Ta?(H(Ta),L(),Va=U.preferredFormat||tinycolor(Ta).format,u(Ta)):L(),V&&C();var e=p?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Ha.delegate(".sp-thumb-el",e,c),Ia.delegate(".sp-thumb-el:nth-child(1)",e,{ignore:!0},c)}function t(){if(X&&window.localStorage){try{var b=window.localStorage[X].split(",#");b.length>1&&(delete window.localStorage[X],a.each(b,function(a,b){u(b)}))}catch(c){}try{qa=window.localStorage[X].split(";")}catch(c){}}}function u(b){if(W){var c=tinycolor(b).toRgbString();if(!pa[c]&&a.inArray(c,qa)===-1)for(qa.push(c);qa.length>ra;)qa.shift();if(X&&window.localStorage)try{window.localStorage[X]=qa.join(";")}catch(d){}}}function v(){var a=[];if(U.showPalette)for(var b=0;b<qa.length;b++){var c=tinycolor(qa[b]).toRgbString();pa[c]||a.push(qa[b])}return a.reverse().slice(0,U.maxSelectionSize)}function w(){var b=I(),d=a.map(oa,function(a,d){return c(a,b,"sp-palette-row sp-palette-row-"+d,U)});t(),qa&&d.push(c(v(),b,"sp-palette-row sp-palette-row-selection",U)),Ha.html(d.join(""))}function x(){if(U.showInitial){var a=Ua,b=I();Ia.html(c([a,b],b,"sp-palette-row-initial",U))}}function y(){(ca<=0||ba<=0||ea<=0)&&O(),aa=!0,xa.addClass(sa),ta=null,va.trigger("dragstart.spectrum",[I()])}function z(){aa=!1,xa.removeClass(sa),va.trigger("dragstop.spectrum",[I()])}function A(){var a=Ga.val();if(null!==a&&""!==a||!Ya){var b=tinycolor(a);b.isValid()?(H(b),N(!0)):Ga.addClass("sp-validation-error")}else H(null),N(!0)}function B(){_?F():C()}function C(){var b=a.Event("beforeShow.spectrum");return _?void O():(va.trigger(b,[I()]),void(Z.beforeShow(I())===!1||b.isDefaultPrevented()||(d(),_=!0,a(ua).bind("keydown.spectrum",D),a(ua).bind("click.spectrum",E),a(window).bind("resize.spectrum",$),Qa.addClass("sp-active"),xa.removeClass("sp-hidden"),O(),L(),Ua=I(),x(),Z.show(Ua),va.trigger("show.spectrum",[Ua]))))}function D(a){27===a.keyCode&&F()}function E(a){2!=a.button&&(aa||(Wa?N(!0):G(),F()))}function F(){_&&!V&&(_=!1,a(ua).unbind("keydown.spectrum",D),a(ua).unbind("click.spectrum",E),a(window).unbind("resize.spectrum",$),Qa.removeClass("sp-active"),xa.addClass("sp-hidden"),Z.hide(I()),va.trigger("hide.spectrum",[I()]))}function G(){H(Ua,!0)}function H(a,b){if(tinycolor.equals(a,I()))return void L();var c,d;!a&&Ya?Xa=!0:(Xa=!1,c=tinycolor(a),d=c.toHsv(),ja=d.h%360/360,ka=d.s,la=d.v,ma=d.a),L(),c&&c.isValid()&&!b&&(Va=U.preferredFormat||c.getFormat())}function I(a){return a=a||{},Ya&&Xa?null:tinycolor.fromRatio({h:ja,s:ka,v:la,a:Math.round(100*ma)/100},{format:a.format||Va})}function J(){return!Ga.hasClass("sp-validation-error")}function K(){L(),Z.move(I()),va.trigger("move.spectrum",[I()])}function L(){Ga.removeClass("sp-validation-error"),M();var a=tinycolor.fromRatio({h:ja,s:1,v:1});za.css("background-color",a.toHexString());var b=Va;ma<1&&(0!==ma||"name"!==b)&&("hex"!==b&&"hex3"!==b&&"hex6"!==b&&"name"!==b||(b="rgb"));var c=I({format:b}),d="";if(Sa.removeClass("sp-clear-display"),Sa.css("background-color","transparent"),!c&&Ya)Sa.addClass("sp-clear-display");else{var e=c.toHexString(),f=c.toRgbString();if(q||1===c.alpha?Sa.css("background-color",f):(Sa.css("background-color","transparent"),Sa.css("filter",c.toFilter())),U.showAlpha){var g=c.toRgb();g.a=0;var h=tinycolor(g).toRgbString(),i="linear-gradient(left, "+h+", "+e+")";p?Da.css("filter",tinycolor(h).toFilter({gradientType:1},e)):(Da.css("background","-webkit-"+i),Da.css("background","-moz-"+i),Da.css("background","-ms-"+i),Da.css("background","linear-gradient(to right, "+h+", "+e+")"))}d=c.toString(b)}U.showInput&&Ga.val(d),U.showPalette&&w(),x()}function M(){var a=ka,b=la;if(Ya&&Xa)Fa.hide(),Ca.hide(),Aa.hide();else{Fa.show(),Ca.show(),Aa.show();var c=a*ba,d=ca-b*ca;c=Math.max(-da,Math.min(ba-da,c-da)),d=Math.max(-da,Math.min(ca-da,d-da)),Aa.css({top:d+"px",left:c+"px"});var e=ma*ga;Fa.css({left:e-ha/2+"px"});var f=ja*ea;Ca.css({top:f-ia+"px"})}}function N(a){var b=I(),c="",d=!tinycolor.equals(b,Ua);b&&(c=b.toString(Va),u(b)),Na&&va.val(c),a&&d&&(Z.change(b),va.trigger("change",[b]))}function O(){_&&(ba=za.width(),ca=za.height(),da=Aa.height(),fa=Ba.width(),ea=Ba.height(),ia=Ca.height(),ga=Ea.width(),ha=Fa.width(),V||(xa.css("position","absolute"),U.offset?xa.offset(U.offset):xa.offset(g(xa,Ra))),M(),U.showPalette&&w(),va.trigger("reflow.spectrum"))}function P(){va.show(),Ra.unbind("click.spectrum touchstart.spectrum"),xa.remove(),Qa.remove(),o[Za.id]=null}function Q(b,c){return void 0===b?a.extend({},U):void 0===c?U[b]:(U[b]=c,"preferredFormat"===b&&(Va=U.preferredFormat),void j())}function R(){wa=!1,va.attr("disabled",!1),Ra.removeClass("sp-disabled")}function S(){F(),wa=!0,va.attr("disabled",!0),Ra.addClass("sp-disabled")}function T(a){U.offset=a,O()}var U=e(h,f),V=U.flat,W=U.showSelectionPalette,X=U.localStorageKey,Y=U.theme,Z=U.callbacks,$=l(O,10),_=!1,aa=!1,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=0,la=0,ma=1,na=[],oa=[],pa={},qa=U.selectionPalette.slice(0),ra=U.maxSelectionSize,sa="sp-dragging",ta=null,ua=f.ownerDocument,va=(ua.body,a(f)),wa=!1,xa=a(s,ua).addClass(Y),ya=xa.find(".sp-picker-container"),za=xa.find(".sp-color"),Aa=xa.find(".sp-dragger"),Ba=xa.find(".sp-hue"),Ca=xa.find(".sp-slider"),Da=xa.find(".sp-alpha-inner"),Ea=xa.find(".sp-alpha"),Fa=xa.find(".sp-alpha-handle"),Ga=xa.find(".sp-input"),Ha=xa.find(".sp-palette"),Ia=xa.find(".sp-initial"),Ja=xa.find(".sp-cancel"),Ka=xa.find(".sp-clear"),La=xa.find(".sp-choose"),Ma=xa.find(".sp-palette-toggle"),Na=va.is("input"),Oa=Na&&"color"===va.attr("type")&&m(),Pa=Na&&!V,Qa=Pa?a(r).addClass(Y).addClass(U.className).addClass(U.replacerClassName):a([]),Ra=Pa?Qa:va,Sa=Qa.find(".sp-preview-inner"),Ta=U.color||Na&&va.val(),Ua=!1,Va=U.preferredFormat,Wa=!U.showButtons||U.clickoutFiresChange,Xa=!Ta,Ya=U.allowEmpty&&!Oa;n();var Za={show:C,hide:F,toggle:B,reflow:O,option:Q,enable:R,disable:S,offset:T,set:function(a){H(a),N()},get:I,destroy:P,container:xa};return Za.id=o.push(Za)-1,Za}function g(b,c){var d=0,e=b.outerWidth(),f=b.outerHeight(),g=c.outerHeight(),h=b[0].ownerDocument,i=h.documentElement,j=i.clientWidth+a(h).scrollLeft(),k=i.clientHeight+a(h).scrollTop(),l=c.offset();return l.top+=g,l.left-=Math.min(l.left,l.left+e>j&&j>e?Math.abs(l.left+e-j):0),l.top-=Math.min(l.top,l.top+f>k&&k>f?Math.abs(f+g-d):d),l}function h(){}function i(a){a.stopPropagation()}function j(a,b){var c=Array.prototype.slice,d=c.call(arguments,2);return function(){return a.apply(b,d.concat(c.call(arguments)))}}function k(b,c,d,e){function f(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.returnValue=!1}function g(a){if(k){if(p&&j.documentMode<9&&!a.button)return i();var d=a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0],e=d&&d.pageX||a.pageX,g=d&&d.pageY||a.pageY,h=Math.max(0,Math.min(e-l.left,n)),q=Math.max(0,Math.min(g-l.top,m));o&&f(a),c.apply(b,[h,q,a])}}function h(c){var e=c.which?3==c.which:2==c.button;e||k||d.apply(b,arguments)!==!1&&(k=!0,m=a(b).height(),n=a(b).width(),l=a(b).offset(),a(j).bind(q),a(j.body).addClass("sp-dragging"),g(c),f(c))}function i(){k&&(a(j).unbind(q),a(j.body).removeClass("sp-dragging"),setTimeout(function(){e.apply(b,arguments)},0)),k=!1}c=c||function(){},d=d||function(){},e=e||function(){};var j=document,k=!1,l={},m=0,n=0,o="ontouchstart"in window,q={};q.selectstart=f,q.dragstart=f,q["touchmove mousemove"]=g,q["touchend mouseup"]=i,a(b).bind("touchstart mousedown",h)}function l(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d),!c&&d||(d=setTimeout(g,b))}}function m(){return a.fn.spectrum.inputTypeColorSupport()}var n={beforeShow:h,move:h,change:h,show:h,hide:h,color:!1,flat:!1,showInput:!0,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"",chooseText:"",togglePaletteMoreText:"",togglePaletteLessText:"",clearText:"",noColorSelectedText:"",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},o=[],p=!!/msie/i.exec(window.navigator.userAgent),q=function(){function a(a,b){return!!~(""+a).indexOf(b)}var b=document.createElement("div"),c=b.style;return c.cssText="background-color:rgba(0,0,0,.5)",a(c.backgroundColor,"rgba")||a(c.backgroundColor,"hsla")}(),r=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),s=function(){var a="";if(p)for(var b=1;b<=6;b++)a+="<div class='sp-"+b+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",a,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),t="spectrum.id";return a.fn.spectrum=function(b,c){if("string"==typeof b){var d=this,e=Array.prototype.slice.call(arguments,1);return this.each(function(){var c=o[a(this).data(t)];if(c){var f=c[b];if(!f)throw new Error("Spectrum: no such method: '"+b+"'");"get"==b?d=c.get():"container"==b?d=c.container:"option"==b?d=c.option.apply(c,e):"destroy"==b?(c.destroy(),a(this).removeData(t)):f.apply(c,e)}}),d}return this.spectrum("destroy").each(function(){var c=a.extend({},b,a(this).data()),d=f(this,c);a(this).data(t,d.id)})},a.fn.spectrum.load=!0,a.fn.spectrum.loadOpts={},a.fn.spectrum.draggable=k,a.fn.spectrum.defaults=n,a.fn.spectrum.inputTypeColorSupport=function u(){if("undefined"==typeof u._cachedResult){var b=a("<input type='color'/>")[0];u._cachedResult="color"===b.type&&""!==b.value}return u._cachedResult},a.spectrum={},a.spectrum.localization={},a.spectrum.palettes={},a.fn.spectrum.processNativeColorInputs=function(){var b=a("input[type=color]");b.length&&!m()&&b.spectrum({preferredFormat:"hex6"})},function(){function a(a){var c={r:0,g:0,b:0},e=1,g=!1,h=!1;return"string"==typeof a&&(a=G(a)),"object"==typeof a&&(a.hasOwnProperty("r")&&a.hasOwnProperty("g")&&a.hasOwnProperty("b")?(c=b(a.r,a.g,a.b),g=!0,h="%"===String(a.r).substr(-1)?"prgb":"rgb"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("v")?(a.s=D(a.s),a.v=D(a.v),c=f(a.h,a.s,a.v),g=!0,h="hsv"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("l")&&(a.s=D(a.s),a.l=D(a.l),c=d(a.h,a.s,a.l),g=!0,h="hsl"),a.hasOwnProperty("a")&&(e=a.a)),e=w(e),{ok:g,format:a.format||h,r:M(255,N(c.r,0)),g:M(255,N(c.g,0)),b:M(255,N(c.b,0)),a:e}}function b(a,b,c){return{r:255*x(a,255),g:255*x(b,255),b:255*x(c,255)}}function c(a,b,c){a=x(a,255),b=x(b,255),c=x(c,255);var d,e,f=N(a,b,c),g=M(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(b<c?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function d(a,b,c){function d(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+6*(b-a)*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=x(a,360),b=x(b,100),c=x(c,100),0===b)e=f=g=c;else{var h=c<.5?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function e(a,b,c){a=x(a,255),b=x(b,255),c=x(c,255);var d,e,f=N(a,b,c),g=M(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(b<c?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function f(a,b,c){a=6*x(a,360),b=x(b,100),c=x(c,100);var d=K.floor(a),e=a-d,f=c*(1-b),g=c*(1-e*b),h=c*(1-(1-e)*b),i=d%6,j=[c,g,f,f,h,c][i],k=[h,c,c,g,f,f][i],l=[f,f,h,c,c,g][i];return{r:255*j,g:255*k,b:255*l}}function g(a,b,c,d){var e=[C(L(a).toString(16)),C(L(b).toString(16)),C(L(c).toString(16))];return d&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function h(a,b,c,d){var e=[C(E(d)),C(L(a).toString(16)),C(L(b).toString(16)),C(L(c).toString(16))];return e.join("")}function i(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.s-=b/100,c.s=y(c.s),P(c)}function j(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.s+=b/100,c.s=y(c.s),P(c)}function k(a){return P(a).desaturate(100)}function l(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.l+=b/100,c.l=y(c.l),P(c)}function m(a,b){b=0===b?0:b||10;var c=P(a).toRgb();return c.r=N(0,M(255,c.r-L(255*-(b/100)))),c.g=N(0,M(255,c.g-L(255*-(b/100)))),c.b=N(0,M(255,c.b-L(255*-(b/100)))),P(c)}function n(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.l-=b/100,c.l=y(c.l),P(c)}function o(a,b){var c=P(a).toHsl(),d=(L(c.h)+b)%360;return c.h=d<0?360+d:d,P(c)}function p(a){var b=P(a).toHsl();return b.h=(b.h+180)%360,P(b)}function q(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+120)%360,s:b.s,l:b.l}),P({h:(c+240)%360,s:b.s,l:b.l})]}function r(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+90)%360,s:b.s,l:b.l}),P({h:(c+180)%360,s:b.s,l:b.l}),P({h:(c+270)%360,s:b.s,l:b.l})]}function s(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+72)%360,s:b.s,l:b.l}),P({h:(c+216)%360,s:b.s,l:b.l})]}function t(a,b,c){b=b||6,c=c||30;var d=P(a).toHsl(),e=360/c,f=[P(a)];for(d.h=(d.h-(e*b>>1)+720)%360;--b;)d.h=(d.h+e)%360,f.push(P(d));return f}function u(a,b){b=b||6;for(var c=P(a).toHsv(),d=c.h,e=c.s,f=c.v,g=[],h=1/b;b--;)g.push(P({h:d,s:e,v:f})),f=(f+h)%1;return g}function v(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function w(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function x(a,b){A(a)&&(a="100%");var c=B(a);return a=M(b,N(0,parseFloat(a))),c&&(a=parseInt(a*b,10)/100),K.abs(a-b)<1e-6?1:a%b/parseFloat(b)}function y(a){return M(1,N(0,a))}function z(a){return parseInt(a,16)}function A(a){return"string"==typeof a&&a.indexOf(".")!=-1&&1===parseFloat(a)}function B(a){return"string"==typeof a&&a.indexOf("%")!=-1}function C(a){return 1==a.length?"0"+a:""+a}function D(a){return a<=1&&(a=100*a+"%"),a}function E(a){return Math.round(255*parseFloat(a)).toString(16)}function F(a){return z(a)/255}function G(a){a=a.replace(H,"").replace(I,"").toLowerCase();var b=!1;if(Q[a])a=Q[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=S.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=S.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=S.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=S.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=S.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=S.hsva.exec(a))?{h:c[1],s:c[2],v:c[3],a:c[4]}:(c=S.hex8.exec(a))?{a:F(c[1]),r:z(c[2]),g:z(c[3]),b:z(c[4]),format:b?"name":"hex8"}:(c=S.hex6.exec(a))?{r:z(c[1]),g:z(c[2]),b:z(c[3]),format:b?"name":"hex"}:!!(c=S.hex3.exec(a))&&{r:z(c[1]+""+c[1]),g:z(c[2]+""+c[2]),b:z(c[3]+""+c[3]),format:b?"name":"hex"}}var H=/^[\s,#]+/,I=/\s+$/,J=0,K=Math,L=K.round,M=K.min,N=K.max,O=K.random,P=function(b,c){if(b=b?b:"",c=c||{},b instanceof P)return b;if(!(this instanceof P))return new P(b,c);var d=a(b);this._originalInput=b,this._r=d.r,this._g=d.g,this._b=d.b,this._a=d.a,this._roundA=L(100*this._a)/100,this._format=c.format||d.format,this._gradientType=c.gradientType,this._r<1&&(this._r=L(this._r)),this._g<1&&(this._g=L(this._g)),this._b<1&&(this._b=L(this._b)),this._ok=d.ok,this._tc_id=J++};P.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},setAlpha:function(a){return this._a=w(a),this._roundA=L(100*this._a)/100,this},toHsv:function(){var a=e(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=e(this._r,this._g,this._b),b=L(360*a.h),c=L(100*a.s),d=L(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=c(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=c(this._r,this._g,this._b),b=L(360*a.h),d=L(100*a.s),e=L(100*a.l);return 1==this._a?"hsl("+b+", "+d+"%, "+e+"%)":"hsla("+b+", "+d+"%, "+e+"%, "+this._roundA+")"},toHex:function(a){return g(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:L(this._r),g:L(this._g),b:L(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+L(this._r)+", "+L(this._g)+", "+L(this._b)+")":"rgba("+L(this._r)+", "+L(this._g)+", "+L(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:L(100*x(this._r,255))+"%",g:L(100*x(this._g,255))+"%",b:L(100*x(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+L(100*x(this._r,255))+"%, "+L(100*x(this._g,255))+"%, "+L(100*x(this._b,255))+"%)":"rgba("+L(100*x(this._r,255))+"%, "+L(100*x(this._g,255))+"%, "+L(100*x(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(R[g(this._r,this._g,this._b,!0)]||!1)},toFilter:function(a){var b="#"+h(this._r,this._g,this._b,this._a),c=b,d=this._gradientType?"GradientType = 1, ":"";if(a){var e=P(a);c=e.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+b+",endColorstr="+c+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=this._a<1&&this._a>=0,e=!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"name"===a);return e?"name"===a&&0===this._a?this.toName():this.toRgbString():("rgb"===a&&(c=this.toRgbString()),"prgb"===a&&(c=this.toPercentageRgbString()),"hex"!==a&&"hex6"!==a||(c=this.toHexString()),"hex3"===a&&(c=this.toHexString(!0)),"hex8"===a&&(c=this.toHex8String()),"name"===a&&(c=this.toName()),"hsl"===a&&(c=this.toHslString()),"hsv"===a&&(c=this.toHsvString()),c||this.toHexString())},_applyModification:function(a,b){var c=a.apply(null,[this].concat([].slice.call(b)));return this._r=c._r,this._g=c._g,this._b=c._b,this.setAlpha(c._a),this},lighten:function(){return this._applyModification(l,arguments)},brighten:function(){return this._applyModification(m,arguments)},darken:function(){return this._applyModification(n,arguments)},desaturate:function(){return this._applyModification(i,arguments)},saturate:function(){return this._applyModification(j,arguments)},greyscale:function(){return this._applyModification(k,arguments)},spin:function(){return this._applyModification(o,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(t,arguments)},complement:function(){return this._applyCombination(p,arguments)},monochromatic:function(){return this._applyCombination(u,arguments)},splitcomplement:function(){return this._applyCombination(s,arguments)},triad:function(){return this._applyCombination(q,arguments)},tetrad:function(){return this._applyCombination(r,arguments)}},P.fromRatio=function(a,b){if("object"==typeof a){var c={};for(var d in a)a.hasOwnProperty(d)&&("a"===d?c[d]=a[d]:c[d]=D(a[d]));a=c}return P(a,b)},P.equals=function(a,b){return!(!a||!b)&&P(a).toRgbString()==P(b).toRgbString()},P.random=function(){return P.fromRatio({r:O(),g:O(),b:O()})},P.mix=function(a,b,c){c=0===c?0:c||50;var d,e=P(a).toRgb(),f=P(b).toRgb(),g=c/100,h=2*g-1,i=f.a-e.a;d=h*i==-1?h:(h+i)/(1+h*i),d=(d+1)/2;var j=1-d,k={r:f.r*d+e.r*j,g:f.g*d+e.g*j,b:f.b*d+e.b*j,a:f.a*g+e.a*(1-g)};return P(k)},P.readability=function(a,b){var c=P(a),d=P(b),e=c.toRgb(),f=d.toRgb(),g=c.getBrightness(),h=d.getBrightness(),i=Math.max(e.r,f.r)-Math.min(e.r,f.r)+Math.max(e.g,f.g)-Math.min(e.g,f.g)+Math.max(e.b,f.b)-Math.min(e.b,f.b);return{brightness:Math.abs(g-h),color:i}},P.isReadable=function(a,b){var c=P.readability(a,b);return c.brightness>125&&c.color>500},P.mostReadable=function(a,b){for(var c=null,d=0,e=!1,f=0;f<b.length;f++){var g=P.readability(a,b[f]),h=g.brightness>125&&g.color>500,i=3*(g.brightness/125)+g.color/500;(h&&!e||h&&e&&i>d||!h&&!e&&i>d)&&(e=h,d=i,c=P(b[f]))}return c};var Q=P.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},R=P.hexNames=v(Q),S=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hsva:new RegExp("hsva"+e),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=P}(),a(function(){a.fn.spectrum.load&&a.fn.spectrum.processNativeColorInputs()}),{spectrum:a}});
define('block_totara_featured_links/visibility_form', ["jquery"],function(a){var b,c=["audience_showing","preset_showing","tile_rules_showing"],d=function(b){var d=0;a.each(c,function(c,e){a("#tfiid_"+e+"_"+b).is(":checked")&&d++}),a("#tfiid_audience_showing_"+b).length||d++,d>=2?a('[data-element-id="tfiid_aggregation'+b+'"]').each(function(b,c){a(c).removeAttr("data-hidden")}):a('[data-element-id="tfiid_aggregation'+b+'"]').each(function(b,c){a(c).attr("data-hidden","")})},e=function(){a("[data-type=cohort_delete]").each(function(b,c){a(c).off("click"),a(c).click(function(b){a(b.target).closest("li").remove();var c=a(b.target).closest("a").attr("cohortid"),d=a('input[name="audiences_visible"]'),e=d.val().split(",");e.indexOf(c)!=-1&&e.splice(e.indexOf(c),1),d.val(e.join()),d.change()})})};return{init:function(f){b=f,a.each(c,function(b,c){a("#tfiid_"+c+"_"+f).on("change",function(){d(f)})}),a("#tfiid_visibility_"+f).on("change",function(){"2"!=a("input[name=visibility]:checked","#tfiid_visibility_"+f).val()?a('[data-element-id="tfiid_aggregation'+f+'"]').each(function(b,c){a(c).attr("data-hidden","")}):(d(f),e())}),e(),"2"!=a("input[name=visibility]:checked","#tfiid_visibility_"+f).val()?a('[data-element-id="tfiid_aggregation'+f+'"]').each(function(b,c){a(c).attr("data-hidden","")}):d(f)},add_audience_table_listeners:e,add_to_audience_id:function(b){if(0!==b.length){var c=a('input[name="audiences_visible"]');c.val(c.val()+(0===c.val().length?"":",")+b),c.change()}},add_to_audience_list:function(b){a("#audience_visible_table").append(b)},audience_list_contains:function(b){return a("#audience_visible_table").find('span[cohortid="'+b+'"]').length}}});
define('block_totara_featured_links/audience_dialog', ["jquery","core/ajax","block_totara_featured_links/visibility_form","core/str","core/config","core/templates","core/flex_icon"],function(a,b,c,d,e,f,g){var h,i="",j={},k={ok:"",cancel:"",title:""},l=function(){var b=function(){this.baseurl=""};b.prototype=new totaraDialog_handler_treeview_multiselect,b.prototype.every_load=function(){a("#audience_visible_table").find("[cohortid]").each(function(){var b=a(this).attr("cohortid");l._toggle_items("item_"+b,!1)}),this._make_selectable(a(".treeview",this._container)),this._make_deletable(a(".selected",this._container))},i=j.instanceid;var l=new b;h=l;var m={};m[k.ok]=function(){l._update()},m[k.cancel]=function(){l._cancel()};var n=e.wwwroot+"/totara/cohort/dialog/";new totaraDialog("course-cohorts-visible-dialogue","add_audience_id",{buttons:m,title:k.title},n+"cohort.php?selected="+j.visibleselected+"&instancetype="+j.instancetype+"&instanceid="+j.instanceid+"&sesskey="+j.sesskey,l),b.prototype._update=function(){var b=a(".selected [id^=item]",this._container);b.each(function(){var b=a(this).attr("id").split("_"),e=a(this).find("a").text();b=b[b.length-1],b=parseInt(b),c.audience_list_contains(b)||d.get_string("delete_audience_rule","block_totara_featured_links",e).then(function(a){return g.getIconData("delete","core",{alt:a})}).then(function(a){var c={cohortid:b,name:e,deleteicon:a};return f.render("block_totara_featured_links/element_audience_list_item",c)}).then(function(a){c.add_to_audience_list(a),c.add_to_audience_id(b),c.add_audience_table_listeners()})}),l._dialog.hide()}};return{init:function(b,c,e){j.instancetype=b,j.instanceid=c,j.sesskey=e;var f=[];f.push({key:"ok",component:"moodle"}),f.push({key:"cancel",component:"moodle"}),f.push({key:"audience_add",component:"block_totara_featured_links"}),d.get_strings(f).done(function(b){k={ok:b[0],cancel:b[1],title:b[2]},window.dialogsInited?l():(a.isArray(window.dialoginits)||(window.dialoginits=[]),window.dialoginits.push(l))})}}});
define('block_totara_featured_links/ajax', ["jquery","core/ajax","core/str"],function(a,b,c){return{block_totara_featured_links_remove_tile:function(){var d=[];d.push({key:"delete",component:"core"}),d.push({key:"cancel",component:"core"}),d.push({key:"confirm",component:"block_totara_featured_links"}),c.get_strings(d).done(function(c){var d=a('a[type="remove"]');d.off("click"),d.click(function(d){d.preventDefault();var e=new M.core.confirm({question:c[2],modal:!0,yesLabel:c[0],noLabel:c[1],title:"&nbsp;",zIndex:500});e.on("complete-yes",function(){var c=a(d.target).closest("a"),e=c.attr("tileid"),f=b.call([{methodname:"block_totara_featured_links_external_remove_tile",args:{tileid:e}}]);f[0].done(function(b){b===!0&&a(d.target).closest(".block-totara-featured-links-layout > div").hide()})},this)})})}}});
define('block_totara_featured_links/icon_sizer', ["jquery"],function(a){var b=function(b){var c=a("#block-totara-featured-links-tile-"+b+" .block-totara-featured-links-icon");c.each(function(b,c){a(d).attr("style","");var d=a(c).find("span.flex-icon"),e=d.height()/d.width(),f=a(c).parent("div").height(),g=a(c).parent("div").width(),h=f>g?g:f,i=1;a(c).hasClass("block-totara-featured-links-icon-small")&&(i=.5),a(c).hasClass("block-totara-featured-links-icon-medium")&&(i=.8),e<1?a(d).attr("style","font-size: "+Math.floor(e*h)*i+"px !important"):a(d).attr("style","font-size: "+Math.floor(1/e*h)*i+"px !important"),a(d).css("height",h*i+"px"),a(d).css("line-height",h*i+"px")})};return{resize:b}});
define('block_totara_featured_links/learning_item_dialog', ["jquery","core/str","core/config"],function(a,b,c){var d="",e="",f={ok:"",cancel:"",title:""},g=function(){var b=c.wwwroot+"/blocks/totara_featured_links/"+e+"_dialog.php?";totaraSingleSelectDialog(e,f.title+d,b,e+"_name_id",e+"-name"),a('input[name="'+e+'_name"]').attr("readonly","readonly")};return{init:function(c,h){e=h,d=c;var i=[];i.push({key:"cancel",component:"moodle"}),i.push({key:e+"_select",component:"block_totara_featured_links"}),b.get_strings(i).done(function(b){f={cancel:b[0],title:b[1]},window.dialogsInited?g():(a.isArray(window.dialoginits)||(window.dialoginits=[]),window.dialoginits.push(g))})}}});
!function(a){"use strict";"function"==typeof define&&define.amd?define('block_totara_featured_links/slick', ["jquery"],a):"undefined"!=typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";var b=window.Slick||{};b=function(){function b(b,d){var e,f=this;f.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:a(b),appendDots:a(b),arrows:!0,asNavFor:null,prevArrow:'<button class="slick-prev" aria-label="Previous" type="button">Previous</button>',nextArrow:'<button class="slick-next" aria-label="Next" type="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(b,c){return a('<button type="button" />').text(c+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,focusOnChange:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},f.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,scrolling:!1,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,swiping:!1,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},a.extend(f,f.initials),f.activeBreakpoint=null,f.animType=null,f.animProp=null,f.breakpoints=[],f.breakpointSettings=[],f.cssTransitions=!1,f.focussed=!1,f.interrupted=!1,f.hidden="hidden",f.paused=!0,f.positionProp=null,f.respondTo=null,f.rowCount=1,f.shouldClick=!0,f.$slider=a(b),f.$slidesCache=null,f.transformType=null,f.transitionType=null,f.visibilityChange="visibilitychange",f.windowWidth=0,f.windowTimer=null,e=a(b).data("slick")||{},f.options=a.extend({},f.defaults,d,e),f.currentSlide=f.options.initialSlide,f.originalSettings=f.options,"undefined"!=typeof document.mozHidden?(f.hidden="mozHidden",f.visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(f.hidden="webkitHidden",f.visibilityChange="webkitvisibilitychange"),f.autoPlay=a.proxy(f.autoPlay,f),f.autoPlayClear=a.proxy(f.autoPlayClear,f),f.autoPlayIterator=a.proxy(f.autoPlayIterator,f),f.changeSlide=a.proxy(f.changeSlide,f),f.clickHandler=a.proxy(f.clickHandler,f),f.selectHandler=a.proxy(f.selectHandler,f),f.setPosition=a.proxy(f.setPosition,f),f.swipeHandler=a.proxy(f.swipeHandler,f),f.dragHandler=a.proxy(f.dragHandler,f),f.keyHandler=a.proxy(f.keyHandler,f),f.instanceUid=c++,f.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,f.registerBreakpoints(),f.init(!0)}var c=0;return b}(),b.prototype.activateADA=function(){var a=this;a.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},b.prototype.addSlide=b.prototype.slickAdd=function(b,c,d){var e=this;if("boolean"==typeof c)d=c,c=null;else if(c<0||c>=e.slideCount)return!1;e.unload(),"number"==typeof c?0===c&&0===e.$slides.length?a(b).appendTo(e.$slideTrack):d?a(b).insertBefore(e.$slides.eq(c)):a(b).insertAfter(e.$slides.eq(c)):d===!0?a(b).prependTo(e.$slideTrack):a(b).appendTo(e.$slideTrack),e.$slides=e.$slideTrack.children(this.options.slide),e.$slideTrack.children(this.options.slide).detach(),e.$slideTrack.append(e.$slides),e.$slides.each(function(b,c){a(c).attr("data-slick-index",b)}),e.$slidesCache=e.$slides,e.reinit()},b.prototype.animateHeight=function(){var a=this;if(1===a.options.slidesToShow&&a.options.adaptiveHeight===!0&&a.options.vertical===!1){var b=a.$slides.eq(a.currentSlide).outerHeight(!0);a.$list.animate({height:b},a.options.speed)}},b.prototype.animateSlide=function(b,c){var d={},e=this;e.animateHeight(),e.options.rtl===!0&&e.options.vertical===!1&&(b=-b),e.transformsEnabled===!1?e.options.vertical===!1?e.$slideTrack.animate({left:b},e.options.speed,e.options.easing,c):e.$slideTrack.animate({top:b},e.options.speed,e.options.easing,c):e.cssTransitions===!1?(e.options.rtl===!0&&(e.currentLeft=-e.currentLeft),a({animStart:e.currentLeft}).animate({animStart:b},{duration:e.options.speed,easing:e.options.easing,step:function(a){a=Math.ceil(a),e.options.vertical===!1?(d[e.animType]="translate("+a+"px, 0px)",e.$slideTrack.css(d)):(d[e.animType]="translate(0px,"+a+"px)",e.$slideTrack.css(d))},complete:function(){c&&c.call()}})):(e.applyTransition(),b=Math.ceil(b),e.options.vertical===!1?d[e.animType]="translate3d("+b+"px, 0px, 0px)":d[e.animType]="translate3d(0px,"+b+"px, 0px)",e.$slideTrack.css(d),c&&setTimeout(function(){e.disableTransition(),c.call()},e.options.speed))},b.prototype.getNavTarget=function(){var b=this,c=b.options.asNavFor;return c&&null!==c&&(c=a(c).not(b.$slider)),c},b.prototype.asNavFor=function(b){var c=this,d=c.getNavTarget();null!==d&&"object"==typeof d&&d.each(function(){var c=a(this).slick("getSlick");c.unslicked||c.slideHandler(b,!0)})},b.prototype.applyTransition=function(a){var b=this,c={};b.options.fade===!1?c[b.transitionType]=b.transformType+" "+b.options.speed+"ms "+b.options.cssEase:c[b.transitionType]="opacity "+b.options.speed+"ms "+b.options.cssEase,b.options.fade===!1?b.$slideTrack.css(c):b.$slides.eq(a).css(c)},b.prototype.autoPlay=function(){var a=this;a.autoPlayClear(),a.slideCount>a.options.slidesToShow&&(a.autoPlayTimer=setInterval(a.autoPlayIterator,a.options.autoplaySpeed))},b.prototype.autoPlayClear=function(){var a=this;a.autoPlayTimer&&clearInterval(a.autoPlayTimer)},b.prototype.autoPlayIterator=function(){var a=this,b=a.currentSlide+a.options.slidesToScroll;a.paused||a.interrupted||a.focussed||(a.options.infinite===!1&&(1===a.direction&&a.currentSlide+1===a.slideCount-1?a.direction=0:0===a.direction&&(b=a.currentSlide-a.options.slidesToScroll,a.currentSlide-1===0&&(a.direction=1))),a.slideHandler(b))},b.prototype.buildArrows=function(){var b=this;b.options.arrows===!0&&(b.$prevArrow=a(b.options.prevArrow).addClass("slick-arrow"),b.$nextArrow=a(b.options.nextArrow).addClass("slick-arrow"),b.slideCount>b.options.slidesToShow?(b.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),b.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),b.htmlExpr.test(b.options.prevArrow)&&b.$prevArrow.prependTo(b.options.appendArrows),b.htmlExpr.test(b.options.nextArrow)&&b.$nextArrow.appendTo(b.options.appendArrows),b.options.infinite!==!0&&b.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):b.$prevArrow.add(b.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},b.prototype.buildDots=function(){var b,c,d=this;if(d.options.dots===!0){for(d.$slider.addClass("slick-dotted"),c=a("<ul />").addClass(d.options.dotsClass),b=0;b<=d.getDotCount();b+=1)c.append(a("<li />").append(d.options.customPaging.call(this,d,b)));d.$dots=c.appendTo(d.options.appendDots),d.$dots.find("li").first().addClass("slick-active")}},b.prototype.buildOut=function(){var b=this;b.$slides=b.$slider.children(b.options.slide+":not(.slick-cloned)").addClass("slick-slide"),b.slideCount=b.$slides.length,b.$slides.each(function(b,c){a(c).attr("data-slick-index",b).data("originalStyling",a(c).attr("style")||"")}),b.$slider.addClass("slick-slider"),b.$slideTrack=0===b.slideCount?a('<div class="slick-track"/>').appendTo(b.$slider):b.$slides.wrapAll('<div class="slick-track"/>').parent(),b.$list=b.$slideTrack.wrap('<div class="slick-list"/>').parent(),b.$slideTrack.css("opacity",0),b.options.centerMode!==!0&&b.options.swipeToSlide!==!0||(b.options.slidesToScroll=1),a("img[data-lazy]",b.$slider).not("[src]").addClass("slick-loading"),b.setupInfinite(),b.buildArrows(),b.buildDots(),b.updateDots(),b.setSlideClasses("number"==typeof b.currentSlide?b.currentSlide:0),b.options.draggable===!0&&b.$list.addClass("draggable")},b.prototype.buildRows=function(){var a,b,c,d,e,f,g,h=this;if(d=document.createDocumentFragment(),f=h.$slider.children(),h.options.rows>1){for(g=h.options.slidesPerRow*h.options.rows,e=Math.ceil(f.length/g),a=0;a<e;a++){var i=document.createElement("div");for(b=0;b<h.options.rows;b++){var j=document.createElement("div");for(c=0;c<h.options.slidesPerRow;c++){var k=a*g+(b*h.options.slidesPerRow+c);f.get(k)&&j.appendChild(f.get(k))}i.appendChild(j)}d.appendChild(i)}h.$slider.empty().append(d),h.$slider.children().children().children().css({width:100/h.options.slidesPerRow+"%",display:"inline-block"})}},b.prototype.checkResponsive=function(b,c){var d,e,f,g=this,h=!1,i=g.$slider.width(),j=window.innerWidth||a(window).width();if("window"===g.respondTo?f=j:"slider"===g.respondTo?f=i:"min"===g.respondTo&&(f=Math.min(j,i)),g.options.responsive&&g.options.responsive.length&&null!==g.options.responsive){e=null;for(d in g.breakpoints)g.breakpoints.hasOwnProperty(d)&&(g.originalSettings.mobileFirst===!1?f<g.breakpoints[d]&&(e=g.breakpoints[d]):f>g.breakpoints[d]&&(e=g.breakpoints[d]));null!==e?null!==g.activeBreakpoint?(e!==g.activeBreakpoint||c)&&(g.activeBreakpoint=e,"unslick"===g.breakpointSettings[e]?g.unslick(e):(g.options=a.extend({},g.originalSettings,g.breakpointSettings[e]),b===!0&&(g.currentSlide=g.options.initialSlide),g.refresh(b)),h=e):(g.activeBreakpoint=e,"unslick"===g.breakpointSettings[e]?g.unslick(e):(g.options=a.extend({},g.originalSettings,g.breakpointSettings[e]),b===!0&&(g.currentSlide=g.options.initialSlide),g.refresh(b)),h=e):null!==g.activeBreakpoint&&(g.activeBreakpoint=null,g.options=g.originalSettings,b===!0&&(g.currentSlide=g.options.initialSlide),g.refresh(b),h=e),b||h===!1||g.$slider.trigger("breakpoint",[g,h])}},b.prototype.changeSlide=function(b,c){var d,e,f,g=this,h=a(b.currentTarget);switch(h.is("a")&&b.preventDefault(),h.is("li")||(h=h.closest("li")),f=g.slideCount%g.options.slidesToScroll!==0,d=f?0:(g.slideCount-g.currentSlide)%g.options.slidesToScroll,b.data.message){case"previous":e=0===d?g.options.slidesToScroll:g.options.slidesToShow-d,g.slideCount>g.options.slidesToShow&&g.slideHandler(g.currentSlide-e,!1,c);break;case"next":e=0===d?g.options.slidesToScroll:d,g.slideCount>g.options.slidesToShow&&g.slideHandler(g.currentSlide+e,!1,c);break;case"index":var i=0===b.data.index?0:b.data.index||h.index()*g.options.slidesToScroll;g.slideHandler(g.checkNavigable(i),!1,c),h.children().trigger("focus");break;default:return}},b.prototype.checkNavigable=function(a){var b,c,d=this;if(b=d.getNavigableIndexes(),c=0,a>b[b.length-1])a=b[b.length-1];else for(var e in b){if(a<b[e]){a=c;break}c=b[e]}return a},b.prototype.cleanUpEvents=function(){var b=this;b.options.dots&&null!==b.$dots&&(a("li",b.$dots).off("click.slick",b.changeSlide).off("mouseenter.slick",a.proxy(b.interrupt,b,!0)).off("mouseleave.slick",a.proxy(b.interrupt,b,!1)),b.options.accessibility===!0&&b.$dots.off("keydown.slick",b.keyHandler)),b.$slider.off("focus.slick blur.slick"),b.options.arrows===!0&&b.slideCount>b.options.slidesToShow&&(b.$prevArrow&&b.$prevArrow.off("click.slick",b.changeSlide),b.$nextArrow&&b.$nextArrow.off("click.slick",b.changeSlide),b.options.accessibility===!0&&(b.$prevArrow&&b.$prevArrow.off("keydown.slick",b.keyHandler),b.$nextArrow&&b.$nextArrow.off("keydown.slick",b.keyHandler))),b.$list.off("touchstart.slick mousedown.slick",b.swipeHandler),b.$list.off("touchmove.slick mousemove.slick",b.swipeHandler),b.$list.off("touchend.slick mouseup.slick",b.swipeHandler),b.$list.off("touchcancel.slick mouseleave.slick",b.swipeHandler),b.$list.off("click.slick",b.clickHandler),a(document).off(b.visibilityChange,b.visibility),b.cleanUpSlideEvents(),b.options.accessibility===!0&&b.$list.off("keydown.slick",b.keyHandler),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().off("click.slick",b.selectHandler),a(window).off("orientationchange.slick.slick-"+b.instanceUid,b.orientationChange),a(window).off("resize.slick.slick-"+b.instanceUid,b.resize),a("[draggable!=true]",b.$slideTrack).off("dragstart",b.preventDefault),a(window).off("load.slick.slick-"+b.instanceUid,b.setPosition)},b.prototype.cleanUpSlideEvents=function(){var b=this;b.$list.off("mouseenter.slick",a.proxy(b.interrupt,b,!0)),b.$list.off("mouseleave.slick",a.proxy(b.interrupt,b,!1))},b.prototype.cleanUpRows=function(){var a,b=this;b.options.rows>1&&(a=b.$slides.children().children(),a.removeAttr("style"),b.$slider.empty().append(a))},b.prototype.clickHandler=function(a){var b=this;b.shouldClick===!1&&(a.stopImmediatePropagation(),a.stopPropagation(),a.preventDefault())},b.prototype.destroy=function(b){var c=this;c.autoPlayClear(),c.touchObject={},c.cleanUpEvents(),a(".slick-cloned",c.$slider).detach(),c.$dots&&c.$dots.remove(),c.$prevArrow&&c.$prevArrow.length&&(c.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),c.htmlExpr.test(c.options.prevArrow)&&c.$prevArrow.remove()),c.$nextArrow&&c.$nextArrow.length&&(c.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),c.htmlExpr.test(c.options.nextArrow)&&c.$nextArrow.remove()),c.$slides&&(c.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){a(this).attr("style",a(this).data("originalStyling"))}),c.$slideTrack.children(this.options.slide).detach(),c.$slideTrack.detach(),c.$list.detach(),c.$slider.append(c.$slides)),c.cleanUpRows(),c.$slider.removeClass("slick-slider"),c.$slider.removeClass("slick-initialized"),c.$slider.removeClass("slick-dotted"),c.unslicked=!0,b||c.$slider.trigger("destroy",[c])},b.prototype.disableTransition=function(a){var b=this,c={};c[b.transitionType]="",b.options.fade===!1?b.$slideTrack.css(c):b.$slides.eq(a).css(c)},b.prototype.fadeSlide=function(a,b){var c=this;c.cssTransitions===!1?(c.$slides.eq(a).css({zIndex:c.options.zIndex}),c.$slides.eq(a).animate({opacity:1},c.options.speed,c.options.easing,b)):(c.applyTransition(a),c.$slides.eq(a).css({opacity:1,zIndex:c.options.zIndex}),b&&setTimeout(function(){c.disableTransition(a),b.call()},c.options.speed))},b.prototype.fadeSlideOut=function(a){var b=this;b.cssTransitions===!1?b.$slides.eq(a).animate({opacity:0,zIndex:b.options.zIndex-2},b.options.speed,b.options.easing):(b.applyTransition(a),b.$slides.eq(a).css({opacity:0,zIndex:b.options.zIndex-2}))},b.prototype.filterSlides=b.prototype.slickFilter=function(a){var b=this;null!==a&&(b.$slidesCache=b.$slides,b.unload(),b.$slideTrack.children(this.options.slide).detach(),b.$slidesCache.filter(a).appendTo(b.$slideTrack),b.reinit())},b.prototype.focusHandler=function(){var b=this;b.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*",function(c){c.stopImmediatePropagation();var d=a(this);setTimeout(function(){b.options.pauseOnFocus&&(b.focussed=d.is(":focus"),b.autoPlay())},0)})},b.prototype.getCurrent=b.prototype.slickCurrentSlide=function(){var a=this;return a.currentSlide},b.prototype.getDotCount=function(){var a=this,b=0,c=0,d=0;if(a.options.infinite===!0)if(a.slideCount<=a.options.slidesToShow)++d;else for(;b<a.slideCount;)++d,b=c+a.options.slidesToScroll,c+=a.options.slidesToScroll<=a.options.slidesToShow?a.options.slidesToScroll:a.options.slidesToShow;else if(a.options.centerMode===!0)d=a.slideCount;else if(a.options.asNavFor)for(;b<a.slideCount;)++d,b=c+a.options.slidesToScroll,c+=a.options.slidesToScroll<=a.options.slidesToShow?a.options.slidesToScroll:a.options.slidesToShow;else d=1+Math.ceil((a.slideCount-a.options.slidesToShow)/a.options.slidesToScroll);return d-1},b.prototype.getLeft=function(a){var b,c,d,e,f=this,g=0;return f.slideOffset=0,c=f.$slides.first().outerHeight(!0),f.options.infinite===!0?(f.slideCount>f.options.slidesToShow&&(f.slideOffset=f.slideWidth*f.options.slidesToShow*-1,e=-1,f.options.vertical===!0&&f.options.centerMode===!0&&(2===f.options.slidesToShow?e=-1.5:1===f.options.slidesToShow&&(e=-2)),g=c*f.options.slidesToShow*e),f.slideCount%f.options.slidesToScroll!==0&&a+f.options.slidesToScroll>f.slideCount&&f.slideCount>f.options.slidesToShow&&(a>f.slideCount?(f.slideOffset=(f.options.slidesToShow-(a-f.slideCount))*f.slideWidth*-1,g=(f.options.slidesToShow-(a-f.slideCount))*c*-1):(f.slideOffset=f.slideCount%f.options.slidesToScroll*f.slideWidth*-1,g=f.slideCount%f.options.slidesToScroll*c*-1))):a+f.options.slidesToShow>f.slideCount&&(f.slideOffset=(a+f.options.slidesToShow-f.slideCount)*f.slideWidth,g=(a+f.options.slidesToShow-f.slideCount)*c),f.slideCount<=f.options.slidesToShow&&(f.slideOffset=0,g=0),f.options.centerMode===!0&&f.slideCount<=f.options.slidesToShow?f.slideOffset=f.slideWidth*Math.floor(f.options.slidesToShow)/2-f.slideWidth*f.slideCount/2:f.options.centerMode===!0&&f.options.infinite===!0?f.slideOffset+=f.slideWidth*Math.floor(f.options.slidesToShow/2)-f.slideWidth:f.options.centerMode===!0&&(f.slideOffset=0,f.slideOffset+=f.slideWidth*Math.floor(f.options.slidesToShow/2)),b=f.options.vertical===!1?a*f.slideWidth*-1+f.slideOffset:a*c*-1+g,f.options.variableWidth===!0&&(d=f.slideCount<=f.options.slidesToShow||f.options.infinite===!1?f.$slideTrack.children(".slick-slide").eq(a):f.$slideTrack.children(".slick-slide").eq(a+f.options.slidesToShow),b=f.options.rtl===!0?d[0]?(f.$slideTrack.width()-d[0].offsetLeft-d.width())*-1:0:d[0]?d[0].offsetLeft*-1:0,f.options.centerMode===!0&&(d=f.slideCount<=f.options.slidesToShow||f.options.infinite===!1?f.$slideTrack.children(".slick-slide").eq(a):f.$slideTrack.children(".slick-slide").eq(a+f.options.slidesToShow+1),b=f.options.rtl===!0?d[0]?(f.$slideTrack.width()-d[0].offsetLeft-d.width())*-1:0:d[0]?d[0].offsetLeft*-1:0,b+=(f.$list.width()-d.outerWidth())/2)),b},b.prototype.getOption=b.prototype.slickGetOption=function(a){var b=this;return b.options[a]},b.prototype.getNavigableIndexes=function(){var a,b=this,c=0,d=0,e=[];for(b.options.infinite===!1?a=b.slideCount:(c=b.options.slidesToScroll*-1,d=b.options.slidesToScroll*-1,a=2*b.slideCount);c<a;)e.push(c),c=d+b.options.slidesToScroll,d+=b.options.slidesToScroll<=b.options.slidesToShow?b.options.slidesToScroll:b.options.slidesToShow;return e},b.prototype.getSlick=function(){return this},b.prototype.getSlideCount=function(){var b,c,d,e=this;return d=e.options.centerMode===!0?e.slideWidth*Math.floor(e.options.slidesToShow/2):0,e.options.swipeToSlide===!0?(e.$slideTrack.find(".slick-slide").each(function(b,f){if(f.offsetLeft-d+a(f).outerWidth()/2>e.swipeLeft*-1)return c=f,!1}),b=Math.abs(a(c).attr("data-slick-index")-e.currentSlide)||1):e.options.slidesToScroll},b.prototype.goTo=b.prototype.slickGoTo=function(a,b){var c=this;c.changeSlide({data:{message:"index",index:parseInt(a)}},b)},b.prototype.init=function(b){var c=this;a(c.$slider).hasClass("slick-initialized")||(a(c.$slider).addClass("slick-initialized"),c.buildRows(),c.buildOut(),c.setProps(),c.startLoad(),c.loadSlider(),c.initializeEvents(),c.updateArrows(),c.updateDots(),c.checkResponsive(!0),c.focusHandler()),b&&c.$slider.trigger("init",[c]),c.options.accessibility===!0&&c.initADA(),c.options.autoplay&&(c.paused=!1,c.autoPlay())},b.prototype.initADA=function(){var b=this,c=Math.ceil(b.slideCount/b.options.slidesToShow),d=b.getNavigableIndexes().filter(function(a){return a>=0&&a<b.slideCount});b.$slides.add(b.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),null!==b.$dots&&(b.$slides.not(b.$slideTrack.find(".slick-cloned")).each(function(c){var e=d.indexOf(c);a(this).attr({role:"tabpanel",id:"slick-slide"+b.instanceUid+c,tabindex:-1}),e!==-1&&a(this).attr({"aria-describedby":"slick-slide-control"+b.instanceUid+e})}),b.$dots.attr("role","tablist").find("li").each(function(e){var f=d[e];a(this).attr({role:"presentation"}),a(this).find("button").first().attr({role:"tab",id:"slick-slide-control"+b.instanceUid+e,"aria-controls":"slick-slide"+b.instanceUid+f,"aria-label":e+1+" of "+c,"aria-selected":null,tabindex:"-1"})}).eq(b.currentSlide).find("button").attr({"aria-selected":"true",tabindex:"0"}).end());for(var e=b.currentSlide,f=e+b.options.slidesToShow;e<f;e++)b.$slides.eq(e).attr("tabindex",0);b.activateADA()},b.prototype.initArrowEvents=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},a.changeSlide),a.$nextArrow.off("click.slick").on("click.slick",{message:"next"},a.changeSlide),a.options.accessibility===!0&&(a.$prevArrow.on("keydown.slick",a.keyHandler),a.$nextArrow.on("keydown.slick",a.keyHandler)))},b.prototype.initDotEvents=function(){var b=this;b.options.dots===!0&&(a("li",b.$dots).on("click.slick",{message:"index"},b.changeSlide),b.options.accessibility===!0&&b.$dots.on("keydown.slick",b.keyHandler)),b.options.dots===!0&&b.options.pauseOnDotsHover===!0&&a("li",b.$dots).on("mouseenter.slick",a.proxy(b.interrupt,b,!0)).on("mouseleave.slick",a.proxy(b.interrupt,b,!1))},b.prototype.initSlideEvents=function(){var b=this;b.options.pauseOnHover&&(b.$list.on("mouseenter.slick",a.proxy(b.interrupt,b,!0)),b.$list.on("mouseleave.slick",a.proxy(b.interrupt,b,!1)))},b.prototype.initializeEvents=function(){var b=this;b.initArrowEvents(),b.initDotEvents(),b.initSlideEvents(),b.$list.on("touchstart.slick mousedown.slick",{action:"start"},b.swipeHandler),b.$list.on("touchmove.slick mousemove.slick",{action:"move"},b.swipeHandler),b.$list.on("touchend.slick mouseup.slick",{action:"end"},b.swipeHandler),b.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},b.swipeHandler),b.$list.on("click.slick",b.clickHandler),a(document).on(b.visibilityChange,a.proxy(b.visibility,b)),b.options.accessibility===!0&&b.$list.on("keydown.slick",b.keyHandler),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().on("click.slick",b.selectHandler),a(window).on("orientationchange.slick.slick-"+b.instanceUid,a.proxy(b.orientationChange,b)),a(window).on("resize.slick.slick-"+b.instanceUid,a.proxy(b.resize,b)),a("[draggable!=true]",b.$slideTrack).on("dragstart",b.preventDefault),a(window).on("load.slick.slick-"+b.instanceUid,b.setPosition),a(b.setPosition)},b.prototype.initUI=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.show(),a.$nextArrow.show()),a.options.dots===!0&&a.slideCount>a.options.slidesToShow&&a.$dots.show()},b.prototype.keyHandler=function(a){var b=this;a.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===a.keyCode&&b.options.accessibility===!0?b.changeSlide({data:{message:b.options.rtl===!0?"next":"previous"}}):39===a.keyCode&&b.options.accessibility===!0&&b.changeSlide({data:{message:b.options.rtl===!0?"previous":"next"}}))},b.prototype.lazyLoad=function(){function b(b){a("img[data-lazy]",b).each(function(){var b=a(this),c=a(this).attr("data-lazy"),d=a(this).attr("data-srcset"),e=a(this).attr("data-sizes")||g.$slider.attr("data-sizes"),f=document.createElement("img");f.onload=function(){b.animate({opacity:0},100,function(){d&&(b.attr("srcset",d),e&&b.attr("sizes",e)),b.attr("src",c).animate({opacity:1},200,function(){b.removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading")}),g.$slider.trigger("lazyLoaded",[g,b,c])})},f.onerror=function(){b.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),g.$slider.trigger("lazyLoadError",[g,b,c])},f.src=c})}var c,d,e,f,g=this;if(g.options.centerMode===!0?g.options.infinite===!0?(e=g.currentSlide+(g.options.slidesToShow/2+1),f=e+g.options.slidesToShow+2):(e=Math.max(0,g.currentSlide-(g.options.slidesToShow/2+1)),f=2+(g.options.slidesToShow/2+1)+g.currentSlide):(e=g.options.infinite?g.options.slidesToShow+g.currentSlide:g.currentSlide,f=Math.ceil(e+g.options.slidesToShow),g.options.fade===!0&&(e>0&&e--,f<=g.slideCount&&f++)),c=g.$slider.find(".slick-slide").slice(e,f),"anticipated"===g.options.lazyLoad)for(var h=e-1,i=f,j=g.$slider.find(".slick-slide"),k=0;k<g.options.slidesToScroll;k++)h<0&&(h=g.slideCount-1),c=c.add(j.eq(h)),c=c.add(j.eq(i)),h--,i++;b(c),g.slideCount<=g.options.slidesToShow?(d=g.$slider.find(".slick-slide"),b(d)):g.currentSlide>=g.slideCount-g.options.slidesToShow?(d=g.$slider.find(".slick-cloned").slice(0,g.options.slidesToShow),b(d)):0===g.currentSlide&&(d=g.$slider.find(".slick-cloned").slice(g.options.slidesToShow*-1),b(d))},b.prototype.loadSlider=function(){var a=this;a.setPosition(),a.$slideTrack.css({opacity:1}),a.$slider.removeClass("slick-loading"),a.initUI(),"progressive"===a.options.lazyLoad&&a.progressiveLazyLoad()},b.prototype.next=b.prototype.slickNext=function(){var a=this;a.changeSlide({data:{message:"next"}})},b.prototype.orientationChange=function(){var a=this;a.checkResponsive(),a.setPosition()},b.prototype.pause=b.prototype.slickPause=function(){var a=this;a.autoPlayClear(),a.paused=!0},b.prototype.play=b.prototype.slickPlay=function(){var a=this;a.autoPlay(),a.options.autoplay=!0,a.paused=!1,a.focussed=!1,a.interrupted=!1},b.prototype.postSlide=function(b){var c=this;if(!c.unslicked&&(c.$slider.trigger("afterChange",[c,b]),c.animating=!1,c.slideCount>c.options.slidesToShow&&c.setPosition(),c.swipeLeft=null,c.options.autoplay&&c.autoPlay(),c.options.accessibility===!0&&(c.initADA(),c.options.focusOnChange))){var d=a(c.$slides.get(c.currentSlide));d.attr("tabindex",0).focus()}},b.prototype.prev=b.prototype.slickPrev=function(){var a=this;a.changeSlide({data:{message:"previous"}})},b.prototype.preventDefault=function(a){a.preventDefault()},b.prototype.progressiveLazyLoad=function(b){b=b||1;var c,d,e,f,g,h=this,i=a("img[data-lazy]",h.$slider);i.length?(c=i.first(),d=c.attr("data-lazy"),e=c.attr("data-srcset"),f=c.attr("data-sizes")||h.$slider.attr("data-sizes"),g=document.createElement("img"),g.onload=function(){e&&(c.attr("srcset",e),f&&c.attr("sizes",f)),c.attr("src",d).removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading"),h.options.adaptiveHeight===!0&&h.setPosition(),h.$slider.trigger("lazyLoaded",[h,c,d]),h.progressiveLazyLoad()},g.onerror=function(){b<3?setTimeout(function(){h.progressiveLazyLoad(b+1)},500):(c.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),h.$slider.trigger("lazyLoadError",[h,c,d]),h.progressiveLazyLoad())},g.src=d):h.$slider.trigger("allImagesLoaded",[h])},b.prototype.refresh=function(b){var c,d,e=this;d=e.slideCount-e.options.slidesToShow,!e.options.infinite&&e.currentSlide>d&&(e.currentSlide=d),e.slideCount<=e.options.slidesToShow&&(e.currentSlide=0),c=e.currentSlide,e.destroy(!0),a.extend(e,e.initials,{currentSlide:c}),e.init(),b||e.changeSlide({data:{message:"index",index:c}},!1)},b.prototype.registerBreakpoints=function(){var b,c,d,e=this,f=e.options.responsive||null;if("array"===a.type(f)&&f.length){e.respondTo=e.options.respondTo||"window";for(b in f)if(d=e.breakpoints.length-1,f.hasOwnProperty(b)){for(c=f[b].breakpoint;d>=0;)e.breakpoints[d]&&e.breakpoints[d]===c&&e.breakpoints.splice(d,1),d--;e.breakpoints.push(c),e.breakpointSettings[c]=f[b].settings}e.breakpoints.sort(function(a,b){return e.options.mobileFirst?a-b:b-a})}},b.prototype.reinit=function(){var b=this;b.$slides=b.$slideTrack.children(b.options.slide).addClass("slick-slide"),b.slideCount=b.$slides.length,b.currentSlide>=b.slideCount&&0!==b.currentSlide&&(b.currentSlide=b.currentSlide-b.options.slidesToScroll),b.slideCount<=b.options.slidesToShow&&(b.currentSlide=0),b.registerBreakpoints(),b.setProps(),b.setupInfinite(),b.buildArrows(),b.updateArrows(),b.initArrowEvents(),b.buildDots(),b.updateDots(),b.initDotEvents(),b.cleanUpSlideEvents(),b.initSlideEvents(),b.checkResponsive(!1,!0),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().on("click.slick",b.selectHandler),b.setSlideClasses("number"==typeof b.currentSlide?b.currentSlide:0),b.setPosition(),b.focusHandler(),b.paused=!b.options.autoplay,b.autoPlay(),b.$slider.trigger("reInit",[b])},b.prototype.resize=function(){var b=this;a(window).width()!==b.windowWidth&&(clearTimeout(b.windowDelay),b.windowDelay=window.setTimeout(function(){b.windowWidth=a(window).width(),b.checkResponsive(),b.unslicked||b.setPosition()},50))},b.prototype.removeSlide=b.prototype.slickRemove=function(a,b,c){var d=this;return"boolean"==typeof a?(b=a,a=b===!0?0:d.slideCount-1):a=b===!0?--a:a,!(d.slideCount<1||a<0||a>d.slideCount-1)&&(d.unload(),c===!0?d.$slideTrack.children().remove():d.$slideTrack.children(this.options.slide).eq(a).remove(),d.$slides=d.$slideTrack.children(this.options.slide),d.$slideTrack.children(this.options.slide).detach(),d.$slideTrack.append(d.$slides),d.$slidesCache=d.$slides,void d.reinit())},b.prototype.setCSS=function(a){var b,c,d=this,e={};d.options.rtl===!0&&(a=-a),b="left"==d.positionProp?Math.ceil(a)+"px":"0px",c="top"==d.positionProp?Math.ceil(a)+"px":"0px",e[d.positionProp]=a,d.transformsEnabled===!1?d.$slideTrack.css(e):(e={},d.cssTransitions===!1?(e[d.animType]="translate("+b+", "+c+")",d.$slideTrack.css(e)):(e[d.animType]="translate3d("+b+", "+c+", 0px)",d.$slideTrack.css(e)))},b.prototype.setDimensions=function(){var a=this;a.options.vertical===!1?a.options.centerMode===!0&&a.$list.css({padding:"0px "+a.options.centerPadding}):(a.$list.height(a.$slides.first().outerHeight(!0)*a.options.slidesToShow),a.options.centerMode===!0&&a.$list.css({padding:a.options.centerPadding+" 0px"})),a.listWidth=a.$list.width(),a.listHeight=a.$list.height(),a.options.vertical===!1&&a.options.variableWidth===!1?(a.slideWidth=Math.ceil(a.listWidth/a.options.slidesToShow),a.$slideTrack.width(Math.ceil(a.slideWidth*a.$slideTrack.children(".slick-slide").length))):a.options.variableWidth===!0?a.$slideTrack.width(5e3*a.slideCount):(a.slideWidth=Math.ceil(a.listWidth),a.$slideTrack.height(Math.ceil(a.$slides.first().outerHeight(!0)*a.$slideTrack.children(".slick-slide").length)));var b=a.$slides.first().outerWidth(!0)-a.$slides.first().width();a.options.variableWidth===!1&&a.$slideTrack.children(".slick-slide").width(a.slideWidth-b)},b.prototype.setFade=function(){var b,c=this;c.$slides.each(function(d,e){b=c.slideWidth*d*-1,c.options.rtl===!0?a(e).css({position:"relative",right:b,top:0,zIndex:c.options.zIndex-2,opacity:0}):a(e).css({position:"relative",left:b,top:0,zIndex:c.options.zIndex-2,opacity:0})}),c.$slides.eq(c.currentSlide).css({zIndex:c.options.zIndex-1,opacity:1})},b.prototype.setHeight=function(){var a=this;if(1===a.options.slidesToShow&&a.options.adaptiveHeight===!0&&a.options.vertical===!1){var b=a.$slides.eq(a.currentSlide).outerHeight(!0);a.$list.css("height",b)}},b.prototype.setOption=b.prototype.slickSetOption=function(){var b,c,d,e,f,g=this,h=!1;if("object"===a.type(arguments[0])?(d=arguments[0],h=arguments[1],f="multiple"):"string"===a.type(arguments[0])&&(d=arguments[0],e=arguments[1],h=arguments[2],"responsive"===arguments[0]&&"array"===a.type(arguments[1])?f="responsive":"undefined"!=typeof arguments[1]&&(f="single")),"single"===f)g.options[d]=e;else if("multiple"===f)a.each(d,function(a,b){g.options[a]=b});else if("responsive"===f)for(c in e)if("array"!==a.type(g.options.responsive))g.options.responsive=[e[c]];else{for(b=g.options.responsive.length-1;b>=0;)g.options.responsive[b].breakpoint===e[c].breakpoint&&g.options.responsive.splice(b,1),b--;g.options.responsive.push(e[c])}h&&(g.unload(),g.reinit())},b.prototype.setPosition=function(){var a=this;a.setDimensions(),a.setHeight(),a.options.fade===!1?a.setCSS(a.getLeft(a.currentSlide)):a.setFade(),a.$slider.trigger("setPosition",[a])},b.prototype.setProps=function(){var a=this,b=document.body.style;a.positionProp=a.options.vertical===!0?"top":"left","top"===a.positionProp?a.$slider.addClass("slick-vertical"):a.$slider.removeClass("slick-vertical"),void 0===b.WebkitTransition&&void 0===b.MozTransition&&void 0===b.msTransition||a.options.useCSS===!0&&(a.cssTransitions=!0),a.options.fade&&("number"==typeof a.options.zIndex?a.options.zIndex<3&&(a.options.zIndex=3):a.options.zIndex=a.defaults.zIndex),
void 0!==b.OTransform&&(a.animType="OTransform",a.transformType="-o-transform",a.transitionType="OTransition",void 0===b.perspectiveProperty&&void 0===b.webkitPerspective&&(a.animType=!1)),void 0!==b.MozTransform&&(a.animType="MozTransform",a.transformType="-moz-transform",a.transitionType="MozTransition",void 0===b.perspectiveProperty&&void 0===b.MozPerspective&&(a.animType=!1)),void 0!==b.webkitTransform&&(a.animType="webkitTransform",a.transformType="-webkit-transform",a.transitionType="webkitTransition",void 0===b.perspectiveProperty&&void 0===b.webkitPerspective&&(a.animType=!1)),void 0!==b.msTransform&&(a.animType="msTransform",a.transformType="-ms-transform",a.transitionType="msTransition",void 0===b.msTransform&&(a.animType=!1)),void 0!==b.transform&&a.animType!==!1&&(a.animType="transform",a.transformType="transform",a.transitionType="transition"),a.transformsEnabled=a.options.useTransform&&null!==a.animType&&a.animType!==!1},b.prototype.setSlideClasses=function(a){var b,c,d,e,f=this;if(c=f.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),f.$slides.eq(a).addClass("slick-current"),f.options.centerMode===!0){var g=f.options.slidesToShow%2===0?1:0;b=Math.floor(f.options.slidesToShow/2),f.options.infinite===!0&&(a>=b&&a<=f.slideCount-1-b?f.$slides.slice(a-b+g,a+b+1).addClass("slick-active").attr("aria-hidden","false"):(d=f.options.slidesToShow+a,c.slice(d-b+1+g,d+b+2).addClass("slick-active").attr("aria-hidden","false")),0===a?c.eq(c.length-1-f.options.slidesToShow).addClass("slick-center"):a===f.slideCount-1&&c.eq(f.options.slidesToShow).addClass("slick-center")),f.$slides.eq(a).addClass("slick-center")}else a>=0&&a<=f.slideCount-f.options.slidesToShow?f.$slides.slice(a,a+f.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):c.length<=f.options.slidesToShow?c.addClass("slick-active").attr("aria-hidden","false"):(e=f.slideCount%f.options.slidesToShow,d=f.options.infinite===!0?f.options.slidesToShow+a:a,f.options.slidesToShow==f.options.slidesToScroll&&f.slideCount-a<f.options.slidesToShow?c.slice(d-(f.options.slidesToShow-e),d+e).addClass("slick-active").attr("aria-hidden","false"):c.slice(d,d+f.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"));"ondemand"!==f.options.lazyLoad&&"anticipated"!==f.options.lazyLoad||f.lazyLoad()},b.prototype.setupInfinite=function(){var b,c,d,e=this;if(e.options.fade===!0&&(e.options.centerMode=!1),e.options.infinite===!0&&e.options.fade===!1&&(c=null,e.slideCount>e.options.slidesToShow)){for(d=e.options.centerMode===!0?e.options.slidesToShow+1:e.options.slidesToShow,b=e.slideCount;b>e.slideCount-d;b-=1)c=b-1,a(e.$slides[c]).clone(!0).attr("id","").attr("data-slick-index",c-e.slideCount).prependTo(e.$slideTrack).addClass("slick-cloned");for(b=0;b<d+e.slideCount;b+=1)c=b,a(e.$slides[c]).clone(!0).attr("id","").attr("data-slick-index",c+e.slideCount).appendTo(e.$slideTrack).addClass("slick-cloned");e.$slideTrack.find(".slick-cloned").find("[id]").each(function(){a(this).attr("id","")})}},b.prototype.interrupt=function(a){var b=this;a||b.autoPlay(),b.interrupted=a},b.prototype.selectHandler=function(b){var c=this,d=a(b.target).is(".slick-slide")?a(b.target):a(b.target).parents(".slick-slide"),e=parseInt(d.attr("data-slick-index"));return e||(e=0),c.slideCount<=c.options.slidesToShow?void c.slideHandler(e,!1,!0):void c.slideHandler(e)},b.prototype.slideHandler=function(a,b,c){var d,e,f,g,h,i=null,j=this;if(b=b||!1,!(j.animating===!0&&j.options.waitForAnimate===!0||j.options.fade===!0&&j.currentSlide===a))return b===!1&&j.asNavFor(a),d=a,i=j.getLeft(d),g=j.getLeft(j.currentSlide),j.currentLeft=null===j.swipeLeft?g:j.swipeLeft,j.options.infinite===!1&&j.options.centerMode===!1&&(a<0||a>j.getDotCount()*j.options.slidesToScroll)?void(j.options.fade===!1&&(d=j.currentSlide,c!==!0?j.animateSlide(g,function(){j.postSlide(d)}):j.postSlide(d))):j.options.infinite===!1&&j.options.centerMode===!0&&(a<0||a>j.slideCount-j.options.slidesToScroll)?void(j.options.fade===!1&&(d=j.currentSlide,c!==!0?j.animateSlide(g,function(){j.postSlide(d)}):j.postSlide(d))):(j.options.autoplay&&clearInterval(j.autoPlayTimer),e=d<0?j.slideCount%j.options.slidesToScroll!==0?j.slideCount-j.slideCount%j.options.slidesToScroll:j.slideCount+d:d>=j.slideCount?j.slideCount%j.options.slidesToScroll!==0?0:d-j.slideCount:d,j.animating=!0,j.$slider.trigger("beforeChange",[j,j.currentSlide,e]),f=j.currentSlide,j.currentSlide=e,j.setSlideClasses(j.currentSlide),j.options.asNavFor&&(h=j.getNavTarget(),h=h.slick("getSlick"),h.slideCount<=h.options.slidesToShow&&h.setSlideClasses(j.currentSlide)),j.updateDots(),j.updateArrows(),j.options.fade===!0?(c!==!0?(j.fadeSlideOut(f),j.fadeSlide(e,function(){j.postSlide(e)})):j.postSlide(e),void j.animateHeight()):void(c!==!0?j.animateSlide(i,function(){j.postSlide(e)}):j.postSlide(e)))},b.prototype.startLoad=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.hide(),a.$nextArrow.hide()),a.options.dots===!0&&a.slideCount>a.options.slidesToShow&&a.$dots.hide(),a.$slider.addClass("slick-loading")},b.prototype.swipeDirection=function(){var a,b,c,d,e=this;return a=e.touchObject.startX-e.touchObject.curX,b=e.touchObject.startY-e.touchObject.curY,c=Math.atan2(b,a),d=Math.round(180*c/Math.PI),d<0&&(d=360-Math.abs(d)),d<=45&&d>=0?e.options.rtl===!1?"left":"right":d<=360&&d>=315?e.options.rtl===!1?"left":"right":d>=135&&d<=225?e.options.rtl===!1?"right":"left":e.options.verticalSwiping===!0?d>=35&&d<=135?"down":"up":"vertical"},b.prototype.swipeEnd=function(a){var b,c,d=this;if(d.dragging=!1,d.swiping=!1,d.scrolling)return d.scrolling=!1,!1;if(d.interrupted=!1,d.shouldClick=!(d.touchObject.swipeLength>10),void 0===d.touchObject.curX)return!1;if(d.touchObject.edgeHit===!0&&d.$slider.trigger("edge",[d,d.swipeDirection()]),d.touchObject.swipeLength>=d.touchObject.minSwipe){switch(c=d.swipeDirection()){case"left":case"down":b=d.options.swipeToSlide?d.checkNavigable(d.currentSlide+d.getSlideCount()):d.currentSlide+d.getSlideCount(),d.currentDirection=0;break;case"right":case"up":b=d.options.swipeToSlide?d.checkNavigable(d.currentSlide-d.getSlideCount()):d.currentSlide-d.getSlideCount(),d.currentDirection=1}"vertical"!=c&&(d.slideHandler(b),d.touchObject={},d.$slider.trigger("swipe",[d,c]))}else d.touchObject.startX!==d.touchObject.curX&&(d.slideHandler(d.currentSlide),d.touchObject={})},b.prototype.swipeHandler=function(a){var b=this;if(!(b.options.swipe===!1||"ontouchend"in document&&b.options.swipe===!1||b.options.draggable===!1&&a.type.indexOf("mouse")!==-1))switch(b.touchObject.fingerCount=a.originalEvent&&void 0!==a.originalEvent.touches?a.originalEvent.touches.length:1,b.touchObject.minSwipe=b.listWidth/b.options.touchThreshold,b.options.verticalSwiping===!0&&(b.touchObject.minSwipe=b.listHeight/b.options.touchThreshold),a.data.action){case"start":b.swipeStart(a);break;case"move":b.swipeMove(a);break;case"end":b.swipeEnd(a)}},b.prototype.swipeMove=function(a){var b,c,d,e,f,g,h=this;return f=void 0!==a.originalEvent?a.originalEvent.touches:null,!(!h.dragging||h.scrolling||f&&1!==f.length)&&(b=h.getLeft(h.currentSlide),h.touchObject.curX=void 0!==f?f[0].pageX:a.clientX,h.touchObject.curY=void 0!==f?f[0].pageY:a.clientY,h.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(h.touchObject.curX-h.touchObject.startX,2))),g=Math.round(Math.sqrt(Math.pow(h.touchObject.curY-h.touchObject.startY,2))),!h.options.verticalSwiping&&!h.swiping&&g>4?(h.scrolling=!0,!1):(h.options.verticalSwiping===!0&&(h.touchObject.swipeLength=g),c=h.swipeDirection(),void 0!==a.originalEvent&&h.touchObject.swipeLength>4&&(h.swiping=!0,a.preventDefault()),e=(h.options.rtl===!1?1:-1)*(h.touchObject.curX>h.touchObject.startX?1:-1),h.options.verticalSwiping===!0&&(e=h.touchObject.curY>h.touchObject.startY?1:-1),d=h.touchObject.swipeLength,h.touchObject.edgeHit=!1,h.options.infinite===!1&&(0===h.currentSlide&&"right"===c||h.currentSlide>=h.getDotCount()&&"left"===c)&&(d=h.touchObject.swipeLength*h.options.edgeFriction,h.touchObject.edgeHit=!0),h.options.vertical===!1?h.swipeLeft=b+d*e:h.swipeLeft=b+d*(h.$list.height()/h.listWidth)*e,h.options.verticalSwiping===!0&&(h.swipeLeft=b+d*e),h.options.fade!==!0&&h.options.touchMove!==!1&&(h.animating===!0?(h.swipeLeft=null,!1):void h.setCSS(h.swipeLeft))))},b.prototype.swipeStart=function(a){var b,c=this;return c.interrupted=!0,1!==c.touchObject.fingerCount||c.slideCount<=c.options.slidesToShow?(c.touchObject={},!1):(void 0!==a.originalEvent&&void 0!==a.originalEvent.touches&&(b=a.originalEvent.touches[0]),c.touchObject.startX=c.touchObject.curX=void 0!==b?b.pageX:a.clientX,c.touchObject.startY=c.touchObject.curY=void 0!==b?b.pageY:a.clientY,void(c.dragging=!0))},b.prototype.unfilterSlides=b.prototype.slickUnfilter=function(){var a=this;null!==a.$slidesCache&&(a.unload(),a.$slideTrack.children(this.options.slide).detach(),a.$slidesCache.appendTo(a.$slideTrack),a.reinit())},b.prototype.unload=function(){var b=this;a(".slick-cloned",b.$slider).remove(),b.$dots&&b.$dots.remove(),b.$prevArrow&&b.htmlExpr.test(b.options.prevArrow)&&b.$prevArrow.remove(),b.$nextArrow&&b.htmlExpr.test(b.options.nextArrow)&&b.$nextArrow.remove(),b.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},b.prototype.unslick=function(a){var b=this;b.$slider.trigger("unslick",[b,a]),b.destroy()},b.prototype.updateArrows=function(){var a,b=this;a=Math.floor(b.options.slidesToShow/2),b.options.arrows===!0&&b.slideCount>b.options.slidesToShow&&!b.options.infinite&&(b.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),b.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===b.currentSlide?(b.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),b.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):b.currentSlide>=b.slideCount-b.options.slidesToShow&&b.options.centerMode===!1?(b.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),b.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):b.currentSlide>=b.slideCount-1&&b.options.centerMode===!0&&(b.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),b.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},b.prototype.updateDots=function(){var a=this;null!==a.$dots&&(a.$dots.find("li").removeClass("slick-active").end(),a.$dots.find("li").eq(Math.floor(a.currentSlide/a.options.slidesToScroll)).addClass("slick-active"))},b.prototype.visibility=function(){var a=this;a.options.autoplay&&(document[a.hidden]?a.interrupted=!0:a.interrupted=!1)},a.fn.slick=function(){var a,c,d=this,e=arguments[0],f=Array.prototype.slice.call(arguments,1),g=d.length;for(a=0;a<g;a++)if("object"==typeof e||"undefined"==typeof e?d[a].slick=new b(d[a],e):c=d[a].slick[e].apply(d[a].slick,f),"undefined"!=typeof c)return c;return d}});
define('block_totara_featured_links/element_icon_picker', ["jquery","core/templates","core/config","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var g=function(c,g,h){var i=c,j=g,k=a(a('input[name="'+j+'"]')[0]),l=[];l.push({key:"ok",component:"moodle"}),l.push({key:"cancel",component:"moodle"}),l.push({key:"icon_choose_title",component:"block_totara_featured_links"}),l.push({key:"icon_choose",component:"block_totara_featured_links"}),l.push({key:"icon_change",component:"block_totara_featured_links"});var m=d.get_strings(l),n=b.render("block_totara_featured_links/icon_picker_icons",{icons:h});a.when(m,n).done(function(c,d){var g={ok:c[0],cancel:c[1],title:c[2],choose:c[3],change:c[4]};a("#"+i+"_delete").on("click",function(){a(this).hide(),a("#"+i+"_icon").html(""),a('input[name="'+j+'"]').val(""),a("#show-iconPicker-dialog").html(g.choose)}),e.create({type:"CONFIRM",title:g.title,body:d[0]},a("#show-iconPicker-dialog"),{yesstr:g.ok,nostr:g.cancel}).done(function(c){var d=c.getRoot();d.find(".icon-picker-icons .icon-picker-item").on("click",function(){a(".icon-picker-item.selected").removeClass("selected"),a(this).addClass("selected"),a("#icon-picker-selected-icon").html(a(this).attr("data-flex-icon-identifier"))}),d.on(f.shown,function(b){a(".icon-picker-item.selected").removeClass("selected");var c=a('input[name="'+j+'"]').val();a('[data-flex-icon-identifier="'+c+'"]').addClass("selected")}),d.on(f.yes,function(d){var e=a(".selected").attr("data-flex-icon-identifier");e&&(k.val(e),b.renderIcon(e).done(function(b){a("#"+i+"_icon").html(b);var c=a("#"+i+"_delete");c.removeClass("hidden"),c.show(),a("#show-iconPicker-dialog").html(g.change)}),c.hide())})})})};return{init:g}});
define('block_totara_featured_links/content_form', ["jquery"],function(a){var b=function(){a('[name="type"]').change(function(b){var c=window.location.href;c.match(/type=[^&;]+/)?c=c.replace(/type=[^&;]+/,"type="+encodeURI(a(b.target).val())):c+="&type="+encodeURI(a(b.target).val()),window.location=c})};return{init:b}});
define('block_totara_program_completion/block', ["jquery","core/str"],function(a,b){var c={init:function(c){var d=[];d.push({key:"more",component:"block_totara_program_completion"}),d.push({key:"less",component:"block_totara_program_completion"}),b.get_strings(d).done(function(b){for(var e=[],f=0;f<d.length;f++)e[d[f].key]=b[f];a(".block-totara-prog-completion-morelink"+c).on("click",function(b){b.preventDefault(),a(".block-prog-completions-list .more"+c).toggle(),a(this).text()==e.more?a(this).text(e.less):a(this).text(e.more)})})}};return c});
define('block_totara_program_completion/edit', ["jquery","core/config","core/str"],function(a,b,c){var d={blockid:null,programsselected:null,init:function(e,f){var g=a.Deferred(),h=this;d.blockid=e,d.programsselected=f,window.dialogsInited?g.resolve():(window.dialoginits instanceof Array||(window.dialoginits=[]),window.dialoginits.push(function(){g.resolve()}));var i=[];i.push({key:"save",component:"totara_core"}),i.push({key:"cancel",component:"moodle"}),i.push({key:"addprograms",component:"block_totara_program_completion"}),a.when(c.get_strings(i),g).done(function(a){for(var c=[],e=0;e<i.length;e++)c[i[e].key]=a[e];var f=b.wwwroot+"/blocks/totara_program_completion/",g=h._createDialog(),j=new g;j.baseurl=f;var k={};k[c.save]=function(){j._update()},k[c.cancel]=function(){j._cancel()},totaraDialogs.addblockprograms=new totaraDialog("addblockprograms","add-block-programs-dialog",{buttons:k,title:"<h2>"+c.addprograms+"</h2>"},f+"findprograms.php?selected="+d.programsselected+"&blockid="+d.blockid+"&sesskey="+b.sesskey,j)})},_createDialog:function(){var c=function(){this.baseurl="",this.program_items=a('input:hidden[name="config_programids"]').val(),this.program_items=this.program_items&&this.program_items.length>0?this.program_items.split(","):[],this.program_table=a("#block-programs-table"),this.add_program_delete_event_handlers(),this.check_table_hidden_status()};return c.prototype=new totaraDialog_handler_treeview_multiselect,c.prototype._update=function(c){var d=this,e=a(".selected > div > span",this._container),f=this._get_ids(e),g=f.join(","),h=this._dialog.default_url.split("selected="),i=h[1].slice(h[1].indexOf("&"));this._dialog.default_url=h[0]+"selected="+g+i;var j=[];if(a(f).each(function(a,b){d.program_item_exists(b)||(j.push(b),d.add_program_item(b))}),j.length>0){this._dialog.showLoading();var k=b.wwwroot+"/blocks/totara_program_completion/program_item.php?itemid="+j.join(",")+i;a.getJSON(k,function(b){return b.error?(d._dialog.hide(),void alert(b.error)):(a.each(b.items,function(a,b){d.create_item(b)}),void d._dialog.hide())})}else this._dialog.hide()},c.prototype.program_item_exists=function(a){for(var b in this.program_items)if(this.program_items[b]==a)return!0;return!1},c.prototype.check_table_hidden_status=function(){0==this.program_items.length?a(this.program_table).hide():a(this.program_table).show()},c.prototype.add_program_delete_event_handlers=function(){a(".blockprogramdeletelink",this.program_table).unbind("click");var b=this;this.program_table.on("click",".blockprogramdeletelink",function(a){a.preventDefault(),b.remove_program_item(this)})},c.prototype.add_program_item=function(b){this.program_items.push(b),a('input:hidden[name="config_programids"]').val(this.program_items.join(",")),this.check_table_hidden_status()},c.prototype.create_item=function(b){var c=a(b);this.program_table.append(c)},c.prototype.remove_program_item=function(b){var c=a(b).closest("li"),d=c.data("progid");this.program_items=a.grep(this.program_items,function(a,b){return a==d},!0),c.remove(),this.check_table_hidden_status(),a('input:hidden[name="config_programids"]').val(this.program_items.join(","));var e=this._dialog.default_url.split("selected="),f=e[1].slice(e[1].indexOf("&"));this._dialog.default_url=e[0]+"selected="+this.program_items.join(",")+f},c}};return d});
define('block_totara_report_table/module', ["jquery","core/config","core/templates"],function(a,b,c){var d={change_links:function(e,f){var g=null;a(".block_totara_report_table."+e+" .content .rb-display-table-container").find("div.paging a, th.header a").each(function(){a(this).click(function(h){h.preventDefault();var i=a(this),j=i.attr("href"),k=j.slice(j.indexOf("?")+1);if(k+="&sesskey="+b.sesskey+"&blockid="+f,g&&g.abort(),0===a(h.target).siblings(".block_totara_report_table_instant_wait").length){var l=a('<div class="block_totara_report_table_instant_wait"></div>'),m=a(".block_totara_report_table."+e+" .content .rb-display-table-container");m.addClass("block_totara_report_table_loading"),m.append(l),c.renderIcon("loading","","ft-size-600").done(function(a){l.html(a);var b=m.position();b.left+=m.width()/2-l.width()/2,b.top+=m.height()/2-l.height()/2,l.css(b)})}g=d.refresh_results(e,k,function(){d.change_links(e,f)})})})},refresh_results:function(c,d,e){return a.get(b.wwwroot+"/blocks/totara_report_table/ajax_instantreport.php?"+d).done(function(b){var d=a(".block_totara_report_table."+c+" .content");d.find(".block_totara_report_table_instant_wait").remove(),d.find(".rb-display-table-container").remove(),d.prepend(a(b).find(".rb-display-table-container")),d.find("form").remove(),e&&e()})},populatelist:function(){var c=a("#id_config_savedsearch");a("#id_config_reportid").change(function(){var d=a(this).val();""!==d&&(c.attr("disabled","disabled"),M.util.js_pending("block_totara_report_table-populatelist"),a.ajax({type:"POST",url:b.wwwroot+"/blocks/totara_report_table/ajax_list_saved.php",data:{reportid:d,sesskey:M.cfg.sesskey},success:function(a){c.find("option").remove(),c.append('<option value="">'+M.util.get_string("allavailabledata","block_totara_report_table")+"</option>");for(var b in a)c.append('<option value="'+b+'">'+a[b]+"</option>");c.removeAttr("disabled"),M.util.js_complete("block_totara_report_table-populatelist")}}))})}};return d});
define('media_videojs/loader', ["jquery","core/event"],function(a,b){var c,d=function(d){c=d,e(null,a("body")),b.getLegacyEvents().done(function(b){a(document).on(b.FILTER_CONTENT_UPDATED,e)})},e=function(b,d){var e=".mediaplugin_videojs";d.find(e).addBack(e).find("audio, video").each(function(){var b=a(this).attr("id"),d=a(this).data("setup-lazy"),e=["media_videojs/video-lazy"];d.techOrder&&d.techOrder.indexOf("youtube")!==-1&&e.push("media_videojs/Youtube-lazy"),require(e,function(a){c&&(c(a),c=null),a(b,d)})})};return{setUp:d}});
define('format_tiles/course', ["jquery","core/templates","core/ajax","format_tiles/browser_storage","core/notification","core/str","format_tiles/tile_fitter"],function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m=a("body"),n=a("body, html"),o=[],p=!1,q=!1,r=60,s=!1,t=0,u=!1,v=0,w={PAGE:"#page",TILE:".tile",TILEID:"#tile-",MOVEABLE_SECTION:".moveablesection",FILTER_BUTTON:".filterbutton",TILE_LOADING_ICON:".tile-loading-icon",TILE_LOADING_ICON_ID:"#loading-icon-",TILE_COLLAPSED:".tile-collapsed",TILE_CLICKABLE:".tile-clickable",TILES:"ul.tiles",ACTIVITY:".activity",SPACER:".spacer",SECTION_MOVEABLE:".moveablesection",SECTION_ID:"#section-",SECTION_TITLE:".sectiontitle",SECTION_MAIN:".section.main",SECTION_BUTTONS:"#sectionbuttons",CLOSE_SEC_BTN:".closesectionbtn",HIDE_SEC0_BTN:"#buttonhidesec0",SECTION_ZERO:"#section-0",MOODLE_VIDEO:".mediaplugin.mediaplugin_videojs",LAUNCH_STANDARD:'[data-action="launch-tiles-standard"]',TOOLTIP:"[data-toggle=tooltip]",HEADER_BAR:["header.navbar","nav.fixed-top.navbar","#essentialnavbar.moodle-has-zindex","#navwrap","nav.navbar-fixed-top","#main-navbar"]},x={SELECTED:"selected",HEADER_OVERLAY:"header-overlay",OPEN:"open",CLOSED:"closed",LAUNCH_CM_MODAL:"launch-tiles-cm-modal",STATE_VISIBLE:"state-visible"},y={CLICK:"click",KEYDOWN:"keydown",SCROLL:"scroll"},z={DISPLAY:"display",Z_INDEX:"z-index",HEIGHT:"height",BG_COLOUR:"background-color"},A={ESCAPE:27,TAB:9,RETURN:13},B=function(a){return void 0!==k&&(a===!0?k.fadeIn(300):k.fadeOut(300),!0)},C=function(b){var c=a(w.SECTION_ID+b);c.find("iframe").each(function(b,c){c=a(c),c.attr("data-src",c.attr("src")),c.attr("src","")});var d=c.find(w.MOODLE_VIDEO);d.length>0&&c.html("")},D=function(b){a(w.MOVEABLE_SECTION).each(function(b,c){c=a(c),c.is(":visible")&&(C(c.attr("data-section")),c.slideUp().removeClass(x.STATE_VISIBLE))}),a(w.TILE).removeClass(x.SELECTED).css(z.Z_INDEX,"").css(z.BG_COLOUR,""),a(".section "+x.SELECTED).removeClass(x.SELECTED).css(z.Z_INDEX,""),j.fadeOut(300),B(!1),void 0!==b&&0!==b&&a(w.TILEID+b).focus(),a(w.TILE_LOADING_ICON).fadeOut(300,function(){a(w.TILE_LOADING_ICON).html("")}),q=!1,v=0},E=function(b,c){if(c){if(b.html(c),a(w.TILE_LOADING_ICON).fadeOut(300,function(){a(w.TILE_LOADING_ICON).html("")}),b.attr("id")!==w.SECTION_ZERO){var e=b.find(w.ACTIVITY).not(w.SPACER);b.on(y.KEYDOWN,function(c){c.keyCode===A.ESCAPE&&(d.setLastVisitedSection(0),D(0),a(w.TILEID+b.attr("data-section")).focus())}),e.on(y.KEYDOWN,function(b){if(b.keyCode===A.RETURN){var c=a(b.currentTarget).find("a");c.hasClass(x.LAUNCH_CM_MODAL)?c.click():void 0!==c.attr("href")&&(window.location=c.attr("href"))}}),h||(e.last().on(y.KEYDOWN,function(c){c.keyCode!==A.TAB||c.shiftKey||a(c.relatedTarget).closest(w.SECTION_MAIN).attr("id")===b.attr("id")||setTimeout(function(){b.find(w.SECTION_TITLE).focus(),n.animate({scrollTop:b.offset().top-r},"slow"),b.find("#sectionbuttons").css("top","")},200)}),b.find(w.SECTION_TITLE).on(y.KEYDOWN,function(c){c.keyCode===A.TAB&&c.shiftKey&&a(c.relatedTarget).closest(w.SECTION_MAIN).attr("id")!==b.attr("id")&&setTimeout(function(){e.last().focus()},200)}))}return h||setTimeout(function(){try{b.find(".togglecompletion, .completioncheckbox, .tag-info").tooltip()}catch(a){require(["core/log"],function(b){b.debug(a)})}},500),0!==b.find(w.MOODLE_VIDEO).length&&require(["media_videojs/loader"],function(a){a.setUp()}),!0}return!1},F=function(b,c){var d=function(){var d=a("#tileText-"+c).offset().top-r;d===a(window).scrollTop&&(d+=1),b.find(w.SECTION_TITLE).focus();var e="scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove";m.on(e,function(){m.stop()}),n.animate({scrollTop:d},"slow",function(){n.off(e,function(){n.stop()})}),q=!0,v=c,b.find(w.ACTIVITY).first().focus(),b.find("iframe").each(function(b,c){c=a(c),""===c.attr("src")&&void 0!==c.attr("data-src")&&c.attr("src",c.attr("data-src"))})},e=function(){var c=b.find(w.SECTION_BUTTONS);a(window).on(y.SCROLL,function(){!p&&q&&(p=!0,c.fadeOut(300),setTimeout(function(){var d=a(window).scrollTop(),e=d-b.offset().top+50;e>0&&e<b.outerHeight()-100?(e=d-b.offset().top+50,c.css("top",e),"none"===j.css(z.DISPLAY)&&j.fadeIn(300)):e<0&&c.css("top",0),d>b.offset().top+b.outerHeight()-50?("block"===j.css(z.DISPLAY)&&(j.fadeOut(300),B(!1)),c.css("top",0)):b.offset().top>d+a(window).outerHeight()?("block"===j.css(z.DISPLAY)&&(j.fadeOut(300),B(!1)),c.css("top",0)):"none"===j.css(z.DISPLAY)&&j.fadeIn(300),c.fadeIn(300,function(){p=!1})},500))}),p||q||!j.is(":visible")||j.fadeOut(300)};b.addClass(x.STATE_VISIBLE),b.slideDown(350,function(){d(),e()}),v=c},G=function(b,c){var d=new a.Deferred,e=a(".moveablesection:visible"),f=0;e.length>0&&(f=e.attr("data-section"),D());var h=function(a){g.runReOrg(a).done(function(a){0!==f&&F(e,f),d.resolve(a)}).fail(function(a){0!==f&&F(e,f),d.reject(a)})};return c?setTimeout(function(){g.resizeTilesDivWidth(l).done(function(){h(!1)},b)}):h(b),d.promise()},H=function(a,b,c){throw b?(e.confirm(o.sectionerrortitle,o.sectionerrorstring,o.refresh,o.cancel,function(){window.location.reload()},null),c.html("")):(E(c,"<p>"+o.noconnectionerror+"</p>"),setTimeout(function(){F(c,a)},500)),require(["core/log"],function(a){a.debug(b)}),new Error("Not successful retrieving tile content by AJAX for section "+a)},I=function(a,b){return c.call([{methodname:"format_tiles_get_single_section_page_html",args:{courseid:a,sectionid:b,setjsusedsession:!0}}])[0]},J=function(a,b,c,d){var e=d<0?0:255,f=d<0?d*-1:d,g=Math.round((e-a)*f)+a,h=Math.round((e-b)*f)+b,i=Math.round((e-c)*f)+c;return"rgb("+g+","+h+","+i+")"},K=function(b){j.fadeIn(300),t=parseInt(j.css(z.Z_INDEX));var c=a(w.TILEID+b);if(c.css(z.Z_INDEX,t+1),B(!0),a(w.SECTION_ID+b).css(z.Z_INDEX,t+1),c.css(z.BG_COLOUR)&&"rgba"===c.css(z.BG_COLOUR).substr(0,4)){var d=c.css(z.BG_COLOUR).replace("rgba(","").replace(")","").replace(" ","").split(",");c.css(z.BG_COLOUR,J(parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),.95))}},L=function(b){var c=a(b.currentTarget);if("window-overlay"===c.attr("id")||c.attr("id")===x.HEADER_OVERLAY){c.hide();var d=a(document.elementFromPoint(b.clientX,b.clientY));if(c.show(),"window-overlay"===c.attr("id"))if(d.hasClass("filterbutton")||d.hasClass("list-group-item"))d.click();else{var e=d.closest(w.TILE);e&&e.click()}else D(0),d.click()}},M=function(){var b=a(w.HIDE_SEC0_BTN),c=a(w.SECTION_ZERO);d.storageEnabledLocal()?d.getSecZeroCollapseStatus()===!0?(c.slideUp(0),b.addClass(x.CLOSED).removeClass(x.OPEN)):(c.slideDown(300),b.addClass(x.OPEN).removeClass(x.CLOSED)):(b.addClass(x.OPEN).removeClass(x.CLOSED),c.slideDown(300))},N=function(b,f,g,h){K(g),a(w.TILE).removeClass(x.SELECTED),f.addClass(x.SELECTED),v=g,a(w.MOVEABLE_SECTION).each(function(b,c){c=a(c),c.is(":visible")&&(C(c.attr("data-section")),c.slideUp(200).removeClass(x.STATE_VISIBLE))}),c.call([{methodname:"format_tiles_log_tile_click",args:{courseid:b,sectionid:g}}])[0].fail(e.exception);var j=a(w.SECTION_ID+g);if(j.find(w.ACTIVITY).length>0)F(j,g),(d.getStoredContentAge(b,g)>h||!d.getStoredContentAge(b,g))&&I(b,g).done(function(c){d.storageEnabledSession()&&d.storeCourseContent(b,g,a(c.html).html())});else if(j.html(i),d.storageEnabledLocal()){var k=d.getStoredContentAge(b,g);if(k&&(E(j,d.getCourseContent(b,g)),F(j,g)),!k||k>h){var l=a(w.TILE_LOADING_ICON_ID+g);void 0!==l?l.html(i).fadeIn(200):(l=a("<div>").html(i),j.html(l)),I(b,g).done(function(c){var e=a(c.html).html();E(j,e),F(j,g),d.storageEnabledSession()&&d.storeCourseContent(b,g,e)}).fail(function(a){H(g,a,j),D(g)})}}else I(b,g).done(function(b){E(j,a(b.html).html()),F(j,g)}).fail(function(a){H(g,a,j),D(g)});d.setLastVisitedSection(g)};return{init:function(e,n,p,q,B,C,F,H,J,K,O,P){l=e,h=q,s="1"===K,H=1===H,J="1"===J,d.init(l,p,!1,B,F,J,O),a(document).ready(function(){var e=a("#page-content");0===e.length&&(e=a("#region-main")),0!==B?v=B:s&&d.storageEnabledLocal&&(v=d.getLastVisitedSection()),0!==v?g.init(l,v,P,!1):(a(w.TILEID+"1").focus(),g.init(l,null,P,!1));var p=a(window).outerWidth();if(n){j=a("<div></div>").addClass("modal-backdrop fade in").hide().attr("id","window-overlay").appendTo(m),j.click(function(a){D(0),L(a)}),e.on(y.CLICK,w.TILE_CLICKABLE,function(b){if(n){b.preventDefault(),a(window).off(y.SCROLL),a(w.TILE_LOADING_ICON).fadeOut(300,function(){a(w.TILE_LOADING_ICON).html()});var c=a(b.currentTarget).closest(w.TILE),e=parseInt(c.attr("data-section"));c.hasClass(x.SELECTED)?(D(e),d.setLastVisitedSection(0)):N(l,c,e,C);var f=a(w.SECTION_ID+(e+1));!h&&f.length&&e>0&&setTimeout(function(){var b=d.getStoredContentAge(l,e+1);b&&E(f,d.getCourseContent(l,e+1)),(!b||b>C)&&I(l,e+1).done(function(b){E(f,a(b.html).html()),d.storageEnabledSession()&&d.storeCourseContent(l,e+1,a(b.html).html())})},2e3)}}),a(window).on("resize",function(){u||p===a(window).outerWidth()||(u=!0,setTimeout(function(){var b=!0,c=a(".moveablesection:visible");if(0!==c.length){var d=c.find(".mediaplugin iframe");0!==d.length&&d.each(function(d,e){e=a(e),e.outerWidth()>c.outerWidth()&&(b=!1)})}b&&(p=a(window).outerWidth(),G(!0,P)),u=!1},600))});var q=parseInt(j.css(z.Z_INDEX)),F=a(w.HEADER_BAR.find(function(b){return a(b).length>0}));void 0!==F&&0!==F.length&&(F.css(z.Z_INDEX,q+2),"navwrap"!==F.attr("id")&&(void 0!==F.outerHeight()?(r=F.outerHeight(),k=a("<div></div>").addClass(x.HEADER_OVERLAY).attr("id",x.HEADER_OVERLAY).css(z.DISPLAY,"none"),k.insertAfter(w.PAGE).css(z.Z_INDEX,q+3).css(z.HEIGHT,r).click(function(a){D(0),L(a)})):require(["core/log"],function(a){a.debug("Failed to get navbar.  Ensure theme's navbar selector is included in global HEADER_BAR")}))),e.on(y.CLICK,w.CLOSE_SEC_BTN,function(b){D(a(b.currentTarget).attr("data-section"))}),e.on(y.CLICK,w.LAUNCH_STANDARD,function(b){var c=a(b.currentTarget);void 0!==c.attr("href")?window.location=c.attr("href"):void 0!==c.find("a").attr("href")&&(window.location=c.find("a").attr("href"))}),M()}e.on(y.CLICK,w.HIDE_SEC0_BTN,function(b){var c=a(w.SECTION_ZERO);"none"===c.css(z.DISPLAY)?(c.slideDown(250),a(b.currentTarget).addClass(x.OPEN).removeClass(x.CLOSED),d.setSecZeroCollapseStatus("collapsed")):(c.slideUp(250),a(b.currentTarget).addClass(x.CLOSED).removeClass(x.OPEN),d.setSecZeroCollapseStatus("expanded"))}),H&&(require(["format_tiles/filter_buttons"],function(a){a.init(l,d.storageEnabledLocal)}),n&&e.on(y.CLICK,w.FILTER_BUTTON,function(){D(0),G(!0,!1)})),a(".tiles_coursenav").removeClass("hidden"),b.render("format_tiles/loading",{}).done(function(a){i=a});var J=[{key:"sectionerrortitle",component:"format_tiles"},{key:"sectionerrorstring",component:"format_tiles"},{key:"refresh"},{key:"cancel"},{key:"noconnectionerror",component:"format_tiles"},{key:"show"},{key:"hide"},{key:"other",component:"format_tiles"},{key:"blockedpopuptitle",component:"format_tiles"}];if(f.get_strings(J).done(function(a){a.forEach(function(a,b){o[J[b].key]=a})}),h)e.on(y.CLICK,w.ACTIVITY+".video a",function(b){var d=a(b.currentTarget),e=d.closest(w.ACTIVITY).attr("data-url-secondary");if(void 0!==e){b.preventDefault(),b.stopPropagation();var f=d.closest(w.ACTIVITY);c.call([{methodname:"format_tiles_log_mod_view",args:{courseid:l,cmid:f.attr("data-cmid")}}])[0].done(function(){require(["format_tiles/completion"],function(a){a.markAsAutoCompleteInUI(l,f)})}),window.location=e}});else{a(w.TILE).on(y.KEYDOWN,function(b){b.keyCode===A.RETURN&&a(b.currentTarget).click()}),a("ul.tiles .tile").first().focus();var K=a(w.TOOLTIP);if(0!==K.length)try{K.tooltip()}catch(O){require(["core/log"],function(a){a.debug(O)})}}a(document).on("filter-content-updated",function(b,c){if(c.length>0){var d=a(c[0]);d.hasClass("moodle-dialogue")&&d.css("z-index")<t&&d.css("z-index",t+1)}})})}}});
define('format_tiles/filter_buttons', ["jquery"],function(a){"use strict";var b={FILTER_BUTTON:".filterbutton",TILE:".tile",COLLAPSING:".tile-collapsing",COLLAPSED:".tile-collapsed",SPACER:".spacer",PAGE_CONTENT:"#page-content",REGION_MAIN:"#region-main"},c={COLLAPSING:"tile-collapsing",COLLAPSED:"tile-collapsed",SELECTED:"selected"},d={getPressedFilterButton:function(a,b){return b?localStorage.getItem("mdl-course-"+a+"-filter-btn"):null},setPressedFilterButton:function(a,b,c){c&&(0===b?localStorage.removeItem("mdl-course-"+a+"-filter-btn"):localStorage.setItem("mdl-course-"+a+"-filter-btn",b))},unCollapseTiles:function(d){d.forEach(function(b,e){a("#tile-"+d[e]).addClass(c.COLLAPSING).removeClass(c.COLLAPSED)}),setTimeout(function(){a(b.COLLAPSING).removeClass(c.COLLAPSING)},300)},collapseAllTiles:function(){a(b.TILE).not(a(b.COLLAPSED)).not(a(b.SPACER)).addClass(c.COLLAPSING),setTimeout(function(){a(b.COLLAPSING).addClass(c.COLLAPSED).removeClass(c.COLLAPSING)},250)},unCollapseAllTiles:function(){setTimeout(function(){a(b.COLLAPSED).addClass(c.COLLAPSING).removeClass(c.COLLAPSED),setTimeout(function(){a(b.COLLAPSING).removeClass(c.COLLAPSING)},250)},250)}};return{init:function(e,f){a(document).ready(function(){var g=d.getPressedFilterButton(e,f);if(g){var h=a("#filterbutton"+g);h||d.setPressedFilterButton(e,g,0),a(b.FILTER_BUTTON).removeClass(c.SELECTED),h.addClass(c.SELECTED),d.collapseAllTiles(),setTimeout(function(){d.unCollapseTiles(JSON.parse(h.attr("data-sections")))},250),d.setPressedFilterButton(e,g,f)}var i=a(b.PAGE_CONTENT);0===i.length&&(i=a(b.REGION_MAIN)),i.on("click",b.FILTER_BUTTON,function(g){var h=a(g.target),i=h.attr("data-buttonid");"all"===i||d.getPressedFilterButton(e,f)===i?(d.collapseAllTiles(),setTimeout(function(){d.unCollapseAllTiles()},500),a(b.FILTER_BUTTON).removeClass(c.SELECTED),d.setPressedFilterButton(e,0,f),a("#filterbutton-all").addClass(c.SELECTED)):(a(b.FILTER_BUTTON).removeClass(c.SELECTED),h.addClass(c.SELECTED),d.collapseAllTiles(),setTimeout(function(){d.unCollapseTiles(JSON.parse(h.attr("data-sections")))},250),d.setPressedFilterButton(e,i,f))})})}}});
define('format_tiles/edit_course_mod', ["jquery","core/ajax","core/templates","core/notification","core/str","core/url","core/config"],function(a,b,c,d,e,f,g){"use strict";var h={},i=a("html,body"),j=a("#page"),k={MENU_ACTION:".menu-action-text",SUBTILE:".subtile",SPACER:".spacer",AVAIL_INFO:".availabilityinfo",ACTIVITY_INSTANCE:".subtile-activityinstance",INSTANCE_NAME:".instancename",SECTION_CM_EDIT_ACTIONS:".section-cm-edit-actions",EDITING_MOVE:".editing_move",LABEL_CONVERT:".editing_labelconvert",CM_EDIT_ACTION:".cm-edit-action",ACTIVITY_ICON:".activityicon",EDITING_DELETE:".editing_delete",SECTION_MAIN:".section.main",STEALTH_UNAVAIL_LINK:".editing_makeunavailable"},l={SHOW:"show",HIDE:"hide",FA_EYE_SLASH:"fa-eye-slash",FA_EYE:"fa-eye",DIMMED:"dimmed",EDITING:"editing_",ACTIVITY:"activity",LABEL:"label",SECTION_DRAGGABLE:"sectiondraggable"},m={CLICK:"click",MODULE_ADDED:"filter-content-updated",MOUSEDOWN:"mousedown"},n=function(c){var d,e=a(c.currentTarget);if("tiles-hide"===e.attr("data-action")?(d={changeTo:l.HIDE,old:l.SHOW},a(k.STEALTH_UNAVAIL_LINK).hide()):"tiles-show"===e.attr("data-action")&&(d={changeTo:l.SHOW,old:l.HIDE}),d){c.preventDefault(),e.attr("data-action","tiles-"+d.old);var f=b.call([{methodname:"core_course_edit_module",args:{id:e.attr("data-cmid"),action:d.changeTo}}],!0);f[0].done(function(b){e.removeClass(l.EDITING+d.old).addClass(l.EDITING+d.changeTo),e.attr("href",e.attr("href").replace("&"+d.old+"=","&"+d.changeTo+"="));var c=e.find(k.MENU_ACTION),f=e.closest(k.SUBTILE);d.changeTo===l.SHOW?(c.html(c.html().replace(h.show,h.hide)),e.find("i").removeClass(l.FA_EYE_SLASH).addClass(l.FA_EYE),f.removeClass(l.DIMMED)):d.changeTo===l.HIDE&&(c.html(c.html().replace(h.hide,h.show)),e.find("i").removeClass(l.FA_EYE).addClass(l.FA_EYE_SLASH),f.addClass(l.DIMMED));var g=a(b).find(k.AVAIL_INFO),i=f.find(k.AVAIL_INFO);g?i.length?i.replaceWith(g):g.appendTo(f.find(k.ACTIVITY_INSTANCE)):i.hide()}),f[0].fail(function(){window.location.replace(e.attr("href"))})}},o=function(a){var b={powerpoint:"ppt",document:"doc",spreadsheet:"xls",archive:"zip",pdf:"pdf",mp3:"mp3",mpeg:"mp4",jpeg:"jpeg",text:"txt",html:"html"};return b[a.split("/").slice(-1)[0].split("-")[0]]},p=function(b,c,d){void 0!==d&&""!==d||(d=h.other),b.find("a.cm-edit-action").each(function(b,c){a(c).attr("data-action","")}),b.find("a.editing_moveright").remove();var e={cmid:b.attr("id").split("-").slice(-1)[0],modtitle:b.find(k.INSTANCE_NAME).html().split("<")[0],cmeditmenu:b.find(k.SECTION_CM_EDIT_ACTIONS)[0].outerHTML.replace(/\n/g,""),cmmove:b.find(k.EDITING_MOVE)[0].outerHTML,modname:"resource",modResourceType:c,modnameDisplay:d,useSubtiles:1,isEmbeddedResource:0,clickable:1,isediting:1,visible:1};return e.isPdf="pdf"===e.modResourceType,e},q=function(b,d,j,n){if(j.hasClass(l.SECTION_DRAGGABLE)&&window.location.href.indexOf("expand=")===-1)window.location=g.wwwroot+"/course/view.php?id="+b+"&expand="+j.attr("data-section")+"#section-"+j.attr("data-section");else if(d.hasClass(l.LABEL)&&d.closest("ul").hasClass("subtiles"))window.location.reload();else if(d.hasClass(l.ACTIVITY)&&d.closest("ul").hasClass("subtiles")){d.children().hide(),d.append(a("<img/>").attr("src",f.imageUrl("loading","format_tiles")).addClass("loading-subtile").attr("title",h.loading));var q=d.prevAll(k.SUBTILE).not(k.SPACER).first();d.prevUntil(q,k.SPACER).hide();var r=o(d.find(k.ACTIVITY_ICON).attr("src"));void 0===r&&window.location.reload();var s="displaytitle_mod_"+r;if(void 0===h[s])e.get_string(s,"format_tiles").done(function(b){"[["!==b.substring(0,2)?h[s]=b:b="";var e=p(d,r,b);c.render("format_tiles/course_module",e).done(function(b){d.replaceWith(b);var c=a("#"+a(n).attr("id"));i.animate({scrollTop:c.offset().top-130},"fast");for(var f=0;f<3;f++)c.fadeOut(300).fadeIn(300);a("#module-"+e.cmid).find(".editing_move").attr("data-action","").on(m.MOUSEDOWN,function(){window.location.reload()})})});else{var t=p(d,r,h[s]);c.render("format_tiles/course_module",t).done(function(b){d.replaceWith(b),a("#module-"+t.cmid).find(".editing_move").attr("data-action","").on(m.MOUSEDOWN,function(){window.location.reload()})})}}else d.find("div.mod-indent-outer").css("position","absolute").css("top","0").css("width","100%").css("padding-left","0")};return{init:function(b,c,f){a(document).ready(function(){if(Y.use("moodle-course-coursebase",function(){"undefined"!=typeof M.course&&setTimeout(function(){M.course.coursebase.registermodules=[]},500)}),a(k.LABEL_CONVERT).on(m.CLICK,function(b){b.preventDefault(),d.confirm(h.areyousure,h.converttopage_confirm,h.yes,h.no,function(){window.location=a(b.currentTarget).attr("href")},null)}),0!==f){var c=a("#module-"+f);i.animate({scrollTop:c.offset().top-130},"fast");for(var g=0;g<3;g++)c.fadeOut(300).fadeIn(300)}j.on("click",k.CM_EDIT_ACTION,function(a){n(a)}),a(document).on(m.MODULE_ADDED,function(c,d){var e=a("#"+a(d).attr("id")),f=e.closest(k.SECTION_MAIN);f.length>=1&&q(b,e,f,d)}),j.on(m.CLICK,k.EDITING_DELETE,function(b){var c=a(b.currentTarget).closest("li"+l.ACTIVITY),d=c.prevAll(k.SUBTILE).not(k.SPACER).first();c.hasClass(l.LABEL)&&c.prevUntil(d,k.SPACER).hide()}),e.get_strings([{key:"yes"},{key:"no"},{key:"show"},{key:"hide"},{key:"converttopage_confirm",component:"format_tiles"},{key:"areyousure"},{key:"complete",component:"format_tiles"},{key:"fileaddedtobottom",component:"format_tiles"},{key:"loading",component:"format_tiles"}]).done(function(a){h={yes:a[0],no:a[1],show:a[2],hide:a[3],converttopage_confirm:a[4],areyousure:a[5],complete:a[6],fileaddedtobottom:a[7],loading:a[8]}})})}}});
define('format_tiles/edit_browser_storage', ["jquery","format_tiles/browser_storage_set_up"],function(a,b){"use strict";var c,d,e,f={PAGE:"#page",EDITING_COLLAPSE_SECID:"#collapse",EDITING_COLLAPSE_SEC:".collapse-section",EDITING_EXPAND_SEC:".expand-section",EDITING_EXPAND_SECID:"#expand",SECTION_CONTENT:"li.section.main .content",SECTION_MAIN:"li.section.main",SECTION_ID:"#section-"},g={COURSE_VISIT:"mdl-tiles-editing-last-visit-course-",EDITING_COURSE:"mdl-tiles-editing-course-",SECTION:"-section-",COURSE:"mdl-tiles-course-",LAST_SECTION:"-lastSecId",USER:"-user-",PREFIX:"mdl-tiles-",USER_CHOICE_PREFIX:"mdl-tiles-userPrefStorage-",CONTENT_SUFFIX:"-content",LAST_UPDATED_SUFFIX:"-lastUpdated"},h={OPEN:"1",CLOSED:"0"},i=function(a){return g.EDITING_COURSE+c+g.SECTION+a+g.USER+d},j=function(a){(!a||a>50)&&(a=50);for(var b,c=[],d=1;d<=a;d++)b=sessionStorage.getItem(i(d)),b===h.OPEN&&c.push(d);return c},k=function(){return g.COURSE+c+g.USER+d+g.LAST_SECTION},l=function(a){a?a!==e&&b.storageAllowed&&(e=a,localStorage.setItem(k(),a.toString())):localStorage.clear(k())},m=function(){return e||(e=localStorage.getItem(k())),e},n=function(a,c){b.storageAllowed&&c?sessionStorage.setItem(i(a),h.OPEN):sessionStorage.removeItem(i(a))},o=function(){Object.keys(sessionStorage).filter(function(a){return 0===a.indexOf(g.PREFIX)&&(a.indexOf(g.CONTENT_SUFFIX)===a.length-g.CONTENT_SUFFIX.length||a.indexOf(g.LAST_UPDATED_SUFFIX)===a.length-g.LAST_UPDATED_SUFFIX.length)}).forEach(function(a){sessionStorage.removeItem(a)})},p=function(){Object.keys(localStorage).filter(function(a){return 0===a.indexOf(g.PREFIX)&&a.indexOf(g.USER_CHOICE_PREFIX)===-1}).forEach(function(a){localStorage.removeItem(a)}),Object.keys(sessionStorage).filter(function(a){return 0===a.indexOf(g.PREFIX)&&a.indexOf(g.USER_CHOICE_PREFIX)===-1}).forEach(function(a){sessionStorage.removeItem(a)})};return{getOpenSections:function(a){return j(a)},init:function(e,h,i,j,k,m,q){c=h,d=e,m&&n(m,!0),a(document).ready(function(){if(b.init(d,k,p),0===parseInt(i))return void b.setAllowed(!1);if(o(),b.storageAllowed()){if(sessionStorage.setItem(g.COURSE_VISIT+c+g.USER+d,Date.now().toString()),q)for(var e=1;e<=m;e++)n(e,!1);a(f.PAGE).on("click",f.SECTION_CONTENT,function(b){var c=a(b.currentTarget),d=c.closest(f.SECTION_MAIN).attr("data-section");l(d)})}})},getLastSection:function(){return m()},setSectionStatus:function(a,b){return n(a,b)},setLastSection:function(a){return l(a)}}});
define('format_tiles/tile_fitter', ["jquery","core/ajax"],function(a,b){"use strict";var c,d=!1,e={PAGE:"#page",TILE:".tile",TILEID:"#tile-",TILE_COLLAPSED:".tile-collapsed",TILES:".format-tiles.jsenabled ul.tiles",ACTIVITY:".activity",SPACER:".spacer",SECTION_ID:"#section-",OPEN_SECTION:".moveablesection:visible",SECTION_ZERO:"#section-0",CONTENT_SECTIONS:".moveablesection"},f=null,g=function(){var d=a(window).width(),g=new a.Deferred,h=a(e.TILES),i={standard:260,min:225,mobileMin:160};try{var j=h.parent().innerWidth(),k=a(h.find(e.TILE)[0]),l=k.width()?k.width():i.standard,m=14;l+=m;var n="inherit",o=Math.floor(j/i.min),p=a(e.TILE).not(e.SPACER).length;if(j<2*i.mobileMin)g.reject("Too narrow to resize");else if(p<=3&&j>p*i.mobileMin)n=4*i.standard;else if(j<3*i.min)n=2*(i.standard-m);else if(o<4)n=i.standard*o;else{var q=function(a,b){var c=[];for(a;a<=b;a+=1)c.push(a);return c},r=Math.min(Math.floor(j/l),p);if(p<=r&&p>5)n=(Math.floor(p/2)+1)*l;else if(r>3&&p/r<=3){var s=Math.floor(j/l),t=q(s,r).reverse(),u=t.map(function(a){return p%a});n=u.indexOf(0)!==-1?l*t[u.indexOf(0)]:p<s?p*l:l*t[u.indexOf(Math.max.apply(null,u))]}else n=r*l}var v=parseInt(h.css("max-width").replace("px",""));if(Math.abs(n-v)<100)g.resolve();else{var w=500;h.css("max-width",d).animate({"max-width":n},w,"swing",function(){setTimeout(function(){g.resolve()},w+100),a(e.CONTENT_SECTIONS).animate({"max-width":n},w,"swing")})}f&&clearTimeout(f),f=setTimeout(function(){b.call([{methodname:"format_tiles_set_session_width",args:{courseid:c,width:Math.floor(n)}}])},3e3)}catch(x){h.css("max-width",d).animate({"max-width":"100%"},500,"swing"),b.call([{methodname:"format_tiles_set_session_width",args:{courseid:c,width:0}}]),g.reject("Failed to resize")}return g.promise()},h={getContentSectionPositions:function(){var b,c,d=[],f=a(e.OPEN_SECTION);f.css("display","none");var g=1,h=0,i=a(e.TILES).children(e.TILE).not(e.TILE_COLLAPSED).not(".spacer");return i.each(function(d,e){b=a(e).attr("data-section");var f=100;b&&(0===d?h=1:Math.abs(a(e).position().top-a(c).position().top)<=f?h+=1:h=0,h>g&&(g=h),c=e)}),f.css("display","block"),i.each(function(c,e){b=a(e).attr("data-section"),0===d.length||d[d.length-1].sections.length>=g?(d.length>=1&&(d[d.length-1].displayAfterTile=d[d.length-1].sections[d[d.length-1].sections.length-1]),d.push({displayAfterTile:"",sections:[b]})):d[d.length-1].sections.push(b)}),d[d.length-1].displayAfterTile=d[d.length-1].sections[d[d.length-1].sections.length-1],d},moveContentSectionsToPlaces:function(b,c){b.forEach(function(c){c.sections.forEach(function(d){c.displayAfterTile===b[b.length-1].displayAfterTile?a(e.SECTION_ID+d).detach().insertAfter(a("ul.tiles .tile").last()):a(e.SECTION_ID+d).detach().insertAfter(a("#tile-"+c.displayAfterTile))})}),c.forEach(function(a){"function"==typeof a&&a()})},runReOrg:function(b){var c=new a.Deferred;d===!0&&c.reject("Re-org locked"),d=!0;var e=function(){h.moveContentSectionsToPlaces(h.getContentSectionPositions(),[function(){a("body").removeClass("modal-open"),c.resolve("Finished organising tiles"),d=!1}])};return b===!0?setTimeout(function(){e(),c.resolve("Re-org complete")},1e3):(e(),c.resolve("Re-org complete")),c.promise()}},i=function(){a(".block-hider-hide").click(function(){h.runReOrg(!0)}),a(".block-hider-show").click(function(){h.runReOrg(!0)}),a('.navbar button[data-action="toggle-drawer"]').click(function(){setTimeout(function(){h.runReOrg(!0),g()},600)})},j=function(){a(e.TILES).animate({opacity:1},"fast"),a(e.TILE).not(e.SPACER).each(function(b,c){c=a(c),setTimeout(function(){c.animate({opacity:c.hasClass("tile-hidden")||c.hasClass("tile-restricted")?.5:1},"fast")},10*b)}),a(e.SECTION_ZERO).animate({opacity:1},"fast"),a("#page-loading-icon").fadeOut(500).remove()};return{init:function(b,d,f,k){c=b,a(document).ready(function(){i(),"1"===a(e.TILES).css("opacity")&&h.runReOrg().done(function(){0!==d&&a(e.TILEID+d).click()});var b=function(){h.runReOrg().done(function(){0!==d&&0===a(e.OPEN_SECTION).length&&a(e.TILEID+d).click(),j()})};f&&!k?g().done(function(){b()}).fail(function(){b()}):b()})},resizeTilesDivWidth:function(){return g()},runReOrg:function(a){return h.runReOrg(a)}}});
define('format_tiles/registration', ["jquery","core/notification","core/config","core/str"],function(a,b,c,d){"use strict";return{attemptRegistration:function(e,f,g){g.useragent=navigator.userAgent,g.browserlanguages=navigator.languages,a(document).ready(function(){a.ajax({url:f,type:"POST",crossDomain:!0,contentType:"application/json",data:JSON.stringify(g),dataType:"json",success:function(a){if(a.status){var f=[{key:"registration",component:"admin"},{key:"registeredthanks",component:"format_tiles"},{key:"registerclicktocomplete",component:"format_tiles"},{key:"ok",component:"format_tiles"},{key:"cancel"}];d.get_strings(f).done(function(d){b.confirm(d[0],d[1]+" "+d[2],d[3],d[4],function(){window.location.href=c.wwwroot+"/course/format/tiles/register.php?key="+a.key+"&sesskey="+e},function(){window.location.href=c.wwwroot+"/admin/settings.php?section=formatsettingtiles"})})}},error:b.exception})})}}});
define('format_tiles/course_mod_modal', ["jquery","core/modal_factory","core/config","core/templates","core/notification","core/ajax"],function(a,b,c,d,e,f){"use strict";var g,h,i={},j=a(window),k={toggleCompletion:".togglecompletion",modal:".modal",modalDialog:".modal-dialog",modalBody:".modal-body",sectionMain:".section.main",pageContent:"#page-content",regionMain:"#region-main",completionState:"#completionstate_",cmModalClose:".embed_cm_modal .close",cmModal:".embed_cm_modal",moodleMediaPlayer:".mediaplugin_videojs",urlModalLoadWarning:"#embed-url-error-msg-",closeBtn:"button.close",ACTIVITY:"li.activity",URLACTIVITYPOPUPLINK:".activity.modtype_url.urlpopup a",newWindowButton:".button_expand",modalHeader:".modal-header",embedModuleButtons:".embed-module-buttons"},l={launchResourceModal:"launch-tiles-resource-modal",launchModuleModal:"launch-tiles-module-modal",launchUrlModal:"launch-tiles-url-modal"},m=function(){return Math.min(j.width(),1e3)},n=function(b){var c=b.find("iframe");c.length>0&&b.find(k.closeBtn).click(function(b){a(b.currentTarget).closest(k.cmModal).find("iframe").each(function(b,c){c=a(c),c.attr("src",c.attr("src"))})});var d=b.find("object");d.length>0&&b.find(k.closeBtn).click(function(b){var c=a(b.currentTarget).closest(k.cmModal);c.find("object").each(function(b,c){c=a(c),c.attr("data","")}),i[c.attr("data-cmid")]=void 0});var e=b.find(k.moodleMediaPlayer);e.length>0&&(b.find(k.closeBtn).click(function(){b.find(k.moodleMediaPlayer).html("")}),i[b.attr("data-cmid")]=void 0)},o=function(f){var h=f.attr("data-cmid");return b.create({type:b.types.DEFAULT,title:f.attr("data-title"),body:g}).done(function(b){i[h]=b,b.setLarge(),b.show();var g=a(b.root);g.attr("id","embed_mod_modal_"+h),g.attr("data-cmid",h),g.addClass("embed_cm_modal");var l={id:h,pluginfileUrl:f.attr("data-url"),objectType:"text/html",width:"100%",height:Math.round(j.height()-60),cmid:h,tileid:f.closest(k.sectionMain).attr("data-section"),isediting:0,sesskey:c.sesskey,modtitle:f.attr("data-title"),config:{wwwroot:c.wwwroot},showDownload:0,showNewWindow:0,completionInUseForCm:0};if("resource_pdf"===f.attr("data-modtype")&&(l.objectType="application/pdf",l.showDownload=1,l.showNewWindow=1),d.render("format_tiles/embed_file_modal_body",l).done(function(a){b.setBody(a),g.find(k.modalBody).animate({"min-height":Math.round(j.height()-60)},"fast"),"resource_html"===f.attr("data-modtype")?(g.find(k.modal).animate({"max-width":"100%"},"fast"),g.find(k.modalDialog).animate({"max-width":"100%"},"fast"),g.find(k.modalBody).animate({"max-width":"100%"},"fast"),n(g)):(g.find(k.modal).animate({"max-width":m()},"fast"),g.find(k.modalDialog).animate({"max-width":m()},"fast"))}).fail(e.exception),0!==f.find(k.toggleCompletion).length){var o=parseInt(a(k.completionState+h).attr("value"));l.completionInUseForCm=1,l.completionstate=1-o,l.completionicon=1===o?"n":"y",l.completionstateInverse=o,l.completionIsManual=f.find(k.toggleCompletion).attr("data-ismanual")}return d.render("format_tiles/embed_module_modal_header_btns",l).done(function(a){g.find(k.modalHeader).append(a),g.find(k.closeBtn).detach().appendTo(g.find(k.embedModuleButtons))}).fail(e.exception),!0}),!1},p=function(f){var h=f.attr("data-cmid");return b.create({type:b.types.DEFAULT,title:f.attr("data-title"),body:g}).done(function(b){i[h]=b,b.setLarge(),b.show();var g=a(b.root);g.attr("id","embed_mod_modal_"+h),g.attr("data-cmid",h),g.addClass("embed_cm_modal");var l=Math.round(.9*j.width()),m=Math.round(.9*j.height()),o={id:h,pluginfileUrl:f.attr("data-url"),objectType:"text/html",width:l-30,height:m-30,cmid:h,tileid:f.closest(k.sectionMain).attr("data-section"),isediting:0,sesskey:c.sesskey,modtitle:f.attr("data-title"),config:{wwwroot:c.wwwroot},showDownload:0,showNewWindow:1,completionInUseForCm:0,secondaryurl:f.closest(k.ACTIVITY).attr("data-url-secondary")};if(d.render("format_tiles/embed_url_modal_body",o).done(function(a){b.setBody(a),g.find(k.modalBody).animate({"min-height":m},"fast"),g.find(k.modal).animate({"max-width":l},"fast"),g.find(k.modalDialog).animate({"max-width":l},"fast"),g.find(k.modalBody).animate({"max-width":l},"fast"),n(g),g.find(k.modalBody).addClass("text-center")}).fail(e.exception),0!==f.find(k.toggleCompletion).length){var p=parseInt(a(k.completionState+h).attr("value"));o.completionInUseForCm=1,o.completionstate=1-p,o.completionicon=1===p?"n":"y",o.completionstateInverse=p,o.completionIsManual=f.find(k.toggleCompletion).attr("data-ismanual")}return d.render("format_tiles/embed_module_modal_header_btns",o).done(function(a){g.find(k.modalHeader).append(a),g.find(k.closeBtn).detach().appendTo(g.find(k.embedModuleButtons))}).fail(e.exception),setTimeout(function(){g.find(k.newWindowButton).click(function(){i[g.attr("data-cmid")]=void 0,g.remove(),a(".modal-backdrop").not("#window-overlay").removeClass("show").addClass("hide")})},1e3),!0}),!1},q=function(b){b.find(k.modal).animate({"max-width":m()},"fast");var c=70,d=a(k.moodleMediaPlayer);d.find("div").each(function(b,c){a(c).css("max-width","")}),d.length>0&&n(b),b.find("iframe").each(function(d,e){var f;f=b.find(k.modalDialog),0===f.length&&(f=b.find(k.modal));var g=Math.min(a(e).width(),j.width());g>f.width()-c&&(f.animate({"max-width":Math.max(g+c,m())},"fast"),b.find(k.modal).animate({"max-width":Math.max(g+c,m())},"fast"));var h=Math.min(a(e).height(),j.height()),i=b.find(k.modalBody);h>i.height()-c&&i.animate({"min-height":Math.min(h+c,j.height())},"fast"),n(b)})},r=function(j){var l=j.attr("data-cmid"),m="format_tiles_get_mod_"+j.attr("data-modtype")+"_html";return b.create({type:b.types.DEFAULT,title:j.attr("data-title"),body:g}).done(function(b){i[l]=b,b.setLarge(),b.show();var g=a(b.root);g.attr("data-cmid",l),g.attr("id","embed_mod_modal_"+l),g.addClass("embed_cm_modal"),g.addClass("mod_"+j.attr("data-modtype")),n(g),f.call([{methodname:m,args:{courseid:h,cmid:l}}])[0].done(function(c){var f={cmid:l,modtitle:j.attr("data-title"),content:c.html};if(0!==j.find(k.toggleCompletion).length){var h=parseInt(a(k.completionState+l).attr("value"));f.completionInUseForCm=1,f.completionstate=1-h,f.completionstateInverse=h,f.completionIsManual=j.find(k.toggleCompletion).attr("data-ismanual"),f.completionicon=1===h?"n":"y"}else f.completionInUseForCm=0;return b.setBody(f.content),d.render("format_tiles/embed_module_modal_header_btns",f).done(function(a){g.find(k.modalHeader).append(a),g.find(k.closeBtn).detach().appendTo(g.find(k.embedModuleButtons))}).fail(e.exception),q(g),!0}).fail(function(a){c.developerdebug!==!0?window.location=c.wwwroot+"/mod/"+j.attr("data-modtype")+"/view.php?id="+l:e.exception(a)})}),!1},s=function(b){var c=a(b.currentTarget).closest(k.ACTIVITY);void 0!==c.attr("data-url")&&(b.stopPropagation(),b.preventDefault(),f.call([{methodname:"format_tiles_log_mod_view",args:{courseid:h,cmid:c.attr("data-cmid")}}])[0].done(function(){require(["format_tiles/completion"],function(a){a.markAsAutoCompleteInUI(h,c)});var a=window.open(c.attr("data-url"));try{a.focus()}catch(b){var d='<div><a href="'+c.attr("data-url")+'">'+c.attr("data-url")+"</a></div>";require(["core/str","core/notification"],function(a,b){var c=[{key:"sectionerrortitle",component:"format_tiles"},{key:"blockedpopup",component:"format_tiles"},{key:"cancel"}];a.get_strings(c).done(function(a){b.alert(a[0],a[1]+d,a[2])})})}}).fail(e.exception))};return{init:function(b,c){h=b,a(document).ready(function(){var b=Object.keys(l).map(function(a){return'[data-action="'+l[a]+'"]'}).join(", "),j=a(k.pageContent);0===j.length&&(j=a(k.regionMain)),j.on("click",b,function(b){b.preventDefault();var c=a(b.currentTarget),d=c.closest("li.activity"),g=i[d.attr("data-cmid")];if("object"==typeof g)g.show();else{switch(c.attr("data-action")){case l.launchModuleModal:r(d);break;case l.launchResourceModal:o(d);break;case l.launchUrlModal:p(d);break;default:throw new Error("Unknown modal type "+c.attr("data-action"))}f.call([{methodname:"format_tiles_log_mod_view",args:{courseid:h,cmid:d.attr("data-cmid")}}])[0].fail(e.exception)}}),d.render("format_tiles/loading",{})["catch"](e.exception).done(function(a){g=a}).fail(e.exception),c||j.on("click",k.URLACTIVITYPOPUPLINK,function(a){s(a)})})}}});
define('format_tiles/edit_course', ["jquery","core/config","core/str","core/ajax","format_tiles/edit_browser_storage"],function(a,b,c,d,e){"use strict";var f,g={EDITING_COLLAPSE_SECID:"#collapse",EDITING_COLLAPSE_SEC:".collapse-section",EDITING_EXPAND_SEC:".expand-section",EDITING_EXPAND_SECID:"#expand",ACTIVITY:"li.activity",SECTION_ID:"#section-",TILE_TITLE:"li.section.main .tile_bar_text .inplaceeditable a:not(.quickeditlink)",TILE_BAR_TEXT:".tile_bar_text",SECTION:"ul.section",SECTION_MAIN:"li.section.main",DNDUPLOAD_HIDDEN:"dndupload-hidden",ACTIVITYACTION:"a.cm-edit-action",ACTIONAREA:".actions",EXPAND_ALL_BTNS:".expand-collapse-all-btns a",EXPAND_COLLAPSE_SEC:".expand-collapse-sec ",EDIT_TITLE_PENCIL:".quickeditlink",ICON_PICKER_BTN:".tileiconcontainer",TILE_BAR:".tile_bar",SECTIONACTIONMENU:".section_action_menu",MENU_ACTION:".menu-action"},h={ESCAPE:27,TAB:9,RETURN:13},i={CLICK:"click",KEYDOWN:"keydown",SCROLL:"scroll"},j={SECTION:"data-section",ORIG_TITLE:"data-original-title"},k=function(b){var c=a(g.SECTION_ID+b);a(g.SECTION_ID+b+"-content").animate({opacity:0},300),c.find(g.ACTIVITY).slideUp(500),c.find(".section-modchooser").slideUp(500),c.addClass("collapsed").removeClass("expanded"),c.find(".mod-chooser-outer").fadeOut(500),e.setSectionStatus(b,!1)};return{init:function(c,d,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){f=c,r="1"===r,require(["format_tiles/edit_icon_picker"],function(a){a.init(f,v,w,z)}),x&&require(["format_tiles/edit_course_mod"],function(a){a.init(f,n,y)}),a(document).ready(function(){if(a(g.TILE_BAR_TEXT).on(i.KEYDOWN,function(c){c.keyCode!==h.RETURN||a(c.target).hasClass("form-control")||(window.location=b.wwwroot+"/course/view.php?id="+f+"&section="+a(c.currentTarget).parent().attr(j.SECTION))}),d&&!m){var c=window.location.search.indexOf("expanded=-1")!==-1,n=a(g.SECTION_MAIN).last().attr("data-section");e.init(t,f,l,p,r,n,c)}if(!m){var o=a("[data-toggle=tooltip]");if(0!==o.length)try{o.tooltip()}catch(q){require(["core/log"],function(a){a.debug(q)})}}a("body").on("click keypress",g.SECTION_MAIN+" "+g.SECTIONACTIONMENU+"[data-sectionid] a[data-action]",function(b){var c=a(b.target).closest(g.MENU_ACTION),d=c.closest(g.SECTION_MAIN);"hide"!==c.attr("data-action")&&"show"!==c.attr("data-action")||(k(d.attr("data-section")),d.find(g.SECTION).find(g.ACTIVITY).slideUp(300).remove())})})}}});
define('format_tiles/edit_actions', ["jquery","core/str","core/notification"],function(a,b,c){"use strict";var d={ACTIONAREA:".actions"},e={EDITINPROGRESS:"editinprogress"},f=function(a){var b="";return Y.use("moodle-course-util",function(c){b=c.Moodle.core_course.util.cm.getName(c.Node(a.get(0)))}),b},g=function(a,d){var e=a.attr("class").match(/modtype_([^\s]*)/)[1],g=f(a);b.get_string("pluginname",e).done(function(a){var e={type:a,name:g};b.get_strings([{key:"confirm"},{key:null===g?"deletechecktype":"deletechecktypename",param:e},{key:"yes"},{key:"no"}]).done(function(a){c.confirm(a[0],a[1],a[2],a[3],d)}).fail(c.exception)})},h=function(a){a.addClass(e.EDITINPROGRESS);var b=a.find(d.ACTIONAREA).get(0);if(b){var c=M.util.add_spinner(Y,Y.Node(b));return c.show(),c}return null},i=function(a){var b=M.util.add_lightbox(Y,Y.Node(a.get(0)));return b.show(),b},j=function(a,b,c){window.setTimeout(function(){a.removeClass(e.EDITINPROGRESS),b&&b.hide()},c)},k=function(a,b){a&&window.setTimeout(function(){a.hide()},b)};return{confirmDeleteModule:function(a,b){g(a,b)},removeLightbox:function(a,b){k(a,b)},removeSpinner:function(a,b,c){j(a,b,c)},getModuleName:function(a){f(a)},addSectionLightbox:function(a){i(a)},addActivitySpinner:function(a){h(a)}}});
define('format_tiles/edit_upload_image_helper', ["jquery"],function(a){"use strict";return{init:function(){a(document).ready(function(){a(".fp-btn-choose").click(function(){a("#id_headertag").addClass("collapsed"),a("#id_guidance").addClass("collapsed")})})}}});
define('format_tiles/edit_icon_picker', ["jquery","core/templates","core/ajax","core/str","core/notification","core/config"],function(a,b,c,d,e,f){"use strict";var g,h={pickAnIcon:""},i=[],j=[],k=function(b,d){var e=c.call([{methodname:"format_tiles_get_icon_set",args:{courseid:b}}]);e[0].done(function(b){b.photos&&(j=JSON.parse(b.photos));var c=JSON.parse(b.icons);Object.keys(c).forEach(function(a){i.push({filename:a,displayname:c[a]})}),i.length<=0&&require(["core/log"],function(a){a.error("Error empty icon set"),a.debug(b)}),"function"==typeof d&&d();var e=j.map(function(a){return a.filename});a("#iconpickerphotos").find(".photo").each(function(b,c){c=a(c),e.indexOf(c.attr("data-filename"))===-1&&c.fadeOut(500)}),b.status!==!0&&require(["core/log"],function(a){a.error("Non true status response when getting icon set"),a.debug(b)})}),e[0].fail(function(a){require(["core/log"],function(b){b.error("Fail when getting icon set"),b.debug(a)})})},l=function(a,b){return f.wwwroot+"/course/format/tiles/editimage.php?courseid="+a+"&sectionid="+b},m=function(f,g,h,i,j,m,n,o,p){var q=a("#selectedicon"),r=function(c,d,e){var i="",n={tileicon:h,tileid:g,secid:f,isediting:1};switch(e){case"tileicon":i="tileicon";break;case"tilephoto":i="tilebarphoto",n.phototileurl=d,n.phototileediturl=l(m,f),n.iamgetype=e,c.closest(".tileiconcontainer").addClass("hasphoto"),setTimeout(function(){k(m)},3e3);break;case"draftfile":i="tilebarphoto",n.phototileurl=d,n.phototileediturl=l(m,f),n.iamgetype=e;break;default:throw new Error("Invalid image type "+e)}var o="course-view-tiles"===j?c:q;o.animate({opacity:0},500,function(){b.render("format_tiles/"+i,n).done(function(a){o.html(a).animate({opacity:1},500)})}),"course-editsection"===j&&"tilephoto"===e&&a("input[name=tilephoto]").val(h)},s={image:h,courseid:m,sectionid:f,imagetype:n,sourcecontextid:void 0===o?0:o,sourceitemid:void 0===p?0:p},t=c.call([{methodname:"format_tiles_set_image",args:s}]);t[0].done(function(c){if(c.status===!0)if("course-view-tiles"===j)r(a("#tileicon_"+g),c.imageurl,n);else if("course-edit"===j||"course-editsection"===j){var f=a("#id_defaulttileicon");"course-editsection"===j&&(f=a("#id_tileicon")),f.val(h),"tileicon"===n?(b.renderPix("tileicon/"+h,"format_tiles",i).done(function(a){q.html(a),"course-editsection"===j&&d.get_strings([{key:"tip",component:"format_tiles"},{key:"tileselecttip",component:"format_tiles"}]).done(function(a){e.alert(a[0],a[1])})}),"course-editsection"===j&&a("input[name=tilephoto]").val("")):"tilephoto"===n&&r(a("#tileicon_"+g),c.imageurl,n)}}).fail(function(a){require(["core/log"],function(b){b.error("Fail setting icon"),b.debug(a)})})},n=function(c,d,e,n,o,p){var q=function(b,e,f){var g=a("#iconpickerphotos");g.html(b);var h=2e5,i=[];g.find("img").each(function(b,g){g=a(g),g.attr("data-filesize")<h?setTimeout(function(){g.attr("src",g.attr("data-url"))},20*b):i.push(g),g.click(function(b){var g=a(b.currentTarget);m(e.attr("data-sectionid"),e.attr("data-section"),g.attr("data-filename"),g.attr("data-filename"),c,d,g.attr("data-imagetype"),g.attr("data-contextid"),g.attr("data-itemid")),f.hide()})}),setTimeout(function(){i.forEach(function(a){a.attr("src",a.attr("data-url"))})},1e3)};if("object"!=typeof g){var r=function(){b.render("format_tiles/icon_picker_modal_body",{icon_picker_icons:i,photosallowed:o,wwwroot:f.wwwroot,documentationurl:p}).done(function(i){require(["core/modal_factory"],function(k){k.create({type:k.types.DEFAULT,title:h.pickAnIcon,body:i}).done(function(h){g=h,h.setLarge(),h.show();var i=a(h.root);i.attr("id","icon_picker_modal"),i.attr("data-sectionid",e),i.attr("data-section",n),i.addClass("icon_picker_modal"),i.on("click",".pickericon",function(b){var f=a(b.currentTarget);m(e,n,f.attr("data-icon"),f.attr("title"),c,d,"tileicon",f.attr("data-contextid"),f.attr("data-itemid")),h.hide()}),i.on("input","input.iconsearch",function(b){var c=b.currentTarget.value.toLowerCase();i.find(".pickericon").show(),c.length>=3&&i.find(".pickericon").filter(function(b,d){return a(d).attr("data-original-title").toLowerCase().indexOf(c)<0}).hide()});try{a(".pickericon").tooltip()}catch(k){require(["core/log"],function(a){a.debug(k)})}if(o){var p=l(d,e);i.find("#phototilebtn").attr("href",p),a("#launch-photo-library").click(function(){0!==j.length&&b.render("format_tiles/icon_picker_photos",{icon_picker_photos:j,wwwroot:f.wwwroot}).done(function(a){q(a,i,h)})})}})})})};i.length<=0?k(d,r):r()}else{if(g.root.attr("data-sectionid",e),g.root.attr("data-section",n),g.root.off("click"),g.root.on("click",".pickericon",function(b){var f=a(b.currentTarget);m(e,n,f.attr("data-icon"),f.attr("title"),c,d,f.attr("data-imagetype"),f.attr("data-contextid"),f.attr("data-itemid")),g.hide()}),o){var s=l(d,e);g.root.find("#phototilebtn").attr("href",s)}g.show()}};return{init:function(b,c,e,f){a(document).ready(function(){var g=e?"picknewiconphoto":"picknewicon";d.get_string(g,"format_tiles").done(function(a){h.pickAnIcon=a}),k(b);var i=a("#page-content");0===i.length&&(i=a("#region-main")),i.on("click",".launchiconpicker",function(d){d.preventDefault();var g=a(d.currentTarget);n(c,b,g.attr("data-sectionid"),g.attr("data-section"),e,f)})})}}});
define('format_tiles/browser_storage_set_up', ["jquery"],function(a){"use strict";var b,c={GIVEN:"yes",DENIED:"no"},d={userPrefStorage:"mdl-tiles-userPrefStorage",user:"-user-"},e={local:"local",session:"session"},f={local:!1,session:!1},g=null,h=function(){return d.userPrefStorage+d.user+b},i=function(){if(null!==g)return g;var a=localStorage.getItem(h());return a?g=a===c.GIVEN:null},j=function(a){a?(g=!0,localStorage.setItem(h(),c.GIVEN)):(g=!1,localStorage.setItem(h(),c.DENIED))},k=function(a){require(["core/str","core/notification"],function(b,c){b.get_strings([{key:"datapref",component:"format_tiles"},{key:"dataprefquestion",component:"format_tiles"},{key:"yes"},{key:"no"}]).done(function(b){c.confirm(b[0],b[1],b[2],b[3],function(){j(!0)},function(){j(!1),"function"==typeof a&&a()})})})},l=function(a){var b;try{return a===e.local?b=localStorage:a===e.session&&(b=sessionStorage),"undefined"!=typeof b&&(b.setItem("testItem","testValue"),"testValue"===b.getItem("testItem")&&(b.removeItem("testItem"),!0))}catch(c){return require(["core/log"],function(a){a.debug(c)}),!1}};return{setAllowed:function(a){j(a)},storageAllowed:function(){return i()},getStorageKey:function(){return h()},Enabled:f,init:function(c,d,h){b=c,a(document).ready(function(){f.local=l(e.local),f.session=l(e.session),d?g=!0:null===i()&&f.local&&setTimeout(function(){g=k(h)},3e3),a('a[href*="datapref"]').click(function(a){a.preventDefault(),k(h)})})}}});
define('format_tiles/edit_form_helper', ["jquery","core/notification","core/str","core/templates","format_tiles/browser_storage"],function(a,b,c,d,e){"use strict";return{init:function(f,g,h,i,j,k,l,m){a(document).ready(function(){a("select#id_courseusesubtiles").change(function(b){"0"!==b.currentTarget.value&&a("input#id_courseusebarforheadings").prop("checked",!1)}),a("select#id_courseshowtileprogress").change(function(d){if("0"!==d.currentTarget.value){var e=a("select#id_enablecompletion");"0"===e.val()&&(e.val("1"),c.get_strings([{key:"completion",component:"completion"},{key:"completionswitchhelp",component:"format_tiles"}]).done(function(a){b.alert(a[0],a[1])}))}}),a("select#id_enablecompletion").change(function(b){"0"===b.currentTarget.value&&a("select#id_courseshowtileprogress").val("0")});var n=a("select#id_basecolour");d.render("format_tiles/colour_picker",{colours:n.find("option").map(function(b,c){var d=a(c),e=d.attr("value");return{colour:e,colourname:d.text(),selected:e===n.val(),id:e.replace("#","")}}).toArray()}).done(function(b){a(b).insertAfter(n),n.hide();var c=a(".colourpickercircle");c.click(function(b){var d=a(b.currentTarget);c.removeClass("selected"),d.addClass("selected"),n.val(d.attr("data-colour")),a("#colourselectnotify").fadeIn(200).fadeOut(1200)}),n.change(function(){c.removeClass("selected"),a("#colourpick_"+n.val().replace("#","")).addClass("selected")});var d=a("body");d.hasClass("format-tiles")||d.addClass("format-tiles")});var o,p;if("course-edit"===f?(p=a("#id_defaulttileicon"),o=a("#id_defaulttileicon option:selected").text()):"course-editsection"===f&&(p=a("#id_tileicon"),o=a("#id_tileicon option:selected").text()),"course-edit"===f||"course-editsection"===f&&"0"!==j){var q;q=""===p.val()?g:p.val(),d.render("format_tiles/icon_picker_launch_btn",{initialicon:q,initialname:o,sectionId:i,allowphototiles:l}).done(function(b){a(b).insertAfter(p),p.hide(),require(["format_tiles/edit_icon_picker"],function(a){a.init(h,f,l,m)})})}else"course-editsection"===f&&"0"===j&&p.closest(".row").hide();d.render("format_tiles/edit_form_helptext",{documentationurl:m+"/teacher"}).done(function(b){a(b).appendTo(a("#id_courseformathdr .fcontainer"))}),e.init(h,1,!0,1,0,!0,k),e.cleanUpStorage()})}}});
define('format_tiles/browser_storage', ["jquery","format_tiles/browser_storage_set_up"],function(a,b){"use strict";var c,d,e,f={prefix:"mdl-tiles-",course:"mdl-tiles-course-",lastSection:"-lastSecId",content:"-content",lastUpdated:"-lastUpdated",collapseSecZero:"-collapsesec0",user:"-user-",section:"-sec-",userChoicePrefix:"mdl-tiles-userPrefStorage-"},g=function(){return f.course+c+f.user+d+f.lastSection},h=function(a){return f.course+c+f.section+a.toString()+f.user+d+f.content},i=function(a){return f.course+c+f.section+a.toString()+f.user+d+f.lastUpdated},j=function(){return f.course+c+f.user+d+f.collapseSecZero},k=function(a){return 0===a.indexOf(f.prefix)&&a.substr(-f.lastUpdated.length)===f.lastUpdated},l=function(a,c,d){if(void 0===c||void 0===a)throw new Error("Missing section id");try{void 0!==d&&""!==d&&b.Enabled.session&&b.storageAllowed()===!0?(sessionStorage.setItem(h(c),d),sessionStorage.setItem(i(c),Math.round(Date.now()/1e3).toString())):(sessionStorage.removeItem(h(c)),sessionStorage.removeItem(i(c)))}catch(e){require(["core/log"],function(a){a.debug(e)})}},m=function(a){var b=a.split("-");if(k(a))return{courseId:parseInt(b[b.indexOf("course")+1]),sectionId:parseInt(b[b.indexOf("sec")+1]),userId:parseInt(b[b.indexOf("user")+1]),title:"lastUpdated"};throw new Error("Invalid lastUpdated key")},n=function(a,b,c){if(b)Object.keys(localStorage).filter(function(a){return 0===a.indexOf(f.prefix)&&0!==a.indexOf(f.userChoicePrefix)}).forEach(function(a){localStorage.removeItem(a)}),Object.keys(sessionStorage).filter(function(a){return 0===a.indexOf(f.prefix)}).forEach(function(a){if(k(a)){var b=m(a);l(b.courseId,b.sectionId,"")}});else{var d=Math.round(Date.now()/1e3)-60*a;Object.keys(sessionStorage).filter(function(a){return 0===a.indexOf(f.prefix)}).forEach(function(b){if(k(b)){var c=m(b);(sessionStorage.getItem(b)<d||0===a)&&l(c.courseId,c.sectionId,"")}});var e=Object.keys(sessionStorage).filter(function(a){return k(a)});if(e.length>c){var g=e.map(function(a){return parseInt(sessionStorage[a])}).sort(),h=g[g.length-c];0===c&&(h=Date.now());var i;e.filter(function(a){return sessionStorage[a]<h}).forEach(function(a){i=m(a),l(i.courseId,i.sectionId,"")})}}},o=function(){n(0,1,1)},p=function(a){a&&b.Enabled.local?localStorage.setItem(g(),a.toString()):localStorage.removeItem(g())},q={init:function(f,g,h,i,j,k,m){c=f.toString(),d=m.toString(),e=parseInt(g),b.init(d,k,o),0===parseInt(g)&&b.setAllowed(!1),a(document).ready(function(){if(b.storageAllowed()!==!0&&n(0,1,0),h)p(i),n(0,1,0),b.Enabled.session&&l(c,i,""),a('a.menu-action[data-title="switchroleto,moodle"]').click(function(){n(0,1,0)});else{var d=a("#page-content");0===d.length&&(d=a("#region-main")),d.on("click",".tile",function(){setTimeout(function(){n(parseInt(j),0,e)},2e3)})}})},storageEnabledSession:function(){return b.Enabled.session},storageEnabledLocal:function(){return b.Enabled.local},storagestorageSetUperence:function(){return b.storageAllowed()},getLastVisitedSection:function(){return b.Enabled.local&&localStorage.getItem(g())},getCourseContent:function(a,b){return sessionStorage.getItem(h(b))},getStoredContentAge:function(a,b){var c=parseInt(sessionStorage.getItem(i(b)));return!!c&&Math.round(Date.now()/1e3-c)},setSecZeroCollapseStatus:function(a){b.Enabled.local&&b.storageAllowed()&&("collapsed"===a?localStorage.removeItem(j()):localStorage.setItem(j(),"1"))},getSecZeroCollapseStatus:function(){return!!localStorage.getItem(j())},storeCourseContent:function(a,b,c){l(a,b,c)},cleanUpStorage:function(){o()},setLastVisitedSection:function(a){b.storageAllowed()&&p(a)}};return q});
define('format_tiles/completion', ["jquery","core/templates","core/config","format_tiles/completion"],function(a,b,c){"use strict";var d,e={},f={cmid:"data-cmid",numberComplete:"data-numcomplete",numberOutOf:"data-numoutof",section:"data-section"},g={launchModuleModal:'[data-action="launch-tiles-module-modal"]',launchResourceModal:'[data-action="launch-tiles-resource-modal"]',pageContent:"#page-content",regionMain:"#region-main",resourceModule:".activity.resource",completeonevent:".completeonevent",completeonview:".completeonview",activity:"li.activity",section:"li.section.main",togglecompletion:"form.togglecompletion",tileId:"#tile-"},h={completionYes:"completion-icon-y",completionNo:"completion-icon-n"},i=[],j=function(b,c,d,e){var f={tileid:b,numComplete:c,numOutOf:d,showAsPercent:e,percent:Math.round(c/d*100),percentCircumf:106.8,percentOffset:Math.round((d-c)/d*106.8),isComplete:!1,isSingleDigit:!1,hastilephoto:a(g.tileId+b).hasClass("phototile")};return 0===b?f.isOverall=1:f.isOverall=0,c>=d&&(f.isComplete=!0),f.percent<10&&(f.isSingleDigit=!0),f},k=function(c,d,e){if(!(0===d.attr(f.numberComplete)&&e<0)){var g=Math.min(parseInt(d.attr(f.numberComplete))+e,d.attr(f.numberOutOf)),h=a("#tileprogress-0"),i=Math.min(parseInt(h.attr(f.numberComplete))+e,h.attr(f.numberOutOf));b.render("format_tiles/progress",j(c,g,d.attr(f.numberOutOf),d.hasClass("percent"))).done(function(b){d.replaceWith(b);try{a("#tileprogress-"+c).tooltip()}catch(e){require(["core/log"],function(a){a.debug(e)})}}),b.render("format_tiles/progress",j(0,i,h.attr(f.numberOutOf),!0)).done(function(b){a("#tileprogress-0").replaceWith(b).fadeOut(0).animate({opacity:1},500)})}},l=function(b){var e=b.attr(f.cmid),j=a("#completionstate_"+e),l={id:e,completionstate:parseInt(j.attr("value")),fromajax:1,sesskey:c.sesskey};try{b.tooltip("hide")}catch(m){require(["core/log"],function(a){a.debug(m)})}var n=c.wwwroot+"/course/togglecompletion.php";a.post(n,l,function(c,l){if("success"===l&&"OK"===c){var m,n=a(".completion_img_"+e);"1"===j.attr("value")?(a("#completion_dynamic_change").attr("value",0),j.attr("value",0),m=1,n.addClass(h.completionYes).removeClass(h.completionNo),a(".complete-y-"+e).fadeIn(200).fadeOut(1e3)):(a("#completion_dynamic_change").attr("value",1),j.attr("value",1),m=-1,a(".complete-n-"+e).fadeIn(200).fadeOut(1e3),n.addClass(h.completionNo).removeClass(h.completionYes)),j.closest(g.activity).is(i.map(function(a){return"."+a}).join(","))||(k(b.attr(f.section),a("#tileprogress-"+b.attr(f.section)),m),require(["format_tiles/browser_storage"],function(a){a.storeCourseContent(d,b.attr("data-section"),"")}))}}).fail(function(){throw new Error("Failed to register completion change with server")})},m=function(b){var c=b.closest(g.section).attr("data-section");if(b.hasClass("completeonview")){var f=b.find(".completion-icon"),i=f.closest(".completioncheckbox");if("0"===i.attr("data-ismanual")&&"0"===i.attr("data-completionstate")){f.addClass(h.completionYes).removeClass(h.completionNo),i.attr("data-completionstate",1),i.attr("data-original-title",e.completeauto);try{i.tooltip()}catch(j){require(["core/log"],function(a){a.debug(j)})}k(c,a("#tileprogress-"+c),1)}}require(["format_tiles/browser_storage"],function(a){a.storeCourseContent(d,c,"")})};return{init:function(b,c,f){d=b,a(document).ready(function(){i=JSON.parse(f),e.completeauto=c,a("body").on("click",g.togglecompletion,function(b){b.preventDefault(),l(a(b.currentTarget))});var b=a("#page-content");0===b.length&&(b=a("#region-main")),b.on("click",g.launchModuleModal+", "+g.launchResourceModal,function(b){var c=a(b.currentTarget).closest(g.activity);c.hasClass("completeonview")&&m(c)}),a(g.pageContent).on("click",g.completeonevent+", "+g.completeonview,function(b){var c=a(b.currentTarget).closest(g.section).attr("data-section");require(["format_tiles/browser_storage"],function(a){a.storeCourseContent(d,c,"")})})})},markAsAutoCompleteInUI:function(a,b){d=a,m(b)}}});
define('gradingform_guide/comment_chooser', ["jquery","core/templates","core/notification","core/yui"],function(a,b,c){return{initialise:function(d,e,f,g){function h(b,c){var e="<label>"+M.util.get_string("insertcomment","gradingform_guide")+"</label>",g="comment-chooser-"+d+"-cancel",h='<button id="'+g+'">'+M.util.get_string("cancel","moodle")+"</button>",i=new M.core.dialogue({modal:!0,headerContent:e,bodyContent:b,footerContent:h,focusAfterHide:"#"+f,id:"comments-chooser-dialog-"+d});a("#"+g).click(function(){i.hide()}),a.each(c,function(b,c){var e="#comment-option-"+d+"-"+c.id;a(e).click(function(){var b=a("#"+f),d=b.val();""!==a.trim(d)&&(d+="\n"),d+=c.description,b.val(d),i.hide()}),a(document).off("keypress",e).on("keypress",e,function(){var b=event.which||event.keyCode;13!=b&&32!=b||a(e).click()})}),i.after("visibleChange",function(a){a.prevVal&&!a.newVal&&this.destroy()},i),i.show()}function i(){var a={criterionId:d,comments:g};b.render("gradingform_guide/comment_chooser",a).done(function(a){h(a,g)}).fail(c.exception)}a("#"+e).click(function(a){a.preventDefault(),i()})}}});
define('totara_appraisal/myappraisal', ["jquery","core/str","core/config"],function(a,b,c){var d={config:{},init:function(b){b&&(d.config=a.parseJSON(b));var c=a("input#id_submitbutton").closest("form"),e=a("<input>").attr({type:"hidden",name:"submitaction"}).val("saveprogress"),f=a("<input>").attr({type:"hidden",name:"submitaction"}).val("completestage");a("#saveprogress").on("submit",function(a){window.onbeforeunload=null,a.preventDefault(),c.append(e),c.submit()}),a("#completestage").on("submit",function(a){window.onbeforeunload=null,a.preventDefault(),c.append(f),c.submit()}),window.dialogsInited?(d.stagesSelectDialog(),d.savePdfDialog()):(a.isArray(window.dialoginits)||(window.dialoginits=[]),window.dialoginits.push(this.stagesSelectDialog),window.dialoginits.push(this.savePdfDialog)),setInterval(d.keepAlive,1e3*d.config.keepalivetime)},stagesSelectDialog:function(){var e=new totaraDialog_handler;e._print=function(b,d){var f=a("#printform").serialize();M.util.help_popups.setup(Y);var g={name:"printpopup",url:c.wwwroot+"/totara/appraisal/snapshot.php?"+f,options:"height=500,width=600,top=100,left=100,menubar=0,location=0,scrollbars,resizable,toolbar,status,directories=0,dependent"};openpopup(b,g),e._cancel()};var f={appraisalid:d.config.appraisalid,role:d.config.role,subjectid:d.config.subjectid,action:"stages"},g=a.param(f),h=[];h.push({key:"printnow",component:"totara_appraisal"}),h.push({key:"cancel",component:"moodle"}),h.push({key:"printyourappraisal",component:"totara_appraisal"}),b.get_strings(h).done(function(a){for(var b=[],d=0;d<h.length;d++)b[h[d].key]=a[d];var f={};f[b.printnow]=function(a){e._print(a,c.wwwroot+"/totara/appraisal/snapshot.php?"+g)},f[b.cancel]=function(){e._cancel()},totaraDialogs.print=new totaraDialog("print","show-print-dialog",{buttons:f,title:"<h2>"+b.printyourappraisal+"</h2>"},c.wwwroot+"/totara/appraisal/snapshot.php?"+g,e)})},savePdfDialog:function(){var e=new totaraDialog_handler;e._download=function(){var b=a("#downloadurl").val();b&&(window.location.href=b,e._cancel())},e._open=function(){e._dialog.dialog.html(b.get_string("snapshotgeneration","totara_appraisal"))};var f={appraisalid:d.config.appraisalid,role:d.config.role,subjectid:d.config.subjectid,action:"snapshot",sesskey:c.sesskey},g=a.param(f),h=[];h.push({key:"downloadnow",component:"totara_appraisal"}),h.push({key:"cancel",component:"moodle"}),h.push({key:"snapshotdialogtitle",component:"totara_appraisal"}),b.get_strings(h).done(function(a){for(var b=[],d=0;d<h.length;d++)b[h[d].key]=a[d];var f={};f[b.downloadnow]=function(){e._download()},f[b.cancel]=function(){e._cancel()},totaraDialogs.savepdf=new totaraDialog("savepdf","show-savepdf-dialog",{buttons:f,title:"<h2>"+b.snapshotdialogtitle+"</h2>",height:"200"},c.wwwroot+"/totara/appraisal/snapshot.php?"+g,e)})},keepAlive:function(){a.get(c.wwwroot+"/totara/appraisal/keepalive.php")}};return d});
define('totara_catalog/toggle_filter_panel', [],function(){function a(){return this instanceof a?(this.activeClass="tw-toggleFilterPanel__active",this.fixedClass="tw-toggleFilterPanel__trigger_fixed",this.targetwidget=".tw-selectRegionPanel",this.toggleClass="tw-selectRegionPanel__hiddenOnSmall_show",void(this.widget="")):new a}a.prototype={constructor:a,events:function(){var a=this;this.widget.addEventListener("click",function(b){b.preventDefault(),b.target&&b.target.closest("[data-tw-toggleFilterPanel-trigger]")&&a.toggleWidget()}),this.setPositionFixedEvent=function(){var b=a.widget.querySelector("[data-tw-toggleFilterPanel-trigger]"),c=a.widget.parentNode,d=c.getBoundingClientRect().top,e=a.widget.offsetHeight,f=c.offsetHeight-e;d<0&&d>-f?b.classList.add(a.fixedClass):b.classList.remove(a.fixedClass)};var b=new MutationObserver(function(){if("false"!==a.widget.getAttribute("data-tw-toggleFilterPanel-addLabelContent")){var b=a.widget.getAttribute("data-tw-toggleFilterPanel-addLabelContent");a.widget.querySelector("[data-tw-toggleFilterPanel-extraContent]").innerHTML=b,a.widget.setAttribute("data-tw-toggleFilterPanel-addLabelContent",!1)}});b.observe(this.widget,{attributes:!0,attributeFilter:["data-tw-togglefilterpanel-addlabelcontent"],subtree:!1})},setParent:function(a){this.widget=a},setPositionFixed:function(){var a=this.widget.querySelector("[data-tw-toggleFilterPanel-trigger]");this.widget.classList.contains(this.activeClass)?window.addEventListener("scroll",this.setPositionFixedEvent,!0):(window.removeEventListener("scroll",this.setPositionFixedEvent,!0),a.classList.remove(this.fixedClass))},toggleWidget:function(){this.widget.classList.toggle(this.activeClass),this.setPositionFixed(),this.triggerEvent("changed",{targetwidget:this.targetwidget,toggleClass:this.toggleClass})},triggerEvent:function(a,b){var c=new CustomEvent("totara_catalog/toggle_filter_panel:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_catalog/form_element_matrix', ["totara_form/form","core/templates"],function(a,b){function c(b,d,e,f){return this instanceof c?(a.Element.apply(this,arguments),this.input=document.getElementById(e),this.id=e,this.parent=b,this.node=f,this.potentialfilters={},void(this.name=this.input.getAttribute("data-name"))):new c(b,d,e,f)}return c.prototype=Object.create(a.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object Matrix]"},c.prototype.init=function(a){var b=this.input.getElementsByClassName("totara_catalog-matrix__addfilter")[0].options,c=0;for(c=1;c<b.length;c++)this.potentialfilters[b[c].value]=b[c].label,this.input.querySelectorAll("[data-id="+b[c].value+"]").length>0&&(b[c].classList.add("totara_form_option_invisible"),b[c].disabled=!0);this.input.getElementsByClassName("totara_catalog-matrix__addfilter")[0].addEventListener("change",this._addItem.bind(this)),this.input.addEventListener("click",this._changeItem.bind(this)),this.input.addEventListener("change",this.changed.bind(this)),a()},c.prototype.getValue=function(){var a,b=this.input.getElementsByTagName("tbody")[0].getElementsByTagName("tr"),c=[];for(a=0;a<b.length;a++)c.push({id:b[a].getAttribute("data-id"),name:b[a].getElementsByTagName("input")[0].value});return c},c.prototype._addItem=function(a){if(""!==a.target.value){var c=this,d={id:a.target.value,filtername:this.potentialfilters[a.target.value],heading:this.potentialfilters[a.target.value],name:this.name},e=a.target;b.render("totara_catalog/element_matrix__row",d).done(function(a){c.input.querySelector("#"+c.id+"_table tbody").insertAdjacentHTML("beforeend",a),e.options[e.selectedIndex].classList.add("totara_form_option_invisible"),e.options[e.selectedIndex].disabled=!0,e.selectedIndex=0,c.changed()})}},c.prototype._changeItem=function(a){var b=a.target.closest("tr"),c=a.target.closest("[data-action]");if(c){switch(a.preventDefault(),c.getAttribute("data-action")){case"delete":var d,e=this.input.getElementsByClassName("totara_catalog-matrix__addfilter")[0];d=e.querySelector("option[value="+b.getAttribute("data-id")+"]"),d.classList.remove("totara_form_option_invisible"),d.disabled=!1,b.remove();break;case"move-up":null!==b.previousElementSibling&&b.parentElement.insertBefore(b,b.previousElementSibling);break;case"move-down":null!==b.nextElementSibling&&b.nextElementSibling.insertAdjacentElement("afterend",b)}this.changed()}},c});
define('totara_catalog/pagination', [],function(){function a(){return this instanceof a?void(this.widget=""):new a}a.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.preventDefault(),b.target&&b.target.closest("[data-tw-pagination-trigger]")){var c=b.target.getAttribute("data-tw-pagination-limitFrom"),d=b.target.getAttribute("data-tw-pagination-maxCount");a.triggerEvent("changed",{limitfrom:c,maxcount:d})}})},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent("totara_catalog/pagination:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_catalog/results_sort', [],function(){function a(){return this instanceof a?void(this.widget=""):new a}a.prototype={bubbledEventsListener:function(){var a="totara_core/select_tree",b=this;this.widget.addEventListener(a+":add",function(a){b.triggerEvent("add",a.detail)}),this.widget.addEventListener(a+":changed",function(){b.triggerEvent("changed",{})}),this.widget.addEventListener(a+":remove",function(a){b.triggerEvent("remove",a.detail)})},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent("totara_catalog/results_sort:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.bubbledEventsListener(),c(d)})};return{init:b}});
define('totara_catalog/item_style_toggle', [],function(){function a(){return this instanceof a?(this.activeClass="tw-catalogItemStyleToggle__btn_active",void(this.widget="")):new a}a.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.preventDefault(),b.target&&b.target.closest("[data-tw-catalogItemStyleToggle_trigger]")){var c=b.target.closest("[data-tw-catalogItemStyleToggle_trigger]");if(c.classList.contains(a.activeClass))return;a.toggle(c),a.triggerEvent("changed",{})}})},preset:function(){var a=this.widget.querySelector("."+this.activeClass);a&&this.triggerEvent("add",{key:"itemstyle",val:a.getAttribute("data-tw-catalogItemStyleToggle_trigger")})},setParent:function(a){this.widget=a},toggle:function(a){for(var b=this.widget.querySelectorAll("[data-tw-catalogItemStyleToggle_trigger]"),c=0;c<b.length;c++)b[c].classList.toggle(this.activeClass);this.triggerEvent("add",{key:"itemstyle",val:a.getAttribute("data-tw-catalogItemStyleToggle_trigger")})},triggerEvent:function(a,b){var c=new CustomEvent("totara_catalog/item_style_toggle:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.preset(),d.events(),c(d)})};return{init:b}});
define('totara_catalog/config_form', ["core/str","totara_form/form"],function(a,b){var c=null,d="data-totara_catalog--dirty",e=function(f,g){var h="totaraCatalogAdminFormInit"+f,i="tf_fid_"+f;M.util.js_pending(h);var j=new Promise(function(b){a.get_string("discard_unsaved_changes","totara_catalog").then(b)}).then(function(a){null===c&&(c=function(b){var c=document.getElementById(i);if("true"===c.getAttribute(d))return b.preventDefault(),b.returnValue=a,a},window.addEventListener("beforeunload",c))}),k=new Promise(function(a,c){var d=b.getFormInstance(i);if(null===d||g){var e=document.getElementById(i);null===e&&c();var f=function(){"true"===e.getAttribute("data-totara_form-initialised")&&(h.disconnect(),a(b.getFormInstance(i)))},h=new MutationObserver(f);h.observe(e,{attributes:!0,attributeFilter:["data-totara_form-initialised"]})}else a(d)}).then(function(a){var b=a.form[0],c=b.querySelector('[data-name="submitbutton"], [name="submitbutton"]'),i=b.querySelector('[data-name="cancelbutton"], [name="cancelbutton"]'),j=function(){b.removeAttribute(d)},k=function(){b.setAttribute(d,"true")};g&&k(),c.addEventListener("click",j),i.addEventListener("click",j),a._parentValueChanged=a.valueChanged,a.valueChanged=function(b,d){var e=a.form[0].parentElement.querySelectorAll(".alert"),f=0;for(f=0;f<e.length;f++)e[f].remove();c.removeAttribute("disabled"),c.setAttribute("name",c.getAttribute("data-name")),c.closest('[data-item-classification="element"]').setAttribute("data-element-frozen","0"),i.removeAttribute("disabled"),i.setAttribute("name",i.getAttribute("data-name")),i.closest('[data-item-classification="element"]').setAttribute("data-element-frozen","0"),k(),this._parentValueChanged(b,d)},a._parentReload=a.reload,a.reload=function(a){var c=f;M.util.js_pending(h+"_reload"),this.ajaxSubmit(a,!0).then(function(){var a=b.parentElement,d=function(){e(c,!0),f.disconnect(),M.util.js_complete(h+"_reload")},f=new MutationObserver(d);f.observe(a,{childList:!0})})}});Promise.all([j,k]).then(function(){M.util.js_complete(h)})};return{init:e}});
define('totara_catalog/manage_btns', [],function(){function a(){return this instanceof a?void(this.widget=""):new a}a.prototype={events:function(){this.widget.addEventListener("click",function(a){if(a.target&&a.target.closest("[data-tw-catalogManageBtnsGroup]")){a.target.closest(".tw-catalogManageBtns__group_options")||a.preventDefault();var b=a.target.closest("[data-tw-catalogManageBtnsGroup]");b.classList.toggle("tw-catalog__activePopover")}})},setParent:function(a){this.widget=a}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_catalog/form_element_multiple_select', ["totara_form/form","core/templates"],function(a,b){function c(b,d,e,f){return this instanceof c?(a.Element.apply(this,arguments),this.input=document.getElementById(e),this.id=e,this.parent=b,this.node=f,this.addSelector=this.input.getElementsByClassName("totara_catalog-multiple_select__addicon")[0],void(this.name=this.input.getAttribute("data-name"))):new c(b,d,e,f)}return c.prototype=Object.create(a.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object multiSelect]"},c.prototype.init=function(a){var b=this.addSelector.options,c=0;for(c=1;c<b.length;c++)this.input.querySelectorAll("[data-id="+b[c].value+"]").length>0&&(b[c].classList.add("totara_form_option_invisible"),b[c].disabled=!0);this.addSelector.addEventListener("change",this._addItem.bind(this)),this.input.addEventListener("click",this._changeItem.bind(this)),this._checkempty(),a()},c.prototype.getValue=function(){var a,b=this.input.getElementsByTagName("ol")[0].getElementsByTagName("li"),c=[];for(a=0;a<b.length;a++)c.push(b[a].getAttribute("data-id"));return c},c.prototype._addItem=function(a){if(""!==a.target.value){var c=this,d=a.target,e=d.selectedIndex,f={id:d.value,iconname:d.options[e].text};b.render("totara_catalog/element_multiple_select__item",f).done(function(a){c.input.querySelector("#"+c.id+"_list").insertAdjacentHTML("beforeend",a),d.options[e].classList.add("totara_form_option_invisible"),d.options[e].disabled=!0,d.selectedIndex=0,c._changed()})}},c.prototype._changeItem=function(a){var b=a.target.closest("li"),c=a.target.closest("[data-action]");if(c){switch(a.preventDefault(),c.getAttribute("data-action")){case"delete":var d,e=this.input.getElementsByClassName("totara_catalog-multiple_select__addicon")[0];d=e.querySelector("option[value="+b.getAttribute("data-id")+"]"),d.classList.remove("totara_form_option_invisible"),d.disabled=!1,b.remove();break;case"move-up":null!==b.previousElementSibling&&b.parentElement.insertBefore(b,b.previousElementSibling);break;case"move-down":null!==b.nextElementSibling&&b.nextElementSibling.insertAdjacentElement("afterend",b)}this._changed()}},c.prototype._changed=function(){this.node.querySelector("[type=hidden]").value=JSON.stringify(this.getValue()),this._checkempty(),this.changed()},c.prototype._checkempty=function(){null===this.input.querySelector(".totara_catalog-multiple_select__selected li")?this.input.classList.add("totara_catalog-multiple_select__noitems"):this.input.classList.remove("totara_catalog-multiple_select__noitems")},c});
define('totara_catalog/catalog', ["core/templates","core/ajax","core/notification","core/event"],function(a,b,c,d){function e(){return this instanceof e?(this.filterPanelCount=0,this.overlayClass="tw-catalog__overlay",this.activePopoverClass="tw-catalog__activePopover",this.widget="",this.fetchedData="",this.pageChangeType="",this.requestData={debug:!1,filterparams:{},limitfrom:0,maxcount:-1,orderbykey:"featured",request:1,resultsonly:!1,itemstyle:"narrow"},this.requestItemData={catalogid:0,request:1},this.lastRequest={catalogid:""},this.requestEpoch="",void(this.requestPending=!1)):new e}e.prototype={constructor:e,bubbledEventsListener:function(){var a=this,b="totara_core/select_region_panel",c="totara_core/select_region_primary",d="totara_core/grid",e="totara_catalog/pagination",f="totara_catalog/results_sort",g="totara_catalog/item_style_toggle",h="totara_catalog/toggle_filter_panel";this.widget.addEventListener(b+":add",function(b){a.setFilterAdd(b.detail),a.filterPanelCount++,a.setFilterPanelToggleCount()}),this.widget.addEventListener(b+":changed",function(){a.eventFilterChange()}),this.widget.addEventListener(b+":remove",function(b){a.setFilterRemove(b.detail),a.filterPanelCount--,a.setFilterPanelToggleCount()}),this.widget.addEventListener(c+":add",function(b){"catalog_fts"!==b.detail.key||a.requestData.filterparams.catalog_fts||a.setOrderBy({val:"score"}),a.setFilterAdd(b.detail)}),this.widget.addEventListener(c+":changed",function(){a.eventFilterChange()}),this.widget.addEventListener(c+":remove",function(b){a.setFilterRemove(b.detail)}),this.widget.addEventListener(f+":add",function(b){a.setOrderBy(b.detail)}),this.widget.addEventListener(f+":changed",function(){a.eventFilterChange()}),this.widget.addEventListener(g+":add",function(b){a.setItemStyle(b.detail)}),this.widget.addEventListener(g+":changed",function(){a.eventFilterChange()}),this.widget.addEventListener(e+":changed",function(b){a.setLimitFrom(b.detail.limitfrom),a.setMaxCount(b.detail.maxcount),a.setPageChangeType("resultsOnly"),a.setResultsOnly(!0),a.contentRequest()}),this.widget.addEventListener(h+":changed",function(b){var c=a.widget.querySelector(b.detail.targetwidget);c.classList.toggle(b.detail.toggleClass)}),this.widget.addEventListener(d+":add",function(b){b.detail.val!==a.lastRequest.catalogid&&(a.setItemAdd(b.detail),a.setPageChangeType("details"),a.contentRequest())})},checkDebugMode:function(){var a=window.location.search.slice(1);a=a.split("#")[0];for(var b=a.split("&"),c=0;c<b.length;c++)"debug=true"!==b[c]&&"debug=1"!==b[c]||(this.requestData.debug=!0)},contentRequest:function(){var a,b=this;this.loadingDisplayAdd().then(function(){b.setRequestEpoch(Date.now()),a=b.getData(),a.then(function(a){if(a.request==b.requestEpoch){b.setData(a);var c=b.widget.getAttribute("data-tw-catalog-jsRenderState");"locked"===c?b.requestPending=!0:(b.widget.setAttribute("data-tw-catalog-jsRenderState","locked"),b.contentUpdate(),b.contentRequestPageURL())}})})},contentRequestPageURL:function(){if("details"!==this.pageChangeType){var a=Object.assign({},this.requestData);delete a.limitfrom,delete a.maxcount,delete a.request,delete a.resultsonly,delete a.debug,this.setPageURL(this.getRequestPathString(a))}},contentUpdate:function(){var a,b=this,d=this.fetchedData,e=this.pageChangeType,f={data:d,renderType:"fullHTML",target:this.widget.querySelector("[data-tw-catalogDebug]"),template:"totara_catalog/debug"},g={data:d.pagination_template_data,renderType:"innerHTML",target:this.widget.querySelector("[data-tw-pagination]"),template:"totara_catalog/pagination"},h={data:d,renderType:"innerHTML",target:this.widget.querySelector("[data-tw-catalogResultsCount]"),template:"totara_catalog/results_count"},i={data:d,renderType:"fullHTML",target:this.widget.querySelector("[data-tw-catalogResultsEmpty]"),template:"totara_catalog/results_empty"},j={data:d,renderType:"innerHTML",target:this.widget.querySelector("[data-tw-catalogResultsSort]"),template:"totara_catalog/results_sort"},k={data:d.grid_template_data,renderType:"additionalItemHTML",target:this.widget.querySelector("[data-tw-grid]"),template:"totara_core/grid"},l={data:d,renderType:"fullHTML",target:this.widget.querySelector('[data-tw-grid-item-id="'+d.id+'"] [data-tw-catalogDetails]'),template:"totara_catalog/details"};if("filter"===e)M.util.js_pending("totara_catalog-rendering_template"),a=Promise.all([this.contentUpdateRender(k),this.contentUpdateRender(h),this.contentUpdateRender(g),this.contentUpdateRender(j),this.contentUpdateRender(f),this.contentUpdateRender(i)]);else if("details"===e)M.util.js_pending("totara_catalog-rendering_template"),a=Promise.all([this.contentUpdateRender(l)]);else{if("resultsOnly"!==e)return b.widget.setAttribute("data-tw-catalog-jsRenderState","ready"),void this.loadingDisplayRemove();M.util.js_pending("totara_catalog-rendering_template"),a=Promise.all([this.contentUpdateRender(k),this.contentUpdateRender(h),this.contentUpdateRender(g),this.contentUpdateRender(i)])}a.then(function(){b.widget.setAttribute("data-tw-catalog-jsRenderState","ready"),b.loadingDisplayRemove(),b.setPageChangeType(""),M.util.js_complete("totara_catalog-rendering_template")})["catch"](function(a){b.pageError(),c.exception({fileName:"catalog.js",message:a,name:"Error rendering template"}),b.widget.setAttribute("data-tw-catalog-jsRenderState","ready")})},contentUpdateRender:function(b){var c,e=b.data,f=document.createRange(),g=b.renderType,h=b.target,i=b.template,j=this;return new Promise(function(b,k){var l=setTimeout(function(){k("Communication error, could not render "+i)},45e3);a.render(i,e).then(function(e){if(!h)return void b(i);if(f.selectNode(h),c=f.createContextualFragment(e),"additionalItemHTML"===g){var k="[data-tw-grid-item]",m=c.querySelectorAll(k);"resultsOnly"!==j.pageChangeType&&(h.innerHTML="");for(var n=0;n<m.length;n++)h.appendChild(m[n]);if(j.showOverflowEllipsis(),m&&"resultsOnly"===j.pageChangeType){var o=m[0].querySelector("[data-tw-grid-item-toggle]");o.focus(),o.scrollIntoView({block:"start"})}}else if("loadingDisplay"===g)h.appendChild(c);else if("fullHTML"===g)h.innerHTML="",h.appendChild(c);else if("innerHTML"===g){var p=c.querySelector("div"),q=p.querySelector("div");h.innerHTML="",h.appendChild(q)}d.notifyFilterContentUpdated(h),a.runTemplateJS(""),clearTimeout(l),b(i)})})},events:function(){var a=this;window.onpopstate=function(a){null!==a.state&&location.reload()},window.addEventListener("resize",function(){var b;b||(b=setTimeout(function(){b=null;for(var c=a.widget.querySelectorAll('[data-tw-catalogItem="checked"]'),d=0;d<c.length;d++)c[d].setAttribute("data-tw-catalogItem","check"),c[d].classList.remove("tw-catalogItem__showEllipsis");a.showOverflowEllipsis()},66))}),document.addEventListener("click",function(b){var c=document.querySelector("."+a.activePopoverClass);if(c&&b.target){var d=b.target.closest("."+a.activePopoverClass);d||c.classList.remove(a.activePopoverClass)}});var b=new MutationObserver(function(b){var c=a.widget.getAttribute("data-tw-catalog-jsRenderState");if(a.requestPending&&"locked"!==c)for(var d=0;d<b.length;d++){var e=b[d].oldValue;"ready"===c&&"locked"===e&&(a.contentUpdate(),a.contentRequestPageURL())}});b.observe(this.widget,{attributes:!0,attributeFilter:["data-tw-catalog-jsrenderstate"],attributeOldValue:!0,subtree:!1})},eventFilterChange:function(){this.setPageChangeType("filter"),this.setResultsOnly(!1),this.setLimitFrom("0"),this.setMaxCount("-1"),this.contentRequest()},getData:function(){var a,d,e=this;"details"===this.pageChangeType?(a=this.requestItemData,d="totara_catalog_external_get_details_template_data"):(e.setLastItemRemove(),a=this.requestData,d="totara_catalog_external_get_catalog_template_data");var f=[{args:a,methodname:d}];return M.util.js_pending("totara_catalog-requesting_data"),new Promise(function(a,d){var g=b.call(f,!0,!0);g[0].done(function(b){a(b),M.util.js_complete("totara_catalog-requesting_data")}).fail(function(a){c.exception(a),d(a),e.pageError(),M.util.js_complete("totara_catalog-requesting_data")})})},getRequestPathString:function(a){var b="";return Object.keys(a).forEach(function(c){var d=a[c];"filterparams"===c?Object.keys(a.filterparams).forEach(function(c){var d=a.filterparams[c];if(Array.isArray(d)){if(d.length)for(var e=0;e<d.length;e++)b+=""===b?"?":"&",b+=c+"[]="+d[e]}else b+=""===b?"?":"&",b+=c+"="+d}):(b+=""===b?"?":"&",b+=c+"="+d)}),b},loadingDisplayAdd:function(){var a,b=this;a="details"===this.pageChangeType?this.widget.querySelector("[data-tw-grid-item-active] [data-tw-catalogDetails]"):"filter"===this.pageChangeType||"resultsOnly"===this.pageChangeType?this.widget.querySelector("[data-tw-grid]"):this.widget.querySelector("[data-tw-catalogContent]"),a.classList.add(b.overlayClass);var c={data:"",renderType:"loadingDisplay",target:a,template:"totara_catalog/loading_overlay"};return M.util.js_pending("totara_catalog-rendering_template"),new Promise(function(a,d){b.contentUpdateRender(c).then(function(){a(),M.util.js_complete("totara_catalog-rendering_template")})["catch"](function(){d()})})},loadingDisplayRemove:function(){for(var a=this.widget.querySelectorAll("[data-tw-catalog-overlay]"),b=this.widget.parentNode.querySelectorAll("."+this.overlayClass),c=0;c<a.length;c++)a[c].remove();for(var d=0;d<b.length;d++)b[d].classList.remove(this.overlayClass)},pageError:function(){this.setPageChangeType(""),this.loadingDisplayRemove()},setData:function(a){this.fetchedData=a},setFilterAdd:function(a){var b=this.requestData.filterparams;a.groupValues?b[a.key]=a.groupValues:(this.setFilterRemove(a),b[a.key]=a.val)},setFilterRemove:function(a){var b=this.requestData.filterparams;a.groupValues?b[a.key]=a.groupValues:delete b[a.key]},setFilterPanelToggleCount:function(){var a=this.filterPanelCount>=1?"( "+this.filterPanelCount+" )":"",b=this.widget.querySelector("[data-tw-toggleFilterPanel]");b.setAttribute("data-tw-toggleFilterPanel-addLabelContent",a)},setLimitFrom:function(a){this.requestData.limitfrom=a},setMaxCount:function(a){this.requestData.maxcount=a},setOrderBy:function(a){this.requestData.orderbykey=a.val},setPageChangeType:function(a){this.pageChangeType=a},setPageURL:function(a){var b=window.location.pathname+a;history.pushState({ajaxPageChange:!0},null,b)},setParent:function(a){this.widget=a},setRequestEpoch:function(a){this.requestEpoch=a,"details"===this.pageChangeType?this.requestItemData.request=a:this.requestData.request=a},showOverflowEllipsis:function(){for(var a,b,c,d=this.widget.querySelectorAll('[data-tw-catalogItem="check"]'),e=0;e<d.length;e++)a=d[e],b=a.offsetHeight,c=a.parentNode.offsetHeight,b>c&&a.classList.add("tw-catalogItem__showEllipsis"),a.setAttribute("data-tw-catalogItem","checked")},setResultsOnly:function(a){this.requestData.resultsonly=a},setItemAdd:function(a){this.setItemRemove(),this.requestItemData.catalogid=a.val,this.lastRequest.catalogid=a.val},setItemRemove:function(){this.requestItemData.catalogid=""},setItemStyle:function(a){this.requestData.itemstyle=a.val},setLastItemRemove:function(){this.lastRequest.catalogid=""}};var f=function(a){return new Promise(function(b){var c=new e;c.setParent(a),c.bubbledEventsListener(),c.events(),c.checkDebugMode(),c.showOverflowEllipsis(),c.loadingDisplayRemove(),b(c)})};return{init:f}});
define('totara_catalog/results_share', [],function(){function a(){return this instanceof a?(this.activeClass="tw-catalog__activePopover",void(this.widget="")):new a}a.prototype={copyToClipboard:function(){var a=this.widget.querySelector("[data-tw-catalogResultsShare_url]");a.select(),document.execCommand("copy")},displayURL:function(){var a=this.widget.querySelector("[data-tw-catalogResultsShare_url]"),b=window.location.href;a.setAttribute("value",b)},events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target&&!b.target.closest("label"))if(b.preventDefault(),b.target.closest("[data-tw-catalogResultsShare_btn]")){a.displayURL(),a.toggleUI();var c=a.widget.querySelector("[data-tw-catalogresultsshare_expanded]");c.getBoundingClientRect().top<0&&c.scrollIntoView({block:"start"})}else b.target.closest("[data-tw-catalogresultsshare_close]")?a.toggleUI():b.target.closest("[data-tw-catalogResultsShare_expanded_btn]")&&a.copyToClipboard()})},setParent:function(a){this.widget=a},toggleUI:function(){this.widget.classList.toggle(this.activeClass)},triggerEvent:function(a,b){var c=new CustomEvent("catalog/results_share:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_cohort/assignroles', ["jquery"],function(a){var b={init:function(){a("#selectallnoneroles").click(function(){a(".selectedroles").prop("checked",!a(".selectedroles").prop("checked"))})}};return b});
define('totara_completioneditor/form_element_confirm_action_button', ["jquery","totara_form/form","core/notification"],function(a,b,c){function d(a,c,e,f){return this instanceof d?(b.Element.apply(this,arguments),void(this.input=null)):new d(a,c,e,f)}return d.prototype=Object.create(b.Element.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return"[object ConfirmActionButtonElement]"},d.prototype.init=function(b){var d=!0,e=a("#"+this.id);e.on("click",function(a){d===!0&&(a.preventDefault(),c.confirm(e.data("dialogtitle"),e.data("dialogmessage"),e.data("yesbuttonlabel"),e.data("nobuttonlabel"),function(){d=!1,e.click()},function(){d=!0}))}),b()},d});
define('totara_completioneditor/edit_course_completion', ["jquery","core/str","core/notification"],function(a,b,c){var d={init:function(d){a(".deletecompletionhistorybutton").on("click",function(d){d.preventDefault();var e=a(this).attr("href"),f=[];f.push({key:"coursecompletionhistorydelete",component:"totara_completioneditor"}),f.push({key:"areyousure",component:"moodle"}),f.push({key:"yes",component:"moodle"}),f.push({key:"no",component:"moodle"}),b.get_strings(f).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=e})})}),a(".deleteorphanedcritcomplbutton").on("click",function(d){d.preventDefault();var e=a(this).attr("href"),f=[];f.push({key:"coursecompletionorphanedcritcompldelete",component:"totara_completioneditor"}),f.push({key:"areyousure",component:"moodle"}),f.push({key:"yes",component:"moodle"}),f.push({key:"no",component:"moodle"}),b.get_strings(f).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=e})})}),a(".deletecompletionlink").on("click",function(d){d.preventDefault();var e=a(this).attr("href"),f=[];f.push({key:"areyousure",component:"moodle"}),f.push({key:"coursecompletiondelete",component:"totara_completioneditor"}),f.push({key:"yes",component:"moodle"}),f.push({key:"no",component:"moodle"}),b.get_strings(f).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=e})})})}};return d});
define('totara_completioneditor/check_completion', ["jquery","core/str","core/yui"],function(a,b,c){function d(a,d){var e=[];e.push({key:"fixconfirmtitle",component:"totara_completioneditor"}),e.push({key:d,component:"totara_completioneditor"}),b.get_strings(e).done(function(b){c.use("moodle-core-notification-confirm",function(c){var d=new M.core.confirm({title:b[0],question:b[1],width:500});d.on("complete-yes",function(){window.location.href=a}),d.on("complete-no",function(a){a.preventDefault()}),d.show()})})}var e={init:function(b){a(".problemaggregation a").on("click",function(b){b.preventDefault(),d(a(this).attr("href"),"fixconfirmsome")}),a(".problemsolution a").on("click",function(b){b.preventDefault(),d(a(this).attr("href"),"fixconfirmone")})}};return e});
define('totara_contentmarketplace/disable', ["jquery","core/modal_factory","core/modal_events","core/str"],function(a,b,c,d){var e={};return e.init=function(){a(".tcm-disable").each(function(){var e=a(this),f=e.data("marketplace"),g="contentmarketplace_"+f,h=[{key:"warningdisablemarketplace:title",component:g},{key:"warningdisablemarketplace:body:html",component:g},{key:"warningdisablemarketplace:yes",component:g},{key:"cancel"}];d.get_strings(h).done(function(a){b.create({type:b.types.CONFIRM,title:a[0],body:a[1]},e,{yesstr:a[2],nostr:a[3]}).done(function(a){var b=a.getRoot();b.on(c.yes,function(){window.location=e.attr("href")})})})})},e});
define('totara_contentmarketplace/filter_checkboxes_searchable', ["jquery","core/templates"],function(a,b){function c(a,b,c,d){this.name="",this.context=null,this.data={},this.selection=[],this.onFitler=null,this.showCounts=!1,this.init(a,b,c,d)}return c.prototype.init=function(b,c,d,e){this.name=b,this.showCounts=c,this.context=a(d),this.onFilter=e,this.context.on("keyup",".tcm-search-filter-term",this,function(a){"Escape"!==a.key&&setTimeout(function(){a.data.updateSearch()},1)}),this.context.on("focus",".tcm-search-filter-term",this,function(a){a.data.updateSearch(),a.data.showMenu()}),this.context.on("change",".tcm-checkbox-filter input",this,function(a){a.preventDefault(),a.data.onChange(a.currentTarget)})},c.prototype.populate=function(b){this.data=b.options,this.selection=[],a.isEmptyObject(b.options)&&this.context.hide()},c.prototype.showMenu=function(){a("body").on("keydown.tcm-filter-"+this.name,this,this.hideIfEscape),a("body").on("click.tcm-filter-"+this.name,this,this.hideIfOutside),a("body").on("focus.tcm-filter-"+this.name,"*",this,this.hideIfOutside),this.context.addClass("focused")},c.prototype.hideMenu=function(){a("body").off("keydown.tcm-filter-"+this.name),a("body").off("click.tcm-filter-"+this.name),a("body").off("focus.tcm-filter-"+this.name),this.context.removeClass("focused"),a(".tcm-search-filter-term",this.context).val(""),a(".tcm-search-filter-results",this.context).hide()},c.prototype.hideIfEscape=function(b){var c=b.data;"Escape"===b.key&&(a(".tcm-search-filter-term",c.context).trigger("blur"),c.hideMenu())},c.prototype.hideIfOutside=function(b){var c=b.data;a.contains(a(".tcm-search-filter-widget",c.context)[0],b.target)||c.hideMenu()},c.prototype.updateSearch=function(){var c,d,e=this,f=[];d=a(".tcm-search-filter-term",this.context).val(),d=d.trim().toLowerCase(),a.each(this.search(d),function(a,b){e.selection.indexOf(b)===-1&&f.push(e.data[b])}),0===f.length?a(".tcm-search-filter-results",e.context).hide():(c={results:f},b.render("totara_contentmarketplace/filter_checkboxes_searchable_results",c).done(function(b){a(".tcm-search-filter-results",e.context).html(b),a(".tcm-search-filter-results",e.context).show()}))},c.prototype.updateSelection=function(){var c,d=this,e=[],f=a.Deferred();return this.selection.forEach(function(a){var b=Object.assign({},d.data[a]);b.htmlid+="-selected",e.push(b)}),c={results:e},b.render("totara_contentmarketplace/filter_checkboxes_searchable_results",c).done(function(a){f.resolve(a)}),f.done(function(b){a(".tcm-search-filter-selection-wrapper",d.context).html(b)}),f.promise()},c.prototype.search=function(b){var c=this,d=new RegExp(c.escapeRegex(b),"i");return a.grep(Object.keys(c.data),function(a){return d.test(c.data[a].label)})},c.prototype.escapeRegex=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},c.prototype.onChange=function(b){var c=this,d=a(b).val(),e=a(b).is(":checked"),f=this.selection.indexOf(d);e?(f===-1&&this.selection.push(d),this.data[d].checked=!0):(f!==-1&&this.selection.splice(f,1),this.data[d].checked=!1);var g=this.updateSelection();this.onFilter(),e&&g.done(function(){var d;a(b).parent().hide(),d=0!==a(".tcm-search-filter-results .tcm-checkbox-filter:visible",c.context).length,a(".tcm-search-filter-results",c.context).toggle(d)})},c.prototype.getValue=function(){return this.selection},c.prototype.setCounts=function(b){if(this.showCounts){var c=this;for(var d in this.data)this.data[d].count="0";for(var d in b)d in this.data&&(this.data[d].count=b[d]);a(".tcm-filter-option-count",this.context).each(function(b,d){var e=a(d).data("value");a(d).text(c.data[e].count)})}},c});
define('totara_contentmarketplace/explorer', ["jquery","core/str","core/config","core/templates","core/modal_factory","core/modal_events","totara_contentmarketplace/filters"],function(a,b,c,d,e,f,g){var h="create-course",i={};return i.selector=null,i.haveQueriedOrSortedAtLeastOnce=!1,i.selected=[],i.totalResults=0,i.maxSelectAll=1e4,i.maxCreateCourse=100,i.warnCreateCourse=11,i.filters=null,i.lockId=0,i.createpagepath="",i.init=function(b){var c=this,d=a(b);this.selector=b,this.createpagepath=d.data("createpagepath"),this.marketplace=d.data("marketplace"),this.mode=d.data("mode"),this.mode===h&&a(".tcm-collection-tool",this.selector).hide(),this.category=d.data("category"),a(".tcm-sorting select",d).on("change",this,function(a){a.preventDefault(),a.data.sort()}),a(".tcm-search_query form",d).on("submit",this,function(a){a.preventDefault(),a.data.search()}),this.filters=new g(b,this.search.bind(this),this.marketplace,this.mode,this.category),a(".tcm-load-more button",d).on("click",this,function(a){a.preventDefault(),a.data.more()}),d.on("change",".tcm-thumbnail_selection input",this,function(b){b.preventDefault(),a(b.target).is(":checked")?c.addToSelection(a(b.target).val()):c.removeFromSelection(a(b.target).val())}),d.on("click",".tcm-thumbnail_selection label, .tcm-thumbnail_selection input",function(a){a.stopPropagation()}),d.on("click",".tcm-search-thumbnail",function(b){b.preventDefault();var d=a(this).find("input").val();c.showDetails(d)}),a(".tcm-search_selection_tools",d).on("click",".tcm-create-course.tcm-tool-enabled",this,function(a){a.preventDefault(),a.data.createCourse()}),a(".tcm-add-to-collection",d).on("click",this,function(a){a.preventDefault(),a.data.addToCollection()}),a(".tcm-remove-from-collection",d).on("click",this,function(a){a.preventDefault(),a.data.removeFromCollection()}),a(".tcm-select-all",d).on("click",this,function(a){a.preventDefault(),a.data.selectAll()}),a(".tcm-deselect-all",d).on("click",this,function(a){a.preventDefault(),a.data.deselectAll()}),this.search()},i.sort=function(){this.haveQueriedOrSortedAtLeastOnce=!0,this.search()},i.search=function(){var b,e,f=a(this.selector),g=this,i=this.lock();f.addClass("tcm-is-searching"),a(".tcm-search_result_summary",f).html(""),b=a(".tcm-search_query input",f).val().trim(),e={sesskey:c.sesskey,page:0,query:b,sort:a(".tcm-sorting select",f).val(),multivaluefilters:[],singlevaluefilters:[],marketplace:this.marketplace,category:this.category,mode:this.mode},this.haveQueriedOrSortedAtLeastOnce||""===b||(this.haveQueriedOrSortedAtLeastOnce=!0,e.isfirstquerywithdefaultsort=!0),a.each(this.filters.getValues(),function(a,b){b instanceof Array?e.multivaluefilters.push(a):e.singlevaluefilters.push(a),e["filter-"+a]=b}),this.data=e,a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/search.php",data:e}).done(function(b){g.totalResults=b.total,d.render("totara_contentmarketplace/results",b).done(function(c){g.checkLock(i)&&(c=a(c),a(".tcm-thumbnail_selection input",c).each(function(){g.selected.indexOf(a(this).val())>=0&&a(this).prop("checked",!0)}),a(".tcm-results").replaceWith(c),b.more?(a(".tcm-load-more",f).removeClass("tcm-load-more-loading"),a(".tcm-load-more button",f).prop("disabled",!1),a(".tcm-load-more",f).show()):a(".tcm-load-more",f).hide(),g.initResizeHandler())}),g.checkLock(i)&&g.filters.setCounts(b.filters),d.render("totara_contentmarketplace/result_summary",b).done(function(b){g.checkLock(i)&&(f.removeClass("tcm-is-searching"),a(".tcm-search_result_summary",f).replaceWith(b))}),a(".tcm-sorting select",f).val(b.sort),g.mode!==h&&("add"===b.selectionmode?(a(".tcm-add-to-collection",f).show(),a(".tcm-remove-from-collection",f).hide()):"remove"===b.selectionmode&&(a(".tcm-add-to-collection",f).hide(),a(".tcm-remove-from-collection",f).show()))})},i.more=function(){var b,e=a(this.selector),f=this,g=this.lock();a(".tcm-load-more",e).addClass("tcm-load-more-loading"),a(".tcm-load-more button",e).prop("disabled",!0),b=this.data,b.page+=1,a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/search.php",data:b}).done(function(b){d.render("totara_contentmarketplace/results",b).done(function(c){f.checkLock(g)&&(c=a(c),a(".tcm-thumbnail_selection input",c).each(function(){f.selected.indexOf(a(this).val())>=0&&a(this).prop("checked",!0)}),a("> div",c).appendTo(".tcm-results"),b.more?(a(".tcm-load-more",e).removeClass("tcm-load-more-loading"),a(".tcm-load-more button",e).prop("disabled",!1),a(".tcm-load-more",e).show()):a(".tcm-load-more",e).hide(),f.initResizeHandler())})})},i.addToSelection=function(a){var b=this.selected.indexOf(a);b<0&&this.selected.push(a),this.selection()},i.removeFromSelection=function(a){var b=this.selected.indexOf(a);b>-1&&this.selected.splice(b,1),this.selection()},i.selection=function(){var c=a(this.selector);if(this.selected.length>0){var d=this,e=this.selected.length,f=1===e?"itemselected":"itemselected_plural",g=a(".tcm-search_selection_status",c);b.get_string(f,"totara_contentmarketplace",e).done(function(b){d.selected.length===e&&(g.text(b),a(".tcm-search_selection_tools",c).css("visibility","visible"))})}else a(".tcm-search_selection_tools",c).css("visibility","hidden")},i.selectAll=function(){var b=this;b.totalResults>b.maxSelectAll?b.warningTooManySelectAll():(a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/select.php",data:this.data}).done(function(c){a(".tcm-select-all").siblings(".tcm-loading").css({visibility:"hidden"}),b.selected=b.selected.concat(c.selection.filter(function(a){return b.selected.indexOf(a)<0})),a(".tcm-thumbnail_selection input").each(function(){b.selected.indexOf(a(this).val())>=0&&a(this).prop("checked",!0)}),b.selection()}),a(".tcm-select-all").siblings(".tcm-loading").css({visibility:"visible"}))},i.deselectAll=function(){this.selected=[];var b=a(this.selector);a(".tcm-thumbnail_selection input:checked",b).prop("checked",!1),this.selection()},i.createCourse=function(){this.selected.length>this.maxCreateCourse?(this.disableCreateCourse(),this.warningCreateTooManyCourses()):this.selected.length>=this.warnCreateCourse?(this.disableCreateCourse(this.selected),this.warningCreateLotsOfCourses(this.openCreateCourseForm.bind(this,this.selected))):this.openCreateCourseForm(this.selected)},i.openCreateCourseForm=function(b){var d={category:this.category,selection:b,mode:this.mode};this.disableCreateCourse(),window.location=c.wwwroot+this.createpagepath+"?"+a.param(d)},i.addToCollection=function(){var b=this,d=a(b.selector);d.addClass("tcm-is-searching"),a(".tcm-search_selection_tools",d).css("visibility","hidden"),a(".tcm-search_result_summary",d).html(""),a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/update_collection.php",data:{sesskey:c.sesskey,selection:this.selected,action:"add",marketplace:this.marketplace}}).done(function(a){b.search()}),b.selected=[]},i.removeFromCollection=function(){var b=this,d=a(b.selector);d.addClass("tcm-is-searching"),a(".tcm-search_selection_tools",d).css("visibility","hidden"),a(".tcm-search_result_summary",d).html(""),a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/update_collection.php",data:{sesskey:c.sesskey,selection:this.selected,action:"remove",marketplace:this.marketplace}}).done(function(a){b.search()}),b.selected=[]},i.warningTooManySelectAll=function(){var a=[{key:"warningtoomanyselectall:title",component:"totara_contentmarketplace"},{key:"warningtoomanyselectall:body",component:"totara_contentmarketplace"}];b.get_strings(a).done(function(a){e.create({type:e.types.CANCEL,title:a[0],body:a[1]}).done(function(a){a.show()})})},i.warningCreateTooManyCourses=function(){var a=this,c=[{key:"warningcreatetoomanycourses:title",component:"totara_contentmarketplace"},{key:"warningcreatetoomanycourses:body",component:"totara_contentmarketplace"}];b.get_strings(c).done(function(b){e.create({type:e.types.CANCEL,title:b[0],body:b[1]}).done(function(b){var c=b.getRoot();c.on(f.hidden,a.enableCreateCourse),b.show()})})},i.warningCreateLotsOfCourses=function(a){var c=this,d=[{key:"warningcreatelotsofcourses:title",component:"totara_contentmarketplace"},{key:"warningcreatelotsofcourses:body",component:"totara_contentmarketplace",param:this.selected.length},{key:"createcourses",component:"totara_contentmarketplace",param:this.selected.length},{key:"cancel"}];b.get_strings(d).done(function(b){e.create({type:e.types.CONFIRM,title:b[0],body:b[1]},void 0,{yesstr:b[2],nostr:b[3]}).done(function(b){var d=b.getRoot();d.on(f.yes,a),d.on(f.hidden,c.enableCreateCourse),b.show()})})},i.enableCreateCourse=function(){a(".tcm-create-course").addClass("tcm-tool-enabled")},i.disableCreateCourse=function(){a(".tcm-create-course").removeClass("tcm-tool-enabled")},i.showDetails=function(b){var e=this;e.hideDetails(),a(".tcm-result").removeClass("tcm-details-target"),a("#selection-"+b).closest(".tcm-result").addClass("tcm-details-target");var f=this.data;f.id=b,a("#tcm-details-wrapper-actual").length||a(".tcm-details-wrapper").clone().insertAfter(".tcm-results").attr("id","tcm-details-wrapper-actual");var g=a("#tcm-details-wrapper-actual");if(a(".tcm-details-content").remove(),g.show(),a(".tcm-preloader").show(),e.positionDetails(),!e.isElementInViewport(g[0])){var h=g[0].getBoundingClientRect();window.scrollBy({top:h.bottom-window.innerHeight,behavior:"smooth"})}a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/fetch_details.php",data:f}).done(function(c){d.render("totara_contentmarketplace/details",c).done(function(c){b===a(".tcm-details-target").find("input").val()&&(a(".tcm-preloader").hide(),a(".tcm-details-content").remove(),a(c).insertAfter(".tcm-preloader"),a(".tcm-details-close").click(e.hideDetails),a(".tcm-create-course-button").click(function(){e.openCreateCourseForm([b])}))})})},i.positionDetails=function(){var b=a("#tcm-details-wrapper-actual"),c=a(".tcm-details-target",this.selector);if(b.length&&c.length){var d=c.offset().left+Math.round(c.width()/2);a(".tcm-details-pointer").offset({left:d});var e=c;c.hasClass("tcm-last")||(e=c.nextAll(".tcm-last:first")),b.detach().insertAfter(e)}},i.hideDetails=function(){a("#tcm-details-wrapper-actual",this.selector).remove(),a(".tcm-result").removeClass("tcm-details-target")},i.initResizeHandler=function(){var b=this;a(window).on("resize",function(){if(a(".tcm-result").length){var c=a("#tcm-details-wrapper-actual");c.length&&a("#tcm-details-wrapper-actual").hide();var d=a(".tcm-result:first",b.selector).position().left;a(".tcm-result",b.selector).removeClass("tcm-last"),a(".tcm-result").each(function(){if(a(this).position().left===d){var b=a(this).prev();b.hasClass("tcm-details-wrapper")&&(b=b.prev()),b.addClass("tcm-last")}}),a(".tcm-result:last").addClass("tcm-last"),c.length&&a("#tcm-details-wrapper-actual").show(),b.positionDetails()}}),a(window).trigger("resize")},i.isElementInViewport=function(a){var b=a.getBoundingClientRect();return b.top>=0&&b.left>=0&&b.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&b.right<=(window.innerWidth||document.documentElement.clientWidth)},i.lock=function(){return++this.lockId},i.checkLock=function(a){return this.lockId===a},i});
define('totara_contentmarketplace/filter_radios', ["jquery","core/templates"],function(a,b){function c(a,b,c,d){this.name="",this.context=null,this.value=null,this.onFitler=null,this.showCounts=!1,this.init(a,b,c,d)}return c.prototype.init=function(b,c,d,e){this.name=b,this.showCounts=c,this.context=a(d),this.onFitler=e,this.context.on("change",".tcm-filter-radios input",this,function(a){a.preventDefault(),a.data.onFitler()})},c.prototype.populate=function(c){var d=this,e=a.Deferred();return 0===c.options.length?(this.context.hide(),e.resolve()):b.render("totara_contentmarketplace/filter_radios",c).done(function(b){a(".tcm-filter-input",d.context).append(b),e.resolve()}),e.promise()},c.prototype.getValue=function(){return a("input:checked",this.context).val()},c.prototype.setCounts=function(b){this.showCounts&&a(".tcm-filter-option-count",this.context).each(function(c,d){var e=a(d).data("value");a(d).text(b[e]||"0")})},c});
define('totara_contentmarketplace/filters', ["jquery","core/config"],function(a,b){function c(b,c,d,e){this.context=null,this.filters={},this.marketplace=null,this.category=null,this.populated=a.Deferred(),this.mode=null,this.init(b,c,d,e)}return c.prototype.init=function(b,c,d,e,f){var g=this,h=[];this.context=a(b+" .tcm-search-filters-wrapper"),this.marketplace=d,this.mode=e,this.category=f,a(".tcm-search-filter",this.context).each(function(){var d=a(this).data("filter-name"),e=a(this).data("filter-module"),f=a(this).data("filter-showcounts");h.push(g.initFilter(d,e,f,b+" .tcm-search-filter-name-"+d,c))}),a.when.apply(a,h).done(function(){g.fetchFilterSeeds().done(function(a){g.populateFilters(a)})})},c.prototype.setCounts=function(b){var c=this;this.populated.done(function(){a.each(b,function(a,b){c.filters[b.name].setCounts(b.values)})})},c.prototype.getValues=function(){var a={};for(var b in this.filters)a[b]=this.filters[b].getValue();return a},c.prototype.initFilter=function(b,c,d,e,f){var g=this,h=a.Deferred();return require([c],function(a){var c=new a(b,d,e,f);g.filters[c.name]=c,h.resolve()}),h.promise()},c.prototype.populateFilters=function(b){var c=this,d=[];a.each(b,function(a,b){d.push(c.filters[b.name].populate(b))}),a.when.apply(a,d).done(function(){c.populated.resolve(),a(".tcm-search-filters-loading",c.context).hide(),a(".tcm-search-filters",c.context).show()})},c.prototype.fetchFilterSeeds=function(){var c={sesskey:b.sesskey,marketplace:this.marketplace,category:this.category,mode:this.mode};return a.post({url:b.wwwroot+"/totara/contentmarketplace/ajax/filters.php",data:c})},c});
define('totara_core/select_tree', [],function(){function a(){return this instanceof a?(this.activeClass="tw-selectTree__active",this.activeSelector="data-tw-selector-active",this.clearSelector="data-tw-selectorgroup-clear",this.hideClass="tw-selectTree__hidden",this.key="",this.keyboardClass="tw-selectTree__keyboard",this.repositionClass="tw-selectTree__reposition",this.widget="",void(this.visibility=!1)):new a}a.prototype={constructor:a,add:function(a){var b=a.getAttribute("data-tw-selectTree-urlVal"),c=a.getAttribute("data-tw-selectTree-label"),d=a.parentNode,e=d.hasAttribute("data-tw-selectTree-default");this.removeActive(),this.closeLists(),this.setCurrentLabel(c),d.classList.add(this.activeClass),e||d.setAttribute(this.activeSelector,""),this.expandActiveLists(d),this.setEventType(b)},closeLists:function(){for(var a=this.widget.querySelectorAll("[data-tw-selectTree-list]"),b=0;b<a.length;b++)if(!a[b].classList.contains(this.hideClass)){var c=a[b].previousElementSibling,d=c.querySelector("[data-tw-selectTree-toggle]");this.toggleTreeList(a[b],d)}},events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.preventDefault(),b.target)if(b.target.closest("[data-tw-selectTree-trigger]"))a.toggleTree();else if(b.target.closest("[data-tw-selectTree-toggle]")){var c=b.target.closest("[data-tw-selectTree-toggle]"),d=c.parentNode.nextElementSibling;c.hasAttribute("data-tw-selecttree-label")&&(c=c.previousElementSibling),a.toggleTreeList(d,c)}else if(b.target.closest("[data-tw-selectTree-urlVal]")){var e=b.target.closest("[data-tw-selectTree-urlVal]");if(e.parentNode.classList.contains(a.activeClass))return;a.add(e),a.toggleTree(),a.triggerEvent("changed",{})}});var b=function(b){var c=a.widget.querySelector("[data-tw-selectTree-tree]");a.widget.contains(b.target)||c.classList.contains(a.hideClass)||a.toggleTree()};document.addEventListener("click",b),document.addEventListener("touchstart",b),this.widget.addEventListener("keydown",function(b){if(b.target){for(var c=0,d=a.widget.querySelectorAll(".tw-selectTree__list_row"),e=!1,f=0;f<d.length;++f)if(d[f]==document.activeElement.closest(".tw-selectTree__list_row")){c=f,e=!0;break}if(!e)for(var g=0;g<d.length;++g)if(d[g].classList.contains("tw-selectTree__active")){c=g;break}switch(a.widget.classList.add(a.keyboardClass),b.key){case"Enter":b.preventDefault(),b.target.click(),d[c].getElementsByClassName("tw-selectTree__list_row_link")[0].focus();break;case"Tab":if(c===d.length-1&&a.visibility)return void a.toggleTree();for(var h=!0,i=c+1;i<d.length;++i){var j=d[i].getElementsByClassName("tw-selectTree__list_row_link")[0];if(j&&0!==j.offsetHeight)return b.preventDefault(),h=!1,void j.focus()}h&&a.visibility&&a.toggleTree();break;case"ArrowUp":case"Up":if(b.preventDefault(),0===c)return;for(var k=c-1,l=k;l<d.length;++l){var m=d[k].getElementsByClassName("tw-selectTree__list_row_link")[0];if(m&&0!==m.offsetHeight)return void m.focus();k--}break;case"ArrowDown":case"Down":if(b.preventDefault(),c===d.length-1)return;for(var n=c+1;n<d.length;++n){var o=d[n].getElementsByClassName("tw-selectTree__list_row_link")[0];if(o&&0!==o.offsetHeight)return void o.focus()}break;case"ArrowLeft":case"Left":b.preventDefault();var p=d[c].getElementsByClassName("tw-selectTree__list_row_icon_expand")[0];p&&p.classList.contains("tw-selectTree__hidden")&&d[c].querySelector("[data-tw-selecttree-toggle]").click();break;case"ArrowRight":case"Right":b.preventDefault();var q=d[c].getElementsByClassName("tw-selectTree__list_row_icon_expanded")[0];q&&q.classList.contains("tw-selectTree__hidden")&&d[c].querySelector("[data-tw-selecttree-toggle]").click()}}});var c=new MutationObserver(function(){"true"===a.widget.getAttribute(a.clearSelector)&&(a.setToDefault(),a.triggerEvent("changed",{}),a.widget.setAttribute(a.clearSelector,!1))});c.observe(this.widget,{attributes:!0,attributeFilter:[a.clearSelector],subtree:!1})},expandActiveLists:function(a){for(var b,c=!1;!c;)if(b=a.closest("[data-tw-selectTree-list]."+this.hideClass)){var d=b.previousElementSibling,e=d.querySelector("[data-tw-selectTree-toggle]");this.toggleTreeList(b,e)}else c=!0},preset:function(){var a=this.widget.querySelector("["+this.activeSelector+"]");if(a){var b=a.querySelector("[data-tw-selectTree-urlVal]"),c=b.getAttribute("data-tw-selectTree-urlVal");this.expandActiveLists(a),this.setEventType(c)}else{var d=this.widget.querySelector("[data-tw-selectTree-default] [data-tw-selectTree-urlVal]");if(d){var e=d.getAttribute("data-tw-selectTree-urlVal");e&&this.setEventType(e)}}},removeActive:function(){var a=this.widget.querySelectorAll("[data-tw-selectTree-tree] ["+this.activeSelector+"]"),b=this.widget.querySelector("[data-tw-selectTree-default]");b&&b.classList.remove(this.activeClass);for(var c=0;c<a.length;c++)a[c].classList.remove(this.activeClass),a[c].removeAttribute(this.activeSelector)},setCurrentLabel:function(a){var b=this.widget.querySelector("[data-tw-selectTree-current]");b.innerHTML=a},setEventType:function(a){a?this.triggerEvent("add",{key:this.key,val:a,widget:this.widget}):this.triggerEvent("remove",{key:this.key})},setKey:function(a){this.key=a},setParent:function(a){this.widget=a},setToDefault:function(){var a=this.widget.querySelector("[data-tw-selectTree-default] [data-tw-selectTree-urlVal]");if(this.removeActive(),this.closeLists(),a){var b=a.getAttribute("data-tw-selectTree-label"),c=a.getAttribute("data-tw-selectTree-urlVal"),d=a.parentNode;this.expandActiveLists(d),this.setCurrentLabel(b),d.classList.add(this.activeClass),this.setEventType(c)}else{var e=this.widget.querySelector("[data-tw-selecttree-callToActionLabel]");e&&this.setCurrentLabel(e.getAttribute("data-tw-selecttree-callToActionLabel"))}},toggleExpandIcons:function(a){var b=a.childNodes;b[0].classList.toggle(this.hideClass),b[1].classList.toggle(this.hideClass)},toggleTreeList:function(a,b){a.classList.toggle(this.hideClass),this.toggleExpandIcons(b);var c=a.classList.contains(this.hideClass)?"false":"true";b.setAttribute("aria-expanded",c)},toggleTree:function(){this.visibility=!this.visibility;var a=this.widget.querySelector("[data-tw-selectTree-tree]"),b=this.widget.querySelector("[data-tw-selectTree-trigger]");a.classList.remove(this.repositionClass),b.classList.toggle(this.activeClass),a.classList.toggle(this.hideClass);var c=a.getBoundingClientRect().right,d=document.documentElement.clientWidth;if(d<c&&a.classList.toggle(this.repositionClass),a.classList.contains(this.hideClass))a.setAttribute("aria-hidden","true"),this.widget.classList.remove(this.keyboardClass);else{a.setAttribute("aria-hidden","false");var e=a.querySelector("["+this.activeSelector+"] [data-tw-selectTree-label]"),f=e?e:a.querySelector("[data-tw-selectTree-default]");f&&(this.expandActiveLists(f),f.focus())}},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/select_tree:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.setKey(b.getAttribute("data-tw-selectTree-urlkey")),d.preset(),d.events(),c(d)})};return{init:b}});
define('totara_core/quickaccessmenu', ["core/str","core/popover_region_controller"],function(a,b){function c(a){b.call(this,a),this.element=a}function d(a){return new Promise(function(b){var d=new c(a);d.setupEvents(),b(d)})}return c.prototype=Object.create(b.prototype),c.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?a.get_string("quickaccessmenu:hidemenuwindow","totara_core").done(function(a){this.isMenuOpen()&&this.menuToggle.attr("aria-label",a)}.bind(this)):a.get_string("quickaccessmenu:showmenuwindow","totara_core").done(function(a){this.isMenuOpen()===!1&&this.menuToggle.attr("aria-label",a)}.bind(this))},c.prototype.setupEvents=function(){var a=this;this.element.querySelector("[data-quickaccessmenu-close-menu]").addEventListener("click",function(b){return b.preventDefault(),a.closeMenu(),!1}),"complete"===document.readyState?a.checkLocation():window.addEventListener("load",a.checkLocation.bind(a))},c.prototype.checkLocation=function(){var a=this.element.querySelector("#quickaccess-popover-content"),b=a.getBoundingClientRect();b.left<0||b.right>window.innerWidth?a.classList.add("totara_core__QuickAccess_menu--large"):a.classList.remove("totara_core__QuickAccess_menu--large")},{init:d}});
define('totara_core/select_search_text', [],function(){function a(){return this instanceof a?(this.activeSelector="data-tw-selector-active",this.clearSelector="data-tw-selectorgroup-clear",this.hideClass="tw-selectSearchText__hidden",this.searchTerm="",void(this.widget="")):new a}a.prototype={constructor:a,add:function(a){var b=this.widget.querySelector("[data-tw-selectSearchText-urlkey]"),c=b.getAttribute("data-tw-selectSearchText-urlkey"),d=b.parentNode.querySelector("[data-tw-selectSearchText-clear]");this.setSearchTerm(a),b.setAttribute(this.activeSelector,!0),d.classList.remove(this.hideClass),this.triggerEvent("add",{key:c,val:a})},clear:function(){var a=this.widget.querySelector("[data-tw-selectSearchText-urlkey]"),b=a.getAttribute("data-tw-selectSearchText-urlkey"),c=a.parentNode.querySelector("[data-tw-selectSearchText-clear]");this.setSearchTerm(""),a.removeAttribute(this.activeSelector),c.classList.add(this.hideClass),a.value="",this.triggerEvent("remove",{key:b,val:""})},events:function(){var a=this;this.widget.addEventListener("click",function(b){b.preventDefault(),b.target&&(b.target.closest("[data-tw-selectSearchText-trigger]")?a.valueCheck():b.target.closest("[data-tw-selectSearchText-clear]")&&(a.clear(),a.triggerEvent("changed",{})))}),this.widget.addEventListener("keydown",function(b){b.target.closest("[data-tw-selectSearchText-urlkey]")&&("Enter"!==b.key&&13!==b.which&&13!==b.keyCode||(b.preventDefault(),a.valueCheck()))});var b=new MutationObserver(function(){"true"===a.widget.getAttribute(a.clearSelector)&&(a.clear(),a.widget.setAttribute(a.clearSelector,!1))});b.observe(this.widget,{attributes:!0,attributeFilter:[a.clearSelector],subtree:!1})},preset:function(){var a=this.widget.querySelector("[data-tw-selectSearchText-urlkey]"),b=a.value;if(""===b&&a.getAttribute(this.activeSelector)===!0)this.clear(),this.triggerEvent("changed",{});else{if(""===b)return;this.setSearchTerm(b),this.add(b)}},setParent:function(a){this.widget=a},setSearchTerm:function(a){this.searchTerm=a},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/select_search_text:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)},valueCheck:function(){var a=this.widget.querySelector("[data-tw-selectSearchText-urlkey]").value;this.searchTerm!==a&&(""===a?this.clear():this.add(a),this.triggerEvent("changed",{}))}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.preset(),d.events(),c(d)})};return{init:b}});
define('totara_core/totaranav', ["core/templates"],function(a){function b(){return this instanceof b?(this.widget="",void(this.itemExpandedClass="totaraNav--list_item_expanded")):new b}b.prototype={constructor:b,events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target){if(b.target.closest("[data-tw-totaraNav-toggle]")||b.target.closest("[data-tw-totaranav-list-close]"))return a.widget.querySelector("[data-tw-totaraNav-list]").classList.toggle("totaraNav_prim--list_showMobile"),a.widget.querySelector("[data-tw-totaraNav-list]").classList.toggle("totaraNav_prim--list_hideMobile"),void(b.target.closest("[data-tw-totaraNav-toggle]")&&a.widget.querySelector("[data-tw-totaranav-list-close]").focus());var c=b.target.closest("li");if(c&&c.hasAttribute("data-tw-totaraNav-hasChildren")){b.preventDefault();var d=c.classList.contains(a.itemExpandedClass);if(d)return void a.toggleExpandedList(c);var e=c.parentNode.closest("[data-tw-totaraNav-hasChildren]"),f=e?e:"";a.closeAllExpandedLists(f),a.toggleExpandedList(c)}}});for(var b=this.widget.querySelectorAll("[data-tw-totaranav-toplevelitem]"),c=0;c<b.length;c++)b[c].addEventListener("mouseenter",function(){var b=document.activeElement;b.classList.contains("totaraNav_prim--list_item_link")&&!b.parentNode.classList.contains(a.itemExpandedClass)&&b.blur()});this.widget.addEventListener("mouseleave",function(){var b=document.activeElement;b.closest("[data-tw-totaranav-item]")&&a.closeAllExpandedLists()}),window.innerWidth>991?(this.widget.addEventListener("keydown",function(b){if(b.target&&b.target.closest("[data-tw-totaraNav-item]")){var c=b.target.closest("[data-tw-totaraNav-item]"),d=b.target.closest("[data-tw-navExpand-list]");switch(b.key){case"ArrowDown":case"Down":b.preventDefault(),a.listItemKeyDown(c,d);break;case"ArrowLeft":case"Left":b.preventDefault(),a.listItemKeyLeft(c,d);break;case"ArrowRight":case"Right":b.preventDefault(),a.listItemKeyRight(c,d);break;case"ArrowUp":case"Up":b.preventDefault(),a.listItemKeyUp(c,d);break;case"Escape":case"Esc":a.listItemKeyEsc(c,d);break;case"Tab":b.shiftKey?a.listItemKeyTabBack(c):a.listItemKeyTab(c,d);break;case" ":case"Spacebar":b.preventDefault(),a.listItemKeySpace(c)}}}),window.addEventListener("click",function(b){b.target.closest("[data-tw-totaranav-item]")||a.closeAllExpandedLists()})):window.addEventListener("click",function(b){b.target.closest("[data-tw-totaraNav-list]")||b.target.closest("[data-tw-totaraNav-toggle]")||(a.widget.querySelector("[data-tw-totaraNav-list]").classList.remove("totaraNav_prim--list_showMobile"),a.widget.querySelector("[data-tw-totaraNav-list]").classList.add("totaraNav_prim--list_hideMobile"))}),window.addEventListener("resize",function(){var b=function(){c=null;for(var b=a.widget.querySelector("[data-tw-totaraNav-list]"),d=a.widget.querySelectorAll(".totaraNav--icon_chevron"),e=0;e<d.length;e++)d[e].remove();window.innerWidth>991?(a.addExpandableIcons(),b.classList.remove("totaraNav_prim--list_hideMobile","totaraNav_prim--list_showMobile")):(a.addExpandableIcons(),b.classList.contains("totaraNav_prim--list_showMobile")||b.classList.add("totaraNav_prim--list_hideMobile"))};if(M.cfg.behatsiterunning)return void b();var c;c||(c=setTimeout(b,66))})},addExpandableIcons:function(){for(var a=this.widget.querySelectorAll("[data-tw-totaraNav-chevron]"),b=0;b<a.length;b++)this.toggleExpandableIcon(a[b].parentNode)},closeExpandedList:function(a){var b=a.querySelector("[aria-expanded]");a.classList.remove(this.itemExpandedClass),b.setAttribute("aria-expanded",!1),this.toggleExpandableIcon(b)},closeAllExpandedLists:function(a){for(var b=this.widget.querySelectorAll("."+this.itemExpandedClass),c=0;c<b.length;c++)a!==b[c]&&this.closeExpandedList(b[c])},listItemKeyDown:function(a,b){if(a.classList.contains(this.itemExpandedClass)){var c=a.querySelectorAll("[data-tw-navExpand-list]")[0];c.querySelectorAll("a")[0].focus()}else b&&a.nextElementSibling&&a.nextElementSibling.querySelector("a").focus()},listItemKeyEsc:function(a,b){if(b){var c=a.closest("."+this.itemExpandedClass);this.closeExpandedList(c),c.querySelector("a").focus()}},listItemKeyLeft:function(a,b){!b&&a.previousElementSibling&&(this.closeAllExpandedLists(),a.previousElementSibling.querySelector("a").focus())},listItemKeyRight:function(a,b){!b&&a.nextElementSibling&&(this.closeAllExpandedLists(),a.nextElementSibling.querySelector("a").focus())},listItemKeySpace:function(a){a.hasAttribute("data-tw-totaraNav-hasChildren")&&this.toggleExpandedList(a.closest("[data-tw-totaraNav-hasChildren]"))},listItemKeyTab:function(a,b){if(b&&!a.nextElementSibling&&!a.classList.contains(this.itemExpandedClass)){var c=a.parentNode.closest("[data-tw-totaranav-item]"),d=c.nextElementSibling,e=!c.parentNode.closest("[data-tw-totaranav-item]"),f=a.parentNode.closest("[data-tw-totaranav-toplevelitem]");!d||e?this.closeAllExpandedLists(""):d&&this.closeAllExpandedLists(f)}},listItemKeyTabBack:function(a){var b=a.classList.contains(this.itemExpandedClass);b&&this.closeExpandedList(a)},listItemKeyUp:function(a,b){b&&a.previousElementSibling?a.previousElementSibling.querySelector("a").focus():b&&!a.previousElementSibling&&(b.previousElementSibling.focus(),this.closeExpandedList(b.parentNode))},toggleExpandedList:function(a){a.classList.toggle(this.itemExpandedClass);var b=!!a.classList.contains(this.itemExpandedClass),c=a.querySelector("[aria-expanded]");c.setAttribute("aria-expanded",b),c.focus(),this.toggleExpandableIcon(c)},setParent:function(a){this.widget=a},toggleExpandableIcon:function(b){var c,d=b.querySelector("[data-tw-totaraNav-chevron]"),e=b.closest("[data-tw-totaraNav-topLevelItem]"),f=b.parentNode.hasAttribute("data-tw-totaraNav-topLevelItem");if(d.hasChildNodes()&&(c=d.querySelector("[data-flex-icon]").getAttribute("data-flex-icon")),f&&window.innerWidth>991||!e){if(c)return;c="nav-down"}else c="nav-expand"===c?"nav-expanded":"nav-expand";a.renderIcon(c,"","totaraNav--icon_chevron").done(function(a){d.innerHTML=a})}};var c=function(a){var c=new b;c.setParent(a),c.events(),c.addExpandableIcons()};return{init:c}});
define('totara_core/select_region_panel', [],function(){function a(){return this instanceof a?(this.activeSelector="data-tw-selector-active",this.clearNode="",this.clearSelector="data-tw-selectorgroup-clear",this.hideClass="tw-selectRegionPanel__content_hidden",void(this.widget="")):new a}a.prototype={bubbledEventsListener:function(){var a="totara_core/select_multi",b="totara_core/select_search_text",c="totara_core/select_tree",d=this;this.widget.addEventListener(a+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(b+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(c+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(a+":changed",function(){d.regionChange()}),this.widget.addEventListener(b+":changed",function(){d.regionChange()}),this.widget.addEventListener(c+":changed",function(){d.regionChange()}),this.widget.addEventListener(a+":remove",function(a){d.triggerEvent("remove",a.detail)}),this.widget.addEventListener(b+":remove",function(a){d.triggerEvent("remove",a.detail)}),this.widget.addEventListener(c+":remove",function(a){d.triggerEvent("remove",a.detail)})},clear:function(){var a=this.widget.querySelectorAll("["+this.activeSelector+"]"),b=this;if(a){var c=new MutationObserver(function(){var a=b.widget.querySelectorAll("["+b.clearSelector+"=true]").length;a||(this.disconnect(),b.regionChange())});c.observe(this.widget,{attributes:!0,attributeFilter:[b.clearSelector],subtree:!0});for(var d=0;d<a.length;d++){var e=a[d].closest("[data-tw-selectorgroup]"),f=e.getAttribute(this.clearSelector);f&&"false"!==f||e.setAttribute(this.clearSelector,!0)}}},events:function(){var a=this;this.widget.addEventListener("click",function(b){b.preventDefault(),b.target&&b.target.closest("[data-tw-selectRegionPanel-clear]")&&a.clear()})},regionChange:function(){this.updateActiveCount(),this.triggerEvent("changed",{})},updateActiveCount:function(){var a=this.widget.querySelectorAll("["+this.activeSelector+"]").length,b=this.widget.querySelector("[data-tw-selectRegionPanel-clear]"),c=this.widget.querySelector("[data-tw-selectRegionPanel-count]");b&&(a>0?b.classList.remove(this.hideClass):b.classList.add(this.hideClass)),c&&(c.innerHTML=a,a>0?c.parentNode.classList.remove(this.hideClass):c.parentNode.classList.add(this.hideClass))},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/select_region_panel:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.bubbledEventsListener(),d.events(),d.updateActiveCount(),c(d)})};return{init:b}});
define('totara_core/datatable', ["jquery","core/str","core/config","totara_core/jquery.dataTables-lazy"],function(a,b,c){var d={init:function(d,e,f){var g=[];g.push({key:"datatable:sEmptyTable",component:"totara_core"}),g.push({key:"datatable:sInfo",component:"totara_core"}),g.push({key:"datatable:sInfoEmpty",component:"totara_core"}),g.push({key:"datatable:sInfoFiltered",component:"totara_core"}),g.push({key:"datatable:sInfoPostFix",component:"totara_core"}),g.push({key:"datatable:sInfoThousands",component:"totara_core"}),g.push({key:"datatable:sLengthMenu",component:"totara_core"}),g.push({key:"datatable:sLoadingRecords",component:"totara_core"}),g.push({key:"datatable:sProcessing",component:"totara_core"}),g.push({key:"datatable:sSearch",component:"totara_core"}),g.push({key:"datatable:sZeroRecords",component:"totara_core"}),g.push({key:"datatable:oPaginate:sFirst",component:"totara_core"}),g.push({key:"datatable:oPaginate:sLast",component:"totara_core"}),g.push({key:"datatable:oPaginate:sNext",component:"totara_core"}),g.push({key:"datatable:oPaginate:sPrevious",component:"totara_core"}),b.get_strings(g).done(function(b){for(var h=[],i=0;i<g.length;i++)h[g[i].key]=b[i];a(document).ready(function(){a("#datatable").dataTable({searchDelay:500,bProcessing:!0,bServerSide:!0,sPaginationType:"full_numbers",sAjaxSource:c.wwwroot+"/totara/"+d+"/lib/assign/ajax.php",fnServerParams:function(a){a.push({name:"module",value:d}),a.push({name:"suffix",value:e}),a.push({name:"itemid",value:f}),a.push({name:"sesskey",value:c.sesskey})},oLanguage:{sEmptyTable:h["datatable:sEmptyTable"],sInfo:h["datatable:sInfo"],sInfoEmpty:h["datatable:sInfoEmpty"],sInfoFiltered:h["datatable:sInfoFiltered"],sInfoPostFix:h["datatable:sInfoPostFix"],sInfoThousands:h["datatable:sInfoThousands"],sLengthMenu:h["datatable:sLengthMenu"],sLoadingRecords:h["datatable:sLoadingRecords"],sProcessing:h["datatable:sProcessing"],sSearch:h["datatable:sSearch"],sZeroRecords:h["datatable:sZeroRecords"],oPaginate:{sFirst:h["datatable:oPaginate:sFirst"],sLast:h["datatable:oPaginate:sLast"],sNext:h["datatable:oPaginate:sNext"],sPrevious:h["datatable:oPaginate:sPrevious"]}}})})})}};return d});
define('totara_core/grid', [],function(){function a(){return this instanceof a?(this.activeClass="tw-grid__item_active",void(this.widget="")):new a}a.prototype={constructor:a,events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target&&b.target.closest("[data-tw-grid-item-toggle]")){b.preventDefault();var c=b.target.closest("[data-tw-grid-item]"),d=c.classList.contains(a.activeClass);if(a.unsetActive(),d)return void a.triggerEvent("remove",{});a.setActive(c)}})},setParent:function(a){this.widget=a},setActive:function(a){var b=a.getAttribute("data-tw-grid-item-ID");a.setAttribute("data-tw-grid-item-active",""),a.classList.add(this.activeClass),this.setVisibleView(),this.triggerEvent("add",{key:"id",val:b})},setVisibleView:function(){var a=this.widget.querySelector("[data-tw-grid-item-active]");a&&a.scrollIntoView(!1)},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/grid:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)},unsetActive:function(){for(var a,b=this.widget.querySelectorAll("[data-tw-grid-item-active]"),c=0;c<b.length;c++)a=b[c],a.removeAttribute("data-tw-grid-item-active"),a.classList.remove(this.activeClass)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_core/inline-edit', ["core/str"],function(a){function b(b){var c=this;this.element=b,this.allowEmpty="true"===this.element.getAttribute("data-inline-edit-allow-empty"),this.maxLength=this.element.getAttribute("data-inline-edit-max-length")||0,this.controller=this.element.querySelector("[data-inline-edit-control]"),this.target=this.element.querySelector("[data-inline-edit]");var d=this.element.querySelector("[data-inline-edit-input]");if(!d){var e=this.target.getAttribute("class")||"";this.target.insertAdjacentHTML("afterend",'<input class="'+e+'" data-inline-edit-input type="text">'),d=this.element.querySelector("[data-inline-edit-input]")}this.input=d,this.input.style.display="none";var f=this.element.querySelector("[data-inline-edit-tooltip]");f?d.setAttribute("aria-label",f.textContent):(this.target.insertAdjacentHTML("afterend",'<span data-inline-edit-tooltip class="totara_core__InlineEdit--tooltip"></span>'),f=this.element.querySelector("[data-inline-edit-tooltip]"),a.get_string("inlineedit:instructions","totara_core").done(function(a){f.textContent=a,c.tooltipText=a,d.setAttribute("aria-label",a)})),this.tooltip=f,this.tooltipText=f.textContent,this.tooltip.style.display="none",this.editing=!1}return b.prototype.events=function(){var a=this;this.controller.addEventListener("click",function(b){return b.preventDefault(),b.stopPropagation(),a.edit(),a.hideError(),!1}),this.input.addEventListener("keyup",function(b){switch(b.key){case"Enter":a.save();break;case"Esc":case"Escape":a.cancel();break;case"Space":b.stopPropagation()}if(a.editing){var c=a.input.value.trim().length;a.allowEmpty||0!==c?a.maxLength>0&&c>=a.maxLength?a.showError("maxlength"):a.hideError():a.showError("noempty")}}),this.input.addEventListener("focusout",function(b){a.cancel()}),this.input.addEventListener("click",function(a){a.stopPropagation()})},b.prototype.edit=function(){this.editing||(this.input.value=this.target.textContent.trim(),this.target.style.display="none",this.input.style.display="",this.tooltip.style.display="",this.input.focus(),this.controller.style.display="none",this.editing=!0,this.element.dispatchEvent(new CustomEvent("totara_core/inline-edit:edit",{bubbles:!0,detail:{elem:this.element}})))},b.prototype.save=function(){if(this.editing){var a=this.input.value.trim();if(""===a&&!this.allowEmpty)return void this.cancel();if(a.length>this.maxLength&&this.maxLength>0)return void this.cancel();this.target.textContent=a,this.target.style.display="",this.input.style.display="none",this.tooltip.style.display="none",this.controller.style.display="",this.editing=!1,this.element.dispatchEvent(new CustomEvent("totara_core/inline-edit:save",{bubbles:!0,detail:{text:a,elem:this.element}}))}},b.prototype.cancel=function(){this.editing&&(this.element.dispatchEvent(new CustomEvent("totara_core/inline-edit:cancel",{bubbles:!0,detail:{elem:this.element}})),this.input.value="",this.target.style.display="",this.input.style.display="none",this.tooltip.style.display="none",this.controller.style.display="",this.editing=!1)},b.prototype.showError=function(b){var c=this;this.error=b,a.get_string("inlineedit:"+b,"totara_core").done(function(a){c.error===b&&(c.tooltip.textContent=a,c.tooltip.classList.add("totara_core__InlineEdit--tooltip--error"),c.input.setAttribute("aria-label",a))})},b.prototype.hideError=function(){this.error="",this.tooltip.textContent=this.tooltipText,this.tooltip.classList.remove("totara_core__InlineEdit--tooltip--error")},{init:function(a){return new Promise(function(c){var d=new b(a);d.events(),c(d)})}}});
define('totara_core/select_multi', [],function(){function a(){return this instanceof a?(this.activeClass="tw-selectMulti__link_active",this.activeSelector="data-tw-selector-active",this.clearSelector="data-tw-selectorgroup-clear",this.hideClass="tw-selectMulti__hidden",this.key="",void(this.widget="")):new a}a.prototype={constructor:a,add:function(a){var b=a.getAttribute("data-tw-selectMulti-optionKey"),c=a.querySelector("[data-tw-selectMulti-close]");a.classList.add(this.activeClass),a.setAttribute(this.activeSelector,!0),a.setAttribute("aria-selected",!0),c.classList.remove(this.hideClass),this.triggerEvent("add",{groupValues:this.getAllSelectedValues(),key:this.key,val:b})},clear:function(){for(var a=this.widget.querySelectorAll("["+this.activeSelector+"]"),b=0;b<a.length;b++)this.remove(a[b])},events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.preventDefault(),b.target&&b.target.closest("[data-tw-selectMulti-optionKey]")){var c=b.target.closest("[data-tw-selectMulti-optionKey]");c.getAttribute(a.activeSelector)?a.remove(c):a.add(c),a.triggerEvent("changed",{})}});var b=new MutationObserver(function(){"true"===a.widget.getAttribute(a.clearSelector)&&(a.clear(),a.widget.setAttribute(a.clearSelector,!1))});b.observe(this.widget,{attributes:!0,attributeFilter:[a.clearSelector],subtree:!1})},getAllSelectedValues:function(){for(var a,b=this.widget.querySelectorAll("["+this.activeSelector+"]"),c=[],d=0;d<b.length;d++)a=b[d].getAttribute("data-tw-selectMulti-optionKey"),c.push(a);return c},preset:function(){for(var a=this.widget.querySelectorAll("["+this.activeSelector+"]"),b=0;b<a.length;b++)this.triggerEvent("add",{groupValues:this.getAllSelectedValues(),key:this.key,val:a[b].getAttribute("data-tw-selectMulti-optionKey")})},remove:function(a){var b=a.getAttribute("data-tw-selectMulti-optionKey"),c=a.querySelector("[data-tw-selectMulti-close]");a.removeAttribute(this.activeSelector),a.setAttribute("aria-selected",!1),a.classList.remove(this.activeClass),c.classList.add(this.hideClass),this.triggerEvent("remove",{groupValues:this.getAllSelectedValues(),key:this.key,val:b})},setParent:function(a){this.widget=a},setWidgetKey:function(){this.key=this.widget.getAttribute("data-tw-selectMulti-key")},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/select_multi:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.setWidgetKey(),d.preset(),d.events(),c(d)})};return{init:b}});
define('totara_core/select_region_primary', [],function(){function a(){return this instanceof a?void(this.widget=""):new a}a.prototype={bubbledEventsListener:function(){var a="totara_core/select_multi",b="totara_core/select_search_text",c="totara_core/select_tree",d=this;this.widget.addEventListener(a+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(b+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(c+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(a+":changed",function(){d.triggerEvent("changed",{})}),this.widget.addEventListener(b+":changed",function(){d.triggerEvent("changed",{})}),this.widget.addEventListener(c+":changed",function(){d.triggerEvent("changed",{})}),this.widget.addEventListener(a+":remove",function(a){d.triggerEvent("remove",a.detail)}),this.widget.addEventListener(b+":remove",function(a){d.triggerEvent("remove",a.detail)}),this.widget.addEventListener(c+":remove",function(a){d.triggerEvent("remove",a.detail)})},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/select_region_primary:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.bubbledEventsListener(),c(d)})};return{init:b}});
define('totara_core/accordion', ["core/templates"],function(a){function b(a){if(this.element=a,this.alwaysOpen="false"!==this.element.getAttribute("data-always-open"),this.allowMultiple="true"===this.element.getAttribute("data-allow-multiple"),this.alwaysOpen){var b=this.getOpenChildren();0===b.length&&this.toggleItem(this.getChildren()[0])}}function c(a){return new Promise(function(c){var d=new b(a);d.events(),c(d)})}return b.prototype.events=function(){var a=this,b=function(b){if(!b.target.closest("[data-accordion-noop]")){var c=b.target.closest(".totara_core__Accordion__item");c&&a.toggleItem(c)}};this.element.addEventListener("click",b),this.element.addEventListener("totara_core/accordion:open",function(b){var c=b.target.closest(".totara_core__Accordion__item"),d=b.originalEvent||b;a.toggleItem(c,!0,!!d.suppress)}),this.element.addEventListener("totara_core/accordion:close",function(b){var c=b.target.closest(".totara_core__Accordion__item"),d=b.originalEvent||b;a.toggleItem(c,!1,!!d.suppress)})},b.prototype.getChildren=function(){return this.element.querySelectorAll(".totara_core__Accordion__item")},b.prototype.getOpenChildren=function(){return this.element.querySelectorAll(".totara_core__Accordion__item:not(.collapsed)")},b.prototype.toggleItem=function(b,c,d){var e=!b.classList.contains("collapsed"),f=void 0===c?!e:c;if(!this.alwaysOpen||1!==this.getOpenChildren().length||!e){f&&!this.allowMultiple&&this.closeAllItems(),f?b.classList.remove("collapsed"):b.classList.add("collapsed"),b.querySelector(".totara_core__Accordion__item__header").setAttribute("aria-expanded",f);var g=f?"totara_core|accordion-expanded":"totara_core|accordion-collapsed";a.renderIcon(g).then(function(a){b.querySelector(".totara_core__Accordion__item__header__icon").innerHTML=a}),d||(f?b.dispatchEvent(new CustomEvent("totara_core/accordion:opened",{bubbles:!0,detail:{elem:b}})):b.dispatchEvent(new CustomEvent("totara_core/accordion:closed",{bubbles:!0,detail:{elem:b}})))}},b.prototype.closeAllItems=function(){for(var b=this.getChildren(),c=0;c<b.length;c++){var d=b.item(c);d.classList.add("collapsed"),d.querySelector(".totara_core__Accordion__item__header").setAttribute("aria-expanded",!1)}a.renderIcon("totara_core|accordion-collapsed").then(function(a){for(var c=0;c<b.length;c++){var d=b.item(c);d.classList.contains("collapsed")&&(d.querySelector(".totara_core__Accordion__item__header__icon").innerHTML=a)}})},{init:c}});
define('totara_core/quickaccesssettings', ["core/templates","core/str","core/ajax"],function(a,b,c){function d(a){this.element=a}function e(a){return new Promise(function(b){var c=new d(a);c.events(),b(c)})}return d.prototype.events=function(){function c(a){var c=a.detail.elem,d=a.detail.text;c.closest("[data-quickaccesssettings-item-key]")?(h.save("totara_core_quickaccessmenu_rename_item",{key:c.closest("[data-quickaccesssettings-item-key]").getAttribute("data-quickaccesssettings-item-key"),label:d}).fail(function(){window.location.reload()}),b.get_string("quickaccesssettings:itemlabel","totara_core").done(function(a){c.setAttribute("aria-label",a+" "+d)})):c.closest("[data-quickaccesssettings-group-key]")&&h.save("totara_core_quickaccessmenu_rename_group",{groupkey:c.closest("[data-quickaccesssettings-group-key]").getAttribute("data-quickaccesssettings-group-key"),groupname:d}).fail(function(){window.location.reload()})}function d(b){var c=b.detail,d=c.val,e=b.target.closest(".totara_core__QuickAccessSettings__group"),f=e.getAttribute("data-quickaccesssettings-group-key");h.save("totara_core_quickaccessmenu_add_item",{key:d,group:f}).done(function(b){a.render("totara_core/quickaccesssettings_item",b).done(function(b){var c=h.element.querySelector('[data-quickaccesssettings-item-key="'+d+'"]');c&&c.closest(".totara_core__QuickAccessSettings__item").remove();var f=e.querySelector(".totara_core__QuickAccessSettings__item-list");f.insertAdjacentHTML("beforeend",b),a.runTemplateJS()})}).fail(function(a){window.location.reload()});var g=new CustomEvent("totara_core/select_tree:set-active",{bubbles:!1});c.widget.dispatchEvent(g),c.widget.setAttribute("data-tw-selectorgroup-clear",!0)}function e(){h.save("totara_core_quickaccessmenu_add_group",{groupname:""}).done(function(b){a.render("totara_core/quickaccesssettings_group",b).done(function(b){var c=h.element.querySelector(".totara_core__QuickAccessSettings__group-list");c.insertAdjacentHTML("beforeend",b),a.runTemplateJS()})}).fail(function(){window.location.reload()})}var f,g,h=this;for(this.element.addEventListener("click",function(a){var b=a.target.closest("[data-quickaccesssettings-group-key]"),c=a.target.closest("[data-quickaccesssettings-item-key]"),d="";if(c){if(d=a.target.closest("[data-quickaccesssettings-item-action]"),null!==d)switch(d=d.getAttribute("data-quickaccesssettings-item-action")){case"moveup":j(c.previousElementSibling,c),a.preventDefault(),a.stopPropagation();break;case"movedown":j(c,c.nextElementSibling),a.preventDefault(),a.stopPropagation();break;case"delete":a.preventDefault(),a.stopPropagation(),h.save("totara_core_quickaccessmenu_remove_item",{key:c.getAttribute("data-quickaccesssettings-item-key")}).done(function(){c.remove()}).fail(function(){window.location.reload()})}}else if(b){if(d=a.target.closest("[data-quickaccesssettings-group-action]"),null!==d)switch(b.dispatchEvent(new CustomEvent("totara_core/accordion:close",{bubbles:!0})),d=d.getAttribute("data-quickaccesssettings-group-action")){case"moveup":i(b.previousElementSibling,b),a.preventDefault(),a.stopPropagation();break;case"movedown":i(b,b.nextElementSibling),a.preventDefault(),a.stopPropagation();break;case"delete":a.preventDefault(),h.save("totara_core_quickaccessmenu_remove_group",{groupkey:b.getAttribute("data-quickaccesssettings-group-key")}).done(function(){b.remove()}).fail(function(){window.location.reload()})}}else;},!0),this.element.addEventListener("totara_core/inline-edit:save",c),this.element.addEventListener("totara_core/select_tree:add",d),f=this.element.querySelectorAll("[data-quickaccesssettings-addgroup]"),g=0;g<f.length;g++)f.item(g).addEventListener("click",e);var i=function(a,b){if(a&&b){var c=b.getAttribute("data-quickaccesssettings-group-key"),d=a.getAttribute("data-quickaccesssettings-group-key");h.save("totara_core_quickaccessmenu_move_group_before",{key:c,beforekey:d}).done(function(){b.classList.add("totara_core__QuickAccessSettings__item-swap-up"),a.classList.add("totara_core__QuickAccessSettings__item-swap-down"),M.util.js_pending("totara_core-quickaccesssettings-reorder-item-swap-up"),setTimeout(function(){b.classList.remove("totara_core__QuickAccessSettings__item-swap-up"),a.classList.remove("totara_core__QuickAccessSettings__item-swap-down"),a.parentNode.insertBefore(b,a),M.util.js_complete("totara_core-quickaccesssettings-reorder-item-swap-up")},200)}).fail(function(){window.location.reload()})}},j=function(a,b){if(a&&b){var c=b.getAttribute("data-quickaccesssettings-item-key"),d=a.getAttribute("data-quickaccesssettings-item-key");h.save("totara_core_quickaccessmenu_move_item_before",{key:c,beforekey:d}).done(function(){b.classList.add("totara_core__QuickAccessSettings__item-swap-up"),a.classList.add("totara_core__QuickAccessSettings__item-swap-down"),M.util.js_pending("totara_core-quickaccesssettings-reorder-item-up"),setTimeout(function(){b.classList.remove("totara_core__QuickAccessSettings__item-swap-up"),a.classList.remove("totara_core__QuickAccessSettings__item-swap-down"),a.parentNode.insertBefore(b,a),M.util.js_complete("totara_core-quickaccesssettings-reorder-item-up")},200)}).fail(function(){window.location.reload()})}}},d.prototype.save=function(a,b){b.userid=0;var d=c.call([{methodname:a,args:b}])[0];return M.util.js_pending("totara_core-quickaccesssettings-save"),d.always(function(){M.util.js_complete("totara_core-quickaccesssettings-save")}),d},{init:e}});
define('totara_customfield/field_location_loader', function(){function a(){return b+=1}var b=0;return{load:function(b,c,d,e){var f,g,h;e.isBuild?d():(f="___location_callback"+a(),window[f]=d,g=document.createElement("script"),g.setAttribute("type","text/javascript"),g.setAttribute("async",!0),g.setAttribute("src","https://maps.google.com/maps/api/js?"+b+"&callback="+f),h=document.getElementsByTagName("script")[0],h.parentNode.insertBefore(g,h))}}});
define('totara_customfield/field_location', ["jquery"],function(a){function b(b,c){function d(a,b){return c[a]&&"undefined"!==c[a]&&""!==c[a]?c[a]:b}this.google=b,this.clientid=d("clientid",!1),this.apikey=d("apikey",!1),this.fieldprefix=d("fieldprefix",""),this.fordisplay=d("fordisplay",!1),this.regionbias=d("regionbias",""),this.defaultzoomlevel=d("defaultzoomlevel",12),this.address="",this.location={lat:null,lng:null},this.view=null,this.map=null,this.marker=null,this.input_address=a("#id_"+this.fieldprefix+"address"),this.input_latitude=a("#"+this.fieldprefix+"latitude"),this.input_longitude=a("#"+this.fieldprefix+"longitude"),this.input_zoom=a("#"+this.fieldprefix+"zoom"),this.fieldset=null,this.fordisplay||this.wireDefinitionControls();var e=a("#"+this.fieldprefix+"room-location-view"),f=a("#"+this.fieldprefix+"location_map");if(f.length){if(!this.input_latitude.length)return void f.hide();if(this.location.lat=parseFloat(this.input_latitude.val()),!this.input_longitude.length)return void f.hide();this.location.lng=parseFloat(this.input_longitude.val()),this.fieldset=f.closest("fieldset.collapsible.collapsed"),this.fieldset.length&&(window.form_fieldset_expand=window.form_fieldset_expand||[],window.form_fieldset_expand.push({context:this,callback:this.fieldSetRefreshMap}),this.fieldset.attr("data-location-refresh-"+this.fieldprefix,"true")),this.input_zoom.length?this.location.zoom=parseInt(this.input_zoom.val()):this.location.zoom=this.defaultzoomlevel,this.input_address.length&&(this.address=this.input_address.val().trim()),e.length?"map"==e.val()?this.view=this.google.maps.MapTypeId.ROADMAP:"satellite"==e.val()?this.view=this.google.maps.MapTypeId.SATELLITE:this.view=this.google.maps.MapTypeId.HYBRID:this.view=this.google.maps.MapTypeId.ROADMAP,this.load_map()}}return b.prototype.fieldSetRefreshMap=function(b){this.map&&"true"===a(b).attr("data-location-refresh-"+this.fieldprefix)&&(a(b).attr("data-location-refresh-"+this.fieldprefix,"false"),this.google.maps.event.trigger(this.map,"resize"),this.location.lat=parseFloat(this.input_latitude.val()),this.location.lng=parseFloat(this.input_longitude.val()),this.map.panTo(this.location))},b.prototype.wireDefinitionControls=function(){var b=this,c=this.fordisplay,d=this.input_address,e=a("#id_"+this.fieldprefix+"addresslookup"),f=a('.radio_view[name="'+this.fieldprefix+'view"]'),g=a("#id_"+this.fieldprefix+"searchaddress_btn"),h=a("#id_"+this.fieldprefix+"useaddress_btn");g&&g.on("click",function(){b.address=e.val().trim(),b.geocode_address()}),e&&g&&(b.address=e.keydown(function(a){if(13===a.keyCode)return a.preventDefault(),g.click(),!1})),h&&h.on("click",function(){b.address=d.val().trim(),b.geocode_address()}),f&&f.on("change",function(){this.id.indexOf(b.fieldprefix)>-1&&(b.defaultzoomlevel=b.map.getZoom(),b.set_map_view(),b.load_map(c))})},b.prototype.set_map_view=function(){var b=this,c=a('.radio_view[name="'+this.fieldprefix+'view"]:checked');c.each(function(a,c){if(c.id.indexOf(b.fieldprefix)>-1)switch(c.value){case"hybrid":b.map.setMapTypeId(b.google.maps.MapTypeId.HYBRID),b.view=b.google.maps.MapTypeId.HYBRID;break;case"satellite":b.map.setMapTypeId(b.google.maps.MapTypeId.SATELLITE),b.view=b.google.maps.MapTypeId.SATELLITE;break;default:b.map.setMapTypeId(b.google.maps.MapTypeId.ROADMAP),b.view=b.google.maps.MapTypeId.ROADMAP}})},b.prototype.geocode_address=function(){var b=this,c=this.url_encode_address(this.address),d="https://maps.googleapis.com/maps/api/geocode/json?address="+c+"&region="+this.regionbias;M.util.js_pending("totara_customfield-location_search"),""!==c&&(this.clientid?d+="&client="+this.clientid:this.apikey&&(d+="&key="+this.apikey),a.ajax({url:d,type:"GET",success:function(c,d){"success"==d&&c.results.length>0?(b.address=c.results[0].formatted_address,b.location=c.results[0].geometry.location,b.load_map(),a("#fgroup_id_"+b.fieldprefix+"mapelements .felement .alert").hide(),M.util.js_complete("totara_customfield-location_search")):0===a("#fgroup_id_"+b.fieldprefix+"mapelements .felement .alert").length?require(["core/templates","core/str"],function(c,d){d.get_string("locationnotfound","totara_customfield").done(function(d){c.render("core/notification_error",{message:d}).done(function(c){a("#fgroup_id_"+b.fieldprefix+"mapelements .felement").prepend(c),M.util.js_complete("totara_customfield-location_search")})})}):(a("#fgroup_id_"+b.fieldprefix+"mapelements .felement .alert").show(),M.util.js_complete("totara_customfield-location_search"))},error:function(){window.console&&window.console.log&&window.console.log("Failed to load Google maps API.")}}))},b.prototype.get_zoom_level=function(){return parseInt(this.input_zoom.val())},b.prototype.load_map=function(a){if(a="undefined"!=typeof a?a:this.fordisplay,null!==this.location.lat){var b,c=this,d={center:this.location,zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,mapTypeId:this.view,zoom:this.get_zoom_level()},e="";if(this.map=new this.google.maps.Map(document.getElementById(this.fieldprefix+"location_map"),d),a||this.set_map_view(),this.marker=new this.google.maps.Marker({position:this.location,map:this.map,draggable:!a}),this.input_latitude.val(this.location.lat),this.input_longitude.val(this.location.lng),a){if(!(null!==this.address&&this.address.length>0))return;e=this.address,b=new this.google.maps.InfoWindow({content:e}),this.marker.addListener("click",function(){b.open(c.map,c.marker)})}else this.marker.addListener("drag",function(a){c.input_latitude.val(a.latLng.lat()),c.input_longitude.val(a.latLng.lng())}),this.map.addListener("zoom_changed",function(a){c.input_zoom.val(c.map.getZoom())})}},b.prototype.url_encode_address=function(a){return encodeURI(a.replace(/\s+/g,"+"))},{init:function(a){M.util.js_pending("totara_customfield-location_init"),require(["totara_customfield/field_location_loader!"+a.mapparams],function(){new b(google,a),M.util.js_complete("totara_customfield-location_init")})}}});
define('totara_form/element_filemanager', ["core/yui","core/templates","core/str"],function(a,b,c){return M.totara_form=M.totara_form||{},M.totara_form.element_filemanager=M.totara_form.element_filemanager||{},M.totara_form.element_filemanager.templates=M.totara_form.element_filemanager.templates||{},M.totara_form.element_filemanager.init=function(a,b){var c=function(a){c.superclass.constructor.apply(this,arguments)};c.NAME="FileManager",c.ATTRS={options:{},lang:{}},a.extend(c,a.Base,{api:M.cfg.wwwroot+"/repository/draftfiles_ajax.php",menus:{},initializer:function(b){this.options=b,b.mainfile&&(this.enablemainfile=b.mainfile),this.client_id=b.client_id,this.currentpath="/",this.maxfiles=b.maxfiles,this.maxbytes=b.maxbytes,this.areamaxbytes=b.areamaxbytes,this.emptycallback=null,this.filepicker_options=b.filepicker?b.filepicker:{},this.filepicker_options.client_id=this.client_id,this.filepicker_options.context=b.context,this.filepicker_options.maxfiles=this.maxfiles,this.filepicker_options.maxbytes=this.maxbytes,this.filepicker_options.areamaxbytes=this.areamaxbytes,this.filepicker_options.env="filemanager",this.filepicker_options.itemid=b.itemid,b.filecount?this.filecount=b.filecount:this.filecount=0,this.filemanager=a.one("#filemanager-"+b.client_id),this.filemanager.hasClass("filemanager-container")||!this.filemanager.one(".filemanager-container")?this.dndcontainer=this.filemanager:(this.dndcontainer=this.filemanager.one(".filemanager-container"),this.dndcontainer.get("id")||this.dndcontainer.generateID()),this.filemanager.one(".fp-path-folder")&&(this.pathnode=this.filemanager.one(".fp-path-folder"),this.pathbar=this.pathnode.get("parentNode"),this.pathbar.removeChild(this.pathnode)),this.selectnode=a.Node.create(M.totara_form.element_filemanager.templates.fileselectlayout),this.selectnode.setAttribute("aria-live","assertive"),this.selectnode.setAttribute("role","dialog"),this.selectnode.generateID();var c="fm-dialog-label_"+this.selectnode.get("id");this.selectui=new M.core.dialogue({draggable:!0,headerContent:'<h3 id="'+c+'">'+M.util.get_string("edit","moodle")+"</h3>",bodyContent:this.selectnode,centered:!0,width:"480px",modal:!0,visible:!1}),a.one("#"+this.selectnode.get("id")).setAttribute("aria-labelledby",c),this.selectui.hide(),this.setup_select_file(),this.setup_buttons(),this.filemanager.one(".fp-content").on(["scroll","resize"],this.content_scrolled,this),this.viewmode=1,this.filemanager.all(".fp-vb-icons,.fp-vb-tree,.fp-vb-details").removeClass("checked"),this.filemanager.all(".fp-vb-icons").addClass("checked"),this.refresh(this.currentpath)},wait:function(){this.filemanager.addClass("fm-updating")},request:function(b,c){var d,e=this.api+"?action="+b.action,f={},g=this;if(b.scope&&(g=b.scope),f.sesskey=M.cfg.sesskey,f.client_id=this.client_id,f.filepath=this.currentpath,f.itemid=this.options.itemid?this.options.itemid:0,b.params)for(d in b.params)f[d]=b.params[d];var h={method:"POST",on:{complete:function(c,d,e){if(!d)return void(window.console.log&&window.console.log("IO FATAL"));var f=null;try{f=a.JSON.parse(d.responseText)}catch(h){return g.print_msg(M.util.get_string("invalidjson","repository"),"error"),void a.error(M.util.get_string("invalidjson","repository")+":\n"+d.responseText)}f&&f.tree&&g.set_current_tree&&g.set_current_tree(f.tree),b.callback(c,f,e)}},arguments:{scope:g},headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:build_querystring(f)};b.form&&(h.form=b.form),a.io(e,h),c&&this.wait()},filepicker_callback:function(a){this.filecount++,this.check_buttons(),this.refresh(this.currentpath),"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed()},check_buttons:function(){this.filecount>0?this.filemanager.removeClass("fm-nofiles"):this.filemanager.addClass("fm-nofiles"),this.filecount>=this.maxfiles&&this.maxfiles!=-1?this.filemanager.addClass("fm-maxfiles"):this.filemanager.removeClass("fm-maxfiles")},refresh:function(a){var b=this;this.currentpath=a,a?this.currentpath=a:a=this.currentpath,this.request({action:"list",scope:b,params:{filepath:a},callback:function(a,c,d){b.filecount=c.filecount,b.options=c,b.lazyloading={},b.check_buttons(),b.render(c)}},!0)},print_msg:function(b,c){var d=M.util.get_string("error","moodle");if("error"!=c&&(c="info",d=M.util.get_string("info","moodle")),!this.msg_dlg){this.msg_dlg_node=a.Node.create(M.totara_form.element_filemanager.templates.message);this.msg_dlg_node.generateID();this.msg_dlg=new M.core.dialogue({draggable:!0,bodyContent:this.msg_dlg_node,centered:!0,modal:!0,visible:!1}),this.msg_dlg_node.one(".fp-msg-butok").on("click",function(a){a.preventDefault(),this.msg_dlg.hide()},this)}this.msg_dlg.set("headerContent",d),this.msg_dlg_node.removeClass("fp-msg-info").removeClass("fp-msg-error").addClass("fp-msg-"+c),this.msg_dlg_node.one(".fp-msg-text").setContent(a.Escape.html(b)),this.msg_dlg.show()},is_disabled:function(){return null!==this.filemanager.ancestor(".fitem.disabled")},is_frozen:function(){return this.options.frozen||null!==this.filemanager.ancestor('[data-element-frozen="1"]')},setup_buttons:function(){var b=this.filemanager.one(".fp-btn-download"),c=this.filemanager.one(".fp-btn-mkdir"),d=this.filemanager.one(".fp-btn-add");this.is_frozen()?d&&d.hide():d.on("click",this.show_filepicker,this);var e=this.filemanager.one(".dndupload-arrow");e&&(this.is_frozen()?e.hide():e.on("click",this.show_filepicker,this)),this.options.subdirs&&!this.is_frozen()?c.on("click",function(b){if(b.preventDefault(),!this.is_disabled()&&!this.is_frozen()){var c=this,d=function(b){b.preventDefault();var d=a.one("#fm-newname-"+c.client_id).get("value");return d?void c.request({action:"mkdir",params:{filepath:c.currentpath,newdirname:d},callback:function(b,d,e){var f=d.filepath;c.mkdir_dialog.hide(),c.refresh(f),a.one("#fm-newname-"+c.client_id).set("value",""),"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed()}}):void c.mkdir_dialog.hide()},e=function(){var b=!1,d=a.one("#fm-newname-"+c.client_id).get("value");d.length>0&&(b=!0);var e=a.one("#fm-mkdir-butcreate-"+c.client_id);return e&&e.set("disabled",!b),b};if(!this.mkdir_dialog){var f=a.Node.create(M.totara_form.element_filemanager.templates.mkdir);this.mkdir_dialog=new M.core.dialogue({draggable:!0,bodyContent:f,centered:!0,modal:!0,visible:!1}),f.one(".fp-dlg-butcreate").set("id","fm-mkdir-butcreate-"+this.client_id).on("click",d,this),f.one("input").set("id","fm-newname-"+this.client_id).on("keydown",function(b){var c=a.bind(e,this)();c&&13===b.keyCode&&a.bind(d,this)(b)},this),f.one("#fm-newname-"+this.client_id).on(["keyup","change"],function(b){a.bind(e,this)()},this),f.one("label").set("for","fm-newname-"+this.client_id),f.all(".fp-dlg-butcancel").on("click",function(a){a.preventDefault(),this.mkdir_dialog.hide()},this),f.all(".fp-dlg-curpath").set("id","fm-curpath-"+this.client_id)}this.mkdir_dialog.show();for(var g=M.util.get_string("newfolder","repository");this.has_folder(g);)g=increment_filename(g,!0);a.one("#fm-newname-"+c.client_id).set("value",g),a.bind(e,this)(),a.one("#fm-newname-"+c.client_id).focus().select(),a.all("#fm-curpath-"+c.client_id).setContent(this.currentpath)}},this):(this.filemanager.addClass("fm-nomkdir"),c&&c.hide()),b.on("click",function(b){if(b.preventDefault(),!this.is_disabled()){var c=this,d=this.filemanager.one(".fp-img-downloading");"inline"!=d.getStyle("display")&&(d.setStyle("display","inline"),this.request({action:"downloaddir",scope:c,callback:function(b,d,e){var f=c.filemanager.one(".fp-img-downloading");if(f.setStyle("display","none"),d){c.refresh(d.filepath);var g=a.Node.create("<iframe></iframe>").setStyles({visibility:"hidden",width:"1px",height:"1px"});g.set("src",d.fileurl),a.one("body").appendChild(g)}else c.print_msg(M.util.get_string("draftareanofiles","repository"),"error")}}))}},this),this.filemanager.all(".fp-vb-icons,.fp-vb-tree,.fp-vb-details").on("click",function(a){a.preventDefault();var b=this.filemanager.one(".fp-viewbar");this.is_disabled()||b&&b.hasClass("disabled")||(this.filemanager.all(".fp-vb-icons,.fp-vb-tree,.fp-vb-details").removeClass("checked"),a.currentTarget.hasClass("fp-vb-tree")?this.viewmode=2:a.currentTarget.hasClass("fp-vb-details")?this.viewmode=3:this.viewmode=1,a.currentTarget.addClass("checked"),this.render(),this.filemanager.one(".fp-content").setAttribute("tabIndex","0"),this.filemanager.one(".fp-content").focus())},this)},show_filepicker:function(b){if(b.preventDefault(),!this.is_disabled()&&!this.is_frozen()){var c=this.filepicker_options;c.formcallback=this.filepicker_callback,c.magicscope=this,c.savepath=this.currentpath,M.core_filepicker.show(a,c)}},print_path:function(){var b=this.options.path;if(this.pathbar.setContent("").addClass("empty"),b&&0!==b.length&&2!=this.viewmode){for(var c=0;c<b.length;c++){var d=this.pathnode.cloneNode(!0);this.pathbar.appendChild(d),0===c&&d.addClass("first"),c===b.length-1&&d.addClass("last"),c%2?d.addClass("even"):d.addClass("odd"),d.one(".fp-path-folder-name").setContent(a.Escape.html(b[c].name)).on("click",function(a,b){a.preventDefault(),this.is_disabled()||this.refresh(b)},this,b[c].path)}this.pathbar.removeClass("empty")}},get_filepath:function(a){return a.path&&a.path.length?a.path[a.path.length-1].path:""},treeview_dynload:function(a,b){var c={};if(a.children)for(var d in a.children)c[a.children[d].path]=a.children[d];a.path&&"/"!=a.path||(a.fileinfo.filepath="/",a.fileinfo.type="folder",a.fileinfo.fullname=a.fileinfo.title,a.fileinfo.filename="."),this.request({action:"list",params:{filepath:a.path?a.path:""},scope:this,callback:function(d,e,f){var g,h=e.list,i=f.scope;if(2==i.viewmode&&a&&a.getChildrenEl()){null!==b&&(i.options=e,i.currentpath=a.path?a.path:"/"),a.highlight(!1),a.origlist=e.list?e.list:null,a.origpath=e.path?e.path:null,a.children=[];for(g in h)"folder"==h[g].type&&c[h[g].filepath]?(c[h[g].filepath].fileinfo=h[g],a.children[a.children.length]=c[h[g].filepath]):i.view_files([h[g]]);null===b?a.refresh():b(),i.content_scrolled()}}},!1)},content_scrolled:function(b){setTimeout(a.bind(function(){if(!this.processingimages){this.processingimages=!0;var a=this,b=this.filemanager.one(".fp-content"),c=b.getY(),d=b.getStylePx("height"),e=function(a){var b=a.getY()-c;return b<=d&&(b>=0||b+a.getStylePx("height")>=0)};a.lazyloading&&b.all("img").each(function(b){b.get("id")&&a.lazyloading[b.get("id")]&&e(b)&&b.setImgRealSrc(a.lazyloading)}),this.processingimages=!1}},this),200)},view_files:function(b){if(this.filemanager.removeClass("fm-updating").removeClass("fm-noitems"),null===b&&(!this.options.list||0===this.options.list.length)&&2!=this.viewmode)return void this.filemanager.addClass("fm-noitems");var c,d=null!==b?b:this.options.list;2==this.viewmode||3==this.viewmode?c=a.Node.create(M.totara_form.element_filemanager.templates.listfilename):(this.viewmode=1,c=a.Node.create(M.totara_form.element_filemanager.templates.iconfilename));var e={viewmode:this.viewmode,appendonly:null!==b,filenode:c,callbackcontext:this,callback:function(a,b){a.preventDefault&&a.preventDefault(),"folder"==b.type?this.refresh(b.filepath):this.select_file(b)},rightclickcallback:function(a,b){a.preventDefault&&a.preventDefault(),this.select_file(b)},classnamecallback:function(b){var c="";return"folder"!=b.type&&(b.type||b.filename)||(c+=" fp-folder"),(b.filename||b.filepath||b.path&&"/"!=b.path)&&(c+=" fp-hascontextmenu"),b.isref&&(c+=" fp-isreference"),b.refcount&&(c+=" fp-hasreferences"),b.originalmissing&&(c+=" fp-originalmissing"),1==b.sortorder&&(c+=" fp-mainfile"),a.Lang.trim(c)}};2==this.viewmode&&(e.dynload=!0,e.filepath=this.options.path,e.treeview_dynload=this.treeview_dynload,e.norootrightclick=!0,e.callback=function(a,b){b.fullname&&("folder"!=b.type?(a.node.parent&&a.node.parent.origpath&&(this.options.path=a.node.parent.origpath,this.options.list=a.node.parent.origlist,this.print_path()),this.currentpath=b.filepath,this.select_file(b)):(this.options.path=a.node.origpath,this.options.list=a.node.origlist,this.currentpath=b.filepath,this.print_path()))}),this.lazyloading||(this.lazyloading={}),this.filemanager.one(".fp-content").fp_display_filelist(e,d,this.lazyloading),this.content_scrolled()},populate_licenses_select:function(b){if(b){b.setContent("");var c=this.options.licenses;for(var d in c){var e=a.Node.create("<option/>").set("value",c[d].shortname).setContent(a.Escape.html(c[d].fullname));b.appendChild(e)}}},set_current_tree:function(b){var c=function(a,b){if(b&&b.children&&b.children.length)for(var d in b.children)a[a.length]=b.children[d].filepath,c(a,b.children[d])},d=["/"];c(d,b);var e=this.selectnode,f=e.one(".fp-path select");f.setContent("");for(var g in d)f.appendChild(a.Node.create("<option/>").set("value",d[g]).setContent(a.Escape.html(d[g])))},update_file:function(b){if(this.is_disabled()||this.frozen())return void this.selectui.hide();var c,d,e=this.selectnode,f=this.selectui.fileinfo,g=a.Lang.trim(e.one(".fp-saveas input").get("value")),h=g&&g!=f.fullname,i=e.one(".fp-path select"),j=i.get("selectedIndex"),k=i.get("options").item(j).get("value"),l=k!=this.get_parent_folder_name(f),m=a.Lang.trim(e.one(".fp-author input").get("value")),n=m!=a.Lang.trim(f.author),o=e.one(".fp-license select"),p=o.get("selectedIndex"),q=o.get("options").item(p).get("value"),r=q!=f.license,s={callback:this.update_file,callbackargs:[!0],scope:this};if("folder"==f.type){if(!g)return void this.print_msg(M.util.get_string("entername","repository"),"error");if(h||l){if(!b)return s.message=M.util.get_string("confirmrenamefolder","repository"),void this.show_confirm_dialog(s);c={filepath:f.filepath,newdirname:g,newfilepath:k},d="updatedir"}}else{if(!g)return void this.print_msg(M.util.get_string("enternewname","repository"),"error");if((h||l)&&!b&&f.refcount)return s.message=M.util.get_string("confirmrenamefile","repository",f.refcount),void this.show_confirm_dialog(s);(h||l||r||n)&&(c={filepath:f.filepath,filename:f.fullname,newfilename:g,newfilepath:k,newlicense:q,newauthor:m},d="updatefile")}return d?(e.addClass("loading"),void this.request({action:d,scope:this,params:c,callback:function(a,b,c){b.error?(e.removeClass("loading"),c.scope.print_msg(b.error,"error")):(c.scope.selectui.hide(),c.scope.refresh(b&&b.filepath?b.filepath:"/"),"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed())}})):void this.selectui.hide()},show_confirm_dialog:function(b){if(!this.confirm_dlg){this.confirm_dlg_node=a.Node.create(M.totara_form.element_filemanager.templates.confirmdialog);var c=this.confirm_dlg_node;c.generateID(),this.confirm_dlg=new M.core.dialogue({draggable:!0,bodyContent:c,centered:!0,modal:!0,visible:!1,buttons:{}});var d=function(a){var b=this.confirm_dlg.dlgopt;a.preventDefault(),this.confirm_dlg.hide(),b.callback&&(b.callbackargs?b.callback.apply(b.scope||this,b.callbackargs):b.callback.apply(b.scope||this))},e=function(a){a.preventDefault(),this.confirm_dlg.hide()};c.one(".fp-dlg-butconfirm").on("click",d,this),c.one(".fp-dlg-butcancel").on("click",e,this)}this.confirm_dlg.dlgopt=b,this.confirm_dlg_node.one(".fp-dlg-text").setContent(b.message),this.confirm_dlg.show()},setup_select_file:function(){var a=this.selectnode;a.all(".fp-saveas,.fp-path,.fp-author,.fp-license").each(function(a){a.all("label").set("for",a.one("input,select").generateID())}),this.populate_licenses_select(a.one(".fp-license select"));var b=a.one(".fp-file-update"),c=a.one(".fp-file-download"),d=a.one(".fp-file-delete"),e=a.one(".fp-file-zip"),f=a.one(".fp-file-unzip"),g=a.one(".fp-file-setmain"),h=a.all(".fp-file-cancel");this.is_frozen()?(b&&b.hide(),d&&d.hide(),e&&e.hide(),f&&f.hide(),g&&g.hide(),a.all("form input").each(function(){this.setAttribute("readonly","readonly")}),a.all("form select").each(function(){this.setAttribute("disabled","disabled")})):(b.on("click",function(a){a.preventDefault(),this.update_file()},this),a.all("form").on("keydown",function(a){13==a.keyCode&&(a.preventDefault(),this.update_file())},this),d.on("click",function(a){a.preventDefault();var b={},c={},d=this.selectui.fileinfo;b.scope=this,c.filepath=d.filepath,"folder"==d.type?(c.filename=".",b.message=M.util.get_string("confirmdeletefolder","repository")):(c.filename=d.fullname,d.refcount?b.message=M.util.get_string("confirmdeletefilewithhref","repository",d.refcount):b.message=M.util.get_string("confirmdeletefile","repository")),b.callbackargs=[c],b.callback=function(a){this.request({action:"delete",scope:this,params:a,callback:function(a,b,c){c.scope.filecount--,c.scope.refresh(b.filepath),"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed()}})},this.selectui.hide(),this.show_confirm_dialog(b)},this),e.on("click",function(b){b.preventDefault();var c={},d=this.selectui.fileinfo;"folder"==d.type&&(c.filepath=d.filepath,c.filename=".",a.addClass("loading"),this.request({action:"zip",scope:this,params:c,callback:function(a,b,c){c.scope.selectui.hide(),c.scope.refresh(b.filepath)}}))},this),f.on("click",function(b){b.preventDefault();var c={},d=this.selectui.fileinfo;"zip"==d.type&&(c.filepath=d.filepath,c.filename=d.fullname,a.addClass("loading"),this.request({action:"unzip",scope:this,params:c,callback:function(a,b,c){c.scope.selectui.hide(),c.scope.refresh(b.filepath)}}))},this),g.on("click",function(b){b.preventDefault();var c={},d=this.selectui.fileinfo;this.enablemainfile&&"folder"!=d.type&&(c.filepath=d.filepath,c.filename=d.fullname,a.addClass("loading"),this.request({action:"setmainfile",scope:this,params:c,callback:function(a,b,c){c.scope.selectui.hide(),c.scope.refresh(d.filepath)}}))},this)),c.on("click",function(a){a.preventDefault(),"folder"!=this.selectui.fileinfo.type&&(/iPad|iPhone|iPod/.test(navigator.userAgent)?window.open(this.selectui.fileinfo.url,"_blank"):window.location=this.selectui.fileinfo.url)},this),h.on("click",function(a){a.preventDefault(),this.selectui.hide()},this)},get_parent_folder_name:function(a){if("folder"!=a.type||a.filepath.length<a.fullname.length+1)return a.filepath;var b=a.filepath.substr(0,a.filepath.length-a.fullname.length-1),c=a.filepath.substr(a.filepath.length-a.fullname.length-2);return c=="/"+a.fullname+"/"?b:a.filepath},select_file:function(b){if(!this.is_disabled()){var c=this.selectnode;c.removeClass("loading").removeClass("fp-folder").removeClass("fp-file").removeClass("fp-zip").removeClass("fp-cansetmain"),"folder"==b.type||"zip"==b.type?c.addClass("fp-"+b.type):c.addClass("fp-file"),this.enablemainfile&&1!=b.sortorder&&"file"==b.type&&c.addClass("fp-cansetmain"),this.selectui.fileinfo=b,c.one(".fp-saveas input").set("value",b.fullname);var d=this.get_parent_folder_name(b);c.all(".fp-author input").set("value",b.author?b.author:""),c.all(".fp-license select option[selected]").set("selected",!1),c.all(".fp-license select option[value="+b.license+"]").set("selected",!0),c.all(".fp-path select option[selected]").set("selected",!1),c.all(".fp-path select option").each(function(a){a.get("value")==d&&a.set("selected",!0)}),this.is_frozen()?(c.all(".fp-author input").setAttribute("readonly","readonly"),c.all(".fp-license select").setAttribute("disabled","disabled")):(c.all(".fp-author input").setAttribute("readonly","folder"==b.type?"readonly":""),c.all(".fp-license select").setAttribute("disabled","folder"==b.type?"disabled":""));var e=["datemodified","datecreated","size","dimensions","original","reflist"];for(var f in e)if(c.one(".fp-"+e[f])){var g=b[e[f]+"_f"]?b[e[f]+"_f"]:b[e[f]]?b[e[f]]:"";"reflist"!==e[f]&&(g=a.Escape.html(g)),c.one(".fp-"+e[f]).addClassIf("fp-unknown",""+g=="").one(".fp-value").setContent(g)}var h=a.Node.create("<img/>").set("src",b.realthumbnail?b.realthumbnail:b.thumbnail).setStyle("maxHeight",""+(b.thumbnail_height?b.thumbnail_height:90)+"px").setStyle("maxWidth",""+(b.thumbnail_width?b.thumbnail_width:90)+"px");c.one(".fp-thumbnail").setContent("").appendChild(h),b.isref&&!b.original&&(c.one(".fp-original").removeClass("fp-unknown").addClass("fp-loading"),this.request({action:"getoriginal",scope:this,params:{filepath:b.filepath,filename:b.fullname},callback:function(d,e,f){var g=f.scope;g.selectui.fileinfo&&b&&g.selectui.fileinfo.filepath==b.filepath&&g.selectui.fileinfo.fullname==b.fullname&&(c.one(".fp-original").removeClass("fp-loading"),e.original?(b.original=e.original,c.one(".fp-original .fp-value").setContent(a.Escape.html(b.original))):c.one(".fp-original .fp-value").setContent(M.util.get_string("unknownsource","repository")))}},!1)),c.one(".fp-refcount").setContent(b.refcount?M.util.get_string("referencesexist","repository",b.refcount):""),b.refcount&&!b.reflist&&(c.one(".fp-reflist").removeClass("fp-unknown").addClass("fp-loading"),this.request({action:"getreferences",scope:this,params:{filepath:b.filepath,filename:b.fullname},callback:function(d,e,f){var g=f.scope;if(g.selectui.fileinfo&&b&&g.selectui.fileinfo.filepath==b.filepath&&g.selectui.fileinfo.fullname==b.fullname)if(c.one(".fp-reflist").removeClass("fp-loading"),e.references){b.reflist="";for(var h in e.references)b.reflist+="<li>"+a.Escape.html(e.references[h])+"</li>";c.one(".fp-reflist .fp-value").setContent(b.reflist)}else c.one(".fp-reflist .fp-value").setContent("")}},!1));var i=b.fullname,j=50;i.length>j&&(i=i.substring(0,j)+"...");var k=M.util.get_string("edit","moodle")+" "+i;a.one("#fm-dialog-label_"+c.get("id")).setContent(a.Escape.html(k)),this.selectui.show(),a.one("#"+c.get("id")).focus()}},render:function(){this.print_path(),this.view_files(null)},has_folder:function(a){var b;for(var c in this.options.list)if(b=this.options.list[c],"folder"==b.type&&b.fullname==a)return!0;return!1}});var d=a.one("#filemanager-"+b.client_id);d.removeClass("fm-loading").addClass("fm-loaded");var e=new c(b);if(!b.frozen){var f={filemanager:e,acceptedtypes:b.filepicker.accepted_types,clientid:b.client_id,author:b.author,maxfiles:b.maxfiles,maxbytes:b.maxbytes,areamaxbytes:b.areamaxbytes,itemid:b.itemid,repositories:e.filepicker_options.repositories,containerid:e.dndcontainer.get("id"),contextid:b.context.id};M.form_dndupload.init(a,f)}},{init_filemanager:function(b){var d=[];d.push({key:"edit",component:"moodle"}),d.push({key:"invalidjson",component:"repository"}),d.push({key:"error",component:"moodle"}),d.push({key:"info",component:"moodle"}),d.push({key:"newfolder",component:"repository"}),d.push({key:"invalidjson",component:"repository"}),d.push({key:"draftareanofiles",component:"repository"}),d.push({key:"entername",component:"repository"}),d.push({key:"confirmrenamefolder",component:"repository"}),d.push({key:"enternewname",component:"repository"}),d.push({key:"confirmrenamefile",component:"repository"}),d.push({key:"confirmdeletefolder",component:"repository"}),d.push({key:"confirmdeletefilewithhref",component:"repository"}),d.push({key:"confirmdeletefile",component:"repository"}),d.push({key:"unknownsource",component:"repository"}),d.push({key:"referencesexist",component:"repository"}),d.push({key:"unknownsource",component:"repository"}),d.push({key:"unknownsource",component:"repository"}),c.get_strings(d).done(function(){var c=["moodle-core-notification-dialogue","core_filepicker","base","io-base","node","json","core_dndupload","panel","resize-plugin","dd-plugin"];a.use(c,function(a){M.core_filepicker.set_templates(a,b.filepicker.fptemplates),b.filepicker.fptemplates=null,M.totara_form.element_filemanager.templates=b.fmtemplates,b.fmtemplates=null,M.totara_form.element_filemanager.init(a,b)})})}}});
define('totara_form/element_filepicker', ["core/yui"],function(a){return M.totara_form=M.totara_form||{},M.totara_form.element_filepicker=M.totara_form.element_filepicker||{},M.totara_form.element_filepicker.instances=M.totara_form.element_filepicker.instances||[],M.totara_form.element_filepicker.callback=function(a){var b='<div class="filepicker-container"><a href="'+a.url+'">'+a.file+"</a></div>";b+='<div class="dndupload-progressbars"></div>',M.totara_form.element_filepicker.Y.one("#file_info_"+a.client_id+" .filepicker-filename").setContent(b);var c=M.core_filepicker.instances[a.client_id].options.elementname;M.totara_form.element_filepicker.instances[c].fileadded=!0},M.totara_form.element_filepicker.init=function(a,b){M.totara_form.element_filepicker.Y=a,M.totara_form.element_filepicker.instances[b.elementname]={},M.totara_form.element_filepicker.instances[b.elementname].fileadded=!1,b.formcallback=M.totara_form.element_filepicker.callback,M.core_filepicker.instances[b.client_id]||M.core_filepicker.init(a,b),a.on("click",function(a,b){a.preventDefault(),null===this.ancestor(".fitem.disabled")&&M.core_filepicker.instances[b].show()},"#filepicker-button-"+b.client_id,null,b.client_id);var c=document.getElementById("filepicker-wrapper-"+b.client_id);c&&(c.style.display="");var d={clientid:b.client_id,acceptedtypes:b.accepted_types,author:b.author,maxfiles:-1,maxbytes:b.maxbytes,itemid:b.itemid,repositories:b.repositories,formcallback:b.formcallback,containerprefix:"#file_info_",containerid:"file_info_"+b.client_id,contextid:b.context.id};M.form_dndupload.init(a,d)},{init_filepicker:function(b){a.use(["core_filepicker","node","node-event-simulate","core_dndupload"],function(a){M.core_filepicker.set_templates(a,b.fptemplates),b.fptemplates=null,M.totara_form.element_filepicker.init(a,b)})}}});
define('totara_form/form_element_filepicker', ["jquery","core/yui","totara_form/form"],function(a,b,c){function d(a,b,e,f){return this instanceof d?(c.Element.apply(this,arguments),void(this.input=null)):new d(a,b,e,f)}return d.prototype=Object.create(c.Element.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return"[object FilePickerElement]"},d.prototype.init=function(b){this.input=a("#"+this.id);var d={};try{d=this.input.data("fpoptions")}catch(e){throw c.debug("Failed to pick up FilePicker options from data attribute.",this,c.LOGLEVEL.error),e}return""===d?(c.debug("FilePicker initialisation skipped as it was frozen.",this,c.LOGLEVEL.error),void b()):void require(["totara_form/element_filepicker"],function(a){a.init_filepicker(d),b()})},d});
define('totara_form/form_element_yesno', ["totara_form/form_element_radios"],function(a){function b(c,d,e,f){return this instanceof b?void a.apply(this,arguments):new b(c,d,e,f)}return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return"[object YesNoElement]"},b.prototype.Name="YesNo",b});
define('totara_form/form_element_multiselect', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),this.input=null,void(this.validationerroradded=!1)):new c(a,d,e,f)}var d="totara_form-error-container",e="."+d;return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object MultiSelect]"},c.prototype.init=function(b){var c=this.id,d=a("#"+c);this.input=d,this.input.change(a.proxy(this.changed,this)),b()},c.prototype.polyFillValidate=function(b){var c=!1,d=this.input;this.input.find("option").each(function(b,d){a(d).prop("selected")&&(c=!0)}),c?(this.validationerroradded=!1,d.closest(".tf_element").find(e).remove()):(b.preventDefault(),this.validationerroradded||(this.validationerroradded=!0,require(["core/templates","core/str","core/config"],function(a,b,c){b.get_string("required","core").done(function(b){var e={errors_has_items:!0,errors:[{message:b}]};a.render("totara_form/validation_errors",e,c.theme).done(function(a){d.parent().prepend(a)})})})))},c.prototype.getValue=function(){return this.input.val()},c});
define('totara_form/form_clientaction_onchange_reload', ["jquery","totara_form/form","totara_form/clientaction_base"],function(a,b,c){var d="totara_form/form_clientaction_onchange_reload",e=function(a){var c="undefined"!=typeof arguments[1]?arguments[1]:b.LOGLEVEL.debug;b.debug(a,f,c)},f=function(){c.apply(this,arguments),this.initialValues=[],this.reloadTimeoutID=0,this.reloadFormCallback=a.proxy(this.reloadForm,this),this.ignoredValues=arguments[0].ignoredvalues||[]};return f=b.extend(c,f,{init:function(){var a=this.form.getElementById(this.actionconfig.target);return"undefined"==typeof a?void e("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error):(this.getWatchedIds().push(this.actionconfig.target),this.initialValues[this.actionconfig.target]=a.getValue(),void e("Registered onchange_reload client action for "+this.actionconfig.target))},checkState:function(){var a=!1;this.reloadTimeoutID&&this.cancelReloadForm(),this.getWatchedIds().forEach(function(c){if(a!==!0){e("Checking "+c+" for onchange_reload");var d,f=this.form.getElementById(c);if("undefined"==typeof f)return void e("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error);d=f.getValue();var g=function(a,b){var c;if(Array.isArray(a)&&Array.isArray(b)){if(a.length!==b.length)return!1;for(c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b}(this.initialValues[c],d);g||(this.initialValues[c]=d,this.ignoredValues.indexOf(d.toString())===-1&&(f.showLoading(),a=!0))}},this),a&&(e("Onchange reload client action triggered for "+this.actionconfig.target),this.form.showLoading(),M.util.js_pending(d),this.reloadTimeoutID=setTimeout(this.reloadFormCallback,this.actionconfig.delay))},cancelReloadForm:function(){e("Clearing onchange reload client action timeout for "+this.actionconfig.target),clearTimeout(this.reloadTimeoutID),this.reloadTimeoutID=0,M.util.js_complete(d)},reloadForm:function(){e("Onchange reload client action occurring for "+this.actionconfig.target),this.form.reload(),this.reloadTimeoutID=0,M.util.js_complete(d)},toString:function(){return"[object OnChangeReloadAction]"}}),{init:function(a,b,c){var d=new f(a,b);d.init(),c(d)}}});
define('totara_form/form_group_section', ["jquery","totara_form/form","core/str","core/templates"],function(a,b,c,d){function e(a,c,d){return this instanceof e?(b.Group.call(this,a,c,d),this.fieldset=null,this.legend=null,this.input=null,void(this.link=null)):new e(a,c,d)}return e.prototype=Object.create(b.Group.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return"[object SectionGroup]"},e.prototype.init=function(b){if(this.fieldset=a("#"+this.id),this.legend=a("#"+this.id+" legend.tf_section_legend"),this.input=a("#"+this.id+" input.tf_section_collapsible"),!this.fieldset.hasClass("collapsed")&&!this.fieldset.hasClass("collapsible"))return void b();var c=this;this.fieldset.hasClass("collapsed")?(this.legend.html('<a href="#" role="button" aria-expanded="false">'+this.legend.html()+"</a>"),d.renderIcon("collapsed").done(function(a){c.fieldset.hasClass("collapsed")&&(c.legend.find(".flex-icon").remove(),c.legend.prepend(a))})):(this.legend.html('<a href="#" role="button" aria-expanded="true">'+this.legend.html()+"</a>"),d.renderIcon("expanded").done(function(a){c.fieldset.hasClass("collapsible")&&(c.legend.find(".flex-icon").remove(),c.legend.prepend(a))})),this.link=a("#"+this.id+" legend.tf_section_legend a"),this.link.click(a.proxy(this.toggleCollapsed,this)),e.instances.push(this),e.instancecount++,2===e.instancecount&&e.addExpandAll(this.getForm()),b()},e.prototype.toggleCollapsed=function(a){a.preventDefault(),this.fieldset.hasClass("collapsed")?this.expand():this.collapse()},e.prototype.expand=function(){b.debug("Expanding section "+this.legend.text(),this,b.LOGLEVEL.debug),this.fieldset.removeClass("collapsed"),this.fieldset.addClass("collapsible"),this.link.attr("aria-expanded","true"),this.input.val(1);var a=this;d.renderIcon("expanded").done(function(b){a.fieldset.hasClass("collapsible")&&(a.legend.find(".flex-icon").remove(),a.legend.prepend(b))})},e.prototype.collapse=function(){b.debug("Collapsing section "+this.legend.text(),this,b.LOGLEVEL.debug),this.fieldset.addClass("collapsed"),this.fieldset.removeClass("collapsible"),this.link.attr("aria-expanded","false"),this.input.val(0);var a=this;d.renderIcon("collapsed").done(function(b){a.fieldset.hasClass("collapsed")&&(a.legend.find(".flex-icon").remove(),a.legend.prepend(b))})},e.getValue=function(){return null},e.instancecount=0,e.instances=[],e.expandallcontrol=null,e.addExpandAll=function(f){b.debug("Adding expand/collapse all for sections",this,b.LOGLEVEL.info);var g='<div class="collapsible-actions form-section-expandall-control">';g+='<a href="#" class="collapseexpand" role="button" aria-controls="">&nbsp;-&nbsp;</a>',g+="</div>",f.form.prepend(g),e.expandallcontrol=a(".form-section-expandall-control"),a.when(c.get_string("expandall"),d.renderIcon("collapsed")).done(function(a,b){e.expandallcontrol.find("a").html(b+a)}),e.expandallcontrol.click(a.proxy(this.toggleAll,this)),e.expandallcontrol.data("state","expand")},e.toggleAll=function(b){b.preventDefault();var f,g,h=e.expandallcontrol,i=h.data("state"),j=h.find("a"),k="expand"===i;for(f=0;f<e.instances.length;f++)g=e.instances[f],k?g.expand():g.collapse();k?(h.data("state","collapse"),j.addClass("collapse-all"),a.when(c.get_string("collapseall","core"),d.renderIcon("expanded")).done(function(a,b){j.hasClass("collapse-all")&&j.html(b+a)})):(h.data("state","expand"),j.removeClass("collapse-all"),a.when(c.get_string("expandall","core"),d.renderIcon("collapsed")).done(function(a,b){j.hasClass("collapse-all")||j.html(b+a)}))},e});
define('totara_form/form_element_text', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object TextElement]"},c.prototype.init=function(b){this.input=a("#"+this.id),this.input.change(a.proxy(this.changed,this)),b()},c.prototype.getValue=function(){return this.input.val()},c.prototype.isEmpty=function(){var a=this.getValue();return""===a.toString().trim()||!!a.hasOwnProperty("isEmpty")&&a.isEmpty()},c.prototype.compare=function(a){var c,d=this.getValue();switch(a){case b.Operators.Equals:return 2!==arguments.length?(b.debug("Compare Equals expects 2 arguments, "+arguments.length+" given.",this,b.LOGLEVEL.warn),null):(c=arguments[1],!Array.isArray(c)&&d.toString().trim()===c.toString().trim());case b.Operators.Empty:return this.isEmpty();case b.Operators.Filled:return d=d.toString().trim(),""!==d&&"false"!==d.toLowerCase()&&!/^[0]*$/.test(d);case b.Operators.NotEquals:return 2!==arguments.length?(b.debug("Compare NotEquals expects 2 arguments, "+arguments.length+" given.",this,b.LOGLEVEL.warn),null):(c=arguments[1],!this.compare(b.Operators.Equals,c));case b.Operators.NotEmpty:return!this.isEmpty();case b.Operators.NotFilled:return!this.compare(b.Operators.Filled);default:b.debug('Element does not implement all comparisons: "'+a+'", asking the Form',this,b.LOGLEVEL.warn);var e=[d].concat(arguments);return b.Element.prototype.compare.apply(this,e)}},c});
define('totara_form/form_element_editor_atto', ["jquery","core/yui","core/str","totara_form/form"],function($,Y,core_strings,Form){function AttoElement(a,b,c,d){return this instanceof AttoElement?(Form.Element.apply(this,arguments),this.input=null,void(this.editor=null)):new AttoElement(a,b,c,d)}return AttoElement.prototype=Object.create(Form.Element.prototype),AttoElement.constructor=AttoElement,AttoElement.prototype.toString=function(){return"[object AttoElement]"},AttoElement.prototype.init=function(a){M.util.js_pending("totara_form_element_editor_atto");var b=this;this.input=$("#"+this.id),window.totara_form_editors=window.totara_form_editors||{},window.totara_form_editors[this.id]=this;var c=this.input.data("fptemplates"),d=this.input.data("jsmodules"),e=this.input.data("requiredstrings"),f=this.input.data("yuimodules");Y.use(["core_filepicker","node","node-event-simulate","core_dndupload"],function(a){M.core_filepicker.set_templates(a,c)}),M.yui.add_module(d),Y.applyConfig(YUI_config),core_strings.get_strings(e).done(function(){for(var a=0;a<f.length;a++)b.initYUIModules(f[a])}),a()},AttoElement.prototype.initYUIModules=function(yuimodule){var self=this;Y.use(yuimodule.modules,function(){var result=eval(yuimodule.functionstr);result&&self.setEditor(result)})},AttoElement.prototype.setEditor=function(a){this.editor=a,a.on("change",$.proxy(this.changed,this))},AttoElement.prototype.getValue=function(){return this.editor&&this.editor.updateOriginal(),this.input.val().toString()},AttoElement.prototype.setValue=function(a){this.input.val(a),this.editor&&this.editor.updateFromTextArea(),Form.debug("Atto editor value changed programmatically",this,Form.LOGLEVEL.info),this.changed({})},AttoElement.prototype.compare=function(a){var b,c=this.getValue(),d=null;switch(a){case Form.Operators.Equals:if(2!==arguments.length)return Form.debug("Compare Equals expects 2 arguments, "+arguments.length+" given.",this,Form.LOGLEVEL.warn),null;if(b=arguments[1],Array.isArray(b))return!1;d=c.toString()===b.toString()||this.stripValue(c)===b.toString();break;case Form.Operators.Empty:d=null===c||c===!1||""===c.toString()||"0"===c.toString()||""===this.stripValue(c);break;case Form.Operators.Filled:d=null!==c&&""!==c&&""!==this.stripValue(c);break;case Form.Operators.NotEquals:if(2!==arguments.length)return Form.debug("Compare NotEquals expects 2 arguments, "+arguments.length+" given.",this,Form.LOGLEVEL.warn),null;b=arguments[1],d=!this.compare(Form.Operators.Equals,b);break;case Form.Operators.NotEmpty:d=!this.compare(Form.Operators.Empty);break;case Form.Operators.NotFilled:d=!this.compare(Form.Operators.Filled);break;default:Form.debug('Element does not implement all comparisons: "'+a+'", asking the Form',this,Form.LOGLEVEL.warn);var e=[c].concat(Array.prototype.slice.call(arguments));d=Form.prototype.compare.apply(null,e)}return d},AttoElement.prototype.stripValue=function(a){return a.trim().replace(/^<p[^>]*>(.*)<\/p>$/g,"$1").replace(/<br ?\/?>/g,"").replace("&nbsp;","").trim()},AttoElement.prototype.isEmpty=function(){var a=this.getValue();return""===a||"<p></p>"===a},AttoElement.prototype.getObjectClass=function(a){if(a&&a.constructor){if(a.constructor.name)return a.constructor.name;if(a.constructor.toString){var b=a.constructor.toString().match(/function\s*(\w + )/);if(b&&2==b.length)return b[1]}}},AttoElement});
define('totara_form/form_element_textarea', ["jquery","totara_form/form_element_text"],function(a,b){function c(a,d,e,f){return this instanceof c?void b.apply(this,arguments):new c(a,d,e,f)}return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object TextAreaElement]"},c.prototype.Name="Textarea",c});
define('totara_form/form_element_url', ["totara_form/form_element_text"],function(a){function b(c,d,e,f){return this instanceof b?void a.apply(this,arguments):new b(c,d,e,f)}return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return"[object URLElement]"},b.prototype.Name="URL",b});
define('totara_form/form_group_wizard', ["jquery","totara_form/form","core/templates"],function(a,b){function c(a,d,e){return this instanceof c?(b.Group.apply(this,arguments),void(this.node=e)):new c(a,d,e)}return c.prototype=Object.create(b.Group.prototype),c.constructor=c,c.prototype.toString=function(){return"[object Wizard]"},c.prototype.init=function(b){var c,d=this.getForm(),e=a(this.node),f=e.attr("data-element-id"),g=a("#"+f).attr("data-element-name"),h='[name="'+g+'__changestage"]',i=a(h),j=this,k=a("#"+f+" .tf_wizard_progress"),l="cancelled";a(d.node).on("click",'[name="changestage"]',function(b){b.preventDefault(),c=a(this).data("jump-to-stage"),j.changeStage(d,i,c)}),a(d.node).on("click",'[name="submitbutton"]',function(a){a.preventDefault(),d.submit()}),a(d.node).on("click",'[name="cancelbutton"]',function(a){a.preventDefault(),i.val(l),d.submit()}),k.on("click",".tf_wizard_progress_bar_item",function(b){b.preventDefault(),a(this).hasClass("tf_wizard_progress_bar_item_jumpable")&&(c=a(this).data("jump-to-stage"),j.changeStage(d,i,c))}),b()},c.prototype.changeStage=function(a,b,c){b.val(c),a.reload()},c});
define('totara_form/form_clientaction_onchange_submit', ["jquery","totara_form/form","totara_form/clientaction_base"],function(a,b,c){var d="totara_form/form_clientaction_onchange_submit",e=function(a){var c="undefined"!=typeof arguments[1]?arguments[1]:b.LOGLEVEL.debug;b.debug(a,f,c)},f=function(){c.apply(this,arguments),this.initialValues=[],this.submitTimeoutID=0,this.submitFormCallback=a.proxy(this.submitForm,this),this.ignoredValues=arguments[0].ignoredvalues||[]};return f=b.extend(c,f,{init:function(){var a=this.form.getElementById(this.actionconfig.target);return"undefined"==typeof a?void e("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error):(this.getWatchedIds().push(this.actionconfig.target),this.initialValues[this.actionconfig.target]=a.getValue(),void e("Registered onchange_submit client action for "+this.actionconfig.target))},checkState:function(){var c=!1;this.submitTimeoutID&&this.cancelSubmitForm(),this.getWatchedIds().forEach(function(a){if(c!==!0){e("Checking "+a+" for onchange_submit");var d,f=this.form.getElementById(a);if("undefined"==typeof f)return void e("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error);d=f.getValue();var g=function(a,b){var c;if(Array.isArray(a)&&Array.isArray(b)){if(a.length!==b.length)return!1;for(c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b}(this.initialValues[a],d);g||(this.initialValues[a]=d,this.ignoredValues.indexOf(d.toString())===-1&&(f.showLoading(),c=!0))}},this),c&&(e("Onchange submit client action triggered for "+this.actionconfig.target),this.form.showLoading(),M.util.js_pending(d),this.submitTimeoutID=setTimeout(this.submitFormCallback,this.actionconfig.delay),a(window).on("beforeunload",this.submitFormCallback))},cancelSubmitForm:function(){e("Clearing onchange submit client action timeout for "+this.actionconfig.target),clearTimeout(this.submitTimeoutID),this.submitTimeoutID=0,a(window).off("beforeunload",this.submitFormCallback),M.util.js_complete(d)},submitForm:function(){e("Onchange submit client action occurring for "+this.actionconfig.target),this.form.submit(),this.submitTimeoutID=0,a(window).off("beforeunload",this.submitFormCallback),M.util.js_complete(d)},toString:function(){return"[object OnChangeSubmitAction]"}}),{init:function(a,b,c){var d=new f(a,b);d.init(),c(d)}}});
define('totara_form/form_element_static_html', ["jquery","totara_form/element_generic"],function(a,b){function c(a,d,e,f){return this instanceof c?void b.apply(this,arguments):new c(a,d,e,f)}return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object StaticHTML]"},c.prototype.Name="StaticHTML",c});
define('totara_form/form_element_checkbox', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}var d="totara_form-error-container",e="."+d,f=".tf_element",g=".tf_loading";return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object CheckboxElement]"},c.prototype.init=function(b){var c=a("#"+this.id);this.input=c,this.input.change(a.proxy(this.changed,this)),b()},c.prototype.getValue=function(){return this.input.is(":checked")?this.input.val():this.input.data("value-unchecked")},c.prototype.polyFillValidate=function(a){var b=this.input;b.prop("checked")?""!==b.val().trim()&&b.closest(f).find(e).remove():(a.preventDefault(),0===b.closest(f).find(e).length&&require(["core/templates","core/str","core/config"],function(a,c,d){c.get_string("required","core").done(function(c){var e={errors_has_items:!0,errors:[{message:c}]};a.render("totara_form/validation_errors",e,d.theme).done(function(a){b.parent().prepend(a)})})}))},c.prototype.showLoading=function(){this.input.siblings(g).show()},c.prototype.hideLoading=function(){this.siblings(g).hide()},c});
define('totara_form/form_element_tel', ["jquery","totara_form/form_element_text"],function(a,b){function c(a,d,e,f){return this instanceof c?void b.apply(this,arguments):new c(a,d,e,f)}return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object TelElement]"},c.prototype.Name="Tel",c.prototype.isValid=function(){return this.getValue().match(/d+/)},c});
define('totara_form/form_element_select', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),this.input=null,void(this.validationerroradded=!1)):new c(a,d,e,f)}var d="totara_form-error-container",e="."+d;return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object SelectElement]"},c.prototype.init=function(b){this.input=a("#"+this.id),this.input.change(a.proxy(this.changed,this)),b()},c.prototype.polyFillValidate=function(b){var c=!1,d=this.input;d.find("option").each(function(b,d){a(d).prop("selected")&&""!==a(d).val()&&(c=!0)}),c?(this.validationerroradded=!1,d.closest(".tf_element").find(e).remove()):(b.preventDefault(),this.validationerroradded||(this.validationerroradded=!0,require(["core/templates","core/str","core/config"],function(a,b,c){b.get_string("required","core").done(function(b){var e={errors_has_items:!0,errors:[{message:b}]};a.render("totara_form/validation_errors",e,c.theme).done(function(a){d.parent().prepend(a)})})})))},c.prototype.getValue=function(){return this.input.val()},c.prototype.showLoading=function(){this.input.siblings(".tf_loading").show()},c.prototype.hideLoading=function(){this.siblings(".tf_loading").hide()},c});
define('totara_form/form_clientaction_hidden_if', ["totara_form/form","totara_form/clientaction_base"],function(a,b){var c=function(){this.comparisons=[],b.apply(this,arguments)};return c=a.extend(b,c,{init:function(){var b,d;if(this.actionconfig.comparisons)for(b in this.actionconfig.comparisons)this.actionconfig.comparisons.hasOwnProperty(b)&&(d=this.actionconfig.comparisons[b],this.watchedIds.push(d.element),d.element=this.form.getElementById(d.element),this.comparisons.push(d));a.debug("Registered HiddenIf with "+this.comparisons.length+" comparisons",c,a.LOGLEVEL.debug)},enforce:function(){a.debug("Enforcing HiddenIf rule on #"+this.target.getId(),this,a.LOGLEVEL.info),this.target.setHidden(!0)},cease:function(){a.debug("Ceasing enforcement of HiddenIf rule on #"+this.target.getId(),this,a.LOGLEVEL.info),this.target.setHidden(!1)},checkState:function(){var a,b,c,d,e=this.getCurrentState(),f=!1;for(a in this.comparisons)if(this.comparisons.hasOwnProperty(a)&&(b=this.comparisons[a],c=[b.operator].concat(b.options),d=b.element.compare.apply(b.element,c),d===!0)){f=!0;break}f?e||this.enforce():e&&this.cease()},getCurrentState:function(){return this.target.isHidden()}}),{init:function(a,b,d){var e=new c(a,b);e.init(),d(e)}}});
define('totara_form/form_element_utc10date', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object UTC10Date]"},c.prototype.init=function(b){var c=this.id,d=[];if(this.input=a("#"+c),this.input.change(a.proxy(this.changed,this)),!/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)){var e=a.Deferred();this.input.attr("type","text"),d.push(e),require(["totara_form/polyfill_date-lazy"],function(a){a.init(c,!1).done(function(){e.resolve()})})}a.when.apply(a,d).done(b)},c.prototype.getValue=function(){return this.input.val()},c});
define('totara_form/element_generic', ["totara_form/form"],function(a){function b(c,d,e,f){return this instanceof b?void a.Element.apply(this,arguments):new b(c,d,e,f)}return b.prototype=Object.create(a.Element.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return"[object GenericElement]"},b.prototype.init=function(a){a()},b.prototype.getValue=function(){return null},b.prototype.showLoading=function(){},b.prototype.hideLoading=function(){},b});
define('totara_form/form_element_hidden', ["totara_form/form_element_text"],function(a){function b(c,d,e,f){return this instanceof b?void a.apply(this,arguments):new b(c,d,e,f)}return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return"[object HiddenInput]"},b.prototype.Name="Hidden",b});
define('totara_form/form_element_editor', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.constructor=c,c.prototype.toString=function(){return"[object Editor]"},c.prototype.init=function(b){this.input=a("#"+this.id),this.input.change(a.proxy(this.changed,this)),window.totara_form_editors=window.totara_form_editors||{},window.totara_form_editors[this.id]=this,b()},c.prototype.setValue=function(a){this.input.val(a),this.changed({})},c.prototype.getValue=function(){return this.input.val()},c});
define('totara_form/form_element_filemanager', ["jquery","core/yui","totara_form/form"],function(a,b,c){function d(a,b,e,f){return this instanceof d?(c.Element.apply(this,arguments),void(this.input=null)):new d(a,b,e,f)}return d.prototype=Object.create(c.Element.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return"[object FileManagerElement]"},d.prototype.init=function(b){this.input=a("#"+this.id);var d={};try{d=this.input.data("fmoptions")}catch(e){throw c.debug("Failed to pick up FileManager options from data attribute.",this,c.LOGLEVEL.error),e}return""===d?(c.debug("FileManager could not initialise, no options present.",this,c.LOGLEVEL.error),void b()):void require(["totara_form/element_filemanager"],function(a){a.init_filemanager(d),b()})},d});
define('totara_form/form', ["jquery","core/config","core/templates","core/notification"],function(a,b,c,d){function e(a){var b=new Promise(function(b){var c=document.getElementById(a),d=function(){"true"===c.getAttribute("data-totara_form-initialised")&&(e.disconnect(),b())},e=new MutationObserver(d);e.observe(c,{attributes:!0,attributeFilter:["data-totara_form-initialised"]})});return b}function f(a,b,c,d){return this instanceof f?(this.parent=a,this.type=b,this.id=c,void(this.node=d)):new f(a,b,c,d)}function g(){this.elements={}}function h(a,b,c){return this instanceof h?(f.call(this,a,"totara_form\\form\\group",b,c),void g.call(this)):new h(a,b,c)}function i(c){return this instanceof i?(["el"].forEach(function(a){if(!c.hasOwnProperty(a)){var b='Missing required config property "'+a+'"';throw new Error(b)}}),this.node=c.el,this.id=c.el.getAttribute("id"),this.clientActions=[],this.actionListeners=[],this.form=a(this.node),this.form.data("TotaraForm",this),this.form.attr("action")===b.wwwroot+"/totara/form/ajax.php"&&(k.debug("Form submission for "+this.id+" is being directed via ajaxSubmit",this,k.LOGLEVEL.info),this.form.on("submit.ajaxSubmit",a.proxy(function(a){a.preventDefault(),this.ajaxSubmit(this.form.find("input[type=submit]:focus"))},this))),void g.call(this)):new i(c)}var j=!(!window.console||!b.hasOwnProperty("developerdebug"))&&b.developerdebug;f.prototype={toString:function(){return"[object Element]"},init:function(a){a()},getId:function(){return this.id},getType:function(){return this.type},getNode:function(){return this.node},getValue:function(){return null},compare:function(a){var b=this.getValue(),c=[b].concat(Array.prototype.slice.call(arguments));return i.prototype.compare.apply(null,c)},isEmpty:function(){var a=this.getValue();return null===a||""===a||0===a||a===[]||!!a.hasOwnProperty("isEmpty")&&a.isEmpty()},isHidden:function(){return null!==this.node.getAttribute("data-hidden")},setHidden:function(a){a?(k.debug("#"+this.id+" is now hidden",this,k.LOGLEVEL.debug),this.node.setAttribute("data-hidden","")):(k.debug("#"+this.id+" is no longer hidden",this,k.LOGLEVEL.debug),this.node.removeAttribute("data-hidden"))},changed:function(a){this.getForm().valueChanged(this.getId(),this.getValue())},disable:function(){return!!this.input&&(this.input.setAttribute("disabled",""),!0)},enable:function(){return!!this.input&&(this.input.removeAttribute("disabled"),!0)},isDisabled:function(){return this.input?null!==this.input.getAttribute("disabled"):null},isEnabled:function(){return this.input?null===this.input.getAttribute("disabled"):null},getForm:function(){var a=0,b=function(c){if(a++,a>10)throw"Coding error: element nesting is too deep!";return c.hasOwnProperty("parent")?b(c.parent):c};return b(this.parent)}},g.prototype={registerItem:function(a){j&&this.elements[a.getId()]&&k.debug("Item being registered already exists #"+a.getId(),g,k.LOGLEVEL.error),this.elements[a.getId()]=a},registerGroup:function(a,b){this.registerItem(a);var c=!0;if(j){var d=3e3;window.setTimeout(function(){c===!0&&k.debug("Element #"+a.getId()+" failed to call done() in "+d+"ms",a,k.LOGLEVEL.error)},d)}k.debug("Registered group #"+a.getId()+" of type "+a.getType(),a,k.LOGLEVEL.debug),a.init(function(){k.debug("Completed initialisation of #"+a.getId(),a,k.LOGLEVEL.debug),c=!1,b.resolve(a)})},registerElement:function(a,b){this.registerItem(a);var c=!0;if(j){var d=3e3;window.setTimeout(function(){c===!0&&k.debug("Element #"+a.getId()+" failed to call done() in "+d+"ms",a,k.LOGLEVEL.error)},d)}k.debug("Registered element #"+a.getId()+" of type "+a.getType(),a,k.LOGLEVEL.debug),a.init(function(){k.debug("Completed initialisation of #"+a.getId(),a,k.LOGLEVEL.debug),c=!1,b.resolve(a)})},filterItems:function(b,c,d){var e=[],f=[];if(void 0===d&&(d=0),d++,d>6)return k.debug("Filtering depth exceeds known limits, coding error!",this,k.LOGLEVEL.error),e;if(d>4&&k.debug("Filtering depth nearing limit, check you need this level of depth!",this,k.LOGLEVEL.warn),"function"!=typeof b)throw new Error("You must provide a filter function for filterItems()");for(var g in this.elements)if(this.elements.hasOwnProperty(g)){var i=this.elements[g];b(i)===!0&&(e[g]=i),c===!0&&i instanceof h&&(f=i.filterItems(b,!0,d),e=a.extend(e,f))}return e},getElements:function(a){return this.filterItems(function(a){return!(a instanceof h)&&a instanceof f},a)},getGroups:function(a){return this.filterItems(function(a){return a instanceof h},a)},getElementById:function(a){var b=this.getElements(!0);return b[a]},getGroupById:function(a){var b=this.getGroups(!0);return b[a]},getItemById:function(b){var c=a.extend(this.getElements(!0),this.getGroups(!0));return c[b]},map:function(a){var b=this.elements,c=[];for(var d in b)b.hasOwnProperty(d)&&c.push(a(b[d]));return c},disable:function(){return this.map(function(a){a.disable()}),this},enable:function(){return this.map(function(a){a.enable()}),this},isDisabled:function(){var a=this.map(function(a){return a.isDisabled()});return a.indexOf(!1)===-1},isEnabled:function(){var a=this.map(function(a){return a.isEnabled()});return a.indexOf(!1)===-1},isValid:function(){return this.getElements(!0).every(function(a){if("function"!=typeof a.isValid)return!0;var b=a.isValid();return b||"function"!=typeof a.displayError||a.displayError(),b})},toString:function(){return"[object ElementCollection]"},findItemNodes:function(b){var c=k.attributeIdentifiers.CLASSIFICATION+'="'+k.itemIdentifiers.ELEMENT+'"',d=k.getDataAttributeSelector(c),e=k.attributeIdentifiers.CLASSIFICATION+'="'+k.itemIdentifiers.GROUP+'"',f=k.getDataAttributeSelector(e),g=a(b),h=g.find([d,f].join(", ")).get();return h=Array.prototype.filter.call(h,function(b){return 0===a(b).parentsUntil(g,f).length})},getItemNodes:function(){return this.findItemNodes(this.node)},initGroup:function(b){var c,d,e=this,f={},g=k.attributeIdentifiers,i=a.Deferred();if([g.TYPE,g.ID,g.MODULE].forEach(function(a){f[a.split("-").pop()]=b.getAttribute(a)}),f.module)require([f.module],function(c){var d=new c(e,f.id,b),g=d.getItemNodes(),h=a.Deferred();e.registerGroup(d,h),h.done(function(){d.initItems(g).then(function(){i.resolve()},function(a){k.debug("Failed to initialise the items within a group of type "+f.module,e,k.LOGLEVEL.error),i.reject()})})});else{c=new h(this,f.id,b),d=c.getItemNodes();var j=a.Deferred();this.registerGroup(c,j),j.done(function(){c.initItems(d).done(function(){i.resolve()})})}return i.promise()},initElement:function(b){var c=this,d=a.Deferred(),e={},f=k.attributeIdentifiers;return[f.TYPE,f.ID,f.MODULE].forEach(function(a){e[a.split("-").pop()]=b.getAttribute(a)}),e.module||(e.module="totara_form/element_generic"),require([e.module],function(a){var f=new a(c,e.type,e.id,b);c.registerElement(f,d)}),d.promise()},initItems:function(b){var c=Array.prototype.map.call(b,function(a){return a.getAttribute(k.attributeIdentifiers.CLASSIFICATION)===k.itemIdentifiers.GROUP?this.initGroup(a):a.getAttribute(k.attributeIdentifiers.CLASSIFICATION)===k.itemIdentifiers.ELEMENT?this.initElement(a):void 0},this);return a.when.apply(a,c)}},h.prototype=Object.create(f.prototype),a.extend(h.prototype,g.prototype),h.prototype.constructor=h,h.prototype.toString=function(){return"[object Group]"},h.prototype.init=function(a){a()},i.prototype=Object.create(g.prototype),i.prototype.constructor=i,a.extend(i.prototype,{toString:function(){return"[object Form]"},initClientActions:function(b){var c=this,d=b.map(function(a){return c.initClientAction(a).done(function(a){c.clientActions.push(a)})});return a.when.apply(a,d).done(function(){c.checkAllClientActionStates()})},initClientAction:function(b){var c=this,d=a.Deferred(),e=this.convertTypeToModule(b.actionType);if(!e)throw new Error("Unknown action of type ["+b.actionType+"]");return require([e],function(a){a.init(b,c,function(a){d.resolve(a)})}),d.promise()},convertTypeToModule:function(a){var b=a.split("\\"),c=b[0],d=b.slice(1).join("_"),e=c+"/"+d;return k.debug("Found module to be ["+e+"] from type ["+a+"] by split.",i,k.LOGLEVEL.debug),e},checkModuleExists:function(a){return require.specified(a)},valueChanged:function(a){k.debug("Value of #"+a+" changed",this,k.LOGLEVEL.info),this.checkClientActionState(a)},checkClientActionState:function(a){var b=this.setFormWorking("checkaction");k.debug("Checking ClientActions on #"+a,this,k.LOGLEVEL.debug),this.clientActions.forEach(function(b){b.getWatchedIds().indexOf(a)!==-1&&b.checkState()}),b.resolve()},checkAllClientActionStates:function(){var a=this.setFormWorking("checkallactions");k.debug("Checking the state of all ClientActions",this,k.LOGLEVEL.debug);for(var b in this.clientActions)this.clientActions.hasOwnProperty(b)&&this.clientActions[b].checkState();a.resolve()},addActionListener:function(a){this.actionListeners.push(a)},callActionListener:function(a,b){for(var c in this.actionListeners)this.actionListeners.hasOwnProperty(c)&&this.actionListeners[c].hasOwnProperty(a)&&this.actionListeners[c][a].apply(this,b)},submit:function(){this.form.trigger("submit")},reload:function(a){this.ajaxSubmit(a,!0)},ajaxSubmit:function(c,d){d=d||!1,d?k.debug("Reloading form #"+this.id,this,k.LOGLEVEL.info):k.debug("Submitting form #"+this.id+" by AJAX",this,k.LOGLEVEL.info);var e=this.form.serializeArray(),f=a.Deferred(),g=this.setFormWorking("ajaxsubmit");return f.done(function(){g.resolve()}),void 0!==c&&e.push({name:c.attr("name"),value:c.val()}),d&&(e.push({name:"___tf_reload",value:1}),e.push({name:"___tf_original_action",value:this.form.attr("action")})),a.ajax({type:"POST",url:b.wwwroot+"/totara/form/ajax.php",data:e,context:this,success:function(a){this.ajaxSubmitHandler(f,a)},error:function(a,b,c){f.reject(a,b,c)},dataType:"json"}),f},ajaxSubmitHandler:function(b,e){var f=this;b.done(function(a,b){f.callActionListener(a,[f,b])}),"display"===e.formstatus?(k.debug("Displaying the form after an AJAX reload.",i,k.LOGLEVEL.info),c.render(e.templatename,e.templatedata).done(a.proxy(this.replaceFormContents,this),b.resolve(e.formstatus,e.templatedata.formid)).fail(d.exception)):"cancelled"===e.formstatus?(b.done(function(){k.debug("The form has been cancelled, the calling JS needs to do something.",i,k.LOGLEVEL.success)}),b.resolve(e.formstatus,e)):"submitted"===e.formstatus?(b.done(function(){k.debug("The form has been successfully submit, the calling JS needs to do something.",i,k.LOGLEVEL.success)}),b.resolve(e.formstatus,e.data)):(b.done(function(){k.debug("Unexpected reload result.",i,k.LOGLEVEL.error)}),b.resolve("unknown",e))},replaceFormContents:function(a,b){c.replaceNode(this.form,a,b),M.util.js_pending("totara_form-replaceform"),e(this.form.attr("id")).then(function(){M.util.js_complete("totara_form-replaceform")})},compare:function(b,c){if(null!==b&&!Array.isArray(b)&&("function"==typeof b||"object"==typeof b))return!1;var d,e,f,g=i.prototype.compare,h=Array.isArray(b),j=null;switch(c){case i.Operators.Equals:if(3!==arguments.length)return e=arguments.length,k.debug("Compare NotEquals expects 3 arguments, "+e+" given.",i,k.LOGLEVEL.error),j;if(d=arguments[2],Array.isArray(d))if(!h||b.length<d.length)j=!1;else{j=!0;for(f in d)if(d.hasOwnProperty(f)&&!a.inArray(d[f],b)){j=!1;break}}else if(h){for(f in b)if(b.hasOwnProperty(f)&&b[f].toString()===d.toString()){j=!0;break}}else null===b&&(b=""),j=b.toString()===d.toString();break;case i.Operators.Empty:j=null===b||b===!1||""===b.toString()||"0"===b.toString()||h&&0===b.length;break;case i.Operators.Filled:h?j=b.length>0:(null===b&&(b=""),b=b.toString().trim(),j=""!==b&&"false"!==b.toLowerCase()&&!/^[0]*$/.test(b));break;case i.Operators.NotEquals:if(3!==arguments.length)return e=arguments.length,k.debug("Compare NotEquals expects 3 arguments, "+e+" given.",i,k.LOGLEVEL.error),j;d=arguments[2],j=!g(b,i.Operators.Equals,d);break;case i.Operators.NotEmpty:j=!g(b,i.Operators.Empty);break;case i.Operators.NotFilled:j=!g(b,i.Operators.Filled);break;default:k.debug('Unknown comparison operator given: "'+c+'"',i,k.LOGLEVEL.error)}return j},submitHandler:function(b){var c=b.data.form;if(b.preventDefault(),c.isValid()){var d=a(b.target);d.unbind("submit",c.submitHandler),d.submit()}else k.debug("Failed validation, the responsible element should identify itself.",i,k.LOGLEVEL.warn)},setCustomValidation:function(){var b=a(this.node),c=this;c.node.setAttribute("novalidate",""),b.on("submit.working",{form:c},c.submitHandler)},setFormWorking:function(b){k.debug("Form working on "+b+' "'+this.id+'"',i,k.LOGLEVEL.debug);var c=a.Deferred(),d=this;return c.done(function(){d.setFormReady(b)}),M.util.js_pending("totaraForm_"+this.id+"_"+b),this.form&&this.form.on("submit.working",this.preventSubmissionOnSubmit),c},setFormReady:function(a){k.debug("Form ready after "+a+' "'+this.id+'"',i,k.LOGLEVEL.debug),this.form&&this.form.off("submit.working",this.preventSubmissionOnSubmit),M.util.js_complete("totaraForm_"+this.id+"_"+a)},preventSubmissionOnSubmit:function(a){a.preventDefault()},showLoading:function(){a(k.LOADING,this.node).length>0&&a(k.LOADING,this.node).show()},hideLoading:function(){a(k.LOADING,this.node).length>0&&a(k.LOADING,this.node).hide()}}),i.Operators={Equals:"equals",Empty:"empty",Filled:"filled",NotEquals:"notequals",NotEmpty:"notempty",NotFilled:"notfilled"};var k={Operators:i.Operators,Element:f,Group:h,forms:{},listenerQueue:{},itemIdentifiers:{FORM:"data-totara-form",ELEMENT:"element",GROUP:"group",INPUT:"data-totara-form-element-input",LOADING:".tf_loading_form"},attributeIdentifiers:{ID:"data-element-id",TYPE:"data-element-type",MODULE:"data-element-amd-module",CLASSIFICATION:"data-item-classification"},LOGLEVEL:{none:"none",debug:"debug",info:"info",success:"success",warn:"warn",error:"error"},getDataAttributeSelector:function(a){return"["+a+"]"},init:function(b){k.debug("Initialising form #"+b.id,i,k.LOGLEVEL.info);var c=a("#"+b.id);if(0===c.length)throw new Error("Unable to find form #"+b.id);c=c[0],k.debug("Preventing form #"+b.id+" submission during bootstrapping",i,k.LOGLEVEL.debug);var d,e=new i({el:c}),f=b.actionsConfig,g=a.Deferred();this.forms[e.id]=e,this.listenerQueue.hasOwnProperty(e.id)&&e.addActionListener(this.listenerQueue[e.id]);var h=e.setFormWorking("init");if(d=e.getItemNodes(),0===d.length)throw new Error("Form [#"+this.id+"] must contain at least one element or group.");return e.initItems(d).then(function(){e.initClientActions(f).done(function(){g.resolve(e)})},function(a){k.debug("Failed to initialise items in form #"+b.id,i,k.LOGLEVEL.info)}),g.promise().done(function(a){var c=a.node;k.debug("Re-enabling submission of form #"+c.getAttribute("id"),i,k.LOGLEVEL.debug);var d=a.getElements(!0).some(function(a){return"function"==typeof a.isValid});d&&a.setCustomValidation(),c.setAttribute("data-totara_form-initialised",!0),h.resolve(),k.debug("Initialised form #"+b.id+".",i,k.LOGLEVEL.success)})},extend:function(b,c,d){return c&&"undefined"!==c||(c=function(){b.apply(this,arguments)}),c.prototype=Object.create(b.prototype),c.prototype.constructor=c,a.extend(c.prototype,d),c},load:function(f,g,h,j){var l=a.extend(h,{sesskey:b.sesskey,___tf_formclass:f,___tf_idsuffix:g}),m=a("#"+j),n=a.Deferred();return M.util.js_pending("totara_form-loading"),a.ajax({url:b.wwwroot+"/totara/form/ajax.php",data:l,context:this,success:function(b){"display"===b.formstatus?(k.debug("Displaying the form for the first time.",i,k.LOGLEVEL.debug),m.empty(),c.render(b.templatename,b.templatedata).done(function(d,f){c.replaceNodeContents(a("#"+j),d,f),e(b.templatedata.formid).then(function(){M.util.js_complete("totara_form-loading"),n.resolve("display",b.templatedata.formid)})}).fail(d.exception)):(k.debug("Unexpected form response",i,k.LOGLEVEL.warn),n.reject())},error:function(a,b,c){n.reject(a,b,c)},dataType:"json"}),n.promise()},getFormInstance:function(a){return this.forms.hasOwnProperty(a)?this.forms[a]:null},addActionListeners:function(a,b){var c=this.getFormInstance(a);null===c?this.listenerQueue[a]=b:c.addActionListener(b)},debug:function(a,b,c){if(j){if(!window.console.log.apply)return void(window.console.log&&window.console.log(a));c||(c=k.LOGLEVEL.none),a=b?b.prototype&&b.prototype.constructor&&b.prototype.constructor.name?"%cForm."+b.prototype.constructor.name+": %c"+a:b.constructor&&b.constructor.name?"%cForm."+b.constructor.name+": %c"+a:"%cForm: %c"+a:"%cForm: %c"+a;var d="#cb8bbe",e="#ae45a3";switch(c){case k.LOGLEVEL.debug:window.console.log.apply(window.console,[a,"color: "+d+"; font-style: italic; padding-left:2em;","color: #454545; font-style: italic;"]);break;case k.LOGLEVEL.error:window.console.log.apply(window.console,[a,"color: "+e+"; font-weight: bold;","color: #c74939;"]);break;case k.LOGLEVEL.warn:window.console.log.apply(window.console,[a,"color: "+e+"; font-weight: bold;","color: #c68c25;"]);break;case k.LOGLEVEL.success:window.console.log.apply(window.console,[a,"color: "+e+"; font-weight: bold;","color: #2da833;"]);break;case k.LOGLEVEL.info:window.console.log.apply(window.console,[a,"color: "+e+"; font-weight: bold;","color: #235aac;"]);break;default:window.console.log.apply(window.console,[a,"",""])}}}};return k});
define('totara_form/clientaction_base', ["totara_form/form"],function(a){function b(c,d){this.form=d,this.target=d.getItemById(c.target),this.watchedIds=[],this.actionconfig=c,this.target||a.debug("Unable to find the target element #"+c.target,b,a.LOGLEVEL.error)}return b.prototype={checkState:function(){a.debug("A ClientAction does not override the checkState method.",this,a.LOGLEVEL.error)},getTarget:function(){return this.target},init:function(){},getCurrentState:function(){return null},getWatchedIds:function(){return this.watchedIds}},b});
define('totara_form/form_clientaction_onchange_ajaxsubmit', ["jquery","totara_form/form","totara_form/clientaction_base","core/notification","core/str"],function(a,b,c,d,e){var f="totara_form/form_clientaction_onchange_ajaxsubmit",g=function(a){var c="undefined"!=typeof arguments[1]?arguments[1]:b.LOGLEVEL.debug;b.debug(a,h,c)},h=function(){c.apply(this,arguments),this.initialValues=[],this.ajaxSubmitTimeoutID=0,this.ajaxSubmitFormCallback=a.proxy(this.ajaxSubmitForm,this),this.ignoredValues=arguments[0].ignoredvalues||[],this.submitHandler=arguments[0].submithandler||!1};return h=b.extend(c,h,{init:function(){var a=this.form.getElementById(this.actionconfig.target);return"undefined"==typeof a?void g("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error):(this.getWatchedIds().push(this.actionconfig.target),this.initialValues[this.actionconfig.target]=a.getValue(),void g("Registered onchange_ajaxsubmit client action for "+this.actionconfig.target))},checkState:function(){var a=!1;this.ajaxSubmitTimeoutID&&this.cancelAjaxSubmitForm(),this.getWatchedIds().forEach(function(c){if(a!==!0){g("Checking "+c+" for onchange_ajaxsubmit");var d,e=this.form.getElementById(c);if("undefined"==typeof e)return void g("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error);d=e.getValue();var f=function(a,b){var c;if(Array.isArray(a)&&Array.isArray(b)){if(a.length!==b.length)return!1;for(c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b}(this.initialValues[c],d);f||(this.initialValues[c]=d,this.ignoredValues.indexOf(d.toString())===-1&&(e.showLoading(),a=!0))}},this),a&&(g("Onchange submit by ajax client action triggered for "+this.actionconfig.target),this.form.showLoading(),M.util.js_pending(f),this.ajaxSubmitTimeoutID=setTimeout(this.ajaxSubmitFormCallback,this.actionconfig.delay))},cancelAjaxSubmitForm:function(){g("Clearing onchange submit by ajax client action timeout for "+this.actionconfig.target),clearTimeout(this.ajaxSubmitTimeoutID),this.ajaxSubmitTimeoutID=0,M.util.js_complete(f)},ajaxSubmitForm:function(){g("Onchange submit by ajax client action occurring for "+this.actionconfig.target);var b=this.form.ajaxSubmit();this.submitHandler?this.submitHandler.apply(null,[this,b]):b.done(a.proxy(function(a,b){"submitted"===a?(g("Reloading the form to get an updated version after ajaxsubmit for "+this.actionconfig.target),this.form.reload()):e.get_strings([{key:"error",component:"error"},{key:"ok",component:"core"}]).done(function(a){d.alert(a[0],a[0],a[1])})},this)),b.done(function(){M.util.js_complete(f)}),this.ajaxSubmitTimeoutID=0},toString:function(){return"[object OnChangeAjaxSubmitAction]"}}),{init:function(a,b,c){var d=new h(a,b);d.init(),c(d)}}});
define('totara_form/form_element_checkboxes', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),this.container=null,void(this.inputs=null)):new c(a,d,e,f)}var d="totara_form-error-container",e="."+d;return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object CheckboxesElement]"},c.prototype.init=function(b){var c=a("#"+this.id+" input[type=checkbox]"),d=a(c[0]);if(this.container=a("#"+this.id),this.inputs=c,this.inputs.change(a.proxy(this.changed,this)),this.container.data("required")){var e='input[type="submit"]:not([formnovalidate])',f=this;c.each(function(){a(this).on("change",a.proxy(f.polyFillValidate,f))}),d.closest("form").find(e).click(a.proxy(this.polyFillValidate,this))}b()},c.prototype.getValue=function(){for(var b=[],c=0;c<this.inputs.length;c++){var d=a(this.inputs[c]);d.is(":checked")&&b.push(d.val())}return 0!==b.length&&b},c.prototype.polyFillValidate=function(b){var c=!1,d=this.container;this.inputs.each(function(b,d){a(d).prop("checked")&&(c=!0)}),c?(this.validationerroradded=!1,d.closest(".tf_element").find(e).remove()):(b.preventDefault(),this.validationerroradded||(this.validationerroradded=!0,require(["core/templates","core/str","core/config"],function(a,b,c){b.get_string("required","core").done(function(b){var e={errors_has_items:!0,errors:[{message:b}]};a.render("totara_form/validation_errors",e,c.theme).done(function(a){d.prepend(a)})})})))},c});
define('totara_form/form_element_datetime', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object DateTimeElement]"},c.prototype.init=function(b){var c=this.id,d=[];if(this.input=a("#"+c),this.input.change(a.proxy(this.changed,this)),!/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)){this.input.attr("type","text");var e=a.Deferred();d.push(e),require(["totara_form/polyfill_date-lazy"],function(a){a.init(c,!0).then(function(){e.resolve()})})}a.when.apply(a,d).done(b)},c.prototype.getValue=function(){return this.input.val()},c});
define('totara_form/form_element_email', ["jquery","totara_form/form_element_text"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.apply(this,arguments),void(this.Name="Email")):new c(a,d,e,f)}return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object EmailElement]"},c});
define('totara_form/form_element_passwordunmask', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(this.input=null,this.unmaskinput=null,void b.Element.apply(this,arguments)):new c(a,d,e,f)}return String.prototype.repeat||(String.prototype.repeat=function(a){"use strict";if(null==this)throw new TypeError("can't convert "+this+" to object");var b=""+this;if(a=+a,a!=a&&(a=0),a<0)throw new RangeError("repeat count must be non-negative");if(a==1/0)throw new RangeError("repeat count must be less than infinity");if(a=Math.floor(a),0==b.length||0==a)return"";if(b.length*a>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var c="";1==(1&a)&&(c+=b),a>>>=1,0!=a;)b+=b;return c}),c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object PasswordUnmaskElement]"},c.prototype.init=function(b){var c,d=this.id,e=a("#"+d);this.input=e,this.unmaskinput=a("#"+d+"unmask"),this.wrap=this.input.parent(".wrap"),c=a('<input type="text" value="" class="inputmask" />'),this.input.attr("readonly")&&c.attr("readonly","readonly"),c.insertBefore("#"+d),this.mask=this.wrap.find(".inputmask"),this.updateMask(),this.mask.focus(function(a){e.focus()}),this.unmaskinput.change(a.proxy(this.unmask,this)),this.input.keyup(a.proxy(this.updateMask,this)),this.input.mouseup(),this.input.change(a.proxy(this.changed,this)),b()},c.prototype.updateMask=function(){this.mask.val("●".repeat(this.input.val().length))},c.prototype.unmask=function(){this.unmaskinput.is(":checked")?this.input.parents(".totara_form_element_passwordunmask").addClass("unmask-password"):this.input.parents(".totara_form_element_passwordunmask").removeClass("unmask-password")},c.prototype.getValue=function(){return this.input?this.input.val():null},c});
define('totara_form/form_element_radios', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),this.container=null,this.inputs=null,void(this.validationerroradded=!1)):new c(a,d,e,f)}var d="totara_form-error-container",e="."+d;return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object RadiosElement]"},c.prototype.init=function(b){var c=this.id,d=a("#"+c),e=a("#"+c+" input[type=radio]");this.container=d,this.inputs=e,this.inputs.change(a.proxy(this.changed,this)),b()},c.prototype.polyFillValidate=function(b){var c=!1,d=this.container;this.inputs.each(function(b,d){a(d).prop("checked")&&(c=!0)}),c?(this.validationerroradded=!1,d.closest(".tf_element").find(e).remove()):(b.preventDefault(),this.validationerroradded||(this.validationerroradded=!0,require(["core/templates","core/str","core/config"],function(a,b,c){b.get_string("required","core").done(function(b){var e={errors_has_items:!0,errors:[{message:b}]};a.render("totara_form/validation_errors",e,c.theme).done(function(a){d.prepend(a)})})})))},c.prototype.getValue=function(){for(var b=0;b<this.inputs.length;b++){var c=a(this.inputs[b]);if(c.is(":checked"))return c.val()}return!1},c.prototype.showLoading=function(){a(this.inputs).filter(":checked").siblings(".tf_loading").show()},c.prototype.hideLoading=function(){this.inputs.siblings(".tf_loading").hide()},c});
define('totara_form/form_element_number', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(this.input=null,void b.Element.apply(this,arguments)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object NumberInputElement]"},c.prototype.init=function(b){this.input=a("#"+this.id),this.input.change(a.proxy(this.changed,this)),b()},c.prototype.getValue=function(){return this.input.val()},c});
define('totara_hierarchy/hierarchyitems', ["jquery","core/config"],function(a,b){var c={init:function(b){var d=".list-assignedcompetencies .linktype, #list-evidence .linktype, #list-coursecompetency .linktype";a(document).on("change",d,function(){c._update_linktype(b,a(this).data("id"),a(this).val())})},_update_linktype:function(c,d,e){var f={type:c,c:d,sesskey:b.sesskey,t:e};a.get(b.wwwroot+"/totara/plan/update-linktype.php",f)}};return c});
define('totara_hierarchy/mygoals', ["jquery","core/config"],function(a,b){var c={init_company:function(b,d){a("#companygoals").on("change",".company_scalevalue_selector",function(){c._update_goal(b,d,a(this).data("goalid"),a(this).val())})},init_personal:function(b,d){a("#personalgoals").on("change",".personal_scalevalue_selector",function(){c._update_goal(b,d,a(this).data("goalid"),a(this).val())})},init_single_personal:function(b,d){a("#page-totara-hierarchy-prefix-goal-item-view .personal_scalevalue_selector").change(function(){c._update_goal(b,d,a(this).data("goalid"),a(this).val())})},_update_goal:function(c,d,e,f){var g={scope:d,sesskey:b.sesskey,goalitemid:e,userid:c,scalevalueid:f};a.get(b.wwwroot+"/totara/hierarchy/prefix/goal/update-scalevalue.php",g)}};return c});
define('totara_hierarchy/competency_item', ["jquery","core/config","core/str"],function(a,b,c){var d=function(d,e){if(c.get_string("assignrelatedcompetencies","totara_hierarchy").done(function(a){var c=b.wwwroot+"/totara/hierarchy/prefix/competency/related/";totaraMultiSelectDialog("related",a,c+"find.php?sesskey="+b.sesskey+"&id="+d,c+"save.php?sesskey="+b.sesskey+"&id="+d+"&deleteexisting=1&add=")}),"undefined"!=typeof e&&e)totaraDialog_handler_assignEvidence=function(){},totaraDialog_handler_assignEvidence.prototype=new totaraDialog_handler_treeview,totaraDialog_handler_assignEvidence.prototype._handle_update_hierarchy=function(b){var c=this;a("span",b).click(function(){var b=a(this).parent(),d=b.attr("id").substr(10);"cat"!=d.substr(0,3)&&c._handle_course_click(d)})},totaraDialog_handler_assignEvidence.prototype._handle_course_click=function(a){var b=this.baseurl+"course.php?id="+a+"&competency="+d;this._dialog.showLoading(),this._dialog._request(b,{object:this,method:"_display_evidence"})},totaraDialog_handler_assignEvidence.prototype._display_evidence=function(c){this._dialog.hideLoading(),a(".selected",this._dialog.dialog).html(c);var e=this;a("#available-evidence",this._dialog.dialog).find(".addbutton").click(function(c){c.preventDefault();var f=a(this).parent().attr("type"),g=a(this).parent().attr("id"),h=e.baseurl+"add.php?sesskey="+b.sesskey+"&competency="+d+"&type="+f+"&instance="+g;e._dialog._request(h,{object:e,method:"_update"})})};else{totaraDialog_handler_compEvidence=function(){},totaraDialog_handler_compEvidence.prototype=new totaraDialog_handler_treeview_multiselect,totaraDialog_handler_compEvidence.prototype._update=function(b){this._dialog.hide(),a(".noitems-"+this._title).remove();var c=a(b).find("#list-evidence"),d=a("#list-evidence");d.length?d.replaceWith(c):a("div#evidence-list-container").append(c)};var f=b.wwwroot+"/totara/hierarchy/prefix/competency/evidenceitem/",g=f+"add.php?sesskey="+b.sesskey+"&competency="+d+"&type=coursecompletion&instance=0&deleteexisting=1&update=",h={},i=new totaraDialog_handler_compEvidence;i.baseurl=f;var j=[];j.push({key:"save",component:"totara_core"}),j.push({key:"cancel",component:"moodle"}),j.push({key:"assigncoursecompletions",component:"totara_hierarchy"}),c.get_strings(j).done(function(a){for(var b=[],c=0;c<j.length;c++)b[j[c].key]=a[c];h[b.save]=function(){i._save(g)},h[b.cancel]=function(){i._cancel()},totaraDialogs.evidence=new totaraDialog("evidence","show-evidence-dialog",{buttons:h,title:"<h2>"+b.assigncoursecompletions+"</h2>"},f+"edit.php?id="+d,i)})}if("undefined"!=typeof e&&e){var j=[];j.push({key:"cancel",component:"moodle"}),j.push({key:"assignnewevidenceitem",component:"totara_hierarchy"}),c.get_strings(j).done(function(a){for(var c=[],e=0;e<j.length;e++)c[j[e].key]=a[e];var f=b.wwwroot+"/totara/hierarchy/prefix/competency/evidenceitem/",g={},h=new totaraDialog_handler_assignEvidence;h.baseurl=f,g[c.cancel]=function(){h._cancel()},totaraDialogs.evidence=new totaraDialog("evidence","show-evidence-dialog",{buttons:g,title:"<h2>"+c.assignnewevidenceitem+"</h2>"},f+"edit.php?id="+d,h)})}};return{item:function(b,c){var e=a.Deferred();e.done(function(){d(b,c)}),window.dialogsInited?e.resolve():(a.isArray(window.dialoginits)||(window.dialoginits=[]),window.dialoginits.push(e.resolve))},template:function(d){var e=a.Deferred();e.done(function(){var a=b.wwwroot+"/totara/hierarchy/prefix/competency/template/";c.get_string("assignnewcompetency","competency").done(function(b){totaraMultiSelectDialog("assignment","<h2>"+b+"</h2>",a+"find_competency.php?templateid="+d,a+"save_competency.php?templateid="+d+"&deleteexisting=1&add=")})}),window.dialogsInited?e.resolve():(a.isArray(window.dialoginits)||(window.dialoginits=[]),window.dialoginits.push(e.resolve))}}});
define('totara_job/job_management_listing', ["jquery","core/ajax","core/notification","core/str"],function(a,b,c,d){function e(b){this.items=[],this.userid=b;var c=this;this.container=a('[data-enhance="job-management-listing"][data-enhanced="false"][data-userid="'+b+'"]'),this.container&&(this.container.attr("data-enhanced","true"),this.container.find("li a.editjoblink[data-id]").each(function(){var b=a(this),d=b.data("id"),e=b.data("sortorder");c.register_item(d,e,b)}),this.container.delegate("a[data-action]","click",function(b){b.preventDefault(),b.stopPropagation();var d=a(b.currentTarget),e=d.data("action"),f=d.data("id");"up"===e?c.move_item_up(f):"down"===e?c.move_item_down(f):"delete"===e&&c.confirm_delete(f)}))}return e.prototype.userid=null,e.prototype.items=[],e.prototype.container=null,e.prototype.register_item=function(b,c,d){a(d).parent("li").find("a[data-action]").each(function(){a(this).attr("data-id",b)}),this.items.push({id:b,sortorder:c})},e.prototype.confirm_delete=function(b){var e=this.container.find('a.editjoblink[data-id="'+b+'"]'),f=this,g=[],h=a.ajax({url:M.cfg.wwwroot+"/totara/job/dialog/get_deletion_notification.php",type:"GET",data:{sesskey:M.cfg.sesskey,userid:this.userid,jobassignmentid:b,jobassignmenttext:e.text()}});h.done(function(a){g.jobassignment=e.text();var h=d.get_strings([{key:"deletejobassignment",component:"totara_job",param:null,lang:null},{key:"confirmdeletejobassignment",component:"totara_job",param:g,lang:null},{key:"yesdelete",component:"totara_core",param:null,lang:null},{key:"cancel",component:"core",param:null,lang:null}]);h.done(function(d){a&&(d[1]=a),d.push(function(){M.util.js_pending("totara_job-delete");var a=f.delete_job_assignment(b);a.done(function(){M.util.js_complete("totara_job-delete")})}),c.confirm.apply(c.confirm,d)})}).fail(c.exception)},e.prototype.delete_job_assignment=function(c){var d=[{methodname:"totara_job_external_delete_job_assignment",args:{userid:this.userid,jobassignmentid:c}}],e=a.Deferred(),f=this,g=b.call(d,!0,!0);return a.when.apply(null,g).done(function(){f.update_list(arguments[0]),e.resolve()}).fail(function(a){e.reject(a)}),e.promise()},e.prototype.move_item_up=function(b){var c=0,d=0,e=!1,f=this.get_item_by_id(b),g=this.container.find("ul");if(f===!1)return!1;for(c in this.items)this.items.hasOwnProperty(c)&&this.items[c].sortorder>=d&&this.items[c].sortorder<f.sortorder&&(e=this.items[c],d=this.items[c].sortorder);if(!e)return!1;M.util.js_pending("totara_job-move_item_up");var h=this.switch_items(e,f);h.done(function(){var b=a(g.find('a.editjoblink[data-id="'+f.id+'"]').parents("li")[0]);b.fadeOut(50,function(){b.css({backgroundColor:"#fefdb2"})}).fadeIn(500,function(){b.css({backgroundColor:"initial"})}),M.util.js_complete("totara_job-move_item_up")})},e.prototype.move_item_down=function(b){var c=0,d=2147483646,e=!1,f=this.get_item_by_id(b),g=this.container.find("ul");if(f===!1)return!1;for(c in this.items)this.items.hasOwnProperty(c)&&this.items[c].sortorder<=d&&this.items[c].sortorder>f.sortorder&&(e=this.items[c],d=this.items[c].sortorder);if(!e)return!1;M.util.js_pending("totara_job-move_item_down");var h=this.switch_items(e,f);h.done(function(){var b=a(g.find('a.editjoblink[data-id="'+f.id+'"]').parents("li")[0]);b.fadeOut(50,function(){b.css({backgroundColor:"#fefdb2"})}).fadeIn(500,function(){b.css({backgroundColor:"initial"})}),M.util.js_complete("totara_job-move_item_down")})},e.prototype.get_item_by_id=function(a){var b;for(b in this.items)if(this.items.hasOwnProperty(b)&&this.items[b].id==a)return this.items[b];return!1},e.prototype.switch_items=function(c,d){var e,f=!1,g=d.sortorder,h=!1,i=c.sortorder,j=[],k=a.Deferred(),l=this;for(e in this.items)this.items.hasOwnProperty(e)&&(this.items[e].id===c.id&&(this.items[e].sortorder=g,f=e),this.items[e].id===d.id&&(this.items[e].sortorder=i,h=e),j.push({jobassignid:this.items[e].id,sortorder:this.items[e].sortorder}));if(!f&&!h)return k.reject(),k.promise();var m=[{methodname:"totara_job_external_resort_job_assignments",args:{userid:this.userid,sort:j}}],n=b.call(m,!0,!0);return a.when.apply(null,n).done(function(){l.update_list(arguments[0]),k.resolve()}).fail(function(a){k.reject(a)}),k.promise()},e.prototype.update_list=function(a){var b,c,d,e,f,g,h,i=[],j=this.container.find("ul");for(b in a)if(a.hasOwnProperty(b)){d=a[b].jobassignid,e=a[b].sortorder,h=!1;for(c in this.items)if(this.items.hasOwnProperty(c)&&this.items[c].id==d){this.items[c].sortorder=e,h=!0;break}if(!h)continue;f=this.container.find('a[data-id="'+d+'"]'),f.attr("data-sortorder",e),g=f.parent("li"),i.push("<li>"+g.html()+"</li>")}j.empty(),j.append.apply(j,i),this.container.attr("data-jobcount",i.length)},{init:function(a){return new e(a)}}});
define('totara_plan/component', ["jquery","core/config"],function(a,b){var c={config:{},totaraDialog_handler_preRequisite:null,init:function(b){b&&("string"==typeof b&&(b=a.parseJSON(b)),c.config=b),c.add_handlers(),c.totaraDialog_handler_preRequisite=function(){},c.totaraDialog_handler_preRequisite.prototype=new totaraDialog_handler_treeview_multiselect,c.totaraDialog_handler_preRequisite.prototype._update=function(a){this._dialog.hide(),c.totara_totara_plan_update(a)}},add_handlers:function(){jQuery("table.dp-plan-component-items input, table.dp-plan-component-items select").change(function(){var d={updatesettings:"1",ajax:"1",sesskey:b.sesskey,page:c.config.page};d[a(this).attr("name")]=a(this).val(),a.post(b.wwwroot+"/totara/plan/component.php?id="+c.config.plan_id+"&c="+c.config.component_name+"&page="+c.config.page,d,c.totara_totara_plan_update)})},totara_totara_plan_update:function(b){a(".noitems-assign"+c.config.component_name).remove();var d=a(b).find("table.dp-plan-component-items"),e=a(b).filter(".plan_box"),f=a(b).filter(".paging")[0],g=a("form#dp-component-update table.dp-plan-component-items"),h=a(b).filter("span.noitems-assign"+c.config.component_name),i=a("div#dp-component-update-submit");h.length?(a("form#dp-component-update div#dp-component-update-table").append(h),g.empty(),i.hide()):g.length?(g.replaceWith(d),i.show()):(a("form#dp-component-update div#dp-component-update-table").append(d),i.show()),a("div.plan_box").replaceWith(e),a(".paging").replaceWith(f),c.add_handlers(),require(["core/str"],function(a){a.get_string("datepickerlongyeardisplayformat","totara_core").done(function(a){M.totara_core.build_datepicker(null,"[id^=duedate_"+c.config.component_name+"]",a)})})}};return c});
define('totara_plan/templates', ["jquery"],function(a){var b={templates:{},totaraDialog_handler_preRequisite:null,init:function(c){c&&(this.templates=c),a("select#id_templateid").change(function(){var c=a(this),d=c.val();a("input#id_name").val(b.templates[d].fullname);var e=b.templates[d].enddate;a("#id_enddate_day").val(e.mday),a("#id_enddate_month").val(e.mon),a("#id_enddate_year").val(e.year)})}};return b});
define('totara_program/management', [],function(){return{init_autosubmit:function(a){var b=document.getElementById(a);b.addEventListener("change",function(a){a.preventDefault(),b.closest("form").submit()})}}});
define('totara_program/assignments', ["core/ajax","core/templates","core/config","core/notification","core/str"],function(a,b,c,d,e){function f(a){var b=this;this.node=a,this.assignments=[],this.categories=[],this.recent=!1,this.searchTerm="",this.strings={},this.dialog=null,this.baseURL=c.wwwroot+"/totara/program/assignment/",this.programId=parseInt(a.getAttribute("data-totara_program-id"),10),this.canupdate="1"===a.getAttribute("data-totara_program-canupdate"),this.typeid=0,this.actualduedatesdialog=null,this.config={COMPLETION_EVENT_ENROLLMENT_DATE:"6",COMPLETION_EVENT_FIRST_LOGIN:"1",COMPLETION_EVENT_NONE:"0",COMPLETION_TIME_NOT_SET:"-1",CONDENSED_LIMIT:5},this.addOptions=[],M.util.js_pending("totara_program--assignments-strings"),this.stringsPromise=new Promise(function(a){var d=[{component:"totara_program",key:"ok"},{component:"totara_program",key:"remove"},{component:"totara_program",key:"cancel"},{component:"totara_program",key:"setduedate"},{component:"totara_program",key:"completioncriteria"},{component:"totara_program",key:"addorganisationstoprogram"},{component:"totara_program",key:"addpositionstoprogram"},{component:"totara_program",key:"addcohortstoprogram"},{component:"totara_program",key:"addindividualstoprogram"},{component:"totara_program",key:"addmanagerstoprogram"}];e.get_strings(d).done(function(d){b.strings.ok=d[0],b.strings.remove=d[1],b.strings.cancel=d[2],b.strings.setduedate=d[3],b.strings.completioncriteria=d[4],b.addOptions[1]={name:"organisations",url:"find_hierarchy.php?type=organisation",text:d[5],notificationKey:"assignmentsaddedorgainisation"},b.addOptions[2]={name:"positions",url:"find_hierarchy.php?type=position",text:d[6],notificationKey:"assignmentsaddedposition"},b.addOptions[3]={name:"cohorts",url:"find_cohort.php?sesskey="+c.sesskey,text:d[7],notificationKey:"assignmentsaddedaudience"},b.addOptions[5]={name:"individuals",url:"find_individual.php?",text:d[8],notificationKey:"assignmentsaddedindividual"},b.addOptions[6]={name:"managers",url:"find_manager_hierarchy.php?",text:d[9],notificationKey:"assignmentsaddedposition"},M.util.js_complete("totara_program--assignments-strings"),a()})}),M.util.js_pending("totara_program--assignments-dialogs"),this.dialogPromise=new Promise(function(a){window.dialogsInited?(a(),M.util.js_complete("totara_program--assignments-dialogs")):(window.dialoginits=window.dialoginits||[],window.dialoginits.push(function(){a(),M.util.js_complete("totara_program--assignments-dialogs")}))})}function g(a){return new Promise(function(b){var c=new f(a);c.events(),b(c)})}return f.prototype.events=function(){var a=this;this.node.addEventListener("totara_core/select_search_text:add",function(b){a.searchTerm=b.detail.val}),this.node.addEventListener("totara_core/select_search_text:remove",function(b){a.searchTerm=b.detail.val}),this.node.addEventListener("totara_core/select_search_text:changed",a.filter.bind(a)),this.node.addEventListener("totara_core/select_region_panel:add",function(b){switch(b.detail.key){case"recent":a.recent=!0;break;case"type":a.categories=b.detail.groupValues}}),this.node.addEventListener("totara_core/select_region_panel:remove",function(b){switch(b.detail.key){case"recent":a.recent=!1;break;case"type":a.categories=b.detail.groupValues}}),this.node.addEventListener("totara_core/select_region_panel:changed",a.filter.bind(a)),this.node.addEventListener("change",function(b){if("totara_program-assignment--add-users"===b.target.id&&(b.preventDefault(),a.startAdd(b.target.value)),"update-below"===b.target.getAttribute("data-totara_program__assignments--action")){b.preventDefault();var c=b.target.closest("[data-totara_program__assignment-id]"),d=c.getAttribute("data-totara_program__assignment-id"),e=0;switch(c.classList.add("totara_program__assignments__loading"),b.target.tagName.toLowerCase()){case"input":e=b.target.checked?1:0;break;case"select":e=b.target.value}a.updateBelow(d,e)}}),this.node.addEventListener("click",function(b){var c=b.target.closest("[data-totara_program__assignments--action]");if(null!==c){var d=b.target.closest("[data-totara_program__assignment-id]"),e=parseInt(d.getAttribute("data-totara_program__assignment-id"),10);switch(c.getAttribute("data-totara_program__assignments--action")){case"delete":b.preventDefault(),a.deleteAssignment(e);break;case"change-due-date":b.preventDefault(),a.startChangeDuedate(e);break;case"remove-due-date":b.preventDefault(),a.removeDueDate(e);break;case"view-actual-dates":b.preventDefault(),a.viewActualDates(e)}}}),document.addEventListener("click",function(b){var c=b.target.closest(".moodle-dialogue-content .embeddedshortname_program_assignment_duedates a, .moodle-dialogue-content .embeddedshortname_cert_assignment_duedates a");c&&c.getAttribute("href")&&(b.preventDefault(),M.util.js_pending("totara_program--assignments-view-duedates-change"),fetch(c.getAttribute("href"),{credentials:"same-origin",method:"get"}).then(function(a){return a.text()}).then(function(b){a.actualduedatesdialog.set("bodyContent",b),M.util.js_complete("totara_program--assignments-view-duedates-change")})["catch"](d.exception))})},f.prototype.deleteAssignment=function(c){var f=this,g=this.node.querySelector('[data-totara_program__assignment-id="'+c+'"]'),h=g.querySelector(".totara_program__assignments__row-name").innerText;g.classList.add("totara_program__assignments__loading"),M.util.js_pending("totara_program--assignments-delete-assignment");var i=new Promise(function(a){e.get_string("removeassignmentconfirmation","totara_program").done(a)});Promise.all([i,this.stringsPromise]).then(function(i){M.util.js_complete("totara_program--assignments-delete-assignment"),d.confirm("",i[0],f.strings.remove,f.strings.cancel,function(){a.call([{methodname:"totara_program_assignment_delete",args:{assignment_id:c}}])[0].then(function(a){a.success&&(g.remove(),f._clearNotifications(),e.get_string("removedfromprogram","totara_program",h).done(function(a){d.addNotification({message:a,type:"success",closebutton:!0,announce:!0})})),f._updateStatus(a.status),0===f.node.querySelectorAll(".totara_program__assignments__results__table tbody tr").length&&b.render("totara_program/assignment__no-results").done(function(a,c){f.node.querySelector(".totara_program__assignments__results").innerHTML=a,b.runTemplateJS(c)})}).fail(d.exception)},function(){g.classList.remove("totara_program__assignments__loading")})})["catch"](d.exception)},f.prototype.filter=function(){var c=this,e={categories:this.categories,term:this.searchTerm,recent:this.recent,program_id:this.programId},f=this.node.querySelector(".totara_program__assignments__results");f.classList.add("totara_program__assignments__loading"),a.call([{methodname:"totara_program_assignment_filter",args:e}])[0].then(function(a){return a.toomany?b.render("totara_program/assignment__too-many"):0===a.count?b.render("totara_program/assignment__no-results"):(a.canupdate=c.canupdate,b.render("totara_program/assignment_table",a))}).then(function(a,d){c.categories===e.categories&&c.term===e.searchTerm&&c.recent===e.recent&&(f.innerHTML=a,b.runTemplateJS(d),f.classList.remove("totara_program__assignments__loading"))}).fail(d.exception)},f.prototype.startChangeDuedate=function(b){var c=this,f=new Promise(function(a){var b=[{component:"totara_core",key:"datepickerlongyeardisplayformat"},{component:"totara_program",key:"chooseitem"},{component:"moodle",key:"none"},{component:"totara_hierarchy",key:"selected"}];e.get_strings(b).done(a)});M.util.js_pending("totara_program--assignments-change-duedates"),Promise.all([f,this.stringsPromise,this.dialogPromise]).then(function(f){var g={dateFormat:f[0][0],chooseitem:f[0][1],none:f[0][2]},h=function(){var a=new totaraDialog_handler_treeview_singleselect("instance","instancetitle"),b=this,d={};this.save=function(){document.getElementById("instance").value=document.getElementById("treeview_selected_val_"+this.handler._title).value,document.getElementById("instancetitle").innerHTML=document.getElementById("treeview_selected_text_"+this.handler._title).innerText,b.hide()},this.clear=function(){document.getElementById("instance").value=0,document.getElementById("instancetitle").value=""},d[c.strings.ok]=b.save.bind(b),d[c.strings.cancel]=a._cancel.bind(a);var e=' <span id="treeview_currently_selected_span_completion-event-dialog" style="display:none">(<label for="treeview_selected_text_completion-event-dialog">'+f[0][3]+':&nbsp</label><em><span id="treeview_selected_text_completion-event-dialog"></span></em>)</span><input type="hidden" id="treeview_selected_val_completion-event-dialog" name="treeview_selected_val_completion-event-dialog" value=""/>';totaraDialog.call(this,"completion-event-dialog","unused2",{buttons:d,title:"<h2>"+g.chooseitem+e+"</h2>"},"unused2",a)};totaraDialogs.completionevent=new h;var i=function(){};i.prototype=new totaraDialog_handler,i.prototype.first_load=function(){var f=this._dialog.dialog[0],h=this;M.totara_core.build_datepicker(null,'input[name="completiontime"]',g.dateFormat),f.querySelector(".fixeddate").addEventListener("click",function(){var g=f.querySelector(".completiontime").value,i=f.querySelector(".completiontimehour").value,j=f.querySelector(".completiontimeminute").value;M.util.js_pending("totara_program--assignments-change-duedates-fixed"),new Promise(function(a,b){e.get_string("datepickerlongyearregexjs","totara_core").then(function(c){var d=new RegExp(c);d.test(g)===!1?b():a()})}).then(function(){var d={assignment_id:b,duedate:g,hour:i,minute:j};a.call([{methodname:"totara_program_assignment_set_fixed_due_date",args:d}])[0].then(function(a){c._changeDuedate(b,a),h._dialog.hide(),M.util.js_complete("totara_program--assignments-change-duedates-fixed")})})["catch"](function(){e.get_string("datepickerlongyearplaceholder","totara_core").then(function(a){return M.util.js_complete("totara_program--assignments-change-duedates-fixed"),e.get_string("pleaseentervaliddate","totara_program",a)}).then(function(a){d.alert("",a,c.strings.ok)})})}),f.querySelector(".relativeeventtime").addEventListener("click",function(){var g=f.querySelector("#timeamount").value,i=f.querySelector("#eventtype").value,j=""===f.querySelector("#instance").value?0:f.querySelector("#instance").value,k=/^\d{1,3}$/;if(k.test(g)===!1)e.get_string("pleaseentervalidunit","totara_program").done(function(a){d.alert("",a,c.strings.ok)});else if(0==j&&i!=c.config.COMPLETION_EVENT_FIRST_LOGIN&&i!=c.config.COMPLETION_EVENT_ENROLLMENT_DATE)e.get_string("pleasepickaninstance","totara_program").done(function(a){d.alert("",a,c.strings.ok)});else{var l={assignment_id:b,num:f.querySelector("#timeamount").value,period:f.querySelector("#timeperiod").value,event:f.querySelector("#eventtype").value,eventinstanceid:j};a.call([{methodname:"totara_program_assignment_set_relative_due_date",args:l}])[0].then(function(a){c._changeDuedate(b,a),h._dialog.hide()}).fail(d.exception)}})},i.prototype.every_load=function(){var a=this._dialog.dialog[0],b=a.querySelector('[name="event"]'),c=a.querySelector('[name="eventinstancename"]');b&&(a.querySelector('[name="eventtype"]').value=b.value),c&&(a.querySelector("#instancetitle").innerText=c.value)};var j={};j[c.strings.cancel]=function(){c.dialog.hide()};var k="set_completion.php?programid="+c.programId+"&assignmentid="+b;c.dialog=new totaraDialog("completion-dialog",null,{buttons:j,title:"<h2>"+c.strings.completioncriteria+"</h2>"},c.baseURL+k,new i),c.dialog.open(),document.getElementById("completion-dialog").style.height="175px",M.util.js_complete("totara_program--assignments-change-duedates")})["catch"](d.exception)},f.prototype._changeDuedate=function(a,c){var d=this,e=this.node.querySelector('[data-totara_program__assignment-id="'+a+'"]'),f={canupdate:this.canupdate,duedate:c.duedate,duedateupdatable:c.duedateupdatable},g={actualduedate:c.actualduedate};this._updateStatus(c.status),e.classList.add("totara_program__assignments__loading");var h=b.render("totara_program/assignment__due_date",f).then(function(a){e.querySelector(".totara_program__assignments__row-duedate").innerHTML=a});b.render("totara_program/assignment__actual_date",g).then(function(a){return e.querySelector(".totara_program__assignments__row-actual-duedate").innerHTML=a,h}).then(function(){e.classList.remove("totara_program__assignments__loading")}),d.updateSuccess(a)},f.prototype.removeDueDate=function(b){var c=this;a.call([{methodname:"totara_program_assignment_remove_due_date",args:{assignment_id:b}}])[0].then(function(a){c._changeDuedate(b,a)})},f.prototype.viewActualDates=function(a){var b=this,e=c.wwwroot+"/totara/program/assignment/duedates_report.php?programid="+b.programId+"&assignmentid="+a;M.util.js_pending("totara_program--assignments-view-duedates"),fetch(e,{credentials:"same-origin",method:"get"}).then(function(a){return a.text()}).then(function(a){b.actualduedatesdialog&&(b.actualduedatesdialog.destroy(),b.actualduedatesdialog=null),b.actualduedatesdialog=new M.core.dialogue({headerContent:null,bodyContent:a,width:900,centered:!0,modal:!0,render:!0}).show(),M.util.js_complete("totara_program--assignments-view-duedates")})["catch"](d.exception)},f.prototype.startAdd=function(a){var b=this;""!==a&&(this.typeid=a,M.util.js_pending("totara_program--assignments-addItems"),Promise.all([this.stringsPromise,this.dialogPromise]).then(function(){var c={};c[b.strings.ok]=function(){b.addAssignments()},c[b.strings.cancel]=function(){b.dialog.hide()};var d=new totaraDialog_handler_treeview_multiselect,e=b.addOptions[a].url+"&programid="+b.programId;b.dialog=new totaraDialog("add-assignment-dialog-"+a,null,{buttons:c,title:"<h2>"+b.addOptions[a].text+"</h2>"},b.baseURL+e,d),b.dialog.open(),M.util.js_complete("totara_program--assignments-addItems"),b.node.querySelector("#totara_program-assignment--add-users").value=""}))},f.prototype.addAssignments=function(){for(var c=this.dialog.handler._container.get(0).querySelectorAll(".selected > div > span.clickable"),f=[],g=this,h=0;h<c.length;h++){var i,j=c[h];j.getAttribute("data-jaid")?i=parseInt(j.getAttribute("data-jaid"),10):(i=j.id.split("_"),i=i[i.length-1],i=parseInt(i,10)),f.indexOf(i)===-1&&f.push(i)}f.length>0?(M.util.js_pending("totara_program--assignments-addingItems"),g.dialog.showLoading(),new Promise(function(b,c){a.call([{methodname:"totara_program_assignment_create",args:{programid:g.programId,typeid:g.typeid,items:f}}])[0].done(b).fail(c)}).then(function(a){var c=g._updateStatus(a.status),f=new Promise(function(b){g._clearNotifications(),a.items.length<g.config.CONDENSED_LIMIT?a.items.forEach(function(a){e.get_string("assignmentadded","totara_program",a.name).done(function(a){d.addNotification({message:a,type:"success",closebutton:!0,announce:!0}),b()})}):e.get_string(g.addOptions[g.typeid].notificationKey,"totara_program",a.items.length).done(function(a){d.addNotification({message:a,type:"success",closebutton:!0,announce:!0}),b()})}),h=new Promise(function(c,d){var e=a.items.filter(function(a){var b,c=0===g.categories.length;return(!g.searchTerm||a.name.toLowerCase().indexOf(g.searchTerm.toLowerCase())!==-1)&&(b=g.categories.some(function(b){return parseInt(b,10)===a.type_id}),c||b)});if(0===e.length)return void c();if(g.node.getElementsByClassName("totara_program__assignments__results-too-many").length>0)return void c();var f=g.node.querySelectorAll("[data-totara_program__assignment]");if(e.length+f.length>100)return void b.render("totara_program/assignment__too-many").done(function(a,d){g.node.querySelector(".totara_program__assignments__results").innerHTML=a,b.runTemplateJS(d),c()});if(g.node.getElementsByClassName("totara_program__assignments__results-no-results").length>0){var h={items:e,canupdate:g.canupdate};b.render("totara_program/assignment_table",h).done(function(a,d){g.node.querySelector(".totara_program__assignments__results").innerHTML=a,b.runTemplateJS(d),c()})}else{var i=e.map(function(a){return new Promise(function(c){a.canupdate=g.canupdate,b.render("totara_program/assignment__table__row",a).done(c)})});Promise.all(i).then(function(a){var b="";a.forEach(function(a){b+=a}),g.node.querySelector(".totara_program__assignments__results__table tbody").insertAdjacentHTML("beforeend",b),c()})["catch"](d)}});return Promise.all([c,f,h])}).then(function(){g.dialog.hide(),M.util.js_complete("totara_program--assignments-addingItems")})["catch"](d.exception)):this.dialog.hide()},f.prototype.updateBelow=function(b,c){var e=this;a.call([{methodname:"totara_program_assignment_set_include_children",args:{assignmentid:b,value:c}}])[0].done(function(a){var c=e.node.querySelector('[data-totara_program__assignment-id="'+b+'"]');e._updateStatus(a.status),e.updateSuccess(b),c.querySelector("[data-totara_program__assignments--learnercount]").innerHTML=a.numusers,c.classList.remove("totara_program__assignments__loading")}).fail(d.exception)},f.prototype.updateSuccess=function(a){var b='[data-totara_program__assignment-id="'+a+'"] .totara_program__assignments__row-name',c=this.node.querySelector(b).textContent;this._clearNotifications(),e.get_string("individualassignmentupdated","totara_program",c).done(function(a){d.addNotification({message:a,type:"success",closebutton:!0,announce:!0})})},f.prototype._updateStatus=function(a){var d=a.exception_count,f=document.querySelector("#program-assignments .tabtree li:last-child"),g=new Promise(function(a){e.get_string("exceptions","totara_program",d).done(function(b){d===parseInt(f.getAttribute("data-totara_program-exception_count"),10)&&(f.querySelector("a").innerText=b),a()})}),h={message:a.status_string,extraclasses:"notifynotice",announce:!0,closebutton:!1},i=new Promise(function(c){b.render("core/notification_"+a.state,h).done(function(a,d){document.querySelector("[data-totara_program--notification]").innerHTML=a,b.runTemplateJS(d),c()})});return f.setAttribute("data-totara_program-exception_count",d),d>0?(f.classList.remove("disabled"),f.querySelector("a").setAttribute("href",c.wwwroot+"/totara/program/exceptions.php?id="+this.programId)):(f.classList.add("disabled"),f.querySelector("a").removeAttribute("href")),Promise.all([g,i])},f.prototype._clearNotifications=function(){document.getElementById("user-notifications").innerHTML=""},{init:g}});
define('totara_program/check_completion', ["jquery","core/str","core/config","core/yui"],function(a,b,c,d){function e(a,b){var c=new M.core.confirm({title:M.util.get_string("fixconfirmtitle","totara_program"),question:M.util.get_string(b,"totara_program"),width:500});c.on("complete-yes",function(){window.location.href=a}),c.on("complete-no",function(a){a.preventDefault()}),c.show()}var f={init:function(b){d.use("moodle-core-notification-confirm",function(b){a(".problemaggregation a").on("click",function(b){b.preventDefault(),e(a(this).attr("href"),"fixconfirmsome")}),a(".problemsolution a").on("click",function(b){b.preventDefault(),e(a(this).attr("href"),"fixconfirmone")})})}};return f});
define('totara_reportbuilder/filter_dialogs', ["jquery","core/config","core/str"],function(a,b,c){var d=function(b){var c=a(this).attr("name");"undefined"!=typeof c&&(c=c.substr(0,c.length-3),"0"===a(this).val()?(a("#show-"+c+"-dialog").addClass("disabled"),a("#show-"+c+"-dialog").prop("disabled",!0),a("#show-"+c+"-dialog").removeAttr("href"),a('*[data-filtername="'+c+'"] a').addClass("disabled"),a('*[data-filtername="'+c+'"] a').prop("disabled",!0),a('*[data-filtername="'+c+'"] a').removeAttr("href")):(a("#show-"+c+"-dialog").removeClass("disabled"),a("#show-"+c+"-dialog").prop("disabled",!1),a("#show-"+c+"-dialog").attr("href","#"),a('*[data-filtername="'+c+'"] a').removeClass("disabled"),a('*[data-filtername="'+c+'"] a').prop("disabled",!1),a('*[data-filtername="'+c+'"] a').attr("href","#")))},e={waitingitems:[],reportid:0,init:function(b,c,d,f,g){e.waitingitems.push({filter:b,value:c,hierarchytype:d,name:f}),e.reportid=g,window.dialogsInited?this.rb_init_filter_dialogs():(a.isArray(window.dialoginits)||(window.dialoginits=[]),1===this.waitingitems.length&&window.dialoginits.push(this.rb_init_filter_dialogs))},rb_init_filter_dialogs:function(){var b=a.extend(!0,[],e.waitingitems);e.waitingitems=[],a.each(b,function(){switch(this.filter){case"hierarchy":e.rb_load_hierarchy_filters(this);break;case"badge":e.rb_load_badge_filters(this);break;case"jobassign_multi":e.rb_load_jobassign_multi_filters();case"hierarchy_multi":e.rb_load_hierarchy_multi_filters();break;case"cohort":e.rb_load_cohort_filters();break;case"category":e.rb_load_category_filters();break;case"course_multi":e.rb_load_course_multi_filters()}}),a(document).on("click",".multiselect-selected-item a",function(b){b.preventDefault();var c=a(this).parents("div.multiselect-selected-item"),d=c.data("filtername"),e=c.data("id"),f=a("input[name="+d+"]"),g=f.val(),h=g.split(","),i=a.grep(h,function(a){return a!=e}),j=i.join(",");f.val(j),c.remove()})},rb_load_hierarchy_filters:function(d){if(d.name)var e="input#show-"+d.name+"-dialog";else var e="input";switch(d.hierarchytype){case"org":a(e+".rb-filter-choose-org").each(function(){var e=a(this).attr("id");e=e.substr(5,e.length-12);var f=b.wwwroot+"/totara/hierarchy/prefix/organisation/assign/";c.get_string("chooseorganisation","totara_hierarchy").done(function(a){totaraSingleSelectDialog(e,a+d.value,f+"find.php?",e,e+"title")}),"0"===a("select[name="+e+"_op]").val()&&(a("input[name="+e+"_rec]").prop("disabled",!0),a("#show-"+e+"-dialog").prop("disabled",!0))});break;case"pos":a(e+".rb-filter-choose-pos").each(function(){var e=a(this).attr("id");e=e.substr(5,e.length-12);var f=b.wwwroot+"/totara/hierarchy/prefix/position/assign/";c.get_string("chooseposition","totara_hierarchy").done(function(a){totaraSingleSelectDialog(e,a+d.value,f+"position.php?",e,e+"title")}),"0"===a("select[name="+e+"_op]").val()&&(a("input[name="+e+"_rec]").prop("disabled",!0),a("#show-"+e+"-dialog").prop("disabled",!0))});break;case"comp":a(e+".rb-filter-choose-comp").each(function(){var e=a(this).attr("id");e=e.substr(5,e.length-12);var f=b.wwwroot+"/totara/hierarchy/prefix/competency/assign/";c.get_string("selectcompetency","totara_hierarchy").done(function(a){totaraSingleSelectDialog(e,a+d.value,f+"find.php?",e,e+"title")}),"0"===a("select[name="+e+"_op]").val()&&(a("input[name="+e+"_rec]").prop("disabled",!0),a("#show-"+e+"-dialog").prop("disabled",!0))})}},rb_load_jobassign_multi_filters:function(){var e=this;a("div.rb-man-add-link a").each(function(){var f=a(this).attr("id");f=f.substr(5,f.length-12),d.call(a("#id_"+f+"_op")),a(document).on("change","#id_"+f+"_op",d);var g=b.wwwroot+"/totara/job/assignfilter/manager/";c.get_string("choosemanplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(f,a,g+"find.php?reportid="+e.reportid,g+"save.php?reportid="+e.reportid+"&filtername="+f+"&ids=")})}),a("div.rb-app-add-link a").each(function(){var f=a(this).attr("id");f=f.substr(5,f.length-12),d.call(a("#id_"+f+"_op")),a(document).on("change","#id_"+f+"_op",d);var g=b.wwwroot+"/totara/job/assignfilter/appraiser/";c.get_string("chooseappplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(f,a,g+"find.php?reportid="+e.reportid,g+"save.php?reportid="+e.reportid+"&filtername="+f+"&ids=")})})},rb_load_hierarchy_multi_filters:function(){var e=this;a("div.rb-org-add-link a").each(function(){var f=a(this).attr("id");f=f.substr(5,f.length-12),d.call(a("#id_"+f+"_op")),a(document).on("change","#id_"+f+"_op",d);var g=b.wwwroot+"/totara/hierarchy/prefix/organisation/assignfilter/";c.get_string("chooseorgplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(f,a,g+"find.php?reportid="+e.reportid,g+"save.php?filtername="+f+"&ids=")})}),a("div.rb-pos-add-link a").each(function(){var f=a(this).attr("id");f=f.substr(5,f.length-12),d.call(a("#id_"+f+"_op")),a(document).on("change","#id_"+f+"_op",d);var g=b.wwwroot+"/totara/hierarchy/prefix/position/assignfilter/";c.get_string("chooseposplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(f,a,g+"find.php?reportid="+e.reportid,g+"save.php?filtername="+f+"&ids=")})}),a("div.rb-comp-add-link a").each(function(){var e=a(this).attr("id");e=e.substr(5,e.length-12),d.call(a("#id_"+e+"_op")),a(document).on("change","#id_"+e+"_op",d);var f=b.wwwroot+"/totara/hierarchy/prefix/competency/assignfilter/";c.get_string("choosecompplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(e,a,f+"find.php?",f+"save.php?filtername="+e+"&ids=")})})},rb_load_cohort_filters:function(){a("div.rb-cohort-add-link a").each(function(){var d=a(this).attr("id");d=d.substr(5,d.length-12);var e=b.wwwroot+"/totara/reportbuilder/ajax/";c.get_string("choosecohorts","totara_cohort").done(function(a){totaraMultiSelectDialogRbFilter(d,a,e+"find_cohort.php?sesskey="+b.sesskey,e+"save_cohort.php?sesskey="+b.sesskey+"&filtername="+d+"&ids=")})})},rb_load_badge_filters:function(d){a("div.rb-badge-add-link a").each(function(){var e=a(this).attr("id");e=e.substr(5,e.length-12);var f=b.wwwroot+"/totara/reportbuilder/ajax/";c.get_string("choosebadges","badges").done(function(a){totaraMultiSelectDialogRbFilter(e,a,f+"find_badge.php?reportid="+d.value+"&sesskey="+b.sesskey,f+"save_badge.php?filtername="+e+"&sesskey="+b.sesskey+"&ids=")})})},rb_load_category_filters:function(){a(document).on("change","#id_course_category-path_op",function(b){b.preventDefault();var c=a(this).attr("name");c=c.substr(0,c.length-3),"0"===a(this).val()?(a("input[name="+c+"_rec]").prop("disabled",!0),a("#show-"+c+"-dialog").prop("disabled",!0)):(a("input[name="+c+"_rec]").prop("disabled",!1),a("#show-"+c+"-dialog").prop("disabled",!1))}),a("input.rb-filter-choose-category").each(function(){var d=a(this).attr("id");d=d.substr(5,d.length-12);var e=b.wwwroot+"/totara/reportbuilder/ajax/filter/category/";c.get_string("choosecatplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(d,a,e+"find.php?sesskey="+b.sesskey,e+"save.php?filtername="+d+"&sesskey="+b.sesskey+"&ids=")}),"0"===a("select[name="+d+"_op]").val()&&(a("input[name="+d+"_rec]").prop("disabled",!0),a("#show-"+d+"-dialog").prop("disabled",!0))})},rb_load_course_multi_filters:function(){a(document).on("change","#id_course-id_op",function(b){b.preventDefault();var c=a(this).attr("name");c=c.substr(0,c.length-3),"0"===a(this).val()?(a("input[name="+c+"_rec]").prop("disabled",!0),a("#show-"+c+"-dialog").prop("disabled",!0)):(a("input[name="+c+"_rec]").prop("disabled",!1),a("#show-"+c+"-dialog").prop("disabled",!1))}),a("input.rb-filter-choose-course").each(function(){var d=a(this).attr("id");d=d.substr(5,d.length-12);var e=b.wwwroot+"/totara/reportbuilder/ajax/filter/course_multi/";c.get_string("coursemultiitemchoose","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(d,a,e+"find.php?sesskey="+b.sesskey,e+"save.php?filtername="+d+"&sesskey="+b.sesskey+"&ids=")}),"0"===a("select[name="+d+"_op]").val()&&(a("input[name="+d+"_rec]").prop("disabled",!0),a("#show-"+d+"-dialog").prop("disabled",!0))})}};return e});
define('totara_reportbuilder/instantfilter', ["jquery","core/config","core/templates"],function(a,b,c){var d={xhr:null,init:function(){a(".rb-sidebar input:not(.ignoredirty), .rb-sidebar select").change(function(b){try{var e=a(this).parents("form").attr("id");M.form.updateFormState(e)}catch(f){}d.xhr&&d.xhr.abort(),0===a(b.target).siblings(".instantfilterwait").length&&c.renderIcon("loading","loading","instantfilterwait").done(function(c){a(c).insertAfter(a(b.target).parent().children().last())}),d.xhr=d.refresh_results()})},split_search:function(a){var b={};if(void 0===a||a.length<1)return b;for(var c=a.slice(1).split("&"),d=0;d<c.length;d++){var e=c[d].split("="),f=decodeURIComponent(e[0]).replace(/\+/g," "),g=decodeURIComponent(e[1]).replace(/\+/g," ");void 0===b[f]&&(b[f]=[]),b[f].push(g)}return b},remove_param:function(a,b){return a[b]&&delete a[b],a},build_search:function(a){var b="?";for(var c in a)for(var d=0;d<a[c].length;d++)b+="?"==b?"":"&",b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c][d]);return b},refresh_results:function(c){var e=window.location.search,f=d.split_search(e);return f=d.remove_param(f,"spage"),f=d.remove_param(f,"ssort"),f=d.remove_param(f,"sid"),f=d.remove_param(f,"clearfilters"),e=d.build_search(f),a.post(b.wwwroot+"/totara/reportbuilder/ajax/instantreport.php"+e,a(".rb-sidebar").serialize()).done(function(b){var d=a(".instantfilterwait");d.siblings(".sr-only").remove(),d.remove(),a(".rb-display-table-container").replaceWith(a(b).find(".rb-display-table-container")),a(".rb-record-count").replaceWith(a(b).find(".rb-record-count")),a(".rb-report-svggraph").replaceWith(a(b).find(".rb-report-svggraph")),a(".rb-report-pdfgraph").replaceWith(a(b).find(".rb-report-pdfgraph")),a(b).find(".rb-sidebar.mform label").each(function(b,c){var d=a(c);d.attr("for")&&a('label[for="'+d.attr("for")+'"]').html(d.html())}),c&&c()})}};return d});
define('totara_userdata/item_select', ["jquery","core/str"],function(a,b){var c=function(c,d){var e=[{key:"selectall",component:"core"},{key:"deselectall",component:"core"}];b.get_strings(e).done(function(b){var e="tfiid_"+c+"_totara_userdata_form_"+d+"_type_edit",f=a('[data-element-id="'+e+'"] .totara_form_element_static_html'),g='<a href="#" class="select">'+b[0]+'</a> / <a href="#" class="deselect">'+b[1]+"</a>";f.append(g),f.on("click",".select",function(b){b.preventDefault(),a('[data-item-classification="group"] input[type="checkbox"]').prop("checked",!0)}),f.on("click",".deselect",function(b){b.preventDefault(),a('[data-item-classification="group"] input[type="checkbox"]').prop("checked",!1)})})};return{init:c}});
define('tool_sitepolicy/versionform', ["jquery"],function(a){var b={init:function(){var b=a("#tfiid_preview_tool_sitepolicy_form_versionform").val();"1"==b&&(a("#tf_fid_tool_sitepolicy_form_versionform").prev("h2").hide(),a(".totara_form-required_note").hide()),a("#tfiid_previewbutton_tool_sitepolicy_form_versionform").on("click",function(b){a("#tfiid_preview_tool_sitepolicy_form_versionform").val("1")}),a("#tfiid_continuebutton_tool_sitepolicy_form_versionform").on("click",function(b){b.preventDefault(),a("#tfiid_preview_tool_sitepolicy_form_versionform").val(""),a("#tfiid_preview_tool_sitepolicy_form_versionform").trigger("change"),a("#tf_fid_tool_sitepolicy_form_versionform").prev("h2").show(),a(".totara_form-required_note").show()})}};return b});
define('tool_sitepolicy/form_element_consent_statement', ["jquery","totara_form/form","core/templates"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.constructor=c,c.prototype.toString=function(){return"[object ConsentStatement]"},c.prototype.init=function(b){var c=this.getForm(),d=a(this.getNode()),e=d.find('input[data-rel="addstatement"]'),f=d.find('input[data-rel="removestatement"]'),g=a("#"+this.id).attr("data-element-name"),h=a(d.find('input[name="'+g+'__addstatement"]')),i=this;e.on("click",function(){h.val(1),c.reload()}),f.on("click",function(b){M.util.js_pending("tool_sitepolicy-consent_statement_removal"),b.preventDefault();var c,d=a(this),e=a(d.closest('div[data-rel="statement-block"]')),f=a(e.find('input[name="'+g+"__removedstatement["+d.data("index")+']"]'));c=i.delete_confirm(b,function(){f.val(1),e.addClass("hidden"),e.find("input[required]").removeAttr("required")}),c.done(function(){M.util.js_complete("tool_sitepolicy-consent_statement_removal")})}),b()},c.prototype.delete_confirm=function(b,c){var d=a.Deferred();return require(["core/modal_factory","core/modal_events","core/str"],function(e,f,g){var h=[{key:"deleteconsentconfirmtitle",component:"tool_sitepolicy"},{key:"deleteconsentconfirmbody",component:"tool_sitepolicy"}],i=g.get_strings(h);i.done(function(g){var h={type:e.types.CONFIRM,title:g[0],body:g[1]},i=e.create(h,a(b));i.done(function(a){var b=a.getRoot();b.on(f.yes,c),b.on(f.shown,d.resolve),a.show()})})}),d.promise()},c});
define('tool_sitepolicy/translationform', ["jquery"],function(a){var b={init:function(){var b=a("#tfiid_preview_tool_sitepolicy_form_translationform").val();"1"==b&&(a("#tf_fid_tool_sitepolicy_form_translationform").prev("h2").hide(),a(".totara_form-required_note").hide()),a("#tfiid_previewbutton_tool_sitepolicy_form_translationform").on("click",function(b){a("#tfiid_preview_tool_sitepolicy_form_translationform").val("1")}),a("#tfiid_continuebutton_tool_sitepolicy_form_translationform").on("click",function(b){b.preventDefault(),a("#tfiid_preview_tool_sitepolicy_form_translationform").val(""),a("#tfiid_preview_tool_sitepolicy_form_translationform").trigger("change"),a("#tf_fid_tool_sitepolicy_form_translationform").prev("h2").show(),a(".totara_form-required_note").show()})}};return b});
define('tool_templatelibrary/search', ["jquery","core/ajax","core/log","core/notification","core/templates","core/config"],function(a,b,c,d,e,f){var g=function(b){e.render("tool_templatelibrary/search_results",{templates:b}).done(function(b,c){e.replaceNode(a('[data-region="searchresults"]'),b,c)}).fail(d.exception)},h=function(c){var e=a('[data-field="component"]').val(),f=a('[data-field="search"]').val();document.location.hash=f,b.call([{methodname:"tool_templatelibrary_list_templates",args:{component:e,search:f,themename:c},done:g,fail:d.exception}],!0,!1)},i=null,j=function(a,b){null!==i&&window.clearTimeout(i),i=window.setTimeout(function(){a(),i=null},b)},k=function(){j(h.bind(this,f.theme),400)};return a('[data-region="list-templates"]').on("change",'[data-field="component"]',k),a('[data-region="list-templates"]').on("input",'[data-field="search"]',k),a('[data-field="search"]').val(document.location.hash.replace("#","")),h(f.theme),{}});
define('tool_templatelibrary/display', ["jquery","core/ajax","core/log","core/notification","core/templates","core/config","core/str"],function(a,b,c,d,e,f,g){var h=function(a,b){if(!a)return!1;var c="@template "+b,d=0,e=[];if(e=a.match(/{{!([\s\S]*?)}}/g),null!==e)for(d=0;d<e.length;d++){var f=e[d],g=f.indexOf(c);if(g!==-1){var h=g+c.length+1;return f=f.substr(h,f.length-2-h)}}return!1},i=function(b,i,j){g.get_string("templateselected","tool_templatelibrary",b).done(function(b){a('[data-region="displaytemplateheader"]').text(b)}).fail(d.exception);var k=h(i,b);k===!1&&(k=h(j,b)),k&&(i=k),a('[data-region="displaytemplatesource"]').text(i);var l=i.match(/Example context \(json\):([\s\S]*)/),m=!1;if(l){var n=l[1].trim();n=n.replace(/__WWWROOT__/g,f.wwwroot),n=n.replace(/__THEME__/g,f.theme);try{m=a.parseJSON(n)}catch(o){c.debug("Could not parse json example context for template."),c.debug(o)}}m?e.render(b,m).done(function(b,c){e.replaceNodeContents(a('[data-region="displaytemplateexample"]'),b,c)}).fail(d.exception):g.get_string("templatehasnoexample","tool_templatelibrary").done(function(b){a('[data-region="displaytemplateexample"]').text(b)}).fail(d.exception)},j=function(c){var e=c.split("/"),g=e.shift(),h=e.shift(),j=b.call([{methodname:"core_output_load_template",args:{component:g,template:h,themename:f.theme}},{methodname:"tool_templatelibrary_load_canonical_template",args:{component:g,template:h}}],!0,!1);a.when.apply(a,j).done(function(a,b){i(c,a,b)}).fail(d.exception)};return a('[data-region="list-templates"]').on("click","[data-templatename]",function(b){var c=a(this).data("templatename");b.preventDefault(),j(c)}),{}});
define('tool_usertours/managesteps', ["jquery","core/str","core/notification"],function(a,b,c){var d={removeStep:function(d){d.preventDefault(),b.get_strings([{key:"confirmstepremovaltitle",component:"tool_usertours"},{key:"confirmstepremovalquestion",component:"tool_usertours"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(b){c.confirm(b[0],b[1],b[2],b[3],a.proxy(function(){window.location=a(this).attr("href")},d.currentTarget))})},setup:function(){a("body").delegate('[data-action="delete"]',"click",d.removeStep)}};return{setup:d.setup}});
!function(a,b){"function"==typeof define&&define.amd?define('tool_usertours/tour', ["jquery","./popper"],function(c,d){return a.Tour=b(c,d)}):"object"==typeof module&&module.exports?module.exports=b(require("jquery"),require("popper.js")):a.Tour=b(a.$,a.Popper)}(this,function(a,b){"use strict";function c(a){this.init(a)}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return c.prototype.tourName,c.prototype.storageKey,c.prototype.storage,c.prototype.originalConfiguration,c.prototype.listeners,c.prototype.eventHandlers,c.prototype.steps,c.prototype.currentStepNode,c.prototype.currentStepNumber,c.prototype.currentStepPopper,c.prototype.currentStepConfig,c.prototype.templateContent,c.prototype.init=function(a){this.eventHandlers={},this.reset(),this.originalConfiguration=a||{},this.configure.apply(this,arguments);try{this.storage=window.sessionStorage,this.storageKey="tourstate_"+this.tourName}catch(b){this.storage=!1,this.storageKey=""}return this},c.prototype.reset=function(){return this.hide(),this.eventHandlers=[],this.resetStepListeners(),this.originalConfiguration={},this.steps=[],this.currentStepNumber=0,this},c.prototype.configure=function(a){var b=this;return"object"===("undefined"==typeof a?"undefined":d(a))&&("undefined"!=typeof a.tourName&&(this.tourName=a.tourName),a.eventHandlers&&!function(){var c=void 0;for(c in a.eventHandlers)a.eventHandlers[c].forEach(function(a){this.addEventHandler(c,a)},b)}(),this.resetStepDefaults(!0),"object"===d(a.steps)&&(this.steps=a.steps),"undefined"!=typeof a.template&&(this.templateContent=a.template)),this.checkMinimumRequirements(),this},c.prototype.checkMinimumRequirements=function(){if(!this.tourName)throw new Error("Tour Name required");if(!this.steps||!this.steps.length)throw new Error("Steps must be specified")},c.prototype.resetStepDefaults=function(a){return"undefined"==typeof a&&(a=!0),this.stepDefaults={},a&&"undefined"!=typeof this.originalConfiguration.stepDefaults?this.setStepDefaults(this.originalConfiguration.stepDefaults):this.setStepDefaults({}),this},c.prototype.setStepDefaults=function(b){return this.stepDefaults||(this.stepDefaults={}),a.extend(this.stepDefaults,{element:"",placement:"top",delay:0,moveOnClick:!1,moveAfterTime:0,orphan:!1,direction:1},b),this},c.prototype.getCurrentStepNumber=function(){return parseInt(this.currentStepNumber,10)},c.prototype.setCurrentStepNumber=function(a){if(this.currentStepNumber=a,this.storage)try{this.storage.setItem(this.storageKey,a)}catch(b){b.code===DOMException.QUOTA_EXCEEDED_ERR&&this.storage.removeItem(this.storageKey)}},c.prototype.getNextStepNumber=function(a){"undefined"==typeof a&&(a=this.getCurrentStepNumber());for(var b=a+1;b<=this.steps.length;){if(this.isStepPotentiallyVisible(this.getStepConfig(b)))return b;b++}return null},c.prototype.getPreviousStepNumber=function(a){"undefined"==typeof a&&(a=this.getCurrentStepNumber());for(var b=a-1;b>=0;){if(this.isStepPotentiallyVisible(this.getStepConfig(b)))return b;b--}return null},c.prototype.isLastStep=function(a){var b=this.getNextStepNumber(a);return null===b},c.prototype.isFirstStep=function(a){var b=this.getPreviousStepNumber(a);return null===b},c.prototype.isStepPotentiallyVisible=function(a){return!!a&&(!!this.isStepActuallyVisible(a)||(!("undefined"==typeof a.orphan||!a.orphan)||!("undefined"==typeof a.delay||!a.delay)))},c.prototype.isStepActuallyVisible=function(a){if(!a)return!1;var b=this.getStepTarget(a);return!!(b&&b.length&&b.is(":visible"))&&!!b.length},c.prototype.next=function(){return this.gotoStep(this.getNextStepNumber())},c.prototype.previous=function(){return this.gotoStep(this.getPreviousStepNumber(),-1)},c.prototype.gotoStep=function(a,b){if(a<0)return this.endTour();var c=this.getStepConfig(a);return null===c?this.endTour():this._gotoStep(c,b)},c.prototype._gotoStep=function(a,b){if(!a)return this.endTour();if("undefined"!=typeof a.delay&&a.delay&&!a.delayed)return a.delayed=!0,window.setTimeout(this._gotoStep.bind(this),a.delay,a,b),this;if(!a.orphan&&!this.isStepActuallyVisible(a)){var c=b==-1?"getPreviousStepNumber":"getNextStepNumber";return this.gotoStep(this[c](a.stepNumber),b)}return this.hide(),this.fireEventHandlers("beforeRender",a),this.renderStep(a),this.fireEventHandlers("afterRender",a),this},c.prototype.getStepConfig=function(b){if(null===b||b<0||b>=this.steps.length)return null;var c=this.normalizeStepConfig(this.steps[b]);return c=a.extend(c,{stepNumber:b})},c.prototype.normalizeStepConfig=function(b){return"undefined"!=typeof b.reflex&&"undefined"==typeof b.moveAfterClick&&(b.moveAfterClick=b.reflex),"undefined"!=typeof b.element&&"undefined"==typeof b.target&&(b.target=b.element),"undefined"!=typeof b.content&&"undefined"==typeof b.body&&(b.body=b.content),b=a.extend({},this.stepDefaults,b),b=a.extend({},{attachTo:b.target,attachPoint:"after"},b),b.attachTo&&(b.attachTo=a(b.attachTo).first()),b},c.prototype.getStepTarget=function(b){return b.target?a(b.target):null},c.prototype.fireEventHandlers=function(a,b){return"undefined"==typeof this.eventHandlers[a]?this:(this.eventHandlers[a].forEach(function(a){a.call(this,b)},this),this)},c.prototype.addEventHandler=function(a,b){return"undefined"==typeof this.eventHandlers[a]&&(this.eventHandlers[a]=[]),this.eventHandlers[a].push(b),this},c.prototype.processStepListeners=function(b){if(this.listeners.push({node:this.currentStepNode,args:["click",'[data-role="next"]',a.proxy(this.next,this)]},{node:this.currentStepNode,args:["click",'[data-role="previous"]',a.proxy(this.previous,this)]},{node:this.currentStepNode,args:["click",'[data-role="end"]',a.proxy(this.endTour,this)]},{node:a('[data-flexitour="backdrop"]'),args:["click",a.proxy(this.hide,this)]},{node:a("body"),args:["click",a.proxy(function(b){this.currentStepNode.is(b.target)||0!==a(b.target).closest('[data-role="flexitour-step"]').length||this.hide()},this)]},{node:a("body"),args:["keydown",a.proxy(this.handleKeyDown,this)]}),b.moveOnClick){var c=this.getStepTarget(b);this.listeners.push({node:c,args:["click",a.proxy(function(b){0===a(b.target).parents('[data-flexitour="container"]').length&&window.setTimeout(a.proxy(this.next,this),500)},this)]})}return this.listeners.forEach(function(a){a.node.on.apply(a.node,a.args)}),this},c.prototype.resetStepListeners=function(){return this.listeners&&this.listeners.forEach(function(a){a.node.off.apply(a.node,a.args)}),this.listeners=[],this},c.prototype.renderStep=function(b){this.currentStepConfig=b,this.setCurrentStepNumber(b.stepNumber);var c=a(this.getTemplateContent());return c.find('[data-placeholder="title"]').html(b.title),c.find('[data-placeholder="body"]').html(b.body),this.isFirstStep(b.stepNumber)?c.find('[data-role="previous"]').prop("disabled",!0):c.find('[data-role="previous"]').prop("disabled",!1),this.isLastStep(b.stepNumber)?c.find('[data-role="next"]').prop("disabled",!0):c.find('[data-role="next"]').prop("disabled",!1),c.find('[data-role="previous"]').attr("role","button"),c.find('[data-role="next"]').attr("role","button"),c.find('[data-role="end"]').attr("role","button"),b.template=c,this.addStepToPage(b),this.processStepListeners(b),this},c.prototype.getTemplateContent=function(){return a(this.templateContent).clone()},c.prototype.addStepToPage=function(c){var d=(c.template,a('<span data-flexitour="container"></span>').html(c.template).hide()),e=a("body, html").stop(!0,!0);if(this.isStepActuallyVisible(c)){var f=this.getStepTarget(c);f.data("flexitour","target");var g=this.calculateZIndex(f);g&&(c.zIndex=g+1),c.zIndex&&d.css("zIndex",c.zIndex+1),this.positionBackdrop(c),a(document.body).append(d),this.currentStepNode=d,this.currentStepNode.css({top:0,left:0}),e.animate({scrollTop:this.calculateScrollTop(c)}).promise().then(function(){this.positionStep(c),this.revealStep(c)}.bind(this))}else c.orphan&&(c.isOrphan=!0,c.attachTo=a("body").first(),c.attachPoint="append",this.positionBackdrop(c),d.addClass("orphan"),a(document.body).append(d),this.currentStepNode=d,this.currentStepNode.offset(this.calculateStepPositionInPage()),this.currentStepNode.css("position","fixed"),this.currentStepPopper=new b(a("body"),this.currentStepNode[0],{removeOnDestroy:!0,placement:c.placement+"-start",arrowElement:'[data-role="arrow"]',modifiers:{hide:{enabled:!1},applyStyle:{onLoad:null,enabled:!1}}}),this.revealStep(c));return this},c.prototype.revealStep=function(b){return this.currentStepNode.fadeIn("",a.proxy(function(){this.announceStep(b),this.currentStepNode.focus(),window.setTimeout(a.proxy(function(){this.currentStepNode&&this.currentStepNode.focus()},this),100)},this)),this},c.prototype.announceStep=function(a){var b="tour-step-"+this.tourName+"-"+a.stepNumber;this.currentStepNode.attr("id",b);var c=this.currentStepNode.find('[data-placeholder="body"]').first();c.attr("id",b+"-body"),c.attr("role","document");var d=this.currentStepNode.find('[data-placeholder="title"]').first();d.attr("id",b+"-title"),d.attr("aria-labelledby",b+"-body"),this.currentStepNode.attr("role","dialog"),this.currentStepNode.attr("tabindex",0),this.currentStepNode.attr("aria-labelledby",b+"-title"),this.currentStepNode.attr("aria-describedby",b+"-body");var e=this.getStepTarget(a);return e&&(e.attr("tabindex")||e.attr("tabindex",0),e.data("original-describedby",e.attr("aria-describedby")).attr("aria-describedby",b+"-body")),this.accessibilityShow(a),this},c.prototype.handleKeyDown=function(b){var c="a[href], link[href], [draggable=true], [contenteditable=true], :input:enabled, [tabindex], button:enabled";switch(b.keyCode){case 27:this.endTour();break;case 9:(function(){if(this.currentStepConfig.hasBackdrop){var d=a(document.activeElement),e=this.getStepTarget(this.currentStepConfig),f=a(c),g=a('span[data-flexitour="container"]'),h=void 0;e&&(f=f.filter(function(a,b){return null!=e&&(e.has(b).length||g.has(b).length||e.is(b)||g.is(b))})),f.each(function(a,b){if(d.is(b))return h=a,!1});var i=void 0,j=void 0,k=void 0;if(void 0!=h){var l=1;b.shiftKey&&(l=-1),i=h;do i+=l,j=a(f[i]);while(j.length&&j.is(":disabled")||j.is(":hidden"));j.length?(k=j.closest(e).length,k=k||j.closest(this.currentStepNode).length):k=!1}k?j.focus():b.shiftKey?this.currentStepNode.find(c).last().focus():this.currentStepConfig.isOrphan?this.currentStepNode.focus():e.focus(),b.preventDefault()}}).call(this)}},c.prototype.startTour=function(a){if(this.storage&&"undefined"==typeof a){var b=this.storage.getItem(this.storageKey);if(b){var c=parseInt(b,10);c<=this.steps.length&&(a=c)}}return"undefined"==typeof a&&(a=this.getCurrentStepNumber()),this.fireEventHandlers("beforeStart",a),this.gotoStep(a),this.fireEventHandlers("afterStart",a),this},c.prototype.restartTour=function(){return this.startTour(0)},c.prototype.endTour=function(){if(this.fireEventHandlers("beforeEnd"),this.currentStepConfig){var a=this.getStepTarget(this.currentStepConfig);a&&(a.attr("tabindex")||a.attr("tabindex","-1"),a.focus())}return this.hide(!0),this.fireEventHandlers("afterEnd"),this},c.prototype.hide=function(b){if(this.fireEventHandlers("beforeHide"),this.currentStepNode&&this.currentStepNode.length&&(this.currentStepNode.hide(),this.currentStepPopper&&this.currentStepPopper.destroy()),this.currentStepConfig){var c=this.getStepTarget(this.currentStepConfig);c&&(c.data("original-labelledby")&&c.attr("aria-labelledby",c.data("original-labelledby")),c.data("original-describedby")&&c.attr("aria-describedby",c.data("original-describedby")),c.data("original-tabindex")&&c.attr("tabindex",c.data("tabindex"))),this.currentStepConfig=null}var d=0;if(b&&(d=400),a('[data-flexitour="step-background"]').remove(),a('[data-flexitour="step-backdrop"]').removeAttr("data-flexitour"),a('[data-flexitour="backdrop"]').fadeOut(d,function(){a(this).remove()}),this.currentStepNode&&this.currentStepNode.length){var e=this.currentStepNode.attr("id");if(e){var f='[aria-describedby="'+e+'-body"]';a(f).removeAttr("tabindex"),a(f).removeAttr("aria-describedby")}}return this.resetStepListeners(),this.accessibilityHide(),this.fireEventHandlers("afterHide"),this.currentStepNode=null,this.currentStepPopper=null,this},c.prototype.show=function(){var a=this.getCurrentStepNumber();return this.gotoStep(a)},c.prototype.getStepContainer=function(){return a(this.currentStepNode)},c.prototype.calculateScrollTop=function(b){var c=a(window).scrollTop(),d=a(window).height(),e=this.getStepTarget(b);return c="top"===b.placement?e.offset().top-d/2:"bottom"===b.placement?e.offset().top+e.height()-d/2:e.height()<=.8*d?e.offset().top-(d-e.height())/2:e.offset().top-.2*d,c=Math.max(0,c),c=Math.min(a(document).height()-d,c),Math.ceil(c)},c.prototype.calculateStepPositionInPage=function(){var b=a(window).height(),c=this.currentStepNode.height(),d=a(window).width(),e=this.currentStepNode.width();return{top:Math.ceil((b-c)/2),left:Math.ceil((d-e)/2)}},c.prototype.positionStep=function(c){var d=this.currentStepNode;if(!d||!d.length)return this;var e=void 0;switch(c.placement){case"left":e=["left","right","top","bottom"];break;case"right":e=["right","left","top","bottom"];break;case"top":e=["top","bottom","right","left"];break;case"bottom":e=["bottom","top","right","left"];break;default:e="flip"}var f=this.getStepTarget(c),g={placement:c.placement+"-start",removeOnDestroy:!0,modifiers:{flip:{behaviour:e},arrow:{element:'[data-role="arrow"]'}},onCreate:function(a){h(a)},onUpdate:function(a){h(a)}},h=function(b){var c=b.placement.split("-")[0],d=["left","right"].indexOf(c)!==-1,e=b.instance.popper.querySelector('[data-role="arrow"]'),f=a(b.instance.popper.querySelector('[data-role="flexitour-step"]'));if(d){var g=parseFloat(window.getComputedStyle(e).height),h=parseFloat(window.getComputedStyle(e).top),i=parseFloat(window.getComputedStyle(b.instance.popper).height),j=parseFloat(window.getComputedStyle(b.instance.popper).top),k=parseFloat(f.css("borderTopWidth")),l=2*parseFloat(f.css("borderTopLeftRadius")),m=h+g/2,n=i+j-k-l,o=j+k+l;if(m>=n||m<=o){var p=0;p=m>i/2?n-g:o+g,a(e).css("top",p)}}else{var q=parseFloat(window.getComputedStyle(e).width),r=parseFloat(window.getComputedStyle(e).left),s=parseFloat(window.getComputedStyle(b.instance.popper).width),t=parseFloat(window.getComputedStyle(b.instance.popper).left),u=parseFloat(f.css("borderTopWidth")),v=2*parseFloat(f.css("borderTopLeftRadius")),w=r+q/2,x=s+t-u-v,y=t+u+v;if(w>=x||w<=y){var z=0;z=w>s/2?x-q:y+q,a(e).css("left",z)}}},i=a('[data-flexitour="step-background"]');return i.length&&(f=i),this.currentStepPopper=new b(f,d[0],g),this},c.prototype.positionBackdrop=function(b){if(b.backdrop){this.currentStepConfig.hasBackdrop=!0;var c=a('<div data-flexitour="backdrop"></div>');if(b.zIndex?"append"===b.attachPoint?b.attachTo.append(c):c.insertAfter(b.attachTo):a("body").append(c),this.isStepActuallyVisible(b)){var d=a('<div data-flexitour="step-background"></div>'),e=this.getStepTarget(b),f=10,g=e;f&&(g=a("body")),e.css("backgroundColor",this.calculateInherittedBackgroundColor(e));var h={top:e.position().top-f,left:e.position().left-f,width:e.outerWidth()+f+f,height:e.outerHeight()+f+f,backgroundColor:this.calculateInherittedBackgroundColor(g)};b.zIndex||(h.left=e.offset().left-f,h.top=e.offset().top-f),e.offset().left<f&&(h.width=e.outerWidth()+e.offset().left+f,h.left=e.offset().left),e.offset().top<f&&(h.height=e.outerHeight()+e.offset().top+f,h.top=e.offset().top),d.css(h);var i=e.css("borderRadius");i&&i!==a("body").css("borderRadius")&&d.css("borderRadius",i);var j=this.calculatePosition(e);"fixed"===j?d.css("top",0):"absolute"===j&&d.css("position","fixed");var k=d.clone();k.css({backgroundColor:c.css("backgroundColor"),opacity:c.css("opacity")}),k.attr("data-flexitour","step-background-fader"),b.zIndex?"append"===b.attachPoint?b.attachTo.append(d):(k.insertAfter(b.attachTo),d.insertAfter(b.attachTo)):(a("body").append(k),a("body").append(d)),e.attr("data-flexitour","step-backdrop"),b.zIndex&&(c.css("zIndex",b.zIndex),d.css("zIndex",b.zIndex+1),e.css("zIndex",b.zIndex+2)),k.fadeOut("2000",function(){a(this).remove()})}}return this},c.prototype.calculateZIndex=function(b){for(b=a(b);b.length&&b[0]!==document;){var c=b.css("position");if("absolute"===c||"relative"===c||"fixed"===c){var d=parseInt(b.css("zIndex"),10);if(!isNaN(d)&&0!==d)return d}b=b.parent()}return 0},c.prototype.calculateInherittedBackgroundColor=function(b){var c=a("<div>").hide();a("body").append(c);var d=c.css("backgroundColor");for(c.remove(),b=a(b);b.length&&b[0]!==document;){var e=b.css("backgroundColor");if(e!==d)return e;b=b.parent()}return null},c.prototype.calculatePosition=function(b){for(b=a(b);b.length&&b[0]!==document;){var c=b.css("position");if("static"!==c)return c;b=b.parent()}return null},c.prototype.accessibilityShow=function(){var b="data-has-hidden",c="aria-hidden",d=function(a){var d=a.data("flexitour");if(d)switch(d){case"container":case"target":return}var e=a.attr(c);e||(a.attr(b,!0),a.attr(c,!0))};this.currentStepNode.siblings().each(function(b,c){d(a(c))}),this.currentStepNode.parentsUntil("body").siblings().each(function(b,c){d(a(c))})},c.prototype.accessibilityHide=function(){var b="data-has-hidden",c="aria-hidden",d=function(a){var d=a.attr(b);"undefined"!=typeof d&&(a.removeAttr(b),a.removeAttr(c))};a("["+b+"]").each(function(b,c){d(a(c))})},"object"===("undefined"==typeof exports?"undefined":d(exports))&&(module.exports=c),c});
define('tool_usertours/usertours', ["core/ajax","tool_usertours/tour","jquery","core/templates","core/str","core/log","core/notification"],function(a,b,c,d,e,f,g){var h={tourId:null,currentTour:null,context:null,init:function(a,b,d){h.tourId&&h.context||(h.tourId=a,h.context=d,"undefined"==typeof b&&(b=!0),b&&h.fetchTour(a),h.addResetLink(),c("body").on("click",'[data-action="tool_usertours/resetpagetour"]',function(a){a.preventDefault(),h.resetTourState(h.tourId)}))},fetchTour:function(b){M.util.js_pending("admin_usertour_fetchTour"+b),c.when(a.call([{methodname:"tool_usertours_fetch_and_start_tour",args:{tourid:b,context:h.context,pageurl:window.location.href}}])[0],d.render("tool_usertours/tourstep",{})).then(function(a,c){if(1==a.showtour)return h.startBootstrapTour(b,c[0],a.tourconfig)}).always(function(){M.util.js_complete("admin_usertour_fetchTour"+b)}).fail(g.exception)},addResetLink:function(){M.util.js_pending("admin_usertour_addResetLink"),e.get_string("resettouronpage","tool_usertours").done(function(a){c("footer, .logininfo").last().append('<div class="usertour"><a href="#" data-action="tool_usertours/resetpagetour">'+a+"</a></div>")}).always(function(){M.util.js_complete("admin_usertour_addResetLink")}).fail()},startBootstrapTour:function(a,c,d){return h.currentTour&&(d.onEnd=null,h.currentTour.endTour(),delete h.currentTour),d.eventHandlers={afterEnd:[h.markTourComplete],afterRender:[h.markStepShown]},d.tourName=d.name,delete d.name,d.template=c,d.steps=d.steps.map(function(a){return"undefined"!=typeof a.element&&(a.target=a.element,delete a.element),"undefined"!=typeof a.reflex&&(a.moveOnClick=!!a.reflex,delete a.reflex),"undefined"!=typeof a.content&&(a.body=a.content,delete a.content),a}),h.currentTour=new b(d),h.currentTour.startTour()},markStepShown:function(){var b=this.getStepConfig(this.getCurrentStepNumber());c.when(a.call([{methodname:"tool_usertours_step_shown",args:{tourid:h.tourId,context:h.context,pageurl:window.location.href,stepid:b.stepid,stepindex:this.getCurrentStepNumber()}}])[0]).fail(f.error)},markTourComplete:function(){var b=this.getStepConfig(this.getCurrentStepNumber());c.when(a.call([{methodname:"tool_usertours_complete_tour",args:{tourid:h.tourId,context:h.context,pageurl:window.location.href,stepid:b.stepid,stepindex:this.getCurrentStepNumber()}}])[0]).fail(f.error)},resetTourState:function(b){c.when(a.call([{methodname:"tool_usertours_reset_tour",args:{tourid:b,context:h.context,pageurl:window.location.href}}])[0]).then(function(a){a.startTour&&h.fetchTour(a.startTour)}).fail(g.exception)}};return{init:h.init,resetTourState:h.resetTourState}});
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define('tool_usertours/popper', b):a.Popper=b()}(this,function(){"use strict";function a(a){var b=a.offsetParent,c=b&&b.nodeName;return c&&"BODY"!==c&&"HTML"!==c?b:window.document.documentElement}function b(a,b){if(1!==a.nodeType)return[];var c=window.getComputedStyle(a,null);return b?c[b]:c}function c(a){return"HTML"===a.nodeName?a:a.parentNode||a.host}function d(a){if(!a||["HTML","BODY","#document"].indexOf(a.nodeName)!==-1)return window.document.body;var e=b(a),f=e.overflow,g=e.overflowX,h=e.overflowY;return/(auto|scroll)/.test(f+h+g)?a:d(c(a))}function e(a){var d=a.nodeName;return"BODY"!==d&&"HTML"!==d&&("fixed"===b(a,"position")||e(c(a)))}function f(b){var c=a(b),d=e(c);return d?"fixed":"absolute"}function g(a,b){var c="x"===b?"Left":"Top",d="Left"===c?"Right":"Bottom";return Number(a["border"+c+"Width"].split("px")[0])+Number(a["border"+d+"Width"].split("px")[0])}function h(a){var c=navigator.appVersion.indexOf("MSIE 10")!==-1,d=void 0;if(c)try{d=a.getBoundingClientRect()}catch(e){d={}}else d=a.getBoundingClientRect();var f={left:d.left,top:d.top,right:d.right,bottom:d.bottom,width:d.right-d.left,height:d.bottom-d.top};if("HTML"===a.nodeName&&c){var h=window.document.documentElement,i=h.scrollTop,j=h.scrollLeft;f.top-=i,f.bottom-=i,f.left-=j,f.right-=j}var k=d.width-(a.clientWidth||d.right-d.left),l=d.height-(a.clientHeight||d.bottom-d.top);if(k||l){var m=b(a);k-=g(m,"x"),l-=g(m,"y")}return f.right-=k,f.width-=k,f.bottom-=l,f.height-=l,f}function i(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",c="top"===b?"scrollTop":"scrollLeft",d=a.nodeName;if("BODY"===d||"HTML"===d){var e=window.document.documentElement,f=window.document.scrollingElement||e;return f[c]}return a[c]}function j(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=i(b,"top"),e=i(b,"left"),f=c?-1:1;return a.top+=d*f,a.bottom+=d*f,a.left+=e*f,a.right+=e*f,a}function k(c,e){var f=arguments.length>2&&void 0!==arguments[2]&&arguments[2],g=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=d(e),k=h(c),l=h(e),m={top:k.top-l.top,left:k.left-l.left,bottom:k.top-l.top+k.height,right:k.left-l.left+k.width,width:k.width,height:k.height};f&&!g?m=j(m,i,!0):a(c).contains(i)&&"BODY"!==i.nodeName&&(m=j(m,e));var n=b(e),o=Number(n.borderTopWidth.split("px")[0]),p=Number(n.borderLeftWidth.split("px")[0]);return m.top-=o,m.bottom-=o,m.left-=p,m.right-=p,m}function l(){var a=window.document.body,b=window.document.documentElement;return{height:Math.max(a.scrollHeight,a.offsetHeight,b.clientHeight,b.scrollHeight,b.offsetHeight),width:Math.max(a.scrollWidth,a.offsetWidth,b.clientWidth,b.scrollWidth,b.offsetWidth)}}function m(a){var b=void 0;if("HTML"===a.nodeName){var c=l(),d=c.width,e=c.height;b={width:d,height:e,left:0,top:0}}else b={width:a.offsetWidth,height:a.offsetHeight,left:a.offsetLeft,top:a.offsetTop};return b.right=b.left+b.width,b.bottom=b.top+b.height,b}function n(b){var c=m(b);if("HTML"!==b.nodeName){var d=a(b),e=n(d),f={width:c.offsetWidth,height:c.offsetHeight,left:c.left+e.left,top:c.top+e.top,right:c.right-e.right,bottom:c.bottom-e.bottom};return f}return c}function o(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",e=d(a),f=i(e,b);return["BODY","HTML"].indexOf(e.nodeName)===-1?f+o(c(e),b):f}function p(b,g,h){var i={top:0,left:0},j=a(b);if("viewport"===h){var m=n(j),p=m.left,q=m.top,r=window.document.documentElement,s=r.clientWidth,t=r.clientHeight;if("fixed"===f(b))i.right=s,i.bottom=t;else{var u=o(b,"left"),v=o(b,"top");i={top:0-q,right:s-p+u,bottom:t-q+v,left:0-p}}}else{var w=void 0;if(w="scrollParent"===h?d(c(b)):"window"===h?window.document.body:h,"BODY"===w.nodeName){var x=l(),y=x.height,z=x.width;i.right=z,i.bottom=y}else i=k(w,j,e(b))}return i.left+=g,i.top+=g,i.right-=g,i.bottom-=g,i}function q(a,b,c){if(a.indexOf("auto")===-1)return a;var d=p(c,0,"scrollParent"),e={top:b.top-d.top,right:d.right-b.right,bottom:d.bottom-b.bottom,left:b.left-d.left},f=Object.keys(e).sort(function(a,b){return e[b]-e[a]})[0],g=a.split("-")[1];return f+(g?"-"+g:"")}function r(a){var b=!1,c=0,d=document.createElement("span"),e=new MutationObserver(function(){a(),b=!1});return e.observe(d,{attributes:!0}),function(){b||(b=!0,d.setAttribute("x-index",c),c+=1)}}function s(a){var b=!1;return function(){b||(b=!0,setTimeout(function(){b=!1,a()},_))}}function t(a,b){return Array.prototype.find?a.find(b):a.filter(b)[0]}function u(a,b,c){if(Array.prototype.findIndex)return a.findIndex(function(a){return a[b]===c});var d=t(a,function(a){return a[b]===c});return a.indexOf(d)}function v(a){return ga({},a,{right:a.left+a.width,bottom:a.top+a.height})}function w(a){var b=window.getComputedStyle(a),c=parseFloat(b.marginTop)+parseFloat(b.marginBottom),d=parseFloat(b.marginLeft)+parseFloat(b.marginRight),e={width:a.offsetWidth+d,height:a.offsetHeight+c};return e}function x(a){var b={left:"right",right:"left",bottom:"top",top:"bottom"};return a.replace(/left|right|bottom|top/g,function(a){return b[a]})}function y(a,b,c,d){d=d.split("-")[0];var e=w(b),f={position:a,width:e.width,height:e.height},g=["right","left"].indexOf(d)!==-1,h=g?"top":"left",i=g?"left":"top",j=g?"height":"width",k=g?"width":"height";return f[h]=c[h]+c[j]/2-e[j]/2,d===i?f[i]=c[i]-e[k]:f[i]=c[x(i)],f}function z(b,c,d){var e="fixed"===b.position,f=b.isParentTransformed,g=a(e&&f?d:c);return k(d,g,e,f)}function A(a){for(var b=[!1,"ms","webkit","moz","o"],c=a.charAt(0).toUpperCase()+a.slice(1),d=0;d<b.length-1;d++){var e=b[d],f=e?""+e+c:a;if("undefined"!=typeof window.document.body.style[f])return f}return null}function B(a){var b={};return a&&"[object Function]"===b.toString.call(a)}function C(a,b){return a.some(function(a){var c=a.name,d=a.enabled;return d&&c===b})}function D(a,b,c){var d=t(a,function(a){var c=a.name;return c===b});return!!d&&a.some(function(a){return a.name===c&&a.enabled&&a.order<d.order})}function E(a){return""!==a&&!isNaN(parseFloat(a))&&isFinite(a)}function F(a){return"BODY"!==a.nodeName&&("none"!==b(a,"transform")||(c(a)?F(c(a)):a))}function G(a,b){return window.removeEventListener("resize",b.updateBound),b.scrollParents.forEach(function(a){a.removeEventListener("scroll",b.updateBound)}),b.updateBound=null,b.scrollParents=[],b.scrollElement=null,b.eventsEnabled=!1,b}function H(a,b,c){var d=void 0===c?a:a.slice(0,u(a,"name",c));return d.forEach(function(a){a.enabled&&B(a["function"])&&(b=a["function"](b,a))}),b}function I(a,b){Object.keys(b).forEach(function(c){var d=b[c];d!==!1?a.setAttribute(c,b[c]):a.removeAttribute(c)})}function J(a,b){Object.keys(b).forEach(function(c){var d="";["width","height","top","right","bottom","left"].indexOf(c)!==-1&&E(b[c])&&(d="px"),a.style[c]=b[c]+d})}function K(a,b,c,e){var f="BODY"===a.nodeName,g=f?window:a;g.addEventListener(b,c,{passive:!0}),f||K(d(g.parentNode),b,c,e),e.push(g)}function L(a,b,c,e){c.updateBound=e,window.addEventListener("resize",c.updateBound,{passive:!0});var f=d(a);return K(f,"scroll",c.updateBound,c.scrollParents),c.scrollElement=f,c.eventsEnabled=!0,c}function M(a,b){var c={position:a.offsets.popper.position},d={"x-placement":a.placement},e=Math.round(a.offsets.popper.left),f=Math.round(a.offsets.popper.top),g=A("transform");return b.gpuAcceleration&&g?(c[g]="translate3d("+e+"px, "+f+"px, 0)",c.top=0,c.left=0,c.willChange="transform"):(c.left=e,c.top=f,c.willChange="top, left"),J(a.instance.popper,ga({},c,a.styles)),I(a.instance.popper,ga({},d,a.attributes)),a.offsets.arrow&&J(a.arrowElement,a.offsets.arrow),a}function N(a,b,c,d,e){var f=z(e,b,a);return c.placement=q(c.placement,f,b),b.setAttribute("x-placement",c.placement),c}function O(a,b){if(!D(a.instance.modifiers,"arrow","keepTogether"))return console.warn("WARNING: `keepTogether` modifier is required by arrow modifier in order to work, be sure to include it before `arrow`!"),a;var c=b.element;if("string"==typeof c){if(c=a.instance.popper.querySelector(c),!c)return a}else if(!a.instance.popper.contains(c))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),a;var d=a.placement.split("-")[0],e=v(a.offsets.popper),f=a.offsets.reference,g=["left","right"].indexOf(d)!==-1,h=g?"height":"width",i=g?"top":"left",j=g?"left":"top",k=g?"bottom":"right",l=w(c)[h];f[k]-l<e[i]&&(a.offsets.popper[i]-=e[i]-(f[k]-l)),f[i]+l>e[k]&&(a.offsets.popper[i]+=f[i]+l-e[k]);var m=f[i]+f[h]/2-l/2,n=m-v(a.offsets.popper)[i];return n=Math.max(Math.min(e[h]-l,n),0),a.arrowElement=c,a.offsets.arrow={},a.offsets.arrow[i]=n,a.offsets.arrow[j]="",a}function P(a){return"end"===a?"start":"start"===a?"end":a}function Q(a,b){if(C(a.instance.modifiers,"inner"))return a;if(a.flipped&&a.placement===a.originalPlacement)return a;var c=p(a.instance.popper,b.padding,b.boundariesElement),d=a.placement.split("-")[0],e=x(d),f=a.placement.split("-")[1]||"",g=[];return g="flip"===b.behavior?[d,e]:b.behavior,g.forEach(function(h,i){if(d!==h||g.length===i+1)return a;d=a.placement.split("-")[0],e=x(d);var j=v(a.offsets.popper),k=a.offsets.reference,l=Math.floor,m="left"===d&&l(j.right)>l(k.left)||"right"===d&&l(j.left)<l(k.right)||"top"===d&&l(j.bottom)>l(k.top)||"bottom"===d&&l(j.top)<l(k.bottom),n=l(j.left)<l(c.left),o=l(j.right)>l(c.right),p=l(j.top)<l(c.top),q=l(j.bottom)>l(c.bottom),r="left"===d&&n||"right"===d&&o||"top"===d&&p||"bottom"===d&&q,s=["top","bottom"].indexOf(d)!==-1,t=!!b.flipVariations&&(s&&"start"===f&&n||s&&"end"===f&&o||!s&&"start"===f&&p||!s&&"end"===f&&q);(m||r||t)&&(a.flipped=!0,(m||r)&&(d=g[i+1]),t&&(f=P(f)),a.placement=d+(f?"-"+f:""),a.offsets.popper=y(a.instance.state.position,a.instance.popper,a.offsets.reference,a.placement),a=H(a.instance.modifiers,a,"flip"))}),a}function R(a){var b=v(a.offsets.popper),c=a.offsets.reference,d=a.placement.split("-")[0],e=Math.floor,f=["top","bottom"].indexOf(d)!==-1,g=f?"right":"bottom",h=f?"left":"top",i=f?"width":"height";return b[g]<e(c[h])&&(a.offsets.popper[h]=e(c[h])-b[i]),b[h]>e(c[g])&&(a.offsets.popper[h]=e(c[g])),a}function S(a,b){var c=a.placement,d=a.offsets.popper,e=void 0;return E(b.offset)?e=[b.offset,0]:(e=b.offset.split(" "),e=e.map(function(b,d){var e=b.match(/(\d*\.?\d*)(.*)/),f=+e[1],g=e[2],h=c.indexOf("right")!==-1||c.indexOf("left")!==-1;1===d&&(h=!h);var i=h?"height":"width";if(0===g.indexOf("%")){var j=void 0;switch(g){case"%p":j=a.offsets.popper;break;case"%":case"$r":default:j=a.offsets.reference}var k=v(j),l=k[i];return l/100*f}if("vh"===g||"vw"===g){var m=void 0;return m="vh"===g?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),m/100*f}return"px"===g?+f:+b})),a.placement.indexOf("left")!==-1?(d.top+=e[0],d.left-=e[1]||0):a.placement.indexOf("right")!==-1?(d.top+=e[0],d.left+=e[1]||0):a.placement.indexOf("top")!==-1?(d.left+=e[0],d.top-=e[1]||0):a.placement.indexOf("bottom")!==-1&&(d.left+=e[0],d.top+=e[1]||0),a}function T(b,c){var d=c.boundariesElement||a(b.instance.popper),e=p(b.instance.popper,c.padding,d);c.boundaries=e;var f=c.priority,g=v(b.offsets.popper),h={primary:function(a){var b=g[a];return g[a]<e[a]&&!c.escapeWithReference&&(b=Math.max(g[a],e[a])),fa({},a,b)},secondary:function(a){var b="right"===a?"left":"top",d=g[b];return g[a]>e[a]&&!c.escapeWithReference&&(d=Math.min(g[b],e[a]-("right"===a?g.width:g.height))),fa({},b,d)}};return f.forEach(function(a){var b=["left","top"].indexOf(a)!==-1?"primary":"secondary";g=ga({},g,h[b](a))}),b.offsets.popper=g,b}function U(a){var b=a.placement,c=b.split("-")[0],d=b.split("-")[1];if(d){var e=a.offsets.reference,f=v(a.offsets.popper),g=["bottom","top"].indexOf(c)!==-1,h=g?"left":"top",i=g?"width":"height",j={start:fa({},h,e[h]),end:fa({},h,e[h]+e[i]-f[i])};a.offsets.popper=ga({},f,j[d])}return a}function V(a){if(!D(a.instance.modifiers,"hide","preventOverflow"))return console.warn("WARNING: preventOverflow modifier is required by hide modifier in order to work, be sure to include it before hide!"),a;var b=a.offsets.reference,c=t(a.instance.modifiers,function(a){return"preventOverflow"===a.name}).boundaries;if(b.bottom<c.top||b.left>c.right||b.top>c.bottom||b.right<c.left){if(a.hide===!0)return a;a.hide=!0,a.attributes["x-out-of-boundaries"]=""}else{if(a.hide===!1)return a;a.hide=!1,a.attributes["x-out-of-boundaries"]=!1}return a}function W(a){var b=a.placement,c=b.split("-")[0],d=v(a.offsets.popper),e=v(a.offsets.reference),f=["left","right"].indexOf(c)!==-1,g=["top","left"].indexOf(c)===-1;return d[f?"left":"top"]=e[b]-(g?d[f?"width":"height"]:0),a.placement=x(b),a.offsets.popper=v(d),a}for(var X=["native code","[object MutationObserverConstructor]"],Y=function(a){return X.some(function(b){return(a||"").toString().indexOf(b)>-1})},Z="undefined"!=typeof window,$=["Edge","Trident","Firefox"],_=0,aa=0;aa<$.length;aa+=1)if(Z&&navigator.userAgent.indexOf($[aa])>=0){_=1;break}var ba=Z&&Y(window.MutationObserver),ca=ba?r:s,da=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},ea=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),fa=function(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a},ga=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},ha={computeAutoPlacement:q,debounce:ca,findIndex:u,getBordersSize:g,getBoundaries:p,getBoundingClientRect:h,getClientRect:v,getOffsetParent:a,getOffsetRect:m,getOffsetRectRelativeToCustomParent:k,getOuterSizes:w,getParentNode:c,getPopperOffsets:y,getPosition:f,getReferenceOffsets:z,getScroll:i,getScrollParent:d,getStyleComputedProperty:b,getSupportedPropertyName:A,getTotalScroll:o,getWindowSizes:l,includeScroll:j,isFixed:e,isFunction:B,isModifierEnabled:C,isModifierRequired:D,isNative:Y,isNumeric:E,isTransformed:F,removeEventListeners:G,runModifiers:H,setAttributes:I,setStyles:J,setupEventListeners:L},ia={shift:{order:100,enabled:!0,"function":U},offset:{order:200,enabled:!0,"function":S,offset:0},preventOverflow:{order:300,enabled:!0,"function":T,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,"function":R},arrow:{order:500,enabled:!0,"function":O,element:"[x-arrow]"},flip:{order:600,enabled:!0,"function":Q,behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,"function":W},hide:{order:800,enabled:!0,"function":V},applyStyle:{order:900,enabled:!0,gpuAcceleration:!0,"function":M,onLoad:N}},ja={placement:"bottom",eventsEnabled:!0,onCreate:function(){},onUpdate:function(){},modifiers:ia},ka=function(){function a(b,c){var d=this,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};da(this,a),this.scheduleUpdate=function(){return requestAnimationFrame(d.update)},this.update=ca(this.update.bind(this)),this.options=ga({},a.Defaults,e),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=b.jquery?b[0]:b,this.popper=c.jquery?c[0]:c,this.modifiers=Object.keys(a.Defaults.modifiers).map(function(b){return ga({name:b},a.Defaults.modifiers[b])}),this.modifiers=this.modifiers.map(function(a){var b=e.modifiers&&e.modifiers[a.name]||{};return ga({},a,b)}),e.modifiers&&(this.options.modifiers=ga({},a.Defaults.modifiers,e.modifiers),Object.keys(e.modifiers).forEach(function(b){if(void 0===a.Defaults.modifiers[b]){var c=e.modifiers[b];c.name=b,d.modifiers.push(c)}})),this.state.position=f(this.reference),this.modifiers=this.modifiers.sort(function(a,b){return a.order-b.order}),this.modifiers.forEach(function(a){a.enabled&&B(a.onLoad)&&a.onLoad(d.reference,d.popper,d.options,a,d.state)}),this.state.isParentTransformed=F(this.popper.parentNode),this.update();var g=this.options.eventsEnabled;g&&this.enableEventListeners(),this.state.eventsEnabled=g}return ea(a,[{key:"update",value:function(){if(!this.state.isDestroyed){var a={instance:this,styles:{},attributes:{},flipped:!1,offsets:{}};this.state.position=f(this.reference),J(this.popper,{position:this.state.position}),a.offsets.reference=z(this.state,this.popper,this.reference),a.placement=q(this.options.placement,a.offsets.reference,this.popper),a.originalPlacement=this.options.placement,a.offsets.popper=y(this.state,this.popper,a.offsets.reference,a.placement),a=H(this.modifiers,a),this.state.isCreated?this.options.onUpdate(a):(this.state.isCreated=!0,this.options.onCreate(a))}}},{key:"destroy",value:function(){return this.state.isDestroyed=!0,C(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.left="",this.popper.style.position="",this.popper.style.top="",this.popper.style[A("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}},{key:"enableEventListeners",value:function(){this.state.eventsEnabled||(this.state=L(this.reference,this.options,this.state,this.scheduleUpdate))}},{key:"disableEventListeners",value:function(){this.state.eventsEnabled&&(window.cancelAnimationFrame(this.scheduleUpdate),this.state=G(this.reference,this.state))}}]),a}();return ka.Utils=ha,ka.placements=["auto","auto-start","auto-end","top","top-start","top-end","right","right-start","right-end","bottom","bottom-start","bottom-end","left","left-start","left-end"],ka.Defaults=ja,ka});
define('tool_usertours/managetours', ["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){var e={removeTour:function(b){b.preventDefault(),c.get_strings([{key:"confirmtourremovaltitle",component:"tool_usertours"},{key:"confirmtourremovalquestion",component:"tool_usertours"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],a.proxy(function(){window.location=a(this).attr("href")},b.currentTarget))})},setup:function(){a("body").delegate('[data-action="delete"]',"click",e.removeTour)}};return{setup:e.setup}});
define('theme_roots/bootstrap', ["jquery","core/log"],function(a,b){function c(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.alert");d||c.data("bs.alert",d=new t(this)),"string"==typeof b&&d[b].call(c)})}function e(b){return this.each(function(){var c=a(this),d=c.data("bs.button"),e="object"==typeof b&&b;d||c.data("bs.button",d=new v(this,e)),"toggle"==b?d.toggle():b&&d.setState(b)})}function f(b){return this.each(function(){var c=a(this),d=c.data("bs.carousel"),e=a.extend({},w.DEFAULTS,c.data(),"object"==typeof b&&b),f="string"==typeof b?b:e.slide;d||c.data("bs.carousel",d=new w(this,e)),"number"==typeof b?d.to(b):f?d[f]():e.interval&&d.pause().cycle()})}function g(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(document).find(d)}function h(b){return this.each(function(){var c=a(this),d=c.data("bs.collapse"),e=a.extend({},y.DEFAULTS,c.data(),"object"==typeof b&&b);!d&&e.toggle&&/show|hide/.test(b)&&(e.toggle=!1),d||c.data("bs.collapse",d=new y(this,e)),"string"==typeof b&&d[b]()})}function i(b){b&&3===b.which||(a(z).remove(),a(A).each(function(){var c=a(this),d=j(c),e={relatedTarget:this};d.hasClass("open")&&(b&&"click"==b.type&&/input|textarea/i.test(b.target.tagName)&&a.contains(d[0],b.target)||(d.trigger(b=a.Event("hide.bs.dropdown",e)),b.isDefaultPrevented()||(c.attr("aria-expanded","false"),d.removeClass("open").trigger("hidden.bs.dropdown",e))))}))}function j(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(document).find(c);return d&&d.length?d:b.parent()}function k(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new B(this)),"string"==typeof b&&d[b].call(c)})}function l(b,c){return this.each(function(){var d=a(this),e=d.data("bs.modal"),f=a.extend({},C.DEFAULTS,d.data(),"object"==typeof b&&b);e||d.data("bs.modal",e=new C(this,f)),"string"==typeof b?e[b](c):f.show&&e.show(c)})}function m(b){return this.each(function(){var c=a(this),d=c.data("bs.tooltip"),e="object"==typeof b&&b;!d&&/destroy|hide/.test(b)||(d||c.data("bs.tooltip",d=new D(this,e)),"string"==typeof b&&d[b]())})}function n(b){return this.each(function(){var c=a(this),d=c.data("bs.popover"),e="object"==typeof b&&b;!d&&/destroy|hide/.test(b)||(d||c.data("bs.popover",d=new E(this,e)),"string"==typeof b&&d[b]())})}function o(b,c){this.$body=a(document.body),this.$scrollElement=a(a(b).is(document.body)?window:b),this.options=a.extend({},o.DEFAULTS,c),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function p(b){return this.each(function(){var c=a(this),d=c.data("bs.scrollspy"),e="object"==typeof b&&b;d||c.data("bs.scrollspy",d=new o(this,e)),"string"==typeof b&&d[b]()})}function q(b){return this.each(function(){var c=a(this),d=c.data("bs.tab");d||c.data("bs.tab",d=new F(this)),"string"==typeof b&&d[b]()})}function r(b){return this.each(function(){var c=a(this),d=c.data("bs.affix"),e="object"==typeof b&&b;d||c.data("bs.affix",d=new G(this,e)),"string"==typeof b&&d[b]()})}a(".h1").hide(),b.debug("Bootstrap AMD initialised"),a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=c(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){if(a(b.target).is(this))return b.handleObj.handler.apply(this,arguments)}})});var s='[data-dismiss="alert"]',t=function(b){a(b).on("click",s,this.close)};t.VERSION="3.3.4",t.TRANSITION_DURATION=150,t.prototype.close=function(b){function c(){f.detach().trigger("closed.bs.alert").remove()}var d=a(this),e=d.attr("data-target");e||(e=d.attr("href"),e=e&&e.replace(/.*(?=#[^\s]*$)/,"")),e="#"===e?[]:e;var f=a(document).find(e);b&&b.preventDefault(),f.length||(f=d.closest(".alert")),f.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",c).emulateTransitionEnd(t.TRANSITION_DURATION):c())};var u=a.fn.alert;a.fn.alert=d,a.fn.alert.Constructor=t,a.fn.alert.noConflict=function(){return a.fn.alert=u,this},a(document).on("click.bs.alert.data-api",s,t.prototype.close);var v=function(b,c){this.$element=a(b),this.options=a.extend({},v.DEFAULTS,c),this.isLoading=!1};v.VERSION="3.3.4",v.DEFAULTS={loadingText:"loading..."},v.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c))},this),0)},v.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")&&(c.prop("checked")&&this.$element.hasClass("active")?a=!1:b.find(".active").removeClass("active")),a&&c.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));a&&this.$element.toggleClass("active")};var u=a.fn.button;a.fn.button=e,a.fn.button.Constructor=v,a.fn.button.noConflict=function(){return a.fn.button=u,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),e.call(c,"toggle"),b.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))});var w=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};w.VERSION="3.3.4",w.TRANSITION_DURATION=600,w.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},w.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},w.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},w.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},w.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b),d="prev"==a&&0===c||"next"==a&&c==this.$items.length-1;if(d&&!this.options.wrap)return b;var e="prev"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},w.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(a>this.$items.length-1||a<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",this.$items.eq(a))},w.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},w.prototype.next=function(){if(!this.sliding)return this.slide("next")},w.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},w.prototype.slide=function(b,c){var d=this.$element.find(".item.active"),e=c||this.getItemForDirection(b,d),f=this.interval,g="next"==b?"left":"right",h=this;if(e.hasClass("active"))return this.sliding=!1;var i=e[0],j=a.Event("slide.bs.carousel",{relatedTarget:i,direction:g});if(this.$element.trigger(j),!j.isDefaultPrevented()){if(this.sliding=!0,f&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var k=a(this.$indicators.children()[this.getItemIndex(e)]);k&&k.addClass("active")}var l=a.Event("slid.bs.carousel",{relatedTarget:i,direction:g});return a.support.transition&&this.$element.hasClass("slide")?(e.addClass(b),e[0].offsetWidth,d.addClass(g),e.addClass(g),d.one("bsTransitionEnd",function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),h.sliding=!1,setTimeout(function(){h.$element.trigger(l)},0)}).emulateTransitionEnd(w.TRANSITION_DURATION)):(d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger(l)),f&&this.cycle(),this}};var u=a.fn.carousel;a.fn.carousel=f,a.fn.carousel.Constructor=w,a.fn.carousel.noConflict=function(){return a.fn.carousel=u,this};var x=function(b){var c=a(this),d=c.attr("href");d&&(d=d.replace(/.*(?=#[^\s]+$)/,""));var e=c.attr("data-target")||d,g=a(document).find(e);if(g.hasClass("carousel")){var h=a.extend({},g.data(),c.data()),i=c.attr("data-slide-to");i&&(h.interval=!1),f.call(g,h),i&&g.data("bs.carousel").to(i),b.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",x).on("click.bs.carousel.data-api","[data-slide-to]",x),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var b=a(this);f.call(b,b.data())})});var y=function(b,c){this.$element=a(b),this.options=a.extend({},y.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};y.VERSION="3.3.4",y.TRANSITION_DURATION=350,y.DEFAULTS={toggle:!0},y.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},y.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,c=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(c&&c.length&&(b=c.data("bs.collapse"),b&&b.transitioning))){var d=a.Event("show.bs.collapse");if(this.$element.trigger(d),!d.isDefaultPrevented()){c&&c.length&&(h.call(c,"hide"),b||c.data("bs.collapse",null));var e=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[e](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var f=function(){this.$element.removeClass("collapsing").addClass("collapse in")[e](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return f.call(this);var g=a.camelCase(["scroll",e].join("-"));this.$element.one("bsTransitionEnd",a.proxy(f,this)).emulateTransitionEnd(y.TRANSITION_DURATION)[e](this.$element[0][g])}}}},y.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var d=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(d,this)).emulateTransitionEnd(y.TRANSITION_DURATION):d.call(this)}}},y.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},y.prototype.getParent=function(){return a(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(b,c){var d=a(c);this.addAriaAndCollapsedClass(g(d),d)},this)).end()},y.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var u=a.fn.collapse;a.fn.collapse=h,a.fn.collapse.Constructor=y,a.fn.collapse.noConflict=function(){return a.fn.collapse=u,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(b){var c=a(this);c.attr("data-target")||b.preventDefault();var d=g(c),e=d.data("bs.collapse"),f=e?"toggle":c.data();h.call(d,f)});var z=".dropdown-backdrop",A='[data-toggle="dropdown"]',B=function(b){a(b).on("click.bs.dropdown",this.toggle)};B.VERSION="3.3.4",B.prototype.toggle=function(b){var c=a(this);if(!c.is(".disabled, :disabled")){var d=j(c),e=d.hasClass("open");if(i(),!e){"ontouchstart"in document.documentElement&&!d.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",i);var f={relatedTarget:this};if(d.trigger(b=a.Event("show.bs.dropdown",f)),b.isDefaultPrevented())return;c.trigger("focus").attr("aria-expanded","true"),d.toggleClass("open").trigger("shown.bs.dropdown",f)}return!1}},B.prototype.keydown=function(b){if(/(38|40|27|32)/.test(b.which)&&!/input|textarea/i.test(b.target.tagName)){var c=a(this);if(b.preventDefault(),b.stopPropagation(),!c.is(".disabled, :disabled")){var d=j(c),e=d.hasClass("open");if(!e&&27!=b.which||e&&27==b.which)return 27==b.which&&d.find(A).trigger("focus"),c.trigger("click");var f=" li:not(.disabled):visible a",g=d.find('[role="menu"]'+f+', [role="listbox"]'+f);if(g.length){var h=g.index(b.target);38==b.which&&h>0&&h--,40==b.which&&h<g.length-1&&h++,~h||(h=0),g.eq(h).trigger("focus")}}}};var u=a.fn.dropdown;a.fn.dropdown=k,a.fn.dropdown.Constructor=B,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=u,this},a(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",A,B.prototype.toggle).on("keydown.bs.dropdown.data-api",A,B.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',B.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',B.prototype.keydown);var C=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};C.VERSION="3.3.4",C.TRANSITION_DURATION=300,C.BACKDROP_TRANSITION_DURATION=150,C.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},C.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},C.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){c.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(c.$element)&&(c.ignoreBackdropClick=!0)})}),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(c.$body),c.$element.show().scrollTop(0),c.adjustDialog(),d&&c.$element[0].offsetWidth,c.$element.addClass("in").attr("aria-hidden",!1),c.enforceFocus();var e=a.Event("shown.bs.modal",{relatedTarget:b});d?c.$dialog.one("bsTransitionEnd",function(){c.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(C.TRANSITION_DURATION):c.$element.trigger("focus").trigger(e)}))},C.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(C.TRANSITION_DURATION):this.hideModal())},C.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},C.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},C.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},C.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},C.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},C.prototype.backdrop=function(b){var c=this,d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=a.support.transition&&d;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+d).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;e?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(C.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var f=function(){c.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",f).emulateTransitionEnd(C.BACKDROP_TRANSITION_DURATION):f()}else b&&b()},C.prototype.handleUpdate=function(){this.adjustDialog()},C.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},C.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},C.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},C.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},C.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},C.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var u=a.fn.modal;a.fn.modal=l,a.fn.modal.Constructor=C,a.fn.modal.noConflict=function(){return a.fn.modal=u,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,""),f=a(document).find(e),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},f.data(),c.data());c.is("a")&&b.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){c.is(":visible")&&c.trigger("focus")})}),l.call(f,g,this)});var D=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.init("tooltip",a,b)};D.VERSION="3.3.4",D.TRANSITION_DURATION=150,D.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},D.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(document).find(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},D.prototype.getDefaults=function(){return D.DEFAULTS},D.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},D.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},D.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c&&c.$tip&&c.$tip.is(":visible")?void(c.hoverState="in"):(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},D.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},D.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var c=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!c)return;var d=this,e=this.tip(),f=this.getUID(this.type);this.setContent(),e.attr("id",f),this.$element.attr("aria-describedby",f),this.options.animation&&e.addClass("fade");var g="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,h=/\s?auto?\s?/i,i=h.test(g);i&&(g=g.replace(h,"")||"top"),e.detach().css({top:0,left:0,display:"block"}).addClass(g).data("bs."+this.type,this),this.options.container?e.appendTo(a(document).find(this.options.container)):e.insertAfter(this.$element);var j=this.getPosition(),k=e[0].offsetWidth,l=e[0].offsetHeight;if(i){var m=g,n=this.options.container?a(this.options.container):this.$element.parent(),o=this.getPosition(n);g="bottom"==g&&j.bottom+l>o.bottom?"top":"top"==g&&j.top-l<o.top?"bottom":"right"==g&&j.right+k>o.width?"left":"left"==g&&j.left-k<o.left?"right":g,e.removeClass(m).addClass(g)}var p=this.getCalculatedOffset(g,j,k,l);this.applyPlacement(p,g);var q=function(){var a=d.hoverState;d.$element.trigger("shown.bs."+d.type),d.hoverState=null,"out"==a&&d.leave(d)};a.support.transition&&this.$tip.hasClass("fade")?e.one("bsTransitionEnd",q).emulateTransitionEnd(D.TRANSITION_DURATION):q()}},D.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top=b.top+g,b.left=b.left+h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},D.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},D.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},D.prototype.hide=function(b){function c(){"in"!=d.hoverState&&e.detach(),d.$element.removeAttr("aria-describedby").trigger("hidden.bs."+d.type),b&&b()}var d=this,e=a(this.$tip),f=a.Event("hide.bs."+this.type);if(this.$element.trigger(f),!f.isDefaultPrevented())return e.removeClass("in"),a.support.transition&&e.hasClass("fade")?e.one("bsTransitionEnd",c).emulateTransitionEnd(D.TRANSITION_DURATION):c(),this.hoverState=null,this},D.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},D.prototype.hasContent=function(){return this.getTitle()},D.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=d?{top:0,left:0}:b.offset(),g={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},h=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,g,h,f)},D.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},D.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.width&&(e.left=g.left+g.width-k)}return e},D.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},D.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},D.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},D.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},D.prototype.enable=function(){this.enabled=!0},D.prototype.disable=function(){this.enabled=!1},D.prototype.toggleEnabled=function(){this.enabled=!this.enabled},D.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),c.tip().hasClass("in")?c.leave(c):c.enter(c)},D.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type)})};var u=a.fn.tooltip;a.fn.tooltip=m,a.fn.tooltip.Constructor=D,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=u,this};var E=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");E.VERSION="3.3.4",E.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),E.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),E.prototype.constructor=E,E.prototype.getDefaults=function(){return E.DEFAULTS},E.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();if(this.options.html){var d=typeof c;this.options.sanitize&&(b=this.sanitizeHtml(b),"string"===d&&(c=this.sanitizeHtml(c))),a.find(".popover-title").html(b),a.find(".popover-content").children().detach().end()["string"===d?"html":"append"](c)}else a.find(".popover-title").text(b),a.find(".popover-content").children().detach().end().text(c);a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},E.prototype.hasContent=function(){return this.getTitle()||this.getContent()},E.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},E.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var u=a.fn.popover;a.fn.popover=n,a.fn.popover.Constructor=E,a.fn.popover.noConflict=function(){return a.fn.popover=u,this},o.VERSION="3.3.4",o.DEFAULTS={offset:10},o.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},o.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},o.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},o.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},o.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var u=a.fn.scrollspy;a.fn.scrollspy=p,a.fn.scrollspy.Constructor=o,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=u,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);p.call(b,b.data())})});var F=function(b){this.element=a(b)};F.VERSION="3.3.4",F.TRANSITION_DURATION=150,F.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");
if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(document).find(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},F.prototype.activate=function(b,c,d){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),g?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu").length&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),d&&d()}var f=c.find("> .active"),g=d&&a.support.transition&&(f.length&&f.hasClass("fade")||!!c.find("> .fade").length);f.length&&g?f.one("bsTransitionEnd",e).emulateTransitionEnd(F.TRANSITION_DURATION):e(),f.removeClass("in")};var u=a.fn.tab;a.fn.tab=q,a.fn.tab.Constructor=F,a.fn.tab.noConflict=function(){return a.fn.tab=u,this};var x=function(b){b.preventDefault(),q.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',x).on("click.bs.tab.data-api",'[data-toggle="pill"]',x);var G=function(b,c){this.options=a.extend({},G.DEFAULTS,c);var d=this.options.target===G.DEFAULTS.target?a(this.options.target):a(document).find(this.options.target);this.$target=d.on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};G.VERSION="3.3.4",G.RESET="affix affix-top affix-bottom",G.DEFAULTS={offset:0,target:window},G.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return e<c&&"top";if("bottom"==this.affixed)return null!=c?!(e+this.unpin<=f.top)&&"bottom":!(e+g<=a-d)&&"bottom";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&e<=c?"top":null!=d&&i+j>=a-d&&"bottom"},G.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(G.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},G.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},G.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),c=this.options.offset,d=c.top,e=c.bottom,f=a(document.body).height();"object"!=typeof c&&(e=d=c),"function"==typeof d&&(d=c.top(this.$element)),"function"==typeof e&&(e=c.bottom(this.$element));var g=this.getState(f,b,d,e);if(this.affixed!=g){null!=this.unpin&&this.$element.css("top","");var h="affix"+(g?"-"+g:""),i=a.Event(h+".bs.affix");if(this.$element.trigger(i),i.isDefaultPrevented())return;this.affixed=g,this.unpin="bottom"==g?this.getPinnedOffset():null,this.$element.removeClass(G.RESET).addClass(h).trigger(h.replace("affix","affixed")+".bs.affix")}"bottom"==g&&this.$element.offset({top:f-b-e})}};var u=a.fn.affix;a.fn.affix=r,a.fn.affix.Constructor=G,a.fn.affix.noConflict=function(){return a.fn.affix=u,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var b=a(this),c=b.data();c.offset=c.offset||{},null!=c.offsetBottom&&(c.offset.bottom=c.offsetBottom),null!=c.offsetTop&&(c.offset.top=c.offsetTop),r.call(b,c)})})});
define('contentmarketplace_goone/form_element_listeditor', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),this.container=null,this.inputs=null,void(this.validationerroradded=!1)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object ListeditorElement]"},c.prototype.init=function(b){var c=this.id,d=a("#"+c),e=a("#"+c+" li");e.find("a").on("click",a.proxy(this.removeItem,this)),1===e.length&&a("a",d).hide(),this.container=d,b()},c.prototype.getValue=function(){return this.container.find("input").map(function(){return a(this).val()}).get()},c.prototype.showLoading=function(){this.container.find(".tf_update_pending .tf_loading").show()},c.prototype.hideLoading=function(){this.container.find(".tf_loading").hide()},c.prototype.removeItem=function(b){b.preventDefault();var c=a(b.target).closest("li");c.addClass("tf_update_pending"),c.find("input").remove(),this.changed()},c});
define('contentmarketplace_goone/oauth', ["jquery"],function(a){var b={};return b.init=function(b){var c=a(b),d=c.data("oauthauthorizeurl");c.on("click",function(a){a.preventDefault();var b=500,c=700,e=window.screenLeft?window.screenLeft:window.screenX,f=window.screenTop?window.screenTop:window.screenY,g=e+window.innerWidth/2-b/2,h=f+window.innerHeight/2-c/2,i=window.open(d,"setup","height="+c+", width="+b+", top="+h+", left="+g);window.focus&&i.focus()})},b});
define('local_commerce/paypal', ["jquery"],(function(e){return{init:function(e,a){var r=[];e.items.forEach((function(a){r.unshift({name:a.product,unit_amount:{currency_code:e.currency,value:a.price},quantity:a.quantity})})),paypal.Buttons({createOrder:function(a,n){return n.order.create({payer:{email_address:e.email_address,name:{given_name:e.firstname,surname:e.surname},address:{address_line_1:e.address1,address_line_2:e.address2,admin_area_2:e.city,admin_area_1:e.state,postal_code:e.zipcode,country_code:"US"}},purchase_units:[{amount:{currency_code:e.currency,value:e.total,breakdown:{item_total:{currency_code:e.currency,value:e.totalbeforetax},tax_total:{currency_code:e.currency,value:e.taxvalue}}},shipping:{email_address:e.email_address,name:{full_name:e.firstname+" "+e.surname},address:{address_line_1:e.address1,address_line_2:e.address2,admin_area_2:e.city,admin_area_1:e.state,postal_code:e.zipcode,country_code:"US"}},items:r}]})},onApprove:function(e,r){var n="&payerid="+e.payerID,t="&orderid="+e.orderID;return r.order.capture().then((function(){window.location.replace(a+n+t)}))}}).render("#paypal-button-container")}}}));
define('local_commerce/checkout', ["jquery"],(function(t){return{init:function(e){function a(e,a){if(null!=e){let l="/local/commerce/classes/lib/settaxorder.php";t.ajax({method:"POST",url:l,data:{statesymbol:e,orderid:a}}).done((function(e){let a=JSON.parse(e);t("#totalvaluecell").text(a.totalvalue),t("#taxvaluespan").text(a.taxvalue)}))}}t(document).ready((function(){0!=t("#id_states").val()&&a(t("#id_states").val(),e)})),t("#id_states").change((function(){a(t(this).val(),e)}))}}}));
define('commercegateway_paypal_button/paypal', ["jquery"],function(e){return{init:function(e,n){paypal.Buttons({createOrder:function(n,r){return r.order.create({purchase_units:[{amount:{currency_code:e.currency,value:e.total,breakdown:{item_total:{currency_code:e.currency,value:e.total}}}}]})},onApprove:function(e,r){return r.order.capture().then(function(){window.location.replace(n)})}}).render("#paypal-button-container")}}});
